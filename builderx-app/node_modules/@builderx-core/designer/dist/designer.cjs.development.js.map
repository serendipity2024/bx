{"version":3,"file":"designer.cjs.development.js","sources":["../src/components/renderer/RootRenderer.tsx","../src/components/ScrollContainer.tsx","../src/components/ZoomContainer.tsx","../src/components/DesignerReact.tsx","../src/models/serializable/Serializable.ts","../src/models/base-model/rerendererLog.ts","../src/models/base-model/model.ts","../src/models/utils.ts","../src/events/EventCallableRegsitry.ts","../src/models/KeyValueContainer.tsx","../src/models/Style.tsx","../src/models/Props.tsx","../src/models/Layout.tsx","../src/events/index.ts","../src/events/SetLayoutEvent.ts","../src/events/RemoveChildEvent.ts","../src/models/GlobalLayerUpdateController.ts","../src/models/Layer.tsx","../src/models/MiddlewareRegistry.ts","../src/models/FunctionRegistry.ts","../src/events/MouseEvent.ts","../src/events/DropEvent.ts","../src/events/HoverEvent.ts","../src/events/SetScrollEvent.ts","../src/events/SetZoomEvent.ts","../src/constants/index.ts","../src/models/Canvas.tsx","../src/models/Gradient.ts","../src/plugins/Hover/index.ts","../src/plugins/Drag/DragEvent.ts","../src/plugins/Drag/index.ts","../src/plugins/ViewRenderer/ViewRenderer.tsx","../src/plugins/ViewRenderer/ViewComponentDefinition.ts","../src/plugins/ViewRenderer/index.ts","../src/plugins/TouchablOpacityRenderer/TouchableOpacityRenderer.tsx","../src/plugins/TouchablOpacityRenderer/TouchableOpacityComponentDefinition.ts","../src/plugins/TouchablOpacityRenderer/index.ts","../src/plugins/ScrollViewRenderer/ScrollViewRenderer.tsx","../src/plugins/ScrollViewRenderer/ScrollViewComponentDefinition.ts","../src/plugins/ScrollViewRenderer/index.ts","../src/events/RenderEvent.ts","../src/plugins/TextRenderer/TextRenderer.tsx","../src/plugins/TextRenderer/TextComponentDefinition.ts","../src/plugins/TextRenderer/index.ts","../src/plugins/TextInputRenderer/TextInputRenderer.tsx","../src/plugins/TextInputRenderer/TextInputComponentDefinition.ts","../src/plugins/TextInputRenderer/index.ts","../src/plugins/ImageRenderer/ImageRenderer.tsx","../src/plugins/ImageRenderer/ImageComponentDefinition.ts","../src/plugins/ImageRenderer/index.ts","../src/plugins/PathRenderer/PathRenderer.tsx","../src/plugins/PathRenderer/PathComponentDefinition.ts","../src/plugins/PathRenderer/index.ts","../src/plugins/IconRenderer/IconMap.ts","../src/plugins/IconRenderer/IconRenderer.tsx","../src/plugins/IconRenderer/IconComponentDefinition.ts","../src/plugins/IconRenderer/index.ts","../src/plugins/SwitchRenderer/android/AndroidSwitchRenderer.tsx","../src/plugins/SwitchRenderer/iOS/IOSSwitch.tsx","../src/plugins/SwitchRenderer/iOS/IOSSwitchRenderer.tsx","../src/plugins/SwitchRenderer/SwitchRenderer.tsx","../src/plugins/SwitchRenderer/SwitchComponentDefinition.ts","../src/plugins/SwitchRenderer/index.ts","../src/plugins/ActivityIndicatorRenderer/android/AndroidActivityIndicatorRenderer.tsx","../src/plugins/ActivityIndicatorRenderer/iOS/IOSSpinner.tsx","../src/plugins/ActivityIndicatorRenderer/iOS/IOSActivityIndicatorRenderer.tsx","../src/plugins/ActivityIndicatorRenderer/ActivityIndicatorRenderer.tsx","../src/plugins/ActivityIndicatorRenderer/ActivityIndicatorComponentDefinition.ts","../src/plugins/ActivityIndicatorRenderer/index.ts","../src/plugins/EllipseRenderer/EllipseRenderer.tsx","../src/plugins/EllipseRenderer/EllipseComponentDefinition.ts","../src/plugins/EllipseRenderer/index.ts","../src/plugins/SliderRenderer/SliderStyledComponents.tsx","../src/plugins/SliderRenderer/Slider.tsx","../src/plugins/SliderRenderer/SliderRenderer.tsx","../src/plugins/SliderRenderer/SliderComponentDefinition.ts","../src/plugins/SliderRenderer/index.ts","../src/plugins/MapViewRenderer/MapViewRenderer.tsx","../src/plugins/MapViewRenderer/MapViewComponentDefinition.ts","../src/plugins/MapViewRenderer/index.ts","../src/plugins/PopoverMenu/index.tsx","../src/plugins/SnapPointsCalculator/getSiblingPoints.ts","../src/plugins/SnapPointsCalculator/getParentSnapPoints.ts","../src/plugins/SnapPointsCalculator/getGutterPoints.ts","../src/plugins/SnapPointsCalculator/snapToGrid.ts","../src/plugins/SnapPointsCalculator/snapPoint.ts","../src/plugins/SnapPointsCalculator/getSnapPoints.ts","../src/plugins/SnapPointsCalculator/index.ts","../src/plugins/ConstructionLines/index.ts","../src/plugins/ScrollMousePosition/index.ts","../src/plugins/MeasurementLines/utils/index.ts","../src/plugins/MeasurementLines/components/XLines.ts","../src/plugins/MeasurementLines/components/YLines.ts","../src/plugins/MeasurementLines/index.ts","../src/plugins/MouseRect/events/index.ts","../src/plugins/MouseRect/index.ts","../src/plugins/TextEditor/TextEditorRenderer.tsx","../src/plugins/TextEditor/index.tsx","../src/plugins/PathEditor/PathEditorRenderer.tsx","../src/plugins/PathEditor/index.tsx","../src/plugins/GradientEditor/EditorRenderer.tsx","../src/events/CommandEvent.ts","../src/plugins/GradientEditor/index.tsx","../src/plugins/NativeHtmlDrag/index.ts","../src/plugins/StageDesignerDeviceData/index.ts","../src/events/PathEvent.ts","../src/events/ArtboardEvent.ts","../src/events/TextEditorEvent.ts","../src/plugins/LayerDrag/LayerDragEvent.ts","../src/plugins/LayerDrag/index.ts","../src/plugins/GridRenderer/index.tsx","../src/events/SelectLayers.ts","../src/events/ResetResizerEvent.ts","../src/plugins/StageDesigner/index.ts","../src/plugins/LayerMouseCursor/index.ts","../src/plugins/DataStore/index.ts","../src/plugins/Tooltip/index.ts","../src/plugins/OpacityShortcut/index.ts","../src/plugins/FontResizer/FontResizerEvent.ts","../src/plugins/FontResizer/index.ts","../src/plugins/FlexDrag/index.ts","../src/plugins/RulerScale/components/Ruler.tsx","../src/plugins/RulerScale/components/HorizontalRuler.ts","../src/plugins/RulerScale/components/VerticalRuler.tsx","../src/plugins/RulerScale/RulerScaleWrapper.tsx","../src/plugins/RulerScale/index.tsx","../src/plugins/RulerLines/events/RulerLinesAddEvent.ts","../src/plugins/RulerLines/events/RulerLinesSetPositionEvent.ts","../src/plugins/RulerLines/events/RulerLinesRemoveEvent.ts","../src/plugins/RulerLines/index.ts","../src/plugins/SnapLines/drawLinesForSnap.ts","../src/plugins/SnapLines/index.ts","../src/plugins/LineDrawer/events/index.ts","../src/plugins/LineDrawer/index.ts","../src/plugins/StageDesignerPreviewMode/iconsBase64.ts","../src/plugins/StageDesignerPreviewMode/index.ts","../src/plugins/StageDesignerDrop/StageDesignerDropEvent.ts","../src/plugins/StageDesignerDrop/index.ts","../src/plugins/StageDesignerDrawComponent/events/stageDesignerDrawEvent.ts","../src/plugins/StageDesignerDrawComponent/index.tsx","../src/plugins/StageDesignerRuler/index.ts","../src/plugins/DrawComponent/events/drawEvent.ts","../src/plugins/DrawComponent/index.tsx","../src/plugins/LayerLabel/events/layerLabelEvent.ts","../src/plugins/LayerLabel/index.ts","../src/plugins/DeviceFrame/Frames/iPhoneX.tsx","../src/plugins/DeviceFrame/Frames/iPhoneXsMax.tsx","../src/plugins/DeviceFrame/index.tsx","../src/plugins/StatusBar/StatusBarComponent/StatusBars/AndroidStatusBar.tsx","../src/plugins/StatusBar/StatusBarComponent/StatusBars/IPhoneXStatusBar.tsx","../src/plugins/StatusBar/StatusBarComponent/StatusBars/IOSStatusBar.tsx","../src/plugins/StatusBar/StatusBarComponent/index.tsx","../src/plugins/StatusBar/index.tsx","../src/plugins/ResizerRenderer/ResizerRendererDragEvent/index.ts","../src/plugins/ResizerRenderer/utils.ts","../src/plugins/ResizerRenderer/index.ts","../src/plugins/UndoRedo/index.ts","../src/plugins/LayerResizer/LayerResizerEvent/index.ts","../src/plugins/LayerResizer/index.ts","../src/plugins/FloatingButton/index.ts","../src/plugins/GradientEditor/event/index.ts","../src/plugins/PlusButton/index.ts","../src/plugins/HtmlDragToWorld/index.ts","../src/events/KeyboardEvent.ts"],"sourcesContent":["import * as React from 'react';\nimport { Layer } from '../../models/Layer';\nimport { Canvas } from '../../models/Canvas';\nimport ReactDOM from 'react-dom';\nimport { isNil } from 'lodash';\n\ntype RootRendererProps = {\n  canvas: Canvas;\n  layer: Layer;\n};\nexport default class RootRenderer extends React.PureComponent<\n  RootRendererProps,\n  any\n> {\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n\n  componentDidMount() {\n    this.props.layer.on(['type'], this.onUpdate);\n  }\n  componentWillUnmount() {\n    this.props.layer.off(['type'], this.onUpdate);\n  }\n\n  render() {\n    const layer = this.props.layer;\n    const TheChosenOne = this.props.canvas.getRenderer(layer.type);\n    return (\n      <TheChosenOne\n        RootRenderer={RootRenderer}\n        layer={layer}\n        canvas={this.props.canvas}\n      />\n    );\n  }\n}\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\n\nimport Scrollbars from 'react-custom-scrollbars';\nimport { Canvas } from '../models/Canvas';\nimport SetScrollEvent from '../events/SetScrollEvent';\n\ntype Props = {\n  canvas: Canvas;\n  style?: any;\n  stage?: string;\n  displayMode?: string;\n};\nexport default class ScrollContainer extends React.PureComponent<Props, any> {\n  scrollDom: any;\n  scrollContainerRef: Scrollbars | null | undefined;\n  center: any;\n  zoom: any;\n  scroll: any;\n  baseState: any;\n  viewportState: any;\n\n  constructor(props: any) {\n    super(props);\n    this.zoom = props.canvas.getZoom();\n    this.scroll = props.canvas.getScroll();\n\n    const scrollFactor: any = { x: 0.5, y: 0.5 };\n    const scrollXFactor: number = scrollFactor.x;\n    const scrollYFactor: number = scrollFactor.y;\n\n    this.state = {\n      scroll: { x: scrollXFactor, y: scrollYFactor },\n    };\n  }\n\n  onUpdate = () => {\n    const viewport = this.props.canvas.getViewport();\n    this.viewportState = {\n      height: viewport.height,\n      width: viewport.width,\n    };\n\n    this.baseState = {\n      height: this.props.canvas.layout.get('height'),\n      width: this.props.canvas.layout.get('width'),\n    };\n    this.forceUpdate();\n    this.centerScrollTo();\n  };\n\n  componentDidMount() {\n    if (this.scrollContainerRef) {\n      this.scrollDom = ReactDOM.findDOMNode(this.scrollContainerRef);\n    }\n    document.addEventListener('keydown', function(e: any) {\n      if (e.keyCode === 32 && e.target === document.body) {\n        e.preventDefault();\n      }\n    });\n\n    this.setCenterPosition();\n    this.getCenterPointInCurrentViewport();\n    this.centerScrollTo();\n    this.props.canvas.addEventListener('setScroll', this.setScroll);\n    this.props.canvas.on('zoom', (e: any) => {\n      if (this.zoom !== this.props.canvas.getZoom()) {\n        this.zoom = this.props.canvas.getZoom();\n        this.centerScrollTo();\n      }\n    });\n\n    this.props.canvas.on(\n      ['viewport', 'layout', 'mouseCursorType'],\n      this.onUpdate\n    );\n    this.props.canvas.on(['moveWithGrabHandle'], this.onUpdate);\n  }\n\n  componentWillUnmount() {\n    this.props.canvas.off(\n      ['viewport', 'layout', 'mouseCursorType'],\n      this.onUpdate\n    );\n    this.props.canvas.off(['moveWithGrabHandle'], this.onUpdate);\n    this.props.canvas.removeEventListener('setScroll', this.setScroll);\n  }\n  setScroll = (scroll: SetScrollEvent) => {\n    this.state.scroll.x = scroll.scrollX;\n    this.state.scroll.y = scroll.scrollY;\n\n    const scrollX: number =\n      this.state.scroll.x *\n      (this.baseState.width * this.zoom - this.viewportState.width);\n\n    const scrollY: number =\n      this.state.scroll.y *\n      (this.baseState.height * this.zoom - this.viewportState.height);\n\n    const centerX =\n      ((scrollX as number) + this.viewportState.width / 2) /\n      (this.baseState.width * this.zoom);\n\n    const centerY =\n      ((scrollY as number) + this.viewportState.height / 2) /\n      (this.baseState.height * this.zoom);\n\n    this.center = { x: centerX, y: centerY };\n\n    this.centerScrollTo();\n  };\n\n  getScrollPositon(inputScroll?: any): any {\n    const props = this.props;\n    let scroll = inputScroll ? inputScroll : this.scroll;\n    const scrollX: number =\n      scroll.x * (this.baseState.width * this.zoom - this.viewportState.width);\n\n    const scrollY: number =\n      scroll.y *\n      (this.baseState.height * this.zoom - this.viewportState.height);\n\n    return { x: scrollX, y: scrollY };\n  }\n  getCenterPointInCurrentViewport() {\n    const props = this.props;\n    const scrollPostion = this.getScrollPositon();\n    let centerX =\n      (scrollPostion.x + this.viewportState.width / 2) /\n      (this.baseState.width * this.zoom);\n\n    let centerY =\n      (scrollPostion.y + this.viewportState.height / 2) /\n      (this.baseState.height * this.zoom);\n    this.center = { x: centerX, y: centerY };\n  }\n  setCenterPosition() {\n    this.center = {\n      x:\n        (this.state.scroll.x +\n          this.viewportState.width / (this.baseState.width * this.zoom)) /\n        2,\n      y:\n        (this.state.scroll.y +\n          this.viewportState.height / (this.baseState.height * this.zoom)) /\n        2,\n    };\n  }\n\n  centerScrollTo = (emit: boolean = true) => {\n    const centerX: number = this.center.x * (this.baseState.width * this.zoom);\n    const centerY: number = this.center.y * (this.baseState.height * this.zoom);\n\n    let scrollY = centerY - this.viewportState.height / 2;\n    let scrollX = centerX - this.viewportState.width / 2;\n\n    if (this.scrollContainerRef) {\n      this.scrollContainerRef.scrollLeft(scrollX);\n      this.scrollContainerRef.scrollTop(scrollY);\n    }\n  };\n\n  onScrollFrame = (values: any) => {\n    if (this.scrollContainerRef) {\n      if (this.viewportState.height > 0 && this.viewportState.width > 0) {\n        const x =\n          (values.scrollLeft as number) /\n          (this.baseState.width * this.zoom - this.viewportState.width);\n        const y =\n          (values.scrollTop as number) /\n          (this.baseState.height * this.zoom - this.viewportState.height);\n\n        const centerX =\n          ((values.scrollLeft as number) + this.viewportState.width / 2) /\n          (this.baseState.width * this.zoom);\n\n        const centerY =\n          ((values.scrollTop as number) + this.viewportState.height / 2) /\n          (this.baseState.height * this.zoom);\n\n        this.center = {\n          x: centerX,\n          y: centerY,\n        };\n\n        this.state.scroll.x = isNaN(x) ? 0 : x;\n        this.state.scroll.y = isNaN(y) ? 0 : y;\n        this.centerScrollTo();\n        this.props.canvas.setScroll(this.state.scroll);\n      }\n    }\n  };\n\n  moveWithGrabHandle = (event: React.MouseEvent<Scrollbars>) => {\n    if (this.props.canvas.isMouseDown && this.props.canvas.moveWithGrabHandle) {\n      // window.requestAnimationFrame(() => {\n      if (this.scrollContainerRef) {\n        const deltaX = event.nativeEvent.movementX,\n          deltaY = event.nativeEvent.movementY,\n          currentScrollX = this.scrollContainerRef.getScrollLeft(),\n          currentScrollY = this.scrollContainerRef.getScrollTop();\n        this.scrollContainerRef.scrollLeft(currentScrollX - deltaX);\n        this.scrollContainerRef.scrollTop(currentScrollY - deltaY);\n        event.stopPropagation();\n      }\n      // });\n    }\n  };\n\n  render() {\n    const spaceKey = this.props.canvas.moveWithGrabHandle;\n\n    this.baseState = {\n      height: this.props.canvas.layout.get('height'),\n      width: this.props.canvas.layout.get('width'),\n    };\n    const viewport = this.props.canvas.getViewport();\n    this.viewportState = {\n      height: viewport.height,\n      width: viewport.width,\n    };\n    return (\n      <Scrollbars\n        ref={c => {\n          this.scrollContainerRef = c;\n        }}\n        autoHide\n        onScrollFrame={this.onScrollFrame}\n        style={{\n          ...this.props.style,\n          width: this.viewportState.width,\n          height: this.viewportState.height,\n          cursor: this.props.canvas.mouseCursorType\n            ? this.props.canvas.mouseCursorType\n            : 'initial',\n          overflow: 'scroll',\n        }}\n        onMouseDown={e => {\n          // @ts-ignore\n          if (e.button !== 2 && e.which !== 3) {\n            // this.mouseDown = true;\n            this.props.canvas.setMouseDown(true);\n          }\n        }}\n        onMouseUp={() => {\n          // this.mouseDown = false;\n          this.props.canvas.setMouseDown(false);\n        }}\n        onMouseLeave={() => {\n          // this.mouseDown = false;\n          this.props.canvas.setMouseDown(false);\n        }}\n        onMouseMove={this.moveWithGrabHandle}\n        className=\"scrollcontainer\"\n      >\n        {React.Children.map(this.props.children, (child: any) => {\n          if (child) {\n            return React.cloneElement(child, {\n              ...child.props,\n              style: {\n                ...child.props.style,\n                ...(spaceKey && this.props.canvas.isMouseDown\n                  ? { pointerEvents: 'none' }\n                  : {}),\n              },\n            });\n          }\n          return null;\n        })}\n      </Scrollbars>\n    );\n  }\n}\n","import * as React from 'react';\nimport { Canvas } from '../models/Canvas';\nimport SetZoomEvent from 'events/SetZoomEvent';\n\ntype Props = {\n  style?: any;\n  canvas: Canvas;\n  initialScroll: any;\n};\nexport default class ZoomContainer extends React.Component<Props, any> {\n  static defaultProps = { initialScroll: { x: 0, y: 0 } };\n  containerRef: any;\n  mouseDown: any;\n  center: any;\n  zoom: any;\n  constructor(props: any) {\n    super(props);\n    this.zoom = props.canvas.getZoom();\n    const scrollFactor: any =\n      props.initialScroll === undefined\n        ? ZoomContainer.defaultProps.initialScroll\n        : props.initialScroll;\n\n    const scrollXFactor: number = scrollFactor.x;\n    const scrollYFactor: number = scrollFactor.y;\n\n    this.state = {\n      scroll: { x: scrollXFactor, y: scrollYFactor },\n    };\n  }\n  componentDidMount() {\n    document.addEventListener('keydown', function(e: any) {\n      if (e.keyCode === 32 && e.target === document.body) {\n        e.preventDefault();\n      }\n    });\n\n    this.props.canvas.addEventListener('setZoom', this.onUpdateZoom);\n    this.props.canvas.on('children', this.onUpdate);\n  }\n\n  onUpdateZoom = (event: any) => {\n    this.zoom = event.zoom;\n    this.forceUpdate();\n  };\n\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  componentDidUpdate() {\n    this.props.canvas.setZoom(this.zoom);\n  }\n\n  componentWillMount() {\n    this.props.canvas.removeEventListener('setZoom', this.onUpdateZoom);\n    // this.props.canvas.off('children', this.onUpdate);\n  }\n\n  getSceneStyle(): any {\n    var style: any = {\n      position: 'absolute',\n    };\n    style.transform = `scale(${this.zoom})`;\n    // style.zoom = this.zoom;\n    style.transformOrigin = '0 0';\n    return style;\n  }\n\n  render() {\n    let { initialScroll, ...props } = this.props;\n    // console.log(this.zoom, '#####');\n    return (\n      <div\n        ref={(c: any) => {\n          this.containerRef = c;\n        }}\n        onClick={e => {}}\n        style={this.getSceneStyle()}\n        className=\"zoomContainer\"\n      >\n        {React.Children.map(this.props.children, (child: any) => {\n          if (child) {\n            return React.cloneElement(child, {\n              ...child.props,\n              style: {\n                ...child.props.style,\n              },\n            });\n          }\n          return null;\n        })}\n      </div>\n    );\n  }\n}\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport RootRenderer from './renderer/RootRenderer';\nimport ScrollContainer from './ScrollContainer';\nimport ZoomContainer from './ZoomContainer';\nimport { Canvas } from '../models/Canvas';\nclass CanvasRenderer extends React.PureComponent<{ canvas: Canvas }, any> {\n  onUpdate = (keys: any) => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.canvas.on(['zoom', 'viewport', 'layout'], this.onUpdate);\n  }\n  componentWillUnmount() {\n    this.props.canvas.off(['zoom', 'viewport', 'layout'], this.onUpdate);\n  }\n\n  render() {\n    const baseHeight = this.props.canvas.layout.get('height');\n    const baseWidth = this.props.canvas.layout.get('width');\n\n    return (\n      <div\n        style={{\n          position: 'relative',\n          width: baseWidth,\n          height: baseHeight,\n          backgroundColor: this.props.canvas.style.get('backgroundColor'),\n        }}\n      >\n        {this.props.canvas.children.map((child: any, index: any) => (\n          <RootRenderer layer={child} key={index} canvas={this.props.canvas} />\n        ))}\n      </div>\n    );\n  }\n}\nexport class DesignerReact extends React.PureComponent<\n  { canvas: Canvas },\n  any\n> {\n  renderCompiledDom: any;\n  worldStackRef: any;\n  viewportStackRef: any;\n  thisNode: HTMLDivElement | null = null;\n\n  onUpdate = (keys: any) => {\n    this.forceUpdate();\n  };\n  showConstructionLines = () => {\n    let canvasDOMElement = document.createElement('canvas');\n    canvasDOMElement.setAttribute('height', '2000px');\n    canvasDOMElement.setAttribute('width', '2000px');\n    canvasDOMElement.setAttribute('class', 'canvas-element');\n    canvasDOMElement.style.position = 'absolute';\n    canvasDOMElement.style.top = '0px';\n    canvasDOMElement.style.left = '0px';\n    canvasDOMElement.style.opacity = '1';\n    canvasDOMElement.style.pointerEvents = 'none';\n    if (this.renderCompiledDom) {\n      let pane = ReactDOM.findDOMNode(this.renderCompiledDom);\n      const context = canvasDOMElement.getContext('2d');\n      const collisionScope = this.props.canvas.collisionScope;\n      if (pane && context && collisionScope) {\n        context.strokeStyle = '#000';\n        context.beginPath();\n        collisionScope.drawBVH(context);\n        context.stroke();\n        pane.appendChild(canvasDOMElement);\n      }\n    }\n  };\n  renderDOMStack = () => {\n    if (this.worldStackRef) {\n      while (this.worldStackRef.firstChild) {\n        this.worldStackRef.removeChild(this.worldStackRef.firstChild);\n      }\n\n      this.props.canvas.stackWorldDOM.forEach(element => {\n        this.worldStackRef.appendChild(element);\n      });\n    }\n    if (this.viewportStackRef) {\n      while (this.viewportStackRef.firstChild) {\n        this.viewportStackRef.removeChild(this.viewportStackRef.firstChild);\n      }\n\n      this.props.canvas.stackViewportDOM.forEach(element => {\n        this.viewportStackRef.appendChild(element);\n      });\n    }\n  };\n  componentDidMount() {\n    this.renderDOMStack();\n    this.props.canvas.on(['zoom', 'viewport', 'layout'], this.onUpdate);\n\n    this.props.canvas.on(\n      ['stackWorldDOM', 'stackViewportDOM'],\n      this.renderDOMStack\n    );\n  }\n\n  componentWillUnmount() {\n    this.props.canvas.off(['zoom', 'viewport', 'layout'], this.onUpdate);\n    this.props.canvas.off(\n      ['stackWorldDOM', 'stackViewportDOM'],\n      this.renderDOMStack\n    );\n  }\n\n  onMouseDown = (e: React.MouseEvent) => {\n    if (this.thisNode && this.thisNode.ownerDocument) {\n      this.thisNode.ownerDocument.addEventListener(\n        'mousemove',\n        this.onMouseMove\n      );\n      this.thisNode.ownerDocument.addEventListener('mouseup', this.onMouseUp);\n      this.thisNode.ownerDocument.addEventListener(\n        'contextmenu',\n        this.onMouseUp\n      );\n    }\n\n    this.props.canvas.handleNativeEvent(e);\n  };\n\n  onMouseMove = (e: MouseEvent) => {\n    // if (!this.props.canvas.dragging) {\n    this.props.canvas.handleNativeEvent(e);\n    // }\n  };\n\n  onMouseUp = (e: MouseEvent) => {\n    if (this.thisNode && this.thisNode.ownerDocument) {\n      this.thisNode.ownerDocument.removeEventListener(\n        'mousemove',\n        this.onMouseMove\n      );\n      this.thisNode.ownerDocument.removeEventListener(\n        'mouseup',\n        this.onMouseUp\n      );\n      this.thisNode.ownerDocument.removeEventListener(\n        'contextmenu',\n        this.onMouseUp\n      );\n    }\n\n    this.props.canvas.handleNativeEvent(e);\n  };\n\n  render() {\n    const canvas = this.props.canvas;\n    const zoom = canvas.getZoom();\n    const baseHeight = canvas.layout.get('height');\n    const baseWidth = canvas.layout.get('width');\n    const viewport = canvas.getViewport();\n    const viewportHeight = viewport.height;\n    const viewportWidth = viewport.width;\n    // const cursor = canvas.mouseCursorType;\n    return (\n      <div style={{ position: 'absolute' }} ref={r => (this.thisNode = r)}>\n        <ScrollContainer\n          canvas={canvas}\n          ref={c => {\n            this.props.canvas.setViewportRef(c);\n          }}\n        >\n          <ZoomContainer\n            canvas={canvas}\n            style={{\n              height: baseHeight * zoom,\n              width: baseWidth * zoom,\n            }}\n          >\n            <CanvasRenderer canvas={this.props.canvas} />\n            <div\n              style={{\n                position: 'absolute',\n                top: 0,\n                left: 0,\n                right: 0,\n                bottom: 0,\n              }}\n            >\n              <div\n                style={{\n                  position: 'absolute',\n                  top: 0,\n                  left: 0,\n                  right: 0,\n                  bottom: 0,\n                }}\n                // onMouseMove={this.onMouseMove}\n                onMouseDown={this.onMouseDown}\n                onMouseEnter={e => canvas.handleNativeEvent(e)}\n                onMouseMove={e => canvas.handleNativeEvent(e)}\n                onClick={e => canvas.handleNativeEvent(e)}\n                onContextMenu={e => canvas.handleNativeEvent(e)}\n                onDoubleClick={e => canvas.handleNativeEvent(e)}\n                onMouseOut={e => canvas.handleNativeEvent(e)}\n                onDrop={e => canvas.handleNativeEvent(e)}\n                onDragOver={e => e.preventDefault()}\n              />\n              <div\n                ref={ref => {\n                  if (this.worldStackRef && !ref) {\n                    // THis means worldStackRef is being set null while it was set correctly earlier\n                    // We are preventing that here. Don't know the root cause\n                    return;\n                  }\n                  this.worldStackRef = ref;\n                }}\n                style={{\n                  position: 'absolute',\n                  pointerEvents: 'none',\n                  top: 0,\n                  left: 0,\n                  right: 0,\n                  bottom: 0,\n                }}\n              />\n            </div>\n          </ZoomContainer>\n        </ScrollContainer>\n        <div\n          style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            height: viewportHeight,\n            width: viewportWidth,\n            pointerEvents: 'none',\n            overflow: 'hidden',\n          }}\n          ref={ref => (this.viewportStackRef = ref)}\n        />\n      </div>\n    );\n  }\n}\n","import * as _ from 'lodash';\n\nexport default abstract class Serializable {\n  static fromJS(snapshot: any, classObject: any = undefined) {\n    if (!snapshot) {\n      return;\n    }\n    let classInstance: any = undefined;\n    if (classObject) {\n      classInstance = new classObject();\n    } else {\n      classInstance = new (this as any)();\n    }\n\n    // const fields: any = classInstance.getFields();\n    const fields: any = Serializable.getAllFields(classInstance);\n\n    _.forEach(Object.keys(snapshot), (key: any) => {\n      const field = fields[key];\n\n      if (!field) {\n        // console.log(fields, \"fields\");\n        console.warn(\n          `property ${key} is not declared in fields of ${classInstance.constructor.name} `\n        );\n        return;\n      }\n      if (field.type === 'ignore') {\n        return;\n      }\n      if (_.isNil(snapshot[key])) {\n        classInstance[key] = snapshot[key];\n      } else if (field.type === 'literal') {\n        classInstance[key] = snapshot[key];\n      } else if (field.type === 'array') {\n        if (_.isArray(snapshot[key])) {\n          classInstance[key] = [];\n          _.forEach(snapshot[key], (element: any) => {\n            if (_.isArray(element) && field.children.type === 'array') {\n              console.log('case not handled -!-!- toJS Serializable');\n            } else if (typeof element === 'object') {\n              const objectClassInstance = this.getClassInstanceFromPlainObject(\n                field.children,\n                element\n              );\n              if (objectClassInstance) {\n                classInstance[key].push(objectClassInstance);\n              }\n            } else if (field.children.type === 'literal') {\n              classInstance[key].push(element);\n            } else {\n              console.log('case not handled -!-!- toJS Serializable');\n            }\n          });\n        } else if (typeof snapshot[key] === 'object') {\n          // console.log(\"type declared array but got object\");\n          console.log('case not handled -!-!- Serializable');\n        } else if (classInstance[key]) {\n          // console.log(\"type declared array but got literal\");\n          classInstance[key] = snapshot[key];\n        }\n      } else if (field.type === 'map') {\n        classInstance[key] = new Map();\n        _.forEach(snapshot[key], (value: any, mapKey: string) => {\n          if (field.valueType === 'literal') {\n            classInstance[key].set(mapKey, value);\n          } else if (field.valueType.type === 'array') {\n            let valueArray: any[] = [];\n            _.forEach(value, (element: any) => {\n              if (_.isArray(element) && value.children.type === 'array') {\n                console.log('case not handled -!-!- toJS Serializable');\n              } else if (typeof element === 'object') {\n                const objectClassInstance = this.getClassInstanceFromPlainObject(\n                  field.valueType.children,\n                  element\n                );\n                if (objectClassInstance) {\n                  valueArray.push(objectClassInstance);\n                }\n              } else if (value.children.type === 'literal') {\n                valueArray.push(element);\n              } else {\n                console.log('case not handled -!-!- toJS Serializable');\n              }\n            });\n            classInstance[key].set(mapKey, valueArray);\n          } else if (typeof value === 'object') {\n            const valueClassInstance = this.getClassInstanceFromPlainObject(\n              field.valueType,\n              value\n            );\n            classInstance[key].set(mapKey, valueClassInstance);\n          }\n        });\n      } else {\n        classInstance[key] = this.getClassInstanceFromPlainObject(\n          field,\n          snapshot[key]\n        );\n      }\n    });\n    return classInstance;\n  }\n\n  static getAllFields = (instance: any, fields = {}): any => {\n    if (instance && instance.getFields) {\n      const newFields = { ...instance.getFields(), ...fields };\n      // Object.assign(fields, instance.getFields());\n      const superInstance = Object.getPrototypeOf(instance);\n\n      return Serializable.getAllFields(superInstance, newFields);\n    } else {\n      return fields;\n    }\n  };\n\n  // static getAllFields = (instance: any, fields = {}): any => {\n  //   if (instance && instance.getFields) {\n  //     const newFields = { ...instance.getFields(), ...fields };\n  //     // Object.assign(fields, instance.getFields());\n  //     const superFields = instance.getSuperFields();\n  //     console.log(superFields, \"superFields\");\n  //     return newFields;\n  //     // return Serializable.getAllFields(superInstance, newFields);\n  //   } else {\n  //     return fields;\n  //   }\n  // };\n\n  // getSuperFields() {\n  //   // @ts-ignore\n  //   console.log(super());\n  //   // @ts-ignore\n  //   return super.getFields();\n  // }\n\n  static getClassInstanceFromPlainObject(classObject: any, snapshot: any) {\n    if (classObject.fromJS) {\n      return classObject.fromJS(snapshot);\n    } else {\n      throw new Error(\n        `${classObject.constructor.name} is not extended from Serializable`\n      );\n    }\n  }\n\n  abstract getFields(): { [key: string]: any };\n  toJS(shallow: boolean = false) {\n    const fields = Serializable.getAllFields(this);\n    // console.log(fields, \"All Fields from JS\");\n    if (!fields) {\n      throw new Error('fileds are undefiend');\n    }\n    let ret: any = {};\n\n    if (shallow) {\n      delete fields.children;\n    }\n    _.forEach(fields, (value: any, key: any) => {\n      if (value.type === 'ignore') {\n        return;\n      }\n      if (!value) {\n        throw new Error(`type of ${key} is not defined`);\n      }\n      if (value) {\n        if (value.type === 'array') {\n          if (_.isArray((this as any)[key])) {\n            ret[key] = [];\n            _.forEach((this as any)[key], (element: any) => {\n              if (_.isArray(element) && value.children.type === 'array') {\n                console.log('case not handled -!-!- toJS Serializable');\n              } else if (typeof element === 'object') {\n                const object = this.getPlainObjectFromClassInstance(element);\n                if (object) {\n                  ret[key].push(object);\n                }\n              } else if (value.children.type === 'literal') {\n                ret[key].push(element);\n              } else {\n                console.log('case not handled -!-!- toJS Serializable');\n              }\n            });\n          } else if (typeof (this as any)[key] === 'object') {\n            // console.log(\"type declared array but got object\");\n            ret[key] = this.getPlainObjectFromClassInstance((this as any)[key]);\n          } else {\n            // console.log(\"type declared array but got literal\");\n            ret[key] = (this as any)[key];\n          }\n        } else if (value.type === 'map') {\n          ret[key] = this.MapToPOJO((this as any)[key]);\n        } else if (value.type === 'literal') {\n          ret[key] = (this as any)[key];\n        } else {\n          ret[key] = this.getPlainObjectFromClassInstance((this as any)[key]);\n        }\n      }\n      // else {\n      //   ret[key] = undefined;\n      // }\n    });\n    return _.omitBy(ret, _.isNil);\n  }\n\n  getPlainObjectFromClassInstance(object: any) {\n    if (object) {\n      if (object.toJS) {\n        return object.toJS();\n      } else {\n        throw new Error(\n          `${object.constructor.name} is not extended from Serializable`\n        );\n      }\n    } else {\n      return undefined;\n    }\n  }\n  MapToPOJO(mapInstance: Map<any, any>) {\n    const result: any = {};\n    if (mapInstance) {\n      mapInstance.forEach((value: any, key: any) => {\n        var valuePlainArray: any[] = [];\n        if (_.isArray(value)) {\n          _.forEach(value, (element: any) => {\n            const object = this.getPlainObjectFromClassInstance(element);\n            if (object) {\n              valuePlainArray.push(object);\n            }\n          });\n          result[key] = valuePlainArray;\n        } else {\n          result[key] = this.getPlainObjectFromClassInstance(value);\n        }\n      });\n    }\n    return result;\n  }\n}\n\nconst literal = {\n  type: 'literal',\n  children: null,\n};\n\nconst array = function(type: any) {\n  return {\n    type: 'array',\n    children: type,\n  };\n};\nconst map = function(keyType: any, valueType: any) {\n  return {\n    type: 'map',\n    keyType: keyType,\n    valueType: valueType,\n  };\n};\nconst ignore = {\n  type: 'ignore',\n  children: null,\n};\n\nexport const types = {\n  literal,\n  array,\n  map,\n  ignore,\n};\n","let logEnabled = false;\n\nexport const enableLog = () => {\n  logEnabled = true;\n};\n\nexport const rerendererLog = (...args: any[]) => {\n  if (logEnabled) {\n    return console.log(...args);\n  }\n\n  return () => {\n    //\n  };\n};\n\nexport const rerendererTrace = (...args: any[]) => {\n  if (logEnabled) {\n    return console.trace(...args);\n  }\n\n  return () => {\n    //\n  };\n};\n","import { uniq, remove, reduce, union } from 'lodash';\nimport { Serializable, types } from '../serializable';\nimport { rerendererLog } from './rerendererLog';\n\nexport type onUpdateListener = (...args: Array<any>) => void;\nlet stopUpdates = false;\nlet actionCounter = 0;\nlet noRerenderCounter = 0;\n\nconst pendingUpdates: Map<\n  onUpdateListener,\n  { properties: Array<string>; model: Model }\n> = new Map();\nexport const shouldStopUpdates = (value: boolean) => {\n  stopUpdates = value;\n};\nexport const action = (callback: any) => {\n  actionCounter++;\n  callback();\n  // rerendererLog(\"HHH^&^& action completed\", pendingUpdates);\n  // console.log(\n  //   \"HHH^&^& action completed\"\n  //   // JSON.stringify(pendingUpdates.values(), null, 2)\n  // );\n\n  actionCounter--;\n\n  if (actionCounter === 0) {\n    pendingUpdates.forEach(function runListenersBatch(\n      updateObject: any,\n      listener: any\n    ) {\n      // console.log(\"HHH^&^& batch emit\", updateObject.properties, listener);\n      if (!updateObject.model.disposed && !stopUpdates) {\n        listener(updateObject.properties);\n        // @ts-ignore\n        if (window['debug']) {\n          console.log('DEBUG::', 'Emit:', updateObject.properties);\n        }\n      }\n    });\n    pendingUpdates.clear();\n  }\n};\nexport const noRerender = (callback: any) => {\n  noRerenderCounter++;\n  callback();\n  noRerenderCounter--;\n};\n\nexport default abstract class Model extends Serializable {\n  eventListenersMap: Map<string, Array<onUpdateListener>> = new Map();\n  reverseMap: Map<onUpdateListener, Array<string>> = new Map();\n  disposed?: boolean = false;\n\n  getFields(): { [key: string]: any } {\n    return {\n      eventListenersMap: types.ignore,\n      reverseMap: types.ignore,\n      disposed: types.ignore,\n    };\n  }\n\n  on(properties: Array<string> | string, listener: onUpdateListener) {\n    if (typeof properties === 'string') {\n      // If a single property is received, wrap it in an Array\n      properties = [properties];\n    }\n\n    properties.forEach(property => {\n      const existingArrOfListeners = this.eventListenersMap.get(property);\n\n      if (existingArrOfListeners) {\n        existingArrOfListeners.push(listener);\n        this.eventListenersMap.set(property, existingArrOfListeners);\n      } else {\n        this.eventListenersMap.set(property, [listener]);\n      }\n    });\n    // rerendererLog(this, \"^&^&this\");\n    let arrayOfProperties = this.reverseMap.get(listener);\n    if (arrayOfProperties) {\n      arrayOfProperties = arrayOfProperties.concat(properties);\n      // rerendererLog(arrayOfKeys, \"arrayOfKeys &*\");\n      this.reverseMap.set(listener, uniq(arrayOfProperties));\n    } else {\n      this.reverseMap.set(listener, properties);\n    }\n    // rerendererLog(\n    //   this.watchersMap.entries(),\n    //   this.reverseMap.entries(),\n    //   \"watch &*\"\n    // );\n  }\n\n  emit(properties: Array<string> | string) {\n    if (noRerenderCounter > 0) {\n      return;\n    }\n    // console.trace(properties, \"propertiesproperties\");\n    /*if (properties === '*' || properties[0] === '*') {\n      throw Error(\n        'Emitting * is not allowed. Thodi mehnat kar k saari properties emit kar do.'\n      );\n    }*/\n\n    if (typeof properties === 'string') {\n      // If a single property is received, wrap it in an Array\n      properties = [properties];\n    }\n\n    properties.push('*');\n\n    rerendererLog(\n      'HHH^&^& emitting ',\n      properties,\n      this.eventListenersMap,\n      this.reverseMap\n    );\n\n    let combinedArrayOfListeners: Array<onUpdateListener> = reduce(\n      properties,\n      (combined: Array<onUpdateListener>, property) => {\n        const existingArrOfListeners = this.eventListenersMap.get(property);\n        if (existingArrOfListeners) {\n          combined = union(combined, existingArrOfListeners);\n        }\n\n        return combined;\n      },\n      []\n    );\n\n    rerendererLog(combinedArrayOfListeners, 'combinedArrayOfListeners');\n\n    combinedArrayOfListeners.forEach(listener => {\n      rerendererLog('HHH^&^&  updating observer', listener);\n      if (listener) {\n        if (actionCounter) {\n          let existingUpdateObject = pendingUpdates.get(listener);\n          if (existingUpdateObject) {\n            existingUpdateObject.properties = existingUpdateObject.properties.concat(\n              properties\n            );\n            pendingUpdates.set(listener, {\n              properties: uniq(existingUpdateObject.properties),\n              model: this,\n            });\n          } else {\n            pendingUpdates.set(listener, {\n              properties: properties as Array<string>,\n              model: this,\n            });\n          }\n        } else {\n          throw new Error('emitting an event outside of an action');\n        }\n        // listener(properties);\n      }\n    });\n  }\n\n  off(properties: Array<string> | string, listener: onUpdateListener) {\n    // rerendererLog(observerComponent, \"sufhesfbo sefu esfi \");\n\n    if (typeof properties === 'string') {\n      // If a single property is received, wrap it in an Array\n      properties = [properties];\n    }\n\n    properties.forEach(() => {\n      const arrayOfProperties = this.reverseMap.get(listener);\n      if (arrayOfProperties) {\n        arrayOfProperties.forEach(key => {\n          const existingArrOfListeners = this.eventListenersMap.get(key);\n          if (!existingArrOfListeners) {\n            return;\n          }\n\n          remove(existingArrOfListeners, n => {\n            return n === listener;\n          });\n\n          if (existingArrOfListeners.length === 0) {\n            this.eventListenersMap.delete(key);\n          }\n        });\n        this.reverseMap.delete(listener);\n      }\n    });\n\n    // rerendererLog(\n    //   this.watchersMap.entries(),\n    //   this.reverseMap.entries(),\n    //   \"remove &*\"\n    // );\n  }\n}\n","import { IDimensionWithRotation, IPosition, Layer } from './../';\nimport { isNil, map, reverse, forEach } from 'lodash';\nimport { Gradient } from './Gradient';\nexport default class ModelUtils {\n  static pointsOverlap(point1: number, point2: number) {\n    return Math.abs(point1 - point2) <= 1;\n  }\n\n  static getDimensionFromPolygon(points: any) {\n    let height = points[3][1] - points[0][1];\n    let width = points[1][0] - points[0][0];\n    let y = points[0][1];\n    let x = points[0][0];\n\n    return { x, y, width, height };\n  }\n  static rotatePolygon(poly: any, angle: number, centroid?: any) {\n    var centroid = centroid ? centroid : ModelUtils.getCentroid(poly);\n    poly.map((point: any, key: number) => {\n      point = ModelUtils.rotatePoint(point, angle, centroid);\n      poly[key] = point;\n    });\n\n    return poly;\n  }\n  static findAngle(A: any, B: any, C: any, range: 180 | 360) {\n    let AB = Math.sqrt(Math.pow(B[0] - A[0], 2) + Math.pow(B[1] - A[1], 2));\n    let BC = Math.sqrt(Math.pow(B[0] - C[0], 2) + Math.pow(B[1] - C[1], 2));\n    let AC = Math.sqrt(Math.pow(C[0] - A[0], 2) + Math.pow(C[1] - A[1], 2));\n\n    let value = (BC * BC + AB * AB - AC * AC) / (2 * BC * AB);\n    if (value > 1) {\n      value = 1;\n    }\n    if (value < -1) {\n      value = -1;\n    }\n    let angle = Math.acos(value);\n    angle = angle * (180 / Math.PI);\n    if (range === 360) {\n      if (C[0] < A[0]) {\n        angle = 360 - angle;\n      }\n    }\n    return angle;\n  }\n\n  static getAbsoluteRotation(poly: Array<any>) {\n    const centroid = ModelUtils.getCentroid(poly);\n    // get three points of a triangle to get angle between two lines\n    const point1 = [centroid[0], centroid[1] - 2];\n    const point3 = ModelUtils.middlePoint(poly[0], poly[1]);\n    // get angle created by two lines\n    const angle = ModelUtils.findAngle(point1, centroid, point3, 360);\n    return angle;\n  }\n  static middlePoint(point1: any, point2: any) {\n    let newX = (point1[0] + point2[0]) / 2;\n    let newY = (point1[1] + point2[1]) / 2;\n    return [newX, newY];\n  }\n  static getCentroid(coord: Array<any>) {\n    var center: any = coord.reduce(\n      function(point1: any, point2: any) {\n        return [\n          point1[0] + point2[0] / coord.length,\n          point1[1] + point2[1] / coord.length,\n        ];\n      },\n      [0, 0]\n    );\n    return center;\n  }\n  static distance(point1: any, point2: any) {\n    var a = point1[0] - point2[0];\n    var b = point1[1] - point2[1];\n    var c = Math.sqrt(a * a + b * b);\n    return c;\n  }\n  static rotatePoint(point: any, angle: number, centroid: any) {\n    angle = (angle * Math.PI) / 180.0;\n    let newX =\n      (point[0] - centroid[0]) * Math.cos(angle) -\n      (point[1] - centroid[1]) * Math.sin(angle) +\n      centroid[0];\n    let newY =\n      (point[1] - centroid[1]) * Math.cos(angle) +\n      (point[0] - centroid[0]) * Math.sin(angle) +\n      centroid[1];\n    return [newX, newY];\n  }\n  static getPointsFromBoundingBox(box: any, rotation: number = 0): Array<any> {\n    let poly = [\n      [box.x, box.y],\n      [box.x + box.width, box.y],\n      [box.x + box.width, box.y + box.height],\n      [box.x, box.y + box.height],\n    ];\n\n    // var centroid = getCentroid(poly);\n    var rotatedPoly = ModelUtils.rotatePolygon(poly, rotation);\n\n    return rotatedPoly;\n  }\n  static getPointsFromDims(dims: any) {\n    let newX = dims.x;\n    let newY = dims.y;\n    let width = dims.width;\n    let height = dims.height;\n\n    let poly = [\n      [newX, newY],\n      [newX + width, newY],\n      [newX + width, newY + height],\n      [newX, newY + height],\n    ];\n\n    let transform = reverse([...dims.transform]);\n\n    transform.map((obj: any, index: number) => {\n      if (obj.rotate && obj.rotate.rotation && obj.rotate.centroid) {\n        poly = ModelUtils.rotatePolygon(\n          poly,\n          obj.rotate.rotation,\n          obj.rotate.centroid\n        );\n      }\n    });\n\n    return poly;\n  }\n  static depthComparator(a: string | null, b: string | null): -1 | 0 | 1 {\n    let activeA: number | null = ModelUtils.getActiveDigit(a);\n    let activeB: number | null = ModelUtils.getActiveDigit(b);\n\n    if (a === b) {\n      return 0;\n    }\n\n    if (activeA !== null && activeB !== null && activeA !== activeB) {\n      if (activeA < activeB) {\n        return -1;\n      } else {\n        return 1;\n      }\n    } else if (activeA !== null && activeB !== null && activeA === activeB) {\n      let nextA = ModelUtils.getNextCharacter(a);\n      let nextB = ModelUtils.getNextCharacter(b);\n\n      return ModelUtils.depthComparator(nextA, nextB);\n    } else if (activeA !== null) {\n      return 1;\n    } else {\n      return -1;\n    }\n  }\n  private static getNextCharacter(a: string | null): string | null {\n    if (a === null) {\n      return '';\n    }\n    let aIndex = a.indexOf('.');\n    if (aIndex === -1) {\n      return '';\n    }\n\n    return a.substring(aIndex + 1, a.length);\n  }\n  private static getActiveDigit(a: string | null): number | null {\n    if (a === null || a.length === 0) {\n      return null;\n    }\n\n    if (!a.includes('.')) {\n      return parseInt(a, 10);\n    }\n    return parseInt(a.substring(0, a.indexOf('.')), 10);\n  }\n}\n\nexport function getCorrection(\n  orientation: IDimensionWithRotation,\n  finalOrientation: IDimensionWithRotation,\n  handle: any\n) {\n  let rotation = orientation.rotation;\n  let angle = (rotation * Math.PI) / 180.0;\n\n  let x1 = -orientation.width / 2;\n  let y1 = orientation.height / 2;\n\n  // tslint:disable:variable-name\n  let new_x1 = y1 * Math.sin(angle) + x1 * Math.cos(angle);\n  let new_y1 = y1 * Math.cos(angle) - x1 * Math.sin(angle);\n\n  let diff1 = { x: new_x1 - x1, y: new_y1 - y1 };\n\n  // only width\n  let y2 = orientation.height / 2;\n  let x2 = -finalOrientation.width / 2;\n  let new_x2 = y2 * Math.sin(angle) + x2 * Math.cos(angle);\n  let new_y2 = y2 * Math.cos(angle) - x2 * Math.sin(angle);\n  let diff2 = { x: new_x2 - x2, y: new_y2 - y2 };\n\n  let offsetWidth = { x: diff2.x - diff1.x, y: diff2.y - diff1.y };\n\n  // only height\n\n  // tslint:disable:no-duplicate-variable\n  y2 = finalOrientation.height / 2;\n  x2 = -orientation.width / 2;\n\n  new_x2 = y2 * Math.sin(angle) + x2 * Math.cos(angle);\n  new_y2 = y2 * Math.cos(angle) - x2 * Math.sin(angle);\n\n  diff2 = { x: new_x2 - x2, y: new_y2 - y2 };\n\n  let offsetHeight = { x: diff2.x - diff1.x, y: diff2.y - diff1.y };\n\n  let newX = finalOrientation.x;\n  let newY = finalOrientation.y;\n\n  if (handle.indexOf('T') !== -1 || handle.indexOf('L') !== -1) {\n    newX = finalOrientation.x + (offsetWidth.x + offsetHeight.x);\n    newY = finalOrientation.y - (offsetWidth.y + offsetHeight.y);\n  }\n\n  if (handle.indexOf('B') !== -1 || handle.indexOf('R') !== -1) {\n    newX = finalOrientation.x - (offsetWidth.x + offsetHeight.x);\n    newY = finalOrientation.y + (offsetWidth.y + offsetHeight.y);\n  }\n\n  if (handle.indexOf('B') !== -1 && handle.indexOf('L') !== -1) {\n    newX = finalOrientation.x + offsetWidth.x - offsetHeight.x;\n    newY = finalOrientation.y - offsetWidth.y + offsetHeight.y;\n  }\n\n  if (handle.indexOf('T') !== -1 && handle.indexOf('R') !== -1) {\n    newX = finalOrientation.x - offsetWidth.x + offsetHeight.x;\n    newY = finalOrientation.y + offsetWidth.y - offsetHeight.y;\n  }\n\n  if (handle.indexOf('C') !== -1) {\n    newX = finalOrientation.x;\n    newY = finalOrientation.y;\n  }\n\n  return {\n    x: newX,\n    y: newY,\n    height: finalOrientation.height,\n    width: finalOrientation.width,\n    rotation,\n  };\n}\n\nexport function getResizerQuad(rotation: number): string {\n  rotation = rotation % 360;\n\n  if (rotation < 0) {\n    rotation += 360;\n  }\n  if (!rotation) {\n    return '4';\n  }\n  if (rotation < 0) {\n    //\n  }\n  if (\n    (rotation >= 22.5 && rotation < 67.5) ||\n    (rotation >= 202.5 && rotation < 247.5)\n  ) {\n    return '1';\n  }\n\n  if (\n    (rotation >= 67.5 && rotation < 112.5) ||\n    (rotation >= 247.5 && rotation < 292.5)\n  ) {\n    return '2';\n  }\n  if (\n    (rotation >= 112.5 && rotation < 157.5) ||\n    (rotation >= 292.5 && rotation < 337.5)\n  ) {\n    return '3';\n  }\n\n  if (\n    (rotation >= 157.5 && rotation < 202.5) ||\n    (rotation >= 337.5 && rotation < 22.5)\n  ) {\n    return '4';\n  }\n  return '4';\n}\n\nexport function computeOrientation(\n  layout: IDimensionWithRotation,\n  delta: IPosition,\n  handle: string,\n  shift: boolean,\n  alt: boolean\n) {\n  if (shift && !alt) {\n    return computeOrientationWithDeltaAR(layout, delta, handle);\n  } else if (!shift && alt) {\n    return computeOrientationWithDeltaAlt(layout, delta, handle);\n  } else if (shift && alt) {\n    return computeOrientationWithDeltaShiftAlt(layout, delta, handle);\n  } else {\n    return computeOrientationWithDelta(layout, delta, handle);\n  }\n}\n\nexport function computeOrientationMultiple(\n  orientation: IDimensionWithRotation,\n  delta: IPosition,\n  handle: any,\n  boundaryBox: any,\n  points: Array<any>,\n  shift?: boolean,\n  alt?: boolean\n) {\n  if (shift && !alt) {\n    return computeOrientationWithDeltaARMultiple(\n      orientation,\n      delta,\n      handle,\n      boundaryBox,\n      points\n    );\n  } else if (!shift && alt) {\n    return computeOrientationWithDeltaAltMultiple(\n      orientation,\n      delta,\n      handle,\n      boundaryBox,\n      points\n    );\n  } else if (shift && alt) {\n    return computeOrientationWithDeltaShiftAltMultiple(\n      orientation,\n      delta,\n      handle,\n      boundaryBox,\n      points\n    );\n  } else {\n    return computeOrientationWithDeltaMultiple(\n      orientation,\n      delta,\n      handle,\n      boundaryBox,\n      points\n    );\n  }\n}\n\nexport function computeOrientationWithDelta(\n  layout: IDimensionWithRotation,\n  delta: IPosition,\n  handle: string\n): IDimensionWithRotation {\n  let x = layout.x;\n  let y = layout.y;\n  let width = Math.max(layout.width, 0);\n  let height = Math.max(layout.height, 0);\n  let deltaX = !isNil(delta.x) ? delta.x : 0;\n  let deltaY = !isNil(delta.y) ? delta.y : 0;\n  let rotation = layout.rotation;\n\n  if (handle.indexOf('C') !== -1) {\n    x += deltaX;\n    y += deltaY;\n  }\n\n  if (handle.indexOf('B') !== -1) {\n    height += deltaY;\n  }\n  if (handle.indexOf('R') !== -1) {\n    width += deltaX;\n  }\n  if (handle.indexOf('T') !== -1) {\n    height -= deltaY;\n    y += deltaY;\n  }\n\n  if (handle.indexOf('L') !== -1) {\n    width -= deltaX;\n    x += deltaX;\n  }\n\n  let finalOrientation = {\n    x,\n    y,\n    width,\n    height,\n    rotation,\n  };\n\n  finalOrientation = getCorrection(layout, finalOrientation, handle);\n  return finalOrientation;\n}\n\nexport function computeOrientationWithDeltaMultiple(\n  orientation: IDimensionWithRotation,\n  delta: IPosition,\n  handle: any,\n  boundaryBox: any,\n  points: Array<any>\n): IDimensionWithRotation {\n  let x = orientation.x;\n  let y = orientation.y;\n  let width = orientation.width;\n  let height = orientation.height;\n  let deltaX = !isNil(delta.x) ? delta.x : 0;\n  let deltaY = !isNil(delta.y) ? delta.y : 0;\n  let rotation = orientation.rotation;\n  if (handle.indexOf('C') !== -1) {\n    x += deltaX;\n    y += deltaY;\n  } else {\n    let newPoints: any = [...points];\n    map(newPoints, (point: any, index: number) => {\n      let pointXDiff = 0;\n      let pointYDiff = 0;\n      if (handle.indexOf('B') !== -1) {\n        pointYDiff =\n          1 -\n          (boundaryBox.height - (point[1] - boundaryBox.y)) /\n            boundaryBox.height;\n      }\n      if (handle.indexOf('R') !== -1) {\n        pointXDiff =\n          1 -\n          (boundaryBox.width - (point[0] - boundaryBox.x)) / boundaryBox.width;\n      }\n      if (handle.indexOf('T') !== -1) {\n        pointYDiff =\n          (boundaryBox.height - (point[1] - boundaryBox.y)) /\n          boundaryBox.height;\n      }\n      if (handle.indexOf('L') !== -1) {\n        pointXDiff =\n          (boundaryBox.width - (point[0] - boundaryBox.x)) / boundaryBox.width;\n      }\n      let pointY = point[1] + pointYDiff * deltaY;\n      let pointX = point[0] + pointXDiff * deltaX;\n      let pointNew = [pointX, pointY];\n      newPoints[index] = pointNew;\n    });\n\n    newPoints = ModelUtils.rotatePolygon(newPoints, 360 - rotation);\n    let box = ModelUtils.getDimensionFromPolygon(newPoints);\n    height = box.height;\n    width = box.width;\n    y = box.y;\n    x = box.x;\n  }\n\n  return {\n    width,\n    height,\n    x,\n    y,\n    rotation,\n  };\n}\n\nexport function computeOrientationWithDeltaARMultiple(\n  orientation: IDimensionWithRotation,\n  deltaInp: IPosition,\n  handle: any,\n  boundaryBox: any,\n  points: Array<any>\n): IDimensionWithRotation {\n  let x = orientation.x;\n  let y = orientation.y;\n  let width = orientation.width;\n  let height = orientation.height;\n  let rotation = orientation.rotation;\n  let deltaX = !isNil(deltaInp.x) ? deltaInp.x : 0;\n  let deltaY = !isNil(deltaInp.y) ? deltaInp.y : 0;\n\n  let aspectRatio = boundaryBox.width / boundaryBox.height;\n\n  if (handle.indexOf('C') !== -1) {\n    x += deltaX;\n    y += deltaY;\n  } else {\n    let newPoints: any = [...points];\n    let initialDims = ModelUtils.getDimensionFromPolygon(newPoints);\n    let widthFactor =\n      (boundaryBox.width - initialDims.width) / boundaryBox.width;\n\n    map(newPoints, (point: any, index: number) => {\n      let pointXDiff = 0,\n        pointYDiff = 0,\n        pointX = 0,\n        pointY = 0,\n        delta = 0;\n      // for buttom and right\n      let pointYDiffDirect =\n        1 -\n        (boundaryBox.height - (point[1] - boundaryBox.y)) / boundaryBox.height;\n      let pointXDiffDirect =\n        1 -\n        (boundaryBox.width - (point[0] - boundaryBox.x)) / boundaryBox.width;\n      // for top and right\n      let pointYDiffOpposite =\n        (boundaryBox.height - (point[1] - boundaryBox.y)) / boundaryBox.height;\n      let pointXDiffOpposite =\n        (boundaryBox.width - (point[0] - boundaryBox.x)) / boundaryBox.width;\n\n      if (handle.length > 1) {\n        if (handle.indexOf('B') !== -1 && handle.indexOf('L') !== -1) {\n          delta = deltaX > -deltaY ? deltaX : deltaY;\n          pointYDiff = pointYDiffDirect;\n          pointXDiff = pointXDiffOpposite;\n\n          if (deltaX > -deltaY) {\n            pointY = point[1] - pointYDiff * delta * (1 / aspectRatio);\n            pointX = point[0] + delta * pointXDiff;\n          } else {\n            pointY = point[1] + pointYDiff * delta;\n            pointX = point[0] - delta * pointXDiff * aspectRatio;\n          }\n        }\n        if (handle.indexOf('B') !== -1 && handle.indexOf('R') !== -1) {\n          delta = deltaX < deltaY ? deltaX : deltaY;\n          pointYDiff = pointYDiffDirect;\n          pointXDiff = pointXDiffDirect;\n\n          if (deltaX > deltaY) {\n            pointY = point[1] + pointYDiff * delta;\n            pointX = point[0] + delta * pointXDiff * aspectRatio;\n          } else {\n            pointY = point[1] + pointYDiff * delta * (1 / aspectRatio);\n            pointX = point[0] + delta * pointXDiff;\n          }\n        }\n        if (handle.indexOf('T') !== -1 && handle.indexOf('R') !== -1) {\n          delta = deltaX < -deltaY ? deltaX : deltaY;\n\n          pointYDiff = pointYDiffOpposite;\n          pointXDiff = pointXDiffDirect;\n\n          if (deltaX > -deltaY) {\n            pointY = point[1] + pointYDiff * delta;\n            pointX = point[0] - delta * pointXDiff * aspectRatio;\n          } else {\n            pointY = point[1] - pointYDiff * delta * (1 / aspectRatio);\n            pointX = point[0] + delta * pointXDiff;\n          }\n        }\n        if (handle.indexOf('T') !== -1 && handle.indexOf('L') !== -1) {\n          delta = deltaX > deltaY ? deltaX : deltaY;\n          pointYDiff = pointYDiffOpposite;\n          pointXDiff = pointXDiffOpposite;\n\n          if (deltaX > deltaY) {\n            pointY = point[1] + pointYDiff * delta * (1 / aspectRatio);\n            pointX = point[0] + delta * pointXDiff;\n          } else {\n            pointY = point[1] + pointYDiff * delta;\n            pointX = point[0] + delta * pointXDiff * aspectRatio;\n          }\n        }\n      } else {\n        if (handle.indexOf('B') !== -1) {\n          pointYDiff = pointYDiffDirect;\n          pointXDiff = pointXDiffDirect;\n          pointY = point[1] + pointYDiff * deltaY;\n          pointX =\n            point[0] +\n            deltaY * aspectRatio * pointXDiff -\n            (deltaY * aspectRatio) / 2;\n        }\n\n        if (handle.indexOf('T') !== -1) {\n          pointYDiff = pointYDiffOpposite;\n          pointXDiff = pointXDiffOpposite;\n\n          pointY = point[1] + pointYDiff * deltaY;\n          pointX =\n            point[0] +\n            deltaY * pointXDiff * aspectRatio -\n            (deltaY * aspectRatio) / 2;\n        }\n\n        if (handle.indexOf('R') !== -1) {\n          pointYDiff = pointYDiffDirect;\n          pointXDiff = pointXDiffDirect;\n\n          pointX = point[0] + pointXDiff * deltaX;\n          pointY =\n            point[1] +\n            deltaX * pointYDiff * (1 / aspectRatio) -\n            (deltaX * (1 / aspectRatio)) / 2;\n        }\n\n        if (handle.indexOf('L') !== -1) {\n          pointYDiff = pointYDiffOpposite;\n          pointXDiff = pointXDiffOpposite;\n\n          pointX = point[0] + pointXDiff * deltaX;\n          pointY =\n            point[1] +\n            deltaX * pointYDiff * (1 / aspectRatio) -\n            (deltaX * (1 / aspectRatio)) / 2;\n        }\n      }\n\n      let pointNew = [pointX, pointY];\n      newPoints[index] = pointNew;\n    });\n    newPoints = ModelUtils.rotatePolygon(newPoints, 360 - rotation);\n\n    let box = ModelUtils.getDimensionFromPolygon(newPoints);\n    height = box.height;\n    width = box.width;\n    y = box.y;\n    x = box.x;\n  }\n\n  return {\n    width,\n    height,\n    x,\n    y,\n    rotation,\n  };\n}\n\nexport function computeOrientationWithDeltaAltMultiple(\n  orientation: IDimensionWithRotation,\n  delta: IPosition,\n  handle: any,\n  boundaryBox: any,\n  points: Array<any>\n): IDimensionWithRotation {\n  let x = orientation.x;\n  let y = orientation.y;\n  let width = orientation.width;\n  let height = orientation.height;\n  let rotation = orientation.rotation;\n  let deltaX = !isNil(delta.x) ? delta.x : 0;\n  let deltaY = !isNil(delta.y) ? delta.y : 0;\n\n  if (handle.indexOf('C') !== -1) {\n    x += deltaX;\n    y += deltaY;\n  } else {\n    let newPoints: any = [...points];\n    let initialDims = ModelUtils.getDimensionFromPolygon(newPoints);\n    let widthFactor =\n      (boundaryBox.width - initialDims.width) / boundaryBox.width;\n\n    map(newPoints, (point: any, index: number) => {\n      let pointXDiff = 0,\n        pointYDiff = 0,\n        pointX = 0,\n        pointY = 0;\n      // delta = 0;\n      // for buttom and right\n      let pointYDiffDirect =\n        1 -\n        (boundaryBox.height - (point[1] - boundaryBox.y)) / boundaryBox.height;\n      let pointXDiffDirect =\n        1 -\n        (boundaryBox.width - (point[0] - boundaryBox.x)) / boundaryBox.width;\n\n      // for top and right\n      let pointYDiffOpposite =\n        (boundaryBox.height - (point[1] - boundaryBox.y)) / boundaryBox.height;\n      let pointXDiffOpposite =\n        (boundaryBox.width - (point[0] - boundaryBox.x)) / boundaryBox.width;\n\n      if (handle.indexOf('B') !== -1) {\n        pointYDiff = pointYDiffDirect;\n        pointXDiff = pointXDiffDirect;\n\n        pointY = point[1] + pointYDiff * deltaY - deltaY / 2;\n        if (handle.indexOf('L') === -1 && handle.indexOf('R') === -1) {\n          pointX = point[0] + pointXDiff;\n        } else {\n          pointX = point[0] + pointXDiff * deltaX - deltaX / 2;\n        }\n      }\n\n      if (handle.indexOf('T') !== -1) {\n        pointYDiff = pointYDiffOpposite;\n        pointXDiff = pointXDiffDirect;\n        pointY = point[1] - pointYDiff * deltaY - deltaY / 2;\n\n        if (handle.indexOf('L') === -1 && handle.indexOf('R') === -1) {\n          pointX = point[0] + pointXDiff;\n        } else {\n          pointX = point[0] + pointXDiff * deltaX - deltaX / 2;\n        }\n      }\n\n      if (handle.indexOf('R') !== -1) {\n        pointXDiff = pointXDiffDirect;\n        pointYDiff = pointYDiffDirect;\n\n        pointX = point[0] + pointXDiff * deltaX - deltaX / 2;\n        if (handle.indexOf('T') === -1 && handle.indexOf('B') === -1) {\n          pointY = point[1] + pointYDiff;\n        } else {\n          if (handle.indexOf('B') !== -1) {\n            pointY = point[1] + pointYDiff * deltaY - deltaY / 2;\n          } else {\n            pointY = point[1] - pointYDiff * deltaY + deltaY / 2;\n          }\n        }\n      }\n\n      if (handle.indexOf('L') !== -1) {\n        pointXDiff = pointXDiffOpposite;\n        pointYDiff = pointYDiffDirect;\n        pointX = point[0] + pointXDiff * deltaX - deltaX / 2;\n        if (handle.indexOf('T') === -1 && handle.indexOf('B') === -1) {\n          pointY = point[1] + pointYDiff;\n        } else {\n          if (handle.indexOf('B') !== -1) {\n            pointY = point[1] + pointYDiff * deltaY - deltaY / 2;\n          } else {\n            pointY = point[1] - pointYDiff * deltaY + deltaY / 2;\n          }\n        }\n      }\n\n      let pointNew = [pointX, pointY];\n      newPoints[index] = pointNew;\n    });\n    newPoints = ModelUtils.rotatePolygon(newPoints, 360 - rotation);\n\n    let box = ModelUtils.getDimensionFromPolygon(newPoints);\n    height = box.height;\n    width = box.width;\n    y = box.y;\n    x = box.x;\n  }\n\n  return {\n    width,\n    height,\n    x,\n    y,\n    rotation,\n  };\n}\n\nexport function computeOrientationWithDeltaShiftAltMultiple(\n  orientation: IDimensionWithRotation,\n  deltaInp: IPosition,\n  handle: any,\n  boundaryBox: any,\n  points: Array<any>\n): IDimensionWithRotation {\n  let x = orientation.x;\n  let y = orientation.y;\n  let width = orientation.width;\n  let height = orientation.height;\n  let deltaX = !isNil(deltaInp.x) ? deltaInp.x : 0;\n  let deltaY = !isNil(deltaInp.y) ? deltaInp.y : 0;\n  let rotation = orientation.rotation;\n\n  let aspectRatio = boundaryBox.width / boundaryBox.height;\n\n  if (handle.indexOf('C') !== -1) {\n    x += deltaX;\n    y += deltaY;\n  } else {\n    let newPoints: any = [...points];\n    let initialDims = ModelUtils.getDimensionFromPolygon(newPoints);\n    let widthFactor =\n      (boundaryBox.width - initialDims.width) / boundaryBox.width;\n\n    map(newPoints, (point: any, index: number) => {\n      let pointXDiff = 0,\n        pointYDiff = 0,\n        pointX = 0,\n        pointY = 0,\n        delta = 0;\n      // for buttom and right\n      let pointYDiffDirect =\n        1 -\n        (boundaryBox.height - (point[1] - boundaryBox.y)) / boundaryBox.height;\n      let pointXDiffDirect =\n        1 -\n        (boundaryBox.width - (point[0] - boundaryBox.x)) / boundaryBox.width;\n      // for top and right\n      let pointYDiffOpposite =\n        (boundaryBox.height - (point[1] - boundaryBox.y)) / boundaryBox.height;\n      let pointXDiffOpposite =\n        (boundaryBox.width - (point[0] - boundaryBox.x)) / boundaryBox.width;\n\n      if (handle.length > 1) {\n        if (handle.indexOf('B') !== -1 && handle.indexOf('L') !== -1) {\n          delta = deltaX > -deltaY ? deltaX : deltaY;\n          pointYDiff = pointYDiffDirect;\n          pointXDiff = pointXDiffOpposite;\n\n          if (deltaX > -deltaY) {\n            pointY =\n              point[1] -\n              pointYDiff * delta * (1 / aspectRatio) +\n              (delta * (1 / aspectRatio)) / 2;\n            pointX = point[0] + delta * pointXDiff - delta / 2;\n          } else {\n            pointY = point[1] + pointYDiff * delta - delta / 2;\n            pointX =\n              point[0] -\n              delta * pointXDiff * aspectRatio +\n              (delta * aspectRatio) / 2;\n          }\n        }\n        if (handle.indexOf('B') !== -1 && handle.indexOf('R') !== -1) {\n          delta = deltaX < deltaY ? deltaX : deltaY;\n          pointYDiff = pointYDiffDirect;\n          pointXDiff = pointXDiffDirect;\n\n          if (deltaX > deltaY) {\n            pointY = point[1] + pointYDiff * delta - delta / 2;\n            pointX =\n              point[0] +\n              delta * pointXDiff * aspectRatio -\n              (delta * aspectRatio) / 2;\n          } else {\n            pointY =\n              point[1] +\n              pointYDiff * delta * (1 / aspectRatio) -\n              (delta * (1 / aspectRatio)) / 2;\n            pointX = point[0] + delta * pointXDiff - delta / 2;\n          }\n        }\n        if (handle.indexOf('T') !== -1 && handle.indexOf('R') !== -1) {\n          delta = deltaX < -deltaY ? deltaX : deltaY;\n\n          pointYDiff = pointYDiffOpposite;\n          pointXDiff = pointXDiffDirect;\n\n          if (deltaX > -deltaY) {\n            pointY = point[1] + pointYDiff * delta - delta / 2;\n            pointX =\n              point[0] -\n              delta * pointXDiff * aspectRatio +\n              (delta * aspectRatio) / 2;\n          } else {\n            pointY =\n              point[1] -\n              pointYDiff * delta * (1 / aspectRatio) +\n              (delta * (1 / aspectRatio)) / 2;\n            pointX = point[0] + delta * pointXDiff - delta / 2;\n          }\n        }\n        if (handle.indexOf('T') !== -1 && handle.indexOf('L') !== -1) {\n          delta = deltaX > deltaY ? deltaX : deltaY;\n          pointYDiff = pointYDiffOpposite;\n          pointXDiff = pointXDiffOpposite;\n\n          if (deltaX > deltaY) {\n            pointY =\n              point[1] +\n              pointYDiff * delta * (1 / aspectRatio) -\n              (delta * (1 / aspectRatio)) / 2;\n            pointX = point[0] + delta * pointXDiff - delta / 2;\n          } else {\n            pointY = point[1] + pointYDiff * delta - delta / 2;\n            pointX =\n              point[0] +\n              delta * pointXDiff * aspectRatio -\n              (delta * aspectRatio) / 2;\n          }\n        }\n      } else {\n        if (handle.indexOf('B') !== -1) {\n          pointYDiff = pointYDiffDirect;\n          pointXDiff = pointXDiffDirect;\n          pointY = point[1] + pointYDiff * deltaY - deltaY / 2;\n          pointX =\n            point[0] +\n            deltaY * aspectRatio * pointXDiff -\n            (deltaY * aspectRatio) / 2;\n        }\n\n        if (handle.indexOf('T') !== -1) {\n          pointYDiff = pointYDiffOpposite;\n          pointXDiff = pointXDiffOpposite;\n\n          pointY = point[1] + pointYDiff * deltaY - deltaY / 2;\n          pointX =\n            point[0] +\n            deltaY * pointXDiff * aspectRatio -\n            (deltaY * aspectRatio) / 2;\n        }\n\n        if (handle.indexOf('R') !== -1) {\n          pointYDiff = pointYDiffDirect;\n          pointXDiff = pointXDiffDirect;\n\n          pointX = point[0] + pointXDiff * deltaX - deltaX / 2;\n          pointY =\n            point[1] +\n            deltaX * pointYDiff * (1 / aspectRatio) -\n            (deltaX * (1 / aspectRatio)) / 2;\n        }\n\n        if (handle.indexOf('L') !== -1) {\n          pointYDiff = pointYDiffOpposite;\n          pointXDiff = pointXDiffOpposite;\n\n          pointX = point[0] + pointXDiff * deltaX - deltaX / 2;\n          pointY =\n            point[1] +\n            deltaX * pointYDiff * (1 / aspectRatio) -\n            (deltaX * (1 / aspectRatio)) / 2;\n        }\n      }\n\n      let pointNew = [pointX, pointY];\n      newPoints[index] = pointNew;\n    });\n    newPoints = ModelUtils.rotatePolygon(newPoints, 360 - rotation);\n\n    let box = ModelUtils.getDimensionFromPolygon(newPoints);\n    height = box.height;\n    width = box.width;\n    y = box.y;\n    x = box.x;\n  }\n\n  return {\n    width,\n    height,\n    x,\n    y,\n    rotation,\n  };\n}\n\nexport function computeOrientationWithDeltaAR(\n  orientation: IDimensionWithRotation,\n  delta: IPosition,\n  handle: any\n): IDimensionWithRotation {\n  let x = orientation.x;\n  let y = orientation.y;\n  let rotation = orientation.rotation;\n\n  let width = orientation.width;\n  let height = orientation.height;\n  let deltaX = !isNil(delta.x) ? delta.x : 0;\n  let deltaY = !isNil(delta.y) ? delta.y : 0;\n\n  let aspectRatio = width / height;\n\n  if (!width || !height) {\n    aspectRatio = 1;\n  }\n  if (handle.indexOf('C') !== -1) {\n    x += deltaX;\n    y += deltaY;\n  }\n\n  let newX = x,\n    newY = y;\n  if (handle.length === 1 && handle.indexOf('T') !== -1) {\n    // newX = x + (deltaY * aspectRatio) / 2;\n    newY = y + deltaY;\n    height -= deltaY;\n    width = height * aspectRatio;\n  }\n  if (handle.length === 1 && handle.indexOf('B') !== -1) {\n    // newX = x - (deltaY * aspectRatio) / 2;\n    height += deltaY;\n    width = height * aspectRatio;\n  }\n\n  if (handle.length === 1 && handle.indexOf('L') !== -1) {\n    newX = x + deltaX;\n    // newY = y + (deltaX * (1 / aspectRatio)) / 2;\n    width -= deltaX;\n    height = width / aspectRatio;\n  }\n\n  if (handle.length === 1 && handle.indexOf('R') !== -1) {\n    // newY = y - (deltaX * (1 / aspectRatio)) / 2;\n    width += deltaX;\n    height = width / aspectRatio;\n  }\n\n  if (\n    handle.length === 2 &&\n    handle.indexOf('T') !== -1 &&\n    handle.indexOf('R') !== -1\n  ) {\n    if (deltaX > -deltaY) {\n      newY = y - deltaX * (1 / aspectRatio);\n      height += deltaX * (1 / aspectRatio);\n      width += deltaX;\n    } else {\n      newY = y + deltaY;\n      height -= deltaY;\n      width -= deltaY * aspectRatio;\n    }\n  }\n\n  if (\n    handle.length === 2 &&\n    handle.indexOf('T') !== -1 &&\n    handle.indexOf('L') !== -1\n  ) {\n    if (deltaX > deltaY) {\n      newY = y + deltaY;\n      newX = x + deltaY * aspectRatio;\n      height -= deltaY;\n      width -= deltaY * aspectRatio;\n    } else {\n      newY = y + deltaX * (1 / aspectRatio);\n      newX = x + deltaX;\n      width -= deltaX;\n      height -= deltaX * (1 / aspectRatio);\n    }\n  }\n\n  if (\n    handle.length === 2 &&\n    handle.indexOf('B') !== -1 &&\n    handle.indexOf('R') !== -1\n  ) {\n    if (deltaX > deltaY) {\n      width += deltaX;\n      height += deltaX * (1 / aspectRatio);\n    } else {\n      height += deltaY;\n      width += deltaY * aspectRatio;\n    }\n  }\n\n  if (\n    handle.length === 2 &&\n    handle.indexOf('B') !== -1 &&\n    handle.indexOf('L') !== -1\n  ) {\n    if (deltaX > -deltaY) {\n      height += deltaY;\n      newX = x - deltaY * aspectRatio;\n      width += deltaY * aspectRatio;\n    } else {\n      width -= deltaX;\n      newX = x + deltaX;\n      height -= deltaX * (1 / aspectRatio);\n    }\n  }\n\n  // height = Math.max(height, width);\n  // width = Math.max(height, width);\n\n  return { width, height, x: newX, y: newY, rotation };\n}\n\nexport function computeOrientationWithDeltaAlt(\n  orientation: IDimensionWithRotation,\n  delta: IPosition,\n  handle: any\n): IDimensionWithRotation {\n  let x = orientation.x;\n  let y = orientation.y;\n  let rotation = orientation.rotation;\n  let width = orientation.width;\n  let height = orientation.height;\n  let deltaX = !isNil(delta.x) ? delta.x : 0;\n  let deltaY = !isNil(delta.y) ? delta.y : 0;\n\n  // let aspectRatio = width / height;\n\n  if (handle.indexOf('C') !== -1) {\n    x += deltaX;\n    y += deltaY;\n  }\n\n  let newX = x,\n    newY = y;\n  if (handle.indexOf('T') !== -1) {\n    height -= deltaY * 2;\n\n    if (height > 0) newY = y + deltaY;\n  }\n  if (handle.indexOf('B') !== -1) {\n    height += deltaY * 2;\n\n    if (height > 0) newY = y - deltaY;\n  }\n  if (handle.indexOf('R') !== -1) {\n    width += deltaX * 2;\n\n    if (width > 0) newX = x - deltaX;\n  }\n  if (handle.indexOf('L') !== -1) {\n    width -= deltaX * 2;\n    if (width > 0) newX = x + deltaX;\n  }\n\n  return { width, height, x: newX, y: newY, rotation };\n}\n\nexport function computeOrientationWithDeltaShiftAlt(\n  orientation: IDimensionWithRotation,\n  delta: IPosition,\n  handle: any\n): IDimensionWithRotation {\n  let x = orientation.x;\n  let y = orientation.y;\n  let rotation = orientation.rotation;\n  let width = orientation.width;\n  let height = orientation.height;\n  let deltaX = !isNil(delta.x) ? delta.x : 0;\n  let deltaY = !isNil(delta.y) ? delta.y : 0;\n\n  deltaY = deltaY * 2;\n  deltaX = deltaX * 2;\n\n  let aspectRatio = width / height;\n\n  if (!width || !height) {\n    aspectRatio = 1;\n  }\n  if (handle.indexOf('C') !== -1) {\n    x += deltaX;\n    y += deltaY;\n  }\n\n  let newX = x,\n    newY = y;\n  if (handle.length === 1 && handle.indexOf('T') !== -1) {\n    newX = x + (deltaY * aspectRatio) / 2;\n    newY = y + deltaY / 2;\n    height -= deltaY;\n    width = height * aspectRatio;\n  }\n  if (handle.length === 1 && handle.indexOf('B') !== -1) {\n    newX = x - (deltaY * aspectRatio) / 2;\n    newY = y - deltaY / 2;\n    height += deltaY;\n    width = height * aspectRatio;\n  }\n\n  if (handle.length === 1 && handle.indexOf('L') !== -1) {\n    newX = x + deltaX / 2;\n    newY = y + (deltaX * (1 / aspectRatio)) / 2;\n    width -= deltaX;\n    height = width / aspectRatio;\n  }\n\n  if (handle.length === 1 && handle.indexOf('R') !== -1) {\n    newY = y - (deltaX * (1 / aspectRatio)) / 2;\n    newX = x - deltaX / 2;\n    width += deltaX;\n    height = width / aspectRatio;\n  }\n\n  if (\n    handle.length === 2 &&\n    handle.indexOf('T') !== -1 &&\n    handle.indexOf('R') !== -1\n  ) {\n    // if (deltaX > -deltaY) {\n    //   newY = y + deltaY / 2;\n    //   newX = x + (deltaY * aspectRatio) / 2;\n    //   height -= deltaY;\n    //   width -= deltaY * aspectRatio;\n    // } else {\n    //   newY = y - (deltaX * (1 / aspectRatio)) / 2;\n    //   newX = x - deltaX / 2;\n    //   height += deltaX * (1 / aspectRatio);\n    //   width += deltaX;\n    // }\n\n    if (deltaX > -deltaY) {\n      newY = y - (deltaX * (1 / aspectRatio)) / 2;\n      newX = x - deltaX / 2;\n      height += deltaX * (1 / aspectRatio);\n      width += deltaX;\n    } else {\n      newY = y + deltaY / 2;\n      newX = x + (deltaY * aspectRatio) / 2;\n      height -= deltaY;\n      width -= deltaY * aspectRatio;\n    }\n  }\n\n  if (\n    handle.length === 2 &&\n    handle.indexOf('T') !== -1 &&\n    handle.indexOf('L') !== -1\n  ) {\n    // if (deltaX > deltaY) {\n    //   newY = y + (deltaX * (1 / aspectRatio)) / 2;\n    //   newX = x + deltaX / 2;\n    //   width -= deltaX;\n    //   height -= deltaX * (1 / aspectRatio);\n    // } else {\n    //   newY = y + deltaY / 2;\n    //   newX = x + (deltaY * aspectRatio) / 2;\n    //   width -= deltaY * aspectRatio;\n    //   height -= deltaY;\n    // }\n\n    if (deltaX > deltaY) {\n      newY = y + deltaY / 2;\n      newX = x + (deltaY * aspectRatio) / 2;\n      width -= deltaY * aspectRatio;\n      height -= deltaY;\n    } else {\n      newY = y + (deltaX * (1 / aspectRatio)) / 2;\n      newX = x + deltaX / 2;\n      width -= deltaX;\n      height -= deltaX * (1 / aspectRatio);\n    }\n  }\n\n  if (\n    handle.length === 2 &&\n    handle.indexOf('B') !== -1 &&\n    handle.indexOf('R') !== -1\n  ) {\n    // if (deltaX > deltaY) {\n    //   newY = y - deltaY / 2;\n    //   newX = x - (deltaY * aspectRatio) / 2;\n    //   height += deltaY;\n    //   width += deltaY * aspectRatio;\n    // } else {\n    //   newY = y - (deltaX * (1 / aspectRatio)) / 2;\n    //   newX = x - deltaX / 2;\n    //   height += deltaX * (1 / aspectRatio);\n    //   width += deltaX;\n    // }\n\n    if (deltaX > deltaY) {\n      newY = y - (deltaX * (1 / aspectRatio)) / 2;\n      newX = x - deltaX / 2;\n      height += deltaX * (1 / aspectRatio);\n      width += deltaX;\n    } else {\n      newY = y - deltaY / 2;\n      newX = x - (deltaY * aspectRatio) / 2;\n      height += deltaY;\n      width += deltaY * aspectRatio;\n    }\n  }\n\n  if (\n    handle.length === 2 &&\n    handle.indexOf('B') !== -1 &&\n    handle.indexOf('L') !== -1\n  ) {\n    // if (deltaX > -deltaY) {\n    //   height -= deltaX * (1 / aspectRatio);\n    //   width -= deltaX;\n    //   newX = x + deltaX / 2;\n    //   newY = y + (deltaX * (1 / aspectRatio)) / 2;\n    // } else {\n    //   width += deltaY * aspectRatio;\n    //   height += deltaY;\n    //   newX = x - (deltaY * aspectRatio) / 2;\n    //   newY = y - deltaY / 2;\n    // }\n\n    if (deltaX > -deltaY) {\n      width += deltaY * aspectRatio;\n      height += deltaY;\n      newX = x - (deltaY * aspectRatio) / 2;\n      newY = y - deltaY / 2;\n    } else {\n      height -= deltaX * (1 / aspectRatio);\n      width -= deltaX;\n      newX = x + deltaX / 2;\n      newY = y + (deltaX * (1 / aspectRatio)) / 2;\n    }\n  }\n\n  // height = Math.max(height, width);\n  // width = Math.max(height, width);\n  return { width, height, x: newX, y: newY, rotation };\n}\n\nexport function getBoundingBoxFromOrientation({\n  x,\n  y,\n  width,\n  height,\n}: any): any {\n  return {\n    minX: x,\n    minY: y,\n    maxX: x + width,\n    maxY: y + height,\n  };\n}\n\nexport function computeDelta(\n  oldOrientation: IDimensionWithRotation,\n  newOrientation: IDimensionWithRotation\n): IPosition {\n  let [deltaX, deltaY] = [0, 0];\n\n  const oldBB = getBoundingBoxFromOrientation(oldOrientation);\n  const newBB = getBoundingBoxFromOrientation(newOrientation);\n\n  if (oldBB.minX !== newBB.minX) {\n    deltaX = newBB.minX - oldBB.minX;\n  }\n  if (oldBB.minY !== newBB.minY) {\n    deltaY = newBB.minY - oldBB.minY;\n  }\n\n  if (oldBB.maxX !== newBB.maxX) {\n    deltaX = newBB.maxX - oldBB.maxX;\n  }\n  if (oldBB.maxY !== newBB.maxY) {\n    deltaY = newBB.maxY - oldBB.maxY;\n  }\n\n  return {\n    x: deltaX,\n    y: deltaY,\n  };\n}\n\nexport function getGradientString(gradient: Gradient, palette?: any) {\n  let colors: any = [];\n\n  if (palette) {\n    forEach(palette, (data: any, index: number) => {\n      colors.push(data.color);\n    });\n  } else {\n    forEach(gradient.stops, (data: any, index: number) => {\n      colors.push(data.stopColor);\n    });\n  }\n  let vector;\n  if (gradient.to && gradient.from) {\n    vector = {\n      x: (gradient.to.x as number) - (gradient.from.x as number),\n      y: (gradient.to.y as number) - (gradient.from.y as number),\n    };\n  } else {\n    vector = {\n      x: 0,\n      y: 2,\n    };\n  }\n  const angleRad = Math.atan2(vector.y, vector.x);\n  const angleDeg = (angleRad * 180) / Math.PI + 90;\n\n  let realLocations: any = [];\n  if (palette) {\n    forEach(palette, (data: any, index: number) => {\n      realLocations.push(data.pos);\n    });\n  } else {\n    forEach(gradient.stops, (data: any, index: number) => {\n      realLocations.push(data.offset);\n    });\n  }\n\n  const colorStrings = colors\n    .map(\n      (color: any, i: number) =>\n        `${color} ${Math.round(realLocations[i] * 100)}%`\n    )\n    .join(', ');\n\n  if (gradient.gradientType && gradient.gradientType === 'LinearGradient') {\n    return `linear-gradient(${angleDeg}deg, ${colorStrings})`;\n  } else if (\n    gradient.gradientType &&\n    gradient.gradientType === 'RadialGradient'\n  ) {\n    const dist = Math.sqrt(\n      (gradient.to.x - gradient.from.x) * (gradient.to.x - gradient.from.x) +\n        (gradient.to.y - gradient.from.y) * (gradient.to.y - gradient.from.y)\n    );\n    const maxDist = Math.sqrt(\n      (1 - gradient.from.x) * (1 - gradient.from.x) +\n        (1 - gradient.from.y) * (1 - gradient.from.y)\n    );\n    const radialColorStrings = colors\n      .map(\n        (color: any, i: number) =>\n          `${color} ${Math.round(realLocations[i] * (dist / maxDist) * 100)}%`\n      )\n      .join(', ');\n    return `radial-gradient(circle at ${gradient.from.x * 100}% ${gradient.from\n      .y * 100}%,${radialColorStrings})`;\n  } else if (\n    gradient.gradientType &&\n    gradient.gradientType === 'AngularGradient'\n  ) {\n    return `conic-gradient(${colorStrings})`;\n  } else {\n    return `linear-gradient(${angleDeg}deg, ${colorStrings})`;\n  }\n}\n\nexport function getHandles(layers: Array<Layer>) {\n  let handles = ['T', 'B', 'R', 'L', 'BL', 'BR', 'TR', 'TL', 'ROTATE'];\n  if (\n    layers.length === 0 ||\n    (layers.length === 1 && layers[0].type === 'canvas')\n  ) {\n    return [];\n  }\n\n  if (\n    layers.length === 1 &&\n    layers[0].type === 'text' &&\n    !layers[0].style.get('height') &&\n    !layers[0].style.get('width')\n  ) {\n    const textLayer = layers[0];\n    const parentDims = textLayer.parent?.getBoundingClientRect();\n    const textLayerDims = textLayer.getBoundingClientRect();\n    let newHandle = '';\n\n    if (parentDims) {\n      let parentCenterY = parentDims.rootY + parentDims.height / 2;\n      let parentCenterX = parentDims.rootX + parentDims.width / 2;\n\n      let textLayerCenterY = textLayerDims.rootY + textLayerDims.height / 2;\n      let textLayerCenterX = textLayerDims.rootX + textLayerDims.width / 2;\n      if (textLayerCenterY < parentCenterY) {\n        newHandle = 'B';\n      } else if (textLayerCenterY > parentCenterY) {\n        newHandle += 'T';\n      } else {\n        newHandle += '';\n      }\n\n      if (textLayerCenterX < parentCenterX) {\n        newHandle += 'R';\n      } else if (textLayerCenterX > parentCenterX) {\n        newHandle += 'L';\n      } else {\n        newHandle += '';\n      }\n\n      if (\n        textLayerCenterX === parentCenterX &&\n        textLayerCenterY === parentCenterY\n      ) {\n        newHandle = 'B';\n      }\n      return [newHandle, 'ROTATE'];\n    }\n  }\n  // layers.forEach((layer: Layer) => {\n  // if (layer.type === \"icon\" || layer.type === \"switch\") {\n  //   handles = intersection(handles, [\"ROTATE\"]);\n  // }\n  // const isLayerAbsolute = !isNil(\n  //   layer.style.get(\"position\")\n  // );\n  // const isAutoHeight = layer.isHeightAuto;\n  // const isAutoWidth = layer.isWidthAuto;\n  // let handlesForAutoOrAbs = this.getHandlesForAutoOrAbsoluteLayer(\n  //   isAutoHeight,\n  //   isAutoWidth\n  // );\n\n  // if (isLayerAbsolute) {\n  //   handles = intersection(handles, handlesForAutoOrAbs);\n  // } else {\n  //   const handlesForFill = this.getHandlesForFill(layer);\n  //   let handlesHere = intersection(handlesForAutoOrAbs, handlesForFill);\n  //   handles = intersection(handles, handlesHere);\n  // }\n  // });\n  return handles;\n}\nfunction getHandlePoint(box: any, handle?: string) {\n  if (handle) {\n    let point = [box.x + box.width / 2, box.y];\n    switch (handle) {\n      case 'ROTATETL':\n        point = [box.x, box.y];\n        break;\n      case 'ROTATETR':\n        point = [box.x + box.width, box.y];\n        break;\n      case 'ROTATEL':\n        point = [box.x, box.y + box.height / 2];\n        break;\n      case 'ROTATER':\n        point = [box.x + box.width, box.y + box.height / 2];\n        break;\n      case 'ROTATEBL':\n        point = [box.x, box.y + box.height];\n        break;\n      case 'ROTATEB':\n        point = [box.x + box.width / 2, box.y + box.height];\n        break;\n      case 'ROTATEBR':\n        point = [box.x + box.width, box.y + box.height];\n        break;\n      default:\n        break;\n    }\n    return point;\n  } else return [box.x + box.width / 2, box.y - 28];\n}\n\nfunction getQuotient(a: any, b: any, c: any) {\n  return (b[0] - a[0]) * (c[1] - a[1]) - (b[1] - a[1]) * (c[0] - a[0]) > 0\n    ? -1\n    : 1;\n}\nexport function calculateRotation(\n  startValues: any,\n  session: any,\n  oldRotation?: number,\n  delta?: any,\n  handle?: string\n) {\n  let deltaInput = {\n    x: session.current.x - session.start.x,\n    y: session.current.y - session.start.y,\n  };\n\n  if (delta) {\n    deltaInput = delta;\n  }\n  const rotation = oldRotation ? oldRotation : startValues.rotation;\n  const point1 = getHandlePoint(startValues, handle);\n  const polygon = ModelUtils.getPointsFromBoundingBox(startValues);\n  const centroid = ModelUtils.getCentroid(polygon);\n  const point3 = [point1[0] + deltaInput.x, point1[1] + deltaInput.y];\n  let angle = ModelUtils.findAngle(point1, centroid, point3, 180);\n  angle = rotation + angle * getQuotient(point1, centroid, point3);\n  return angle;\n}\n\nexport function getNewLayout(startValues: any, session: any, handle: any) {\n  let newLayout: any;\n  let deltaX = session.current.deltaX;\n  let deltaY = session.current.deltaY;\n  if (handle.indexOf('ROTATE') !== -1) {\n    let rotation = calculateRotation(\n      startValues,\n      session,\n      undefined,\n      undefined,\n      handle\n    );\n    newLayout = { ...startValues, rotation };\n  } else {\n    if (handle === 'C') {\n      let rotateDelta = ModelUtils.rotatePoint(\n        [deltaX, deltaY],\n        startValues.rotation,\n        [0, 0]\n      );\n      deltaX = rotateDelta[0];\n      deltaY = rotateDelta[1];\n      newLayout = computeOrientationWithDelta(\n        startValues,\n        { x: deltaX, y: deltaY },\n        handle\n      );\n    } else {\n      newLayout = computeOrientationWithDelta(\n        startValues,\n        { x: deltaX, y: deltaY },\n        handle\n      );\n    }\n  }\n  if (newLayout.height === 0) {\n    newLayout.height = 0;\n  }\n  if (newLayout.width === 0) {\n    newLayout.width = 0;\n  }\n  return newLayout;\n}\n\nexport function generateRandomString(length: number) {\n  let result = '';\n  let characters = 'ABCDEFGHIJKLMNPQRSTUVWXYZabcdefghijklmnpqrstuvwxyz';\n  for (let i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * characters.length));\n  }\n  return result;\n}\n","import { IEventCallable } from './IEventCallable';\nimport { Event } from './index';\nexport class EventCallableRegsitry implements IEventCallable {\n  registry: Map<string, Array<(event: Event) => {}>>;\n\n  constructor() {\n    this.registry = new Map();\n  }\n\n  addEventListener(name: string, callback: any) {\n    let callbacks = this.registry.get(name);\n    if (callbacks) {\n      callbacks.push(callback);\n    } else {\n      this.registry.set(name, [callback]);\n    }\n  }\n\n  removeEventListener(name: string, callback: any) {\n    let callbacks = this.registry.get(name);\n    if (callbacks) {\n      const indexOf = callbacks.indexOf(callback);\n      if (indexOf > -1) {\n        callbacks.splice(indexOf, 1);\n      }\n    }\n  }\n\n  dispatchEvent(name: string, event: Event) {\n    // @ts-ignore\n    if (window['debug']) {\n      console.log('DEBUG::', 'Event:', name);\n    }\n    let callbacks = this.registry.get(name);\n    for (let i in callbacks) {\n      callbacks[i as any](event);\n      if (!event.propagate) break;\n    }\n  }\n}\n","import { Model } from './base-model';\nimport { types } from './serializable';\nimport { isNil, set, get } from 'lodash';\nexport class KeyValueContainer extends Model {\n  private data: any = {};\n  getFields(): {\n    [key: string]: any;\n  } {\n    return {\n      data: types.literal,\n    };\n  }\n  isValidKey(key: string) {\n    return true;\n  }\n  set(key: string | object, value?: any) {\n    if (typeof key == 'object') {\n      for (var prop in key) {\n        if (this.isValidKey(prop)) {\n          set(this.data, prop, (key as any)[prop]);\n          // this.data[prop] = (key as any)[prop];\n        } else {\n          throw new Error(\n            `Model KeyValueContainer Error: Invalid key '${prop}'`\n          );\n        }\n      }\n    } else {\n      if (this.isValidKey(key)) {\n        set(this.data, key, value);\n        // this.data[key] = value;\n      } else {\n        throw new Error(`Model KeyValueContainer Error: Invalid key '${key}'`);\n      }\n    }\n  }\n  get(key: string): any {\n    return get(this.data, key);\n  }\n  getAll() {\n    return this.data;\n  }\n  remove(key: string | object) {\n    if (typeof key === 'string' && !isNil(this.data[key])) {\n      delete this.data[key];\n    } else if (typeof key == 'object' && Array.isArray(key)) {\n      for (let i = 0; i < key.length; i++) {\n        if (key[i] && this.isValidKey(key[i])) {\n          delete this.data[key[i]];\n        } else {\n          throw new Error(\n            `Model KeyValueContainer Error: Invalid key '${key[i]}'`\n          );\n        }\n      }\n    }\n  }\n}\n","import { KeyValueContainer } from './KeyValueContainer';\nexport class Style extends KeyValueContainer {}\n","import { KeyValueContainer } from './KeyValueContainer';\nexport class Props extends KeyValueContainer {}\n","import { KeyValueContainer } from './KeyValueContainer';\nexport class Layout extends KeyValueContainer {\n  private validKeys = [\n    'left',\n    'right',\n    'width',\n    'top',\n    'bottom',\n    'height',\n    'position',\n    'flex',\n    'flexDirection',\n    'marginLeft',\n    'marginRight',\n    'marginBottom',\n    'marginTop',\n    'margin',\n    'border',\n    'justifyContent',\n    'alignItems',\n    'flexWrap',\n    'borderColor',\n    'borderStyle',\n    'borderLeftWidth',\n    'borderRightWidth',\n    'borderBottomWidth',\n    'borderTopWidth',\n    'borderWidth',\n    'alignSelf',\n    'alignContent',\n    'paddingLeft',\n    'paddingRight',\n    'paddingBottom',\n    'paddingTop',\n    'padding',\n    'lineHeight',\n    'transform',\n    'fontSize',\n    'fontFamily',\n    'fontWeight',\n    'fontStyle',\n    'fontPostscriptName',\n    'letterSpacing',\n  ];\n  isValidKey(key: string) {\n    return this.validKeys.indexOf(key) !== -1;\n  }\n}\n","import { Layer } from '../models/Layer';\n\nexport class Event {\n  target: Layer;\n  name: string;\n  // payload: any;\n  currentTarget: Layer | undefined;\n  private _propagate: boolean;\n  private _defaults: boolean;\n  constructor(name: string, target: Layer, currentTarget?: Layer) {\n    this.name = name;\n    this.target = target;\n    this.currentTarget = currentTarget;\n    this._propagate = true;\n    this._defaults = true;\n  }\n  get propagate() {\n    return this._propagate;\n  }\n  get defaults() {\n    return this._defaults;\n  }\n  stopPropagation() {\n    this._propagate = false;\n  }\n  preventDefault() {\n    this._defaults = false;\n  }\n}\n","import { Event } from './index';\nimport { Layer } from 'models/Layer';\n\nexport default class SetLayoutEvent extends Event {\n  constructor(name: string, target: Layer, currentTarget?: Layer) {\n    super(name, target, currentTarget);\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\n\nexport default class RemoveChildEvent extends Event {\n  payload: any;\n  layer: Layer | null;\n  constructor(\n    name: string,\n    layer: Layer | null,\n    payload?: any,\n    currentTarget?: Layer\n  ) {\n    super(name, payload, currentTarget);\n    this.payload = payload;\n    this.layer = layer;\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { last } from 'lodash';\n\nclass GlobalLayerUpdateController {\n  layerMap = new Map<Layer, any>();\n  get updateLayout(): boolean {\n    return this.updateLayoutCount === 0 ? true : false;\n  }\n  get updateChildrenLayout(): boolean {\n    return this.updateChildrenLayoutCount === 0 ? true : false;\n  }\n  get rerender(): boolean {\n    return this.rerenderCount === 0 ? true : false;\n  }\n\n  shouldBatch: Array<boolean> = [];\n  updateLayoutCount: number = 0;\n  updateChildrenLayoutCount: number = 0;\n  rerenderCount: number = 0;\n\n  shouldAddToBatch = () => {\n    return last(this.shouldBatch);\n  };\n  stopChildrenLayoutUpdates = () => {\n    this.updateChildrenLayoutCount++;\n  };\n  startChildrenLayoutUpdates = () => {\n    this.updateChildrenLayoutCount--;\n  };\n  stopRerender = () => {\n    this.rerenderCount++;\n  };\n  startRerender = () => {\n    this.rerenderCount--;\n  };\n\n  stopAndBatchLayoutUpdates = () => {\n    if (this.shouldAddToBatch() === false) {\n      this.shouldBatch.push(false);\n    } else {\n      this.shouldBatch.push(true);\n    }\n    this.updateLayoutCount++;\n  };\n\n  stopAndForgetLayoutUpdates = () => {\n    this.shouldBatch.push(false);\n    this.updateLayoutCount++;\n  };\n\n  resumeLayoutUpdates = () => {\n    this.updateLayoutCount--;\n    if (this.updateLayoutCount === 0) {\n      this.layerMap.forEach((value, layer) => {\n        layer.setYogaAfterBatch();\n        layer.onUpdateDom();\n      });\n      this.shouldBatch = [];\n      this.layerMap.clear();\n    }\n  };\n}\n\nexport const globalLayerUpdateController = new GlobalLayerUpdateController();\n\nexport const stopChildrenLayoutUpdates =\n  globalLayerUpdateController.stopChildrenLayoutUpdates;\nexport const startChildrenLayoutUpdates =\n  globalLayerUpdateController.startChildrenLayoutUpdates;\nexport const stopRerender = globalLayerUpdateController.stopRerender;\nexport const startRerender = globalLayerUpdateController.startRerender;\nexport const shouldAddToBatch = globalLayerUpdateController.shouldAddToBatch;\nexport const stopAndBatchLayoutUpdates =\n  globalLayerUpdateController.stopAndBatchLayoutUpdates;\nexport const stopAndForgetLayoutUpdates =\n  globalLayerUpdateController.stopAndForgetLayoutUpdates;\nexport const resumeLayoutUpdates =\n  globalLayerUpdateController.resumeLayoutUpdates;\n","import { yoga } from '@builderx-core/yogax';\nimport { Model, action } from './base-model';\nimport { types } from './serializable';\nimport {\n  isNil,\n  isArray,\n  orderBy,\n  findIndex,\n  keys,\n  remove,\n  forEach,\n  get,\n} from 'lodash';\nimport { Collisions } from 'detect-collisions';\nimport { v4 as uuid } from 'uuid';\n\nimport {\n  IDimensionWithRoot,\n  IContext,\n  IDimensionWithRotation,\n  IDimension,\n} from './../interfaces';\nimport ModelUtils, { getGradientString } from './utils';\nimport { EventCallableRegsitry } from '../events/EventCallableRegsitry';\nimport { IEventCallable } from '../events/IEventCallable';\nimport { Style } from './Style';\nimport { Props } from './Props';\nimport { Layout } from './Layout';\nimport { Canvas } from './Canvas';\nimport { Event } from '../events';\nimport SetLayoutEvent from '../events/SetLayoutEvent';\nimport RemoveChildEvent from '../events/RemoveChildEvent';\nimport {\n  stopRerender,\n  startRerender,\n  globalLayerUpdateController,\n} from './GlobalLayerUpdateController';\nimport { Gradient } from './Gradient';\nimport RenderEvent from '../events/RenderEvent';\nimport ReactDOM from 'react-dom';\nwindow['ReactDOM'] = ReactDOM;\nexport abstract class Layer extends Model implements IEventCallable {\n  private _name: string;\n  private _type: string;\n  private _parent: Layer | null;\n  private _props: Props;\n  private _children: Array<Layer>;\n  private _style: Style;\n  private _layout: Layout;\n  private _innerText?: string;\n  private _yogaNode: any;\n  private _collisionScope: Collisions | null;\n  private _collisionNode: any;\n  private _dims: IDimensionWithRotation;\n  private _domDims: IDimensionWithRotation | undefined;\n  private _dom: any;\n\n  private _mouseProps: any;\n  private _locked: boolean;\n  private _visible: boolean;\n  private _thirdParty: boolean = false;\n  private _dragging: boolean = false;\n  private _preservedProperties: {\n    locked: boolean;\n    opacity: number;\n    hidden: boolean;\n  };\n  private _eventCallableRegistry: EventCallableRegsitry = new EventCallableRegsitry();\n  private _canvas: Canvas;\n  private _aspectRatio: number | undefined;\n  private _id: string = uuid();\n  constructor(canvas?: Canvas) {\n    super();\n    this._name = 'layer';\n    this._type = 'view';\n    this._parent = null;\n    this._props = new Props();\n    this._children = [];\n    this._style = new Style();\n    this._layout = new Layout();\n    this._collisionScope = null;\n    let config = yoga.Config.create();\n    config.setPointScaleFactor(0);\n    this._yogaNode = yoga.Node.create(config);\n    this._yogaNode.setType(this._type);\n    let layout = this._layout.toJS();\n    this._locked = false;\n    this._visible = true;\n    this._aspectRatio = undefined;\n    this._preservedProperties = {\n      locked: false,\n      opacity: 1,\n      hidden: false,\n    };\n    // this._yogaNode.setProps(layout.data);\n    this._dims = {\n      x: 0,\n      y: 0,\n      height: 0,\n      width: 0,\n      rotation: 0,\n    };\n    // this._domDims = {\n    //   x: 0,\n    //   y: 0,\n    //   height: 0,\n    //   width: 0,\n    //   rotation: 0,\n    // };\n    this._mouseProps = {};\n\n    //@ts-ignore\n    this._canvas = canvas || (this as Canvas);\n\n    this.addEventListener('domDidMount', (event: RenderEvent) => {\n      event.stopPropagation();\n      // this._dom = event.target;\n      this._thirdParty = true;\n      this.setYoga();\n    });\n\n    this.addEventListener('domDidUpdate', (event: RenderEvent) => {\n      event.stopPropagation();\n      // this._dom = event.target;\n      this._thirdParty = true;\n      this.setYoga();\n    });\n  }\n  get aspectRatio() {\n    return this._aspectRatio;\n  }\n  setAspectRatio = (val: number | undefined) => {\n    this._aspectRatio = val;\n  };\n  setDomRef = (ref: any) => {\n    this._dom = ref;\n  };\n\n  setDragging = (dragging: boolean) => {\n    this._dragging = dragging;\n  };\n  getDomBoundingBox(dom: any, rotation: number) {\n    let left = 0;\n    let top = 0;\n    let width = 0;\n    let height = 0;\n    if (dom) {\n      left = dom.offsetLeft;\n      top = dom.offsetTop;\n      width = dom.offsetWidth;\n      height = dom.offsetHeight;\n\n      if (isNil(left) || isNil(top) || isNil(width) || isNil(height)) {\n        const clientRect = dom.getBoundingClientRect();\n        left = clientRect.left;\n        top = clientRect.top;\n        width = clientRect.width;\n\n        height = clientRect.height;\n\n        let parentDom = dom.parentElement;\n        while (parentDom && parentDom.getAttribute('data-virtual') === 'true') {\n          parentDom = parentDom.parentElement;\n        }\n\n        if (parentDom) {\n          const parentClientRect = dom.getBoundingClientRect();\n          left = left - parentClientRect.left;\n          top = top - parentClientRect.top;\n        }\n      }\n    }\n\n    const rect = {\n      top,\n      left,\n      width,\n      height,\n    };\n\n    return rect;\n  }\n\n  updateDomainCompileDimensions(ref: any) {\n    if (this.isAutoHeight() || this.isAutoWidth()) {\n      try {\n        const dom: any = ReactDOM.findDOMNode(ref);\n        const dims = { ...this.getDomBoundingBox(dom, 0) };\n\n        let width = this.style.get('width')\n          ? this.style.get('width')\n          : dims.width;\n        let height = this.style.get('height')\n          ? this.style.get('height')\n          : dims.height;\n\n        this._domDims = {\n          width: width,\n          height: height,\n          x: dims.left,\n          y: dims.top,\n          rotation: 0,\n        };\n      } catch (Error) {\n        // console.error(Error);\n        this._domDims = undefined;\n      }\n    } else {\n      this._domDims = undefined;\n    }\n  }\n\n  getCanvas(): Canvas {\n    return this._canvas;\n  }\n  get id() {\n    return this._id;\n  }\n  get dragging() {\n    return this._dragging;\n  }\n\n  getFields(): {\n    [key: string]: any;\n  } {\n    return {\n      type: types.literal,\n      props: Props,\n      style: Style,\n      layout: Layout,\n    };\n  }\n  get name() {\n    return this._name;\n  }\n  get parent() {\n    return this._parent;\n  }\n  get type() {\n    return this._type;\n  }\n  get props() {\n    return this._props;\n  }\n  get children() {\n    return this._children;\n  }\n  get style() {\n    return this._style;\n  }\n  get layout() {\n    return this._layout;\n  }\n  get yogaNode() {\n    return this._yogaNode;\n  }\n  get collisionScope() {\n    return this._collisionScope;\n  }\n  get collisionNode() {\n    return this._collisionNode;\n  }\n  setSelectable(val: boolean) {\n    if (val) {\n      this.unlock();\n    } else {\n      this.lock();\n    }\n  }\n  get locked() {\n    return this._locked;\n  }\n  get visible() {\n    return this._visible;\n  }\n  get innerText() {\n    return this._innerText;\n  }\n  get eventCallableRegistry() {\n    return this._eventCallableRegistry;\n  }\n  getBoundingClientRect(): IDimensionWithRoot & IDimensionWithRotation {\n    let dims = { ...this._dims };\n    if (this.parent) {\n      dims.x = dims.x - this.parent.getBorderLeft();\n      dims.y = dims.y - this.parent.getBorderTop();\n    }\n\n    return { ...dims, rootX: this.rootX, rootY: this.rootY };\n  }\n  getBounds(): IDimensionWithRotation {\n    return this._dims;\n  }\n  get rootX() {\n    let val = 0;\n    let parent = this.parent;\n    if (parent) {\n      let parentX = !isNil(parent.rootX) ? parent.rootX : parent._dims.x;\n      val = this._dims.x + parentX;\n    } else {\n      val = this._dims.x;\n    }\n\n    return val;\n  }\n\n  get rootY() {\n    let val = 0;\n    let parent = this.parent;\n    if (parent) {\n      let parentY = !isNil(parent.rootY) ? parent.rootY : parent._dims.y;\n      val = this._dims.y + parentY;\n    } else {\n      val = this._dims.y;\n    }\n    return val;\n  }\n  get rotation() {\n    let styleObj = this.layout.getAll();\n\n    let rotation = 0;\n    if (styleObj.transform) {\n      const transformValue = isArray(styleObj.transform)\n        ? styleObj.transform\n        : styleObj.transform['value'];\n\n      let index = findIndex(transformValue, (item: any) => {\n        let rotate = keys(item).indexOf('rotate');\n        return rotate !== -1 && !isNil(item['rotate']);\n      });\n      if (index > -1) {\n        let value: any =\n          transformValue[index]['rotate'] &&\n          transformValue[index]['rotate'].type\n            ? transformValue[index]['rotate'].value\n            : transformValue[index]['rotate'];\n        if (value && value.indexOf) {\n          if (value.indexOf('rad') > -1) {\n            value = parseFloat(value.slice(0, -3));\n            rotation = (value * 180) / Math.PI;\n          } else {\n            value = parseFloat(value.slice(0, -3));\n            rotation = value;\n          }\n        }\n      }\n    }\n\n    return rotation;\n  }\n\n  getMarginLeft() {\n    let margin = this.layout.get('marginLeft');\n    if (!margin) {\n      margin = this.layout.get('margin');\n    }\n    if (isNil(margin)) {\n      margin = 0;\n    }\n    return margin;\n  }\n  getMarginTop() {\n    let margin = this.layout.get('marginTop');\n    if (!margin) {\n      margin = this.layout.get('margin');\n    }\n    if (isNil(margin)) {\n      margin = 0;\n    }\n    return margin;\n  }\n  getPaddingLeft() {\n    let padding = this.layout.get('paddingLeft');\n    if (!padding) {\n      padding = this.layout.get('padding');\n    }\n    if (isNil(padding)) {\n      padding = 0;\n    }\n    return padding;\n  }\n  getPaddingTop() {\n    let padding = this.layout.get('paddingTop');\n    if (!padding) {\n      padding = this.layout.get('padding');\n    }\n    if (isNil(padding)) {\n      padding = 0;\n    }\n    return padding;\n  }\n  getBorderLeft() {\n    return this.yogaNode.getComputedBorder(yoga.EDGE_LEFT);\n  }\n  getBorderTop() {\n    return this.yogaNode.getComputedBorder(yoga.EDGE_TOP);\n  }\n  // DOC: Layer ops\n  setType(type: string) {\n    if (this._locked) {\n      // console.error('Mutations on locked layers not allowed');\n    }\n    this._type = type;\n    this.yogaNode.setType(type);\n\n    action(() => {\n      this.emit('type');\n    });\n  }\n  removeProp(key?: string) {\n    if (key) {\n      this._props.remove(key);\n      let yogaProps = { ...this._yogaNode.props, [key]: undefined };\n      this._yogaNode.setProps(yogaProps);\n      this.setYoga();\n    } else {\n      this._props = new Props();\n    }\n    action(() => {\n      this.emit('style');\n    });\n  }\n  setProp(key: string, value?: any) {\n    if (this._locked) {\n      // console.error('Mutations on locked layers not allowed');\n    }\n    this._props.set(key, value);\n    let yogaProps = { ...this._yogaNode.props, [key]: value };\n    this._yogaNode.setProps(yogaProps);\n    action(() => {\n      this.emit('props');\n    });\n    this.setYoga();\n  }\n  lock() {\n    this._locked = true;\n    action(() => {\n      this.emit('locked');\n    });\n  }\n  unlock() {\n    this._locked = false;\n    action(() => {\n      this.emit('locked');\n    });\n  }\n  show() {\n    if (\n      this._preservedProperties.hidden // Only apply show operations when the layer was hidden manually, prevents, applying uninteded default values in case show() is called without ever calling hide() first\n    ) {\n      this.children.forEach((child: Layer) => child.show());\n      this._visible = true;\n      this.unlock();\n      this.setStyle('opacity', this._preservedProperties.opacity);\n      if (this._preservedProperties.locked) {\n        this.lock();\n      }\n      this._preservedProperties.hidden = false;\n    }\n  }\n  hide(noShow?: boolean) {\n    if (!this._preservedProperties.hidden) {\n      this._visible = false;\n      this._preservedProperties = {\n        opacity: this._style.get('opacity'),\n        locked: this._locked,\n        hidden: true,\n      };\n      this.setStyle('opacity', 0);\n      this.lock();\n      this.children.forEach((child: Layer) => child.hide());\n    }\n  }\n  setName(name: string) {\n    if (this._locked) {\n      // console.error('Mutations on locked layers not allowed');\n    }\n    this._name = name;\n  }\n  setStyle(key: string | object, value?: any) {\n    if (this._locked) {\n      // console.error('Mutations on locked layers not allowed');\n    }\n    if (key === 'gradient') {\n      this._style.set(key, value);\n      if (!value) {\n        this._style.set('backgroundImage', '');\n      } else {\n        this._style.set(\n          'backgroundImage',\n          getGradientString(value as Gradient)\n        );\n      }\n    } else {\n      this._style.set(key, value);\n    }\n    action(() => {\n      this.emit('style');\n    });\n  }\n  private setParent(layer: Layer | null) {\n    this._parent = layer;\n  }\n  setCollisionScope = (scope: Collisions | null) => {\n    if (this._locked) {\n      // console.error('Mutations on locked layers not allowed');\n    }\n    this._collisionScope = scope;\n  };\n\n  executeFunction(name: string, ...args: any[]): any {\n    let parent: Canvas;\n    let layer: Layer = this;\n\n    while (layer.name !== 'canvas' && layer.parent) {\n      layer = layer.parent;\n    }\n\n    // @ts-ignore\n    parent = layer;\n    if (parent) {\n      const context: IContext = {\n        layer: this,\n        canvas: parent,\n      };\n\n      return parent.functionRegistry.executeFunction(name, context, ...args);\n    } else {\n      return new Promise((resolve, reject) => {\n        return reject('The layer doesnot belong to a canvas.');\n      });\n    }\n  }\n  addChild(layer: Layer, index?: number) {\n    if (this._locked) {\n      // console.error('Mutations on locked layers not allowed');\n    }\n    layer.setParent(this);\n    layer.setCollisionScope(this._collisionScope);\n    if (!isNil(index)) {\n      this._children.splice(index, 0, layer);\n    } else {\n      this._children.push(layer);\n    }\n    layer.addYogaNode(index);\n    layer.setCollisionNode();\n    this.calculateLayout();\n\n    // if (this._domDims) {\n    //   this.yogaNode.setHeight(this._domDims.height);\n    //   this.yogaNode.setWidth(this._domDims.width);\n    // }\n\n    this.setYoga();\n    action(() => {\n      this.emit('children');\n    });\n  }\n  removeChild(layer: Layer) {\n    if (this._locked) {\n      // console.error('Mutations on locked layers not allowed');\n    }\n    layer.removeCollisionNode();\n    const index = this._children.indexOf(layer);\n    if (index !== -1) {\n      let removeChildEvent = new RemoveChildEvent('removeChild', layer);\n      if (layer.parent) {\n        layer.parent.dispatchEvent('removeChild', removeChildEvent);\n      }\n      this._children.splice(index, 1);\n      this._yogaNode.removeChild(layer.yogaNode);\n      layer.setCollisionScope(null);\n      this.calculateLayout();\n      // this.setDims();\n\n      if (layer.isFlexChild()) {\n        if (layer.parent) {\n          layer.parent.children.forEach((child: Layer) => {\n            child.setDims();\n            child.setCollisionNode();\n          });\n        }\n      }\n      action(() => {\n        this.emit(['children', 'yogaNode']);\n      });\n    }\n  }\n  move(newParent: Layer, newIndex?: number) {\n    if (this._parent) {\n      this._parent.removeChild(this);\n    }\n    newParent.addChild(this, newIndex);\n\n    newParent.children.forEach((child: Layer) => {\n      if (child.isFlexChild()) {\n        child.setYoga();\n      }\n    });\n  }\n  // DOC: Yoga ops\n  getRootLayer(node?: Layer): any {\n    if (!node) {\n      node = this;\n    }\n    if (node.type === 'canvas') {\n      return node;\n    }\n    if (!node || !node.parent) {\n      return undefined;\n    }\n    return this.getRootLayer(node.parent);\n  }\n  private addYogaNode(index?: number) {\n    const parentLayer = this.parent;\n    if (parentLayer && parentLayer._yogaNode) {\n      if (parentLayer._yogaNode.getChildCount) {\n        if (isNil(index)) {\n          index = parentLayer.yogaNode.getChildCount();\n        }\n        if (!isNil(index)) {\n          if (parentLayer._yogaNode.insertChild) {\n            parentLayer._yogaNode.insertChild(this._yogaNode, index);\n          }\n        }\n      }\n    }\n  }\n  getComputedLayout() {\n    return this._yogaNode.getComputedLayout();\n  }\n  calculateLayout() {\n    // if (this._locked) {\n    //   return;\n    // }\n    let rootLayer = this.getRootLayer();\n    if (rootLayer && rootLayer.yogaNode) {\n      rootLayer.yogaNode.calculateLayout(\n        yoga.UNDEFINED,\n        yoga.UNDEFINED,\n        yoga.DIRECTION_LTR\n      );\n    } else {\n      this.yogaNode.calculateLayout(\n        yoga.UNDEFINED,\n        yoga.UNDEFINED,\n        yoga.DIRECTION_LTR\n      );\n    }\n    return this.getComputedLayout();\n  }\n\n  isFlexChild() {\n    const elementType = this._layout.get('position');\n    if (elementType && elementType === 'absolute') {\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  getTotalFlexOfFlexChildren() {\n    let sumOfFlex: number = 0;\n    this.children.forEach((child: Layer, index: number) => {\n      const layerFlex = child.getFlexValue();\n      if (layerFlex !== undefined) {\n        sumOfFlex += layerFlex;\n      }\n    });\n    return sumOfFlex;\n  }\n\n  getParentLayerFlexDirection(): any {\n    let parentLayer;\n    // TODO: heavy jugaad\n    try {\n      parentLayer = this.parent;\n    } catch (err) {\n      console.log(err);\n    }\n    if (!parentLayer) {\n      return 'column';\n    }\n    const flexDirection = parentLayer.layout.get('flexDirection');\n    return flexDirection ? flexDirection : 'column';\n  }\n\n  isAutoWidth() {\n    const position = this.layout.get('position');\n    const property = this.layout.get('width');\n    if (!isNil(property)) {\n      return false;\n    }\n    if (position === 'absolute') {\n      let left, right;\n\n      left = this.layout.get('left');\n      right = this.layout.get('right');\n\n      if (!isNil(left) && !isNil(right)) {\n        return false;\n      } else {\n        return true;\n      }\n    } else {\n      const flexDirection = this.getParentLayerFlexDirection();\n      if (!flexDirection) {\n        return false;\n      }\n      if (flexDirection === 'row') {\n        // Main axis\n        const flex = this.layout.get('flex');\n        if (isNil(flex) || isNaN(flex)) {\n          return true;\n        } else {\n          return false;\n        }\n      } else {\n        // Cross axis\n        const flex = this.layout.get('flex');\n        const alignSelf = this.layout.get('alignSelf');\n        if ((isNil(flex) || isNaN(flex)) && alignSelf !== 'stretch') {\n          return true;\n        } else {\n          return false;\n        }\n      }\n    }\n  }\n\n  isAutoHeight() {\n    const position = this.layout.get('position');\n    const property = this.layout.get('height');\n    if (!isNil(property)) {\n      return false;\n    }\n    if (position === 'absolute') {\n      let top, bottom;\n      top = this.layout.get('top');\n      bottom = this.layout.get('bottom');\n\n      if (!isNil(top) && !isNil(bottom)) {\n        return false;\n      } else {\n        return true;\n      }\n    } else {\n      const flexDirection = this.getParentLayerFlexDirection();\n\n      if (!flexDirection) {\n        return false;\n      }\n      if (flexDirection !== 'row') {\n        // Main axis\n        const flex = this.layout.get('flex');\n\n        if (isNil(flex) || isNaN(flex)) {\n          return true;\n        } else {\n          return false;\n        }\n      } else {\n        // Cross axis\n        const alignSelf = this.layout.get('alignSelf');\n        const flex = this.layout.get('flex');\n        if ((isNil(flex) || isNaN(flex)) && alignSelf !== 'stretch') {\n          return true;\n        } else {\n          return false;\n        }\n      }\n    }\n  }\n\n  isFillWidth(): boolean {\n    const position = this.layout.get('position');\n    const property = this.layout.get('width');\n\n    if (!isNil(property)) {\n      return false;\n    }\n\n    if (position === 'absolute') {\n      let left, right;\n      left = this.layout.get('left');\n      right = this.layout.get('right');\n\n      if (!isNil(left) && !isNil(right)) {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      const flexDirection = this.getParentLayerFlexDirection();\n\n      if (!flexDirection) {\n        return false;\n      }\n\n      if (flexDirection.indexOf('row') !== -1) {\n        // Main axis\n        const flex = this.layout.get('flex');\n        if (flex > 0) {\n          return true;\n        } else {\n          return false;\n        }\n      } else {\n        // Cross axis\n        const alignSelf = this.layout.get('alignSelf');\n        if (!alignSelf || alignSelf === 'stretch') {\n          return true;\n        } else {\n          return false;\n        }\n      }\n    }\n  }\n  isFillHeight(): boolean {\n    const position = this.layout.get('position');\n    const property = this.layout.get('height');\n\n    if (!isNil(property)) {\n      return false;\n    }\n\n    if (position === 'absolute') {\n      let top, bottom;\n      top = this.layout.get('top');\n      bottom = this.layout.get('bottom');\n      if (!isNil(top) && !isNil(bottom)) {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      const flexDirection = this.getParentLayerFlexDirection();\n      if (!flexDirection) {\n        return false;\n      }\n      if (flexDirection.indexOf('column') !== -1) {\n        const flex = this.layout.get('flex');\n        if (flex > 0) {\n          return true;\n        } else {\n          return false;\n        }\n      } else {\n        const alignSelf = this.layout.get('alignSelf');\n        if (!alignSelf || alignSelf === 'stretch') {\n          return true;\n        } else {\n          return false;\n        }\n      }\n    }\n  }\n\n  getFlexValue() {\n    const flexGrow = this.layout.get('flexGrow');\n    const flex = this.layout.get('flex');\n\n    return flexGrow ? flexGrow : flex;\n  }\n\n  getSiblingsWithFlex(): Array<Layer> {\n    let siblingsWithFlex = new Array<Layer>();\n    let isFillWidth = this.isFillWidth();\n    let isFillHeight = this.isFillHeight();\n    if (this.parent instanceof Layer) {\n      this.parent.children.forEach((childLayer: Layer, index: number) => {\n        const flex = this.getFlexValue();\n        if (flex && this !== childLayer) {\n          if (\n            childLayer.isFillWidth() === isFillWidth &&\n            childLayer.isFillHeight() === isFillHeight\n          ) {\n            siblingsWithFlex.push(childLayer);\n          }\n        }\n      });\n    }\n    return siblingsWithFlex;\n  }\n\n  setYoga() {\n    // if (this._locked) {\n    //   return;\n    // }\n\n    if (globalLayerUpdateController.updateLayout) {\n      this.setYogaAfterBatch();\n    } else if (globalLayerUpdateController.shouldAddToBatch()) {\n      globalLayerUpdateController.layerMap.set(this, true);\n    }\n  }\n\n  setYogaAfterBatch() {\n    let layout = this._layout.toJS();\n    let yogaProps = {\n      ...this._yogaNode.props,\n      style: layout.data,\n    };\n    this._yogaNode.setProps(yogaProps);\n    this._yogaNode.updateNode(layout.data);\n\n    if (this._thirdParty) {\n      this.updateDomainCompileDimensions(this._dom);\n      if (this._domDims) {\n        this.yogaNode.setHeight(this._domDims.height);\n        this.yogaNode.setWidth(this._domDims.width);\n      }\n    }\n\n    this.calculateLayout();\n    this.setDims();\n    this.setCollisionNode();\n\n    // handle for special case\n\n    if (globalLayerUpdateController.rerender) {\n      action(() => {\n        this.emit('yoga');\n      });\n    }\n  }\n  setChildrenLayout(layer: Layer) {\n    // if (this._locked) {\n    //   return;\n    // }\n    layer.children.forEach((child: Layer) => {\n      child.setYoga();\n      this.setChildrenLayout(child);\n    });\n  }\n\n  private emitLayoutChanges = () => {\n    let setLayoutEvent = new SetLayoutEvent('setLayoutEvent', this);\n\n    if (globalLayerUpdateController.updateChildrenLayout) {\n      if (this.isFlexChild()) {\n        if (this.parent) {\n          this.setChildrenLayout(this.parent);\n        }\n      } else {\n        this.setChildrenLayout(this);\n      }\n    }\n\n    if (globalLayerUpdateController.rerender) {\n      if (!this._dragging) {\n        action(() => {\n          this.emit('layout');\n        });\n      } else {\n        if (globalLayerUpdateController.updateLayout) {\n          this.onUpdateDom();\n        }\n      }\n    }\n    this.dispatchEvent('setLayout', setLayoutEvent);\n  };\n\n  onUpdateDom = () => {\n    let style = this.layout.getAll();\n    if (this._dom) {\n      if (this._dom.setNativeProps) {\n        let updatedStyle = { ...style };\n\n        if (updatedStyle['textDecorationLine']) {\n          updatedStyle = {\n            ...updatedStyle,\n            textDecoration: updatedStyle['textDecorationLine'],\n          };\n        }\n        this._dom.setNativeProps({\n          style: updatedStyle,\n        });\n      } else {\n        try {\n          const dom: any = ReactDOM.findDOMNode(this._dom);\n          if (dom) {\n            const attributes = [\n              'top',\n              'left',\n              'width',\n              'height',\n              'right',\n              'bottom',\n            ];\n            forEach(style, (value: any, key: string) => {\n              if (attributes.indexOf(key) !== -1) {\n                dom.style[key] =\n                  typeof value === 'string' ? value : `${value}px`;\n              } else if (key === 'transform') {\n                const transform = get(value, '0.rotate');\n                if (!isNil(transform)) {\n                  dom.style[key] = `rotate(${transform})`;\n                }\n              }\n            });\n          }\n        } catch (Error) {\n          //\n        }\n      }\n      action(() => {\n        this.emit('updateDom');\n      });\n    } else {\n      // const layerName =\n      //   this.props.layer.type === 'thirdParty'\n      //     ? this.props.layer.layerName.toLowerCase()\n      //     : this.props.layer.type;\n      // const domById = document.getElementById(\n      //   `${this.props.layer.id}_${layerName}`\n      // );\n      // if (domById) {\n      //   forEach(style, (value: any, key: string) => {\n      //     if (attributes.indexOf(key) !== -1) {\n      //       domById.style[key] =\n      //         typeof value === 'string' ? value : `${value}px`;\n      //     } else if (key === 'transform') {\n      //       domById.style[key] = `rotate(${value[0].rotate})`;\n      //     }\n      //   });\n      // }\n    }\n  };\n\n  setLayout(key: string | object, value?: any) {\n    if (!this.parent && this.type !== 'canvas') {\n      throw new Error(\n        'setLayout cannot be called on an orphan layer. Use addChild to add it to another layer first.'\n      );\n    }\n    if (this._locked) {\n      // console.error('Mutations on locked layers not allowed');\n    }\n    this._layout.set(key, value);\n    this.setYoga();\n    this.emitLayoutChanges();\n  }\n\n  recalculateLayout() {\n    this.setYoga();\n    this.emitLayoutChanges();\n  }\n  removeLayout(key?: string | object) {\n    // if (key && !this._layout.isValidKey(key)) {\n    //   return;\n    // }\n    if (key) {\n      this._layout.remove(key);\n    } else {\n      this._layout = new Layout();\n    }\n    this.setYoga();\n    this.emitLayoutChanges();\n  }\n  removeStyle(key?: string) {\n    if (key) {\n      this._style.remove(key);\n    } else {\n      this._style = new Style();\n    }\n\n    action(() => {\n      this.emit('style');\n    });\n  }\n  isValidLayoutKey(key: string) {\n    return this._layout.isValidKey(key);\n  }\n  setViewport(key: string | object, value?: any) {\n    if (this._locked) {\n      // console.error('Mutations on locked layers not allowed');\n    }\n    this._layout.set(key, value);\n    let layout = this._layout.toJS();\n    this._yogaNode.setProps({ ...this._yogaNode.props, style: layout.data });\n    this._yogaNode.updateNode(layout.data);\n\n    this.calculateLayout();\n    this.setDims();\n    action(() => {\n      this.emit(['layout', 'yogaNode']);\n    });\n  }\n  setDims() {\n    let dims = this._yogaNode.getComputedLayout();\n\n    this._dims = {\n      x: dims.left,\n      y: dims.top,\n      height: dims.height || 0,\n      width: dims.width || 0,\n      rotation: this.rotation,\n    };\n\n    // if (this._yogaNode.parent) {\n    //   this._dims.x =\n    //     this._dims.x - this._yogaNode.parent.getComputedBorder(yoga.EDGE_LEFT);\n    //   this._dims.y =\n    //     this._dims.y - this._yogaNode.parent.getComputedBorder(yoga.EDGE_TOP);\n    // }\n  }\n\n  setHeight(height: any) {\n    this._dims.height = height;\n  }\n  setWidth(width: any) {\n    this._dims.width = width;\n  }\n  // DOC: Collision detection ops\n  getTransform() {\n    let newX = this.rootX;\n    let newY = this.rootY;\n    let points = [\n      [newX, newY],\n      [newX + this._dims.width, newY],\n      [newX + this._dims.width, newY + this._dims.height],\n      [newX, newY + this._dims.height],\n    ];\n    let centroid = ModelUtils.getCentroid(points);\n    let transformObj = {\n      rotate: {\n        rotation: this.rotation,\n        centroid: centroid,\n      },\n    };\n    let parent = this.parent;\n    if (!parent) {\n      return [transformObj];\n    }\n    let transformArray: any = [];\n    if (parent.getTransform && isArray(parent.getTransform())) {\n      [...parent.getTransform()].map((transform: any) => {\n        transformArray.push({ ...transform });\n      });\n    }\n    let array = [...transformArray];\n    array.push(transformObj);\n    return array;\n  }\n  getAbsoluteRotation() {\n    let dims = {\n      x: this.rootX || 0,\n      y: this.rootY || 0,\n      width: this._dims.width || 0,\n      height: this._dims.height || 0,\n      transform: this.getTransform(),\n    };\n    let poly = ModelUtils.getPointsFromDims(dims);\n    let angle = ModelUtils.getAbsoluteRotation(poly);\n    return angle;\n  }\n\n  getRotatedDims() {\n    let dims = {\n      x: this.rootX || 0,\n      y: this.rootY || 0,\n      rootX: this.rootY || 0,\n      rootY: this.rootY || 0,\n      width: this._dims.width > 0 ? this._dims.width : 1,\n      height: this._dims.height > 0 ? this._dims.height : 1,\n      transform: this.getTransform(),\n    };\n\n    let poly = ModelUtils.getPointsFromDims(dims);\n    let angle = this.getAbsoluteRotation ? this.getAbsoluteRotation() : 0;\n    let centroid = ModelUtils.getCentroid(poly); // rotate first point of polygon to get original x and y\n    let firstPoint = ModelUtils.rotatePoint(poly[0], 360 - angle, centroid);\n    let box = {\n      x: isNaN(firstPoint[0]) ? poly[0][0] : firstPoint[0],\n      y: isNaN(firstPoint[1]) ? poly[0][1] : firstPoint[1],\n      height: isNaN(this._dims.height) ? 0 : this._dims.height,\n      width: isNaN(this._dims.width) ? 0 : this._dims.width,\n      rotation: isNaN(angle) ? 0 : angle,\n    };\n    return box;\n  }\n\n  getRotatedPolygon() {\n    let dims = {\n      x: this.rootX || 0,\n      y: this.rootY || 0,\n      width: this._dims.width || 0,\n      height: this._dims.height || 0,\n      transform: this.getTransform(),\n    };\n\n    let poly = ModelUtils.getPointsFromDims(dims);\n\n    let angle = ModelUtils.getAbsoluteRotation(poly);\n\n    let centroid = ModelUtils.getCentroid(poly); // rotate first point of polygon to get original x and y\n\n    let firstPoint = ModelUtils.rotatePoint(poly[0], 360 - angle, centroid);\n\n    let box = {\n      centroid,\n      poly,\n      rotation: angle,\n    };\n    return box;\n\n    // let dims = {\n    //   x: this.rootX || 0,\n    //   y: this.rootY || 0,\n    //   width: this._dims.width || 0,\n    //   height: this._dims.height || 0,\n    //   transform: this.getTransform(),\n    // };\n\n    // let poly = ModelUtils.getPointsFromDims(dims);\n\n    // console.log(poly[0], poly[1], 'poly here');\n    // let angle = ModelUtils.getAbsoluteRotation(poly); //? ModelUtils.getAbsoluteRotation : 0;\n    // // let angle = 0;\n    // // let centroid = ModelUtils.getCentroid(poly); // rotate first point of polygon to get original x and y\n    // // let firstPoint = rotatePoint(poly[0], 360 - angle, centroid);\n    // let box = {\n    //   centroid,\n    //   poly,\n    //   rotation: angle,\n    // };\n    // return box;\n  }\n  private removeCollisionNode() {\n    if (this._collisionNode) {\n      this._collisionNode.remove();\n    }\n  }\n  private setCollisionNode() {\n    this.removeCollisionNode();\n    let dims = this.getRotatedPolygon();\n\n    const updatedPoly = dims.poly.map(coord => {\n      return [coord[0] - dims.centroid[0], coord[1] - dims.centroid[1]];\n    });\n\n    if (this._collisionScope) {\n      this._collisionNode = this._collisionScope.createPolygon(\n        dims.centroid[0],\n        dims.centroid[1],\n        updatedPoly,\n        0,\n        1,\n        1\n      );\n      this._collisionScope.update();\n\n      this._collisionNode.data = this;\n    }\n  }\n  getPartialPath(node?: any): string {\n    if (!node) {\n      node = this;\n    }\n    // if (!node.parent) {\n    //   return `0`;\n    //   // TODO: add this code + some other condition for center wrapper\n    //   // } else if (node.parent) {\n    //   //   // added this case for center wrapper, just ignoring it.\n    //   //   return `${this.getPartialPath(node.parent)}`;\n    // } else\n\n    if (node.parent && node.parent.children) {\n      const parentChildren: Array<any> = node.parent.children;\n      let childIndex = findIndex(parentChildren, (child: any) => {\n        if (child) {\n          return node === child;\n        }\n        return false;\n      });\n\n      const parentPath = this.getPartialPath(node.parent);\n\n      // if (appendString) {\n      //   return `${this.getPath(\n      //     node.parent,\n      //     appendString\n      //   )}.children.${childIndex}`;\n      // } else {\n      //   return `${this.getPath(node.parent, appendString)}.${childIndex}`;\n      // }\n\n      if (parentPath) {\n        return `${parentPath}.${childIndex}`;\n      } else {\n        return `${childIndex}`;\n      }\n    } else {\n      return '';\n    }\n  }\n  getDepth() {\n    if (this.parent) {\n      const parentDepth = this.parent.getDepth();\n      let depth: number = parentDepth + 1;\n\n      if (this.parent.style.get('pointerEvents') === 'none') {\n        depth--;\n      }\n      return depth;\n    }\n    return -1;\n  }\n  getIndexInParent(): number {\n    let parentLayer = this.parent;\n    // TODO: add this for center wrapper\n    // let currentLayer: any = this;\n    // if (this._type === 'view' && this._parent) {\n    //   currentLayer = this._parent;\n    //   parentLayer = this._parent._parent;\n    // }\n    if (parentLayer && parentLayer.children) {\n      return parentLayer.children.indexOf(this);\n    }\n    return 0;\n  }\n\n  getHitLayer(x: number, y: number) {\n    const hitLayers = this.getHitResult(x, y);\n    return hitLayers[hitLayers.length - 1];\n  }\n\n  getHitResult(x: number, y: number) {\n    let hitResult: Array<Layer>;\n\n    if (!this._collisionScope) {\n      return [];\n    }\n    this._collisionScope.update();\n    const result = this._collisionScope.createResult();\n    // Create the player (represented by a Circle)\n    const player = this._collisionScope.createPoint(x, y, 1);\n    const potentials = player.potentials();\n    let layersHit: Layer[] = [];\n    // Loop through the potential wall collisions\n    for (const shape of potentials) {\n      // Test if the player collides with the wall\n      if (player.collides(shape, result)) {\n        // Push the player out of the wall\n        // const dataShape = shape as any;\n        if (shape && layersHit.indexOf((shape as any).data) === -1) {\n          // const renderFile = dataShape.data.getFile();\n          // if (renderFile && renderFile.visible) {\n          layersHit.push((shape as any).data);\n          // }\n        }\n      }\n    }\n    this._collisionScope.remove(player);\n\n    layersHit = layersHit.sort((layer1: Layer, layer2: Layer) => {\n      return ModelUtils.depthComparator(\n        layer1.getPartialPath(),\n        layer2.getPartialPath()\n      );\n    });\n\n    let newHitLayers = [];\n\n    for (let i = 0; i < layersHit.length; i++) {\n      if (\n        !layersHit[i].locked &&\n        layersHit[i].style.get('pointerEvents') !== 'none' && // ignored layers shoudl not be included in the result\n        (i === layersHit.length - 1 || // If it's the last layer (i.e. top layer), there is no next layer to compare its depth to\n        layersHit[i].getDepth() !== layersHit[i + 1].getDepth() || // If layer has same depth as next layer, that means they are siblings, so don't include the current layer because it is behind the next layer\n          layersHit[i + 1].style.get('pointerEvents') === 'none') // If next layer is an ignored layer, we can include the current layer\n      ) {\n        newHitLayers.push(layersHit[i]);\n      }\n    }\n\n    hitResult = newHitLayers;\n\n    return this.getCanvas().executeMiddleware(\n      'Layer.getHitResult',\n      hitResult,\n      (hitResult: Array<Layer>) => {\n        return hitResult;\n      }\n    );\n  }\n  getHitRectResult(x: number, y: number, width: number, height: number) {\n    if (!this._collisionScope) {\n      return [];\n    }\n    // for all overlapping layers\n    const result = this._collisionScope.createResult();\n    // Create the player (represented by a Circle)\n    const player = this._collisionScope.createPolygon(\n      0,\n      0,\n      ModelUtils.getPointsFromBoundingBox({ x, y, width, height })\n    );\n    this._collisionScope.update();\n    const potentials = player.potentials();\n    let layersHit: Array<Layer> = [];\n    // Loop through the potential wall collisions\n    for (const shape of potentials) {\n      if (player.collides(shape, result)) {\n        if (shape && layersHit.indexOf((shape as any).data) === -1) {\n          const data = (shape as any).data;\n          if (\n            !data.locked &&\n            !(\n              x > data.rootX &&\n              y > data.rootY &&\n              width < data.width + data.rootX - x &&\n              height < data.height + data.rootY - y\n            )\n          ) {\n            layersHit.push(data);\n          }\n        }\n      }\n    }\n    this._collisionScope.remove(player);\n    layersHit = orderBy(\n      layersHit,\n      [\n        (layer: Layer) => layer.getDepth(),\n        (layer: Layer) => layer.getIndexInParent(),\n      ],\n      ['desc', 'desc']\n    );\n\n    remove(layersHit, layer => {\n      if (layer.style.get('pointerEvents') === 'none') {\n        return true;\n      }\n      return false;\n    });\n\n    return this.getCanvas().executeMiddleware(\n      'Layer.getHitRectResult',\n      layersHit,\n      (layersHit: Array<Layer>) => {\n        return layersHit;\n      }\n    );\n  }\n\n  addEventListener(name: string, callback: any) {\n    this._eventCallableRegistry.addEventListener(name, callback);\n  }\n  removeEventListener(name: string, callback: any) {\n    this._eventCallableRegistry.removeEventListener(name, callback);\n  }\n  dispatchEvent(name: string, event: Event, dispatchedData?: any) {\n    // this.getCanvas().executeMiddleware(\n    //   'Layer.dispatchEvent',\n    //   event,\n    //   (data: any) => {\n    if (this.style.get('pointerEvents') !== 'none') {\n      this._eventCallableRegistry.dispatchEvent(name, event);\n    }\n    if (event.propagate && this._parent) {\n      this._parent.dispatchEvent(name, event, dispatchedData);\n    }\n  }\n\n  setInnerText(text: string) {\n    if (this._locked) {\n      // console.error('Mutations on locked layers not allowed');\n    }\n    this._innerText = text;\n    this._yogaNode.children = text;\n\n    this.emitLayoutChanges();\n    action(() => {\n      this.emit('innerText');\n    });\n    this.setYoga();\n  }\n  getDimensions = (dims: IDimension, container: any) => {\n    let x = dims.x ? dims.x : 0;\n    let y = dims.y ? dims.y : 0;\n    let width = dims.width ? dims.width : 0;\n    let height = dims.height ? dims.height : 0;\n    let containerWidth = container.width;\n    let containerHeight = container.height;\n    let dimensions: any = {\n      left: { percent: undefined, number: undefined },\n      right: { percent: undefined, number: undefined },\n      top: { percent: undefined, number: undefined },\n      bottom: { percent: undefined, number: undefined },\n      width: { percent: undefined, number: undefined },\n      height: { percent: undefined, number: undefined },\n    };\n\n    dimensions.left.number = x;\n    dimensions.left.percent =\n      Math.round((dimensions.left.number / containerWidth) * 100 * 100) / 100 +\n      '%';\n    dimensions.right.number = containerWidth - (x + width);\n    dimensions.right.percent =\n      Math.round((dimensions.right.number / containerWidth) * 100 * 100) / 100 +\n      '%';\n    dimensions.width.number = width;\n    dimensions.width.percent =\n      Math.round((dimensions.width.number / containerWidth) * 100 * 100) / 100 +\n      '%';\n    dimensions.top.number = y;\n    dimensions.top.percent =\n      Math.round((dimensions.top.number / containerHeight) * 100 * 100) / 100 +\n      '%';\n    dimensions.bottom.number = containerHeight - (y + height);\n    dimensions.bottom.percent =\n      Math.round((dimensions.bottom.number / containerHeight) * 100 * 100) /\n        100 +\n      '%';\n    dimensions.height.number = height;\n    dimensions.height.percent =\n      Math.round((dimensions.height.number / containerHeight) * 100 * 100) /\n        100 +\n      '%';\n    return dimensions;\n  };\n\n  convertLayerDimensions(dims: IDimensionWithRotation) {\n    let scopeVariables = {};\n    let layer = this;\n    let layoutData: any = {};\n\n    const originalLeft = layer._layout.get('left');\n    const originalTop = layer._layout.get('top');\n    const originalRight = layer._layout.get('right');\n    const originalBottom = layer._layout.get('bottom');\n    const originalHeight = layer._layout.get('height');\n    const originalWidth = layer._layout.get('width');\n    const originalTransform = layer._layout.get('transform');\n    const position = layer._layout.get('position');\n\n    let newLeft, newRight, newTop, newBottom, newWidth, newHeight;\n\n    let container: any = {\n      width: this._parent ? this._parent.getBoundingClientRect().width : 1,\n      height: this._parent ? this._parent.getBoundingClientRect().height : 1,\n    };\n    let dimensions: any = this.getDimensions(dims, container);\n\n    if (!isNil(originalLeft)) {\n      if (typeof originalLeft === 'number') {\n        newLeft = dimensions.left.number;\n      }\n\n      if (typeof originalLeft === 'string' && originalLeft.endsWith('%')) {\n        newLeft = dimensions.left.percent;\n      }\n    }\n\n    if (!isNil(originalRight)) {\n      if (typeof originalRight === 'number') {\n        newRight = dimensions.right.number;\n      }\n\n      if (typeof originalRight === 'string' && originalRight.endsWith('%')) {\n        newRight = dimensions.right.percent;\n      }\n    }\n\n    if (!isNil(originalWidth)) {\n      if (typeof originalWidth === 'number') {\n        newWidth = dimensions.width.number;\n      }\n\n      if (typeof originalWidth === 'string' && originalWidth.endsWith('%')) {\n        newWidth = dimensions.width.percent;\n        if (layer.parent && layer.parent.type === 'thirdParty') {\n          newWidth = originalWidth;\n        }\n      }\n    }\n\n    if (!isNil(originalTop)) {\n      if (typeof originalTop === 'number') {\n        newTop = dimensions.top.number;\n      }\n\n      if (typeof originalTop === 'string' && originalTop.endsWith('%')) {\n        newTop = dimensions.top.percent;\n      }\n    }\n\n    if (!isNil(originalBottom)) {\n      if (typeof originalBottom === 'number') {\n        newBottom = dimensions.bottom.number;\n      }\n\n      if (typeof originalBottom === 'string' && originalBottom.endsWith('%')) {\n        newBottom = dimensions.bottom.percent;\n      }\n    }\n\n    if (!isNil(originalHeight)) {\n      if (typeof originalHeight === 'number') {\n        newHeight = dimensions.height.number;\n      }\n\n      if (typeof originalHeight === 'string' && originalHeight.endsWith('%')) {\n        newHeight = dimensions.height.percent;\n      }\n    }\n\n    if (!isNil(newLeft) && !isNil(dims.x)) {\n      layoutData.left = newLeft;\n    }\n\n    if (!isNil(newRight) && !isNil(dims.x)) {\n      layoutData.right = newRight;\n    }\n\n    if (\n      isNil(newLeft) &&\n      isNil(newRight) &&\n      position === 'absolute' &&\n      !isNil(dims.x)\n    ) {\n      layoutData.left = dims.x;\n    }\n\n    if (!isNil(newWidth) && !isNil(dims.width)) {\n      layoutData.width = newWidth;\n      // if (layer instanceof EllipseLayer) {\n      //   noRerender(() => {\n      //     const strokeWidth = layer.props.getResolvedProp('strokeWidth') || 0;\n      //     this.session.commandManager.executeAndSkip(\n      //       new SetProp(this.session, layer, 'cx', dimensions.width.number / 2)\n      //     );\n      //     this.session.commandManager.executeAndSkip(\n      //       new SetProp(\n      //         this.session,\n      //         layer,\n      //         'rx',\n      //         dimensions.width.number / 2 - strokeWidth / 2\n      //       )\n      //     );\n      //   });\n      // }\n    }\n\n    if (!isNil(newTop) && !isNil(dims.y)) {\n      layoutData.top = newTop;\n    }\n\n    if (!isNil(newBottom) && !isNil(dims.y)) {\n      layoutData.bottom = newBottom;\n    }\n\n    if (\n      isNil(newTop) &&\n      isNil(newBottom) &&\n      position === 'absolute' &&\n      !isNil(dims.y)\n    ) {\n      layoutData.top = dims.y;\n    }\n    if (!isNil(newHeight) && !isNil(dims.height)) {\n      layoutData.height = newHeight;\n      // if (layer instanceof EllipseLayer) {\n      //   noRerender(() => {\n      //     const strokeWidth = layer.props.getResolvedProp('strokeWidth') || 0;\n      //     this.session.commandManager.executeAndSkip(\n      //       new SetProp(this.session, layer, 'cy', dimensions.height.number / 2)\n      //     );\n      //     this.session.commandManager.executeAndSkip(\n      //       new SetProp(\n      //         this.session,\n      //         layer,\n      //         'ry',\n      //         dimensions.height.number / 2 - strokeWidth / 2\n      //       )\n      //     );\n      //   });\n      // }\n    }\n    // if (layer instanceof EllipseLayer) {\n    //   noRerender(() => {\n    //     const viewBoxWidth = dimensions.width.number.toFixed(2);\n    //     const viewBoxHeight = dimensions.height.number.toFixed(2);\n    //     this.session.commandManager.executeAndSkip(\n    //       new SetProp(\n    //         this.session,\n    //         layer,\n    //         'viewBox',\n    //         `0 0 ${viewBoxWidth} ${viewBoxHeight}`\n    //       )\n    //     );\n    //   });\n    // }\n    if (\n      !isNil(newLeft) &&\n      !isNil(newRight) &&\n      position === 'absolute' &&\n      !isNil(newWidth)\n    ) {\n      delete layoutData.right;\n    }\n\n    if (\n      !isNil(newTop) &&\n      !isNil(newBottom) &&\n      position === 'absolute' &&\n      !isNil(newHeight)\n    ) {\n      delete layoutData.bottom;\n    }\n    // if (\n    //   this.generateGradient &&\n    //   (layer instanceof ViewLayer || layer instanceof EllipseLayer) &&\n    //   !this.session.currentStage.tools.resizer.dragging\n    // ) {\n    //   if (layer.gradient && layer.gradient.getGradientType()) {\n    //     this.session.commandManager.executeAndSkip(\n    //       new GenerateGradientImage(this.session, layer)\n    //     );\n    //   }\n    // }\n\n    // if (\n    //   this.session.currentStage.id === 'layer' &&\n    //   this.session.currentRootLayer instanceof ScrollViewLayer\n    // ) {\n    //   CommandUtils.setScrollViewContentContainerStyle(\n    //     this.session,\n    //     this.session.currentRootLayer\n    //   );\n    // }\n\n    // TODO: FIXME: temporary fix for text drag color bug, need to see in computeYogaNode()\n    // if (color) {\n    //   this.session.commandManager.executeAndSkip(\n    //     new SetStyleAttribute(this.session, layer, 'color', color)\n    //   );\n    // }\n\n    // if (!this.session.currentStage.tools.resizer.dragging) {\n    //   this.session.commandManager.executeAndSkip(\n    //     new SetFileDirty(this.session, true)\n    //   );\n    // }\n\n    if (layer.isFlexChild()) {\n      delete layoutData.top;\n      delete layoutData.left;\n      delete layoutData.bottom;\n      delete layoutData.right;\n    }\n\n    let transformValue = undefined;\n\n    if (!isNil(dims.rotation)) {\n      transformValue = [{ rotate: `${dims.rotation}deg` }];\n    }\n    return {\n      ...layoutData,\n      transform: transformValue,\n    };\n  }\n\n  rerenderDescendants() {\n    action(() => {\n      this.emit(['layout', 'style', 'children']);\n    });\n    this._children.forEach(c => {\n      c.rerenderDescendants();\n    });\n  }\n}\n\nexport class LayerInstantiable extends Layer {}\n","export default class MiddlewareRegistry {\n  _middlewares: Map<string, Array<any>>;\n  constructor() {\n    this._middlewares = new Map();\n  }\n\n  addMiddleware = (type: string, callback: any) => {\n    let middlewares = this._middlewares.get(type);\n    if (middlewares) {\n      middlewares.push(callback);\n    } else {\n      this._middlewares.set(type, [callback]);\n    }\n  };\n\n  execute(middlewareCallbacks: Array<any>, cb: any, data: any) {\n    const self = this;\n    if (middlewareCallbacks.length === 0) {\n      return cb(data);\n    } else {\n      const mw = middlewareCallbacks[0];\n      const remainingCbs = [...middlewareCallbacks];\n      remainingCbs.splice(0, 1);\n\n      const next = (_data: any) => {\n        return self.execute(remainingCbs, cb, _data);\n      };\n      return mw(next, data);\n    }\n  }\n  executeMiddleware(type: string, data: any, callback: any) {\n    const middlewares = this._middlewares.get(type);\n    if (middlewares) {\n      // @ts-ignore\n      if (window['debug'] && window['debugLog']) {\n        // @ts-ignore\n        window['debugLog']('Middleware: ' + type);\n      }\n      return this.execute(middlewares, callback, data);\n    } else {\n      return callback(data);\n    }\n  }\n}\n","export default class FunctionRegistry {\n  _functions: Map<string, Function>;\n  constructor() {\n    this._functions = new Map();\n  }\n\n  // Adding to the Map of functions\n  addFunction = (name: string, callback: any) => {\n    this._functions.set(name, callback);\n  };\n\n  // Executing the callback of the function with the given arguments\n  executeFunction = (name: string, ...args: any[]) => {\n    let fn = this._functions.get(name);\n    if (fn) {\n      return fn(...args);\n    } else {\n      throw new Error(`No function with the given name(${name}) found.`);\n    }\n  };\n\n  // Removing the callback of the given function\n  removeFunction = (name: string) => {\n    this._functions.delete(name);\n  };\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\nimport { Canvas } from 'models/Canvas';\nexport default class DesignerMouseEvent extends Event {\n  originalEvent: any;\n  worldX: number;\n  worldY: number;\n  viewportX: number;\n  viewportY: number;\n  pageX: number;\n  pageY: number;\n  constructor(\n    name: string,\n    target: Layer,\n    originalEvent: any,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    const canvas: Canvas = target.getCanvas();\n    const { pageX, pageY } = originalEvent;\n    this.originalEvent = originalEvent;\n    this.pageX = pageX;\n    this.pageY = pageY;\n\n    let worldPoints = canvas.convertPoint(\n      { x: pageX, y: pageY },\n      'page',\n      'world'\n    );\n\n    this.worldX = worldPoints.x;\n    this.worldY = worldPoints.y;\n\n    let viewportPoints = canvas.convertPoint(\n      { x: pageX, y: pageY },\n      'page',\n      'viewport'\n    );\n\n    this.viewportX = viewportPoints.x;\n    this.viewportY = viewportPoints.y;\n  }\n\n  preventDefault() {\n    super.preventDefault();\n    if (this.originalEvent && this.originalEvent.preventDefault) {\n      this.originalEvent.preventDefault();\n    }\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\nimport { Canvas } from 'models/Canvas';\nexport default class DesignerDropEvent extends Event {\n  originalEvent: any;\n  worldX: number;\n  worldY: number;\n  viewportX: number;\n  viewportY: number;\n  pageX: number;\n  pageY: number;\n\n  constructor(\n    name: string,\n    target: Layer,\n    originalEvent: any,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    const canvas: Canvas = target.getCanvas();\n    const { pageX, pageY } = originalEvent;\n    this.originalEvent = originalEvent;\n    this.pageX = pageX;\n    this.pageY = pageY;\n\n    let worldPoints = canvas.convertPoint(\n      { x: pageX, y: pageY },\n      'page',\n      'world'\n    );\n\n    this.worldX = worldPoints.x;\n    this.worldY = worldPoints.y;\n\n    let viewportPoints = canvas.convertPoint(\n      { x: pageX, y: pageY },\n      'page',\n      'viewport'\n    );\n\n    this.viewportX = viewportPoints.x;\n    this.viewportY = viewportPoints.y;\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\nexport default class HoverEvent extends Event {\n  payload: Array<Layer>;\n  constructor(\n    name: string,\n    target: Layer,\n    payload: Array<Layer>,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.payload = payload;\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\nimport { Canvas } from 'models/Canvas';\nexport default class SetScrollEvent extends Event {\n  scrollX: number;\n  scrollY: number;\n\n  constructor(\n    name: string,\n    target: Layer,\n    originalEvent: any,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.scrollX = originalEvent.x;\n    this.scrollY = originalEvent.y;\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\nimport { Canvas } from 'models/Canvas';\nexport default class SetZoomEvent extends Event {\n  zoom: number;\n\n  constructor(\n    name: string,\n    target: Layer,\n    zoom: number,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.zoom = zoom;\n  }\n}\n","export const ASSET_URL =\n  'https://pre-cloud.builderx.io/assets/plugins/designer';\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { Collisions } from 'detect-collisions';\nimport { DesignerReact } from '../components/DesignerReact';\nimport { action } from './base-model';\nimport {\n  IPosition,\n  IComponentMap,\n  IComponentDefinition,\n  IContext,\n} from './../interfaces';\nimport { isEmpty, maxBy, minBy } from 'lodash';\nimport { LayerInstantiable as Layer } from './Layer';\nimport { IPlugin, IDimensionWithRotation } from 'interfaces';\nimport MiddlewareRegistry from './MiddlewareRegistry';\nimport FunctionRegistry from './FunctionRegistry';\nimport DesignerMouseEvent from '../events/MouseEvent';\nimport ModelUtils from './../models/utils';\nimport DesignerDropEvent from '../events/DropEvent';\nimport HoverEvent from '../events/HoverEvent';\nimport { globalLayerUpdateController } from './GlobalLayerUpdateController';\nimport SetScrollEvent from '../events/SetScrollEvent';\nimport SetZoomEvent from '../events/SetZoomEvent';\nimport { ASSET_URL } from './../constants';\n\nexport class Canvas extends Layer {\n  private plugins = new Map<string, IPlugin>();\n  private dom: any;\n  private zoom: number = 1;\n  private _mouseCursorType: any;\n  private scroll: IPosition = {\n    x: 0,\n    y: 0,\n  };\n  private viewport: {\n    width: number;\n    height: number;\n  };\n  private _viewportRef: any;\n  private _hoveredLayers: Array<Layer>;\n  private _selectedLayers: Array<Layer>;\n  private _stackWorldDOM: Array<any>;\n  private _stackViewportDOM: Array<any>;\n  private _middlewareRegistry: MiddlewareRegistry = new MiddlewareRegistry();\n  private _functionRegistry: FunctionRegistry = new FunctionRegistry();\n  private _componentMap: IComponentMap = {};\n  private _isMouseDown: boolean = false;\n  private _assetURL: string = ASSET_URL;\n  private _mouseEventsBlocked: boolean = false;\n  moveWithGrabHandle: boolean = false;\n  constructor(dom: any) {\n    super();\n    this.dom = dom;\n    this.viewport = {\n      width: 0,\n      height: 0,\n    };\n    this.setType('canvas');\n    this.setCollisionScope(new Collisions());\n    this._hoveredLayers = [];\n    this._selectedLayers = [];\n    this._stackWorldDOM = [];\n    this._stackViewportDOM = [];\n    ReactDOM.render(<DesignerReact canvas={this} />, this.dom);\n    this.addFunction('setScroll', this.setScrollCallback.bind(this));\n    this.addFunction('setZoom', this.setZoomCallback.bind(this));\n  }\n  setMouseCursor(mouseCursorType: string) {\n    this._mouseCursorType = mouseCursorType;\n    action(() => {\n      this.emit('mouseCursorType');\n    });\n  }\n  setScrollCallback(context: IContext, scrollDims: any) {\n    this.dispatchEvent(\n      'setScroll',\n      new SetScrollEvent('setScroll', this, scrollDims)\n    );\n  }\n  setZoomCallback(context: IContext, zoom: number) {\n    this.dispatchEvent('setZoom', new SetZoomEvent('setZoom', this, zoom));\n  }\n  get mouseEventsBlocked() {\n    return this._mouseEventsBlocked;\n  }\n  blockMouseEvents() {\n    this._mouseEventsBlocked = true;\n    action(() => {\n      this.emit('mouseEventsBlocked');\n    });\n  }\n  unblockMouseEvents() {\n    this._mouseEventsBlocked = false;\n    action(() => {\n      this.emit('mouseEventsBlocked');\n    });\n  }\n  get functionRegistry() {\n    return this._functionRegistry;\n  }\n\n  createLayer() {\n    return new Layer(this);\n  }\n\n  addMiddleware(name: string, callback: (next: Function, data: any) => any) {\n    this._middlewareRegistry.addMiddleware(name, callback);\n  }\n  executeMiddleware(name: string, data: any, callback: any) {\n    return this._middlewareRegistry.executeMiddleware(name, data, callback);\n  }\n  // dispatchEvent(name: string, event: Event) {\n  //   this._eventCallableRegistry.dispatchEvent(name, event);\n  //   if (event.propagate)\n  //     if (this._parent) this._parent.dispatchEvent(name, event);\n  // }\n\n  addFunction(\n    name: string,\n    callback: (context: IContext, ...args: any[]) => any\n  ) {\n    this._functionRegistry.addFunction(name, callback);\n  }\n\n  removeFunction(name: string) {\n    this._functionRegistry.removeFunction(name);\n  }\n\n  setAssetUrl(url: string) {\n    this._assetURL = url;\n  }\n  // DOC: canvas ops\n  setViewport(dims: { width: number; height: number }) {\n    this.viewport.width = dims.width;\n    this.viewport.height = dims.height;\n    action(() => {\n      this.emit('viewport');\n    });\n  }\n\n  setViewportRef(ref: any) {\n    this._viewportRef = ref;\n  }\n  getViewport() {\n    return this.viewport;\n  }\n  setZoom(zoom: number) {\n    this.zoom = zoom;\n    action(() => {\n      this.emit('zoom');\n    });\n  }\n  getZoom(): number {\n    return this.zoom;\n  }\n  setScroll(scroll: IPosition) {\n    this.scroll = scroll;\n    action(() => {\n      this.emit('scroll');\n    });\n  }\n  getScroll(): IPosition {\n    return this.scroll;\n  }\n  get assetURL() {\n    return this._assetURL;\n  }\n  get hoveredLayers() {\n    return this._hoveredLayers;\n  }\n  get mouseCursorType() {\n    return this._mouseCursorType;\n  }\n  get selectedLayers() {\n    return this._selectedLayers;\n  }\n  get stackWorldDOM(): Array<any> {\n    return this._stackWorldDOM;\n  }\n  get stackViewportDOM(): Array<any> {\n    return this._stackViewportDOM;\n  }\n  get componentMap(): IComponentMap {\n    return this._componentMap;\n  }\n\n  get isMouseDown(): boolean {\n    return this._isMouseDown;\n  }\n  setMouseDown(val: boolean) {\n    this._isMouseDown = val;\n    if (this.moveWithGrabHandle) {\n      this.setMouseCursor(val ? '-webkit-grabbing' : '-webkit-grab');\n    }\n  }\n\n  setHoverLayers(layers: Array<Layer> | Layer | undefined) {\n    this._hoveredLayers = [];\n    if (layers) {\n      if (Array.isArray(layers)) {\n        layers.forEach((layer: Layer) => {\n          if (!layer.locked) {\n            this._hoveredLayers.push(layer);\n          }\n        });\n      } else if (!layers.locked) {\n        this._hoveredLayers = [layers];\n      }\n    }\n    action(() => {\n      this.emit('hoveredLayers');\n    });\n  }\n  selectLayers(layers: Array<Layer> | Layer | undefined) {\n    this._selectedLayers = [];\n    if (layers) {\n      if (Array.isArray(layers)) {\n        layers.forEach((layer: Layer) => {\n          if (!layer.locked) {\n            this._selectedLayers.push(layer);\n          }\n        });\n      } else if (!layers.locked) {\n        this._selectedLayers = [layers];\n      }\n    }\n    if (globalLayerUpdateController.rerender) {\n      action(() => {\n        this.emit('selectedLayers');\n      });\n    }\n  }\n\n  private convertPointFromViewportToWorld(x: number, y: number) {\n    let viewPortLeftPos =\n      (this.layout.get('width') - this.viewport.width / this.zoom) *\n      this.scroll.x;\n    let viewPortTopPos =\n      (this.layout.get('height') - this.viewport.height / this.zoom) *\n      this.scroll.y;\n    return {\n      x: viewPortLeftPos + x / this.zoom,\n      y: viewPortTopPos + y / this.zoom,\n    };\n  }\n  private convertPointFromWorldToViewport(x: number, y: number) {\n    let viewPortLeftPos =\n      (this.layout.get('width') - this.viewport.width / this.zoom) *\n      this.scroll.x;\n    let viewPortTopPos =\n      (this.layout.get('height') - this.viewport.height / this.zoom) *\n      this.scroll.y;\n\n    return {\n      x: (x - viewPortLeftPos) * this.zoom,\n      y: (y - viewPortTopPos) * this.zoom,\n    };\n  }\n  private convertPointFromPageToViewport(x: number, y: number) {\n    const pageScrollY = document.documentElement.scrollTop;\n    const pageScrollX = document.documentElement.scrollLeft;\n    const viewportDom = ReactDOM.findDOMNode(this._viewportRef);\n\n    let offsetLeft = 0;\n    let offsetTop = 0;\n    if (viewportDom) {\n      // @ts-ignore\n      const clientRect = viewportDom.getBoundingClientRect();\n      offsetLeft = clientRect.x;\n      offsetTop = clientRect.y;\n    }\n\n    return {\n      x: x - pageScrollX - offsetLeft,\n      y: y - pageScrollY - offsetTop,\n    };\n  }\n  private convertPointFromViewportToPage(x: number, y: number) {\n    const pageScrollY = document.documentElement.scrollTop;\n    const pageScrollX = document.documentElement.scrollLeft;\n    const viewportDom = ReactDOM.findDOMNode(this._viewportRef);\n\n    let offsetLeft = 0;\n    let offsetTop = 0;\n    if (viewportDom) {\n      // @ts-ignore\n      const clientRect = viewportDom.getBoundingClientRect();\n      offsetLeft = clientRect.x;\n      offsetTop = clientRect.y;\n    }\n    return {\n      x: x + pageScrollX + offsetLeft,\n      y: y + pageScrollY + offsetTop,\n    };\n  }\n\n  convertPoint = (\n    point: IPosition,\n    from: 'viewport' | 'page' | 'world',\n    to: 'viewport' | 'page' | 'world'\n  ) => {\n    let resultPoint: IPosition = { x: 0, y: 0 };\n    if (from === 'viewport') {\n      switch (to) {\n        case 'page':\n          resultPoint = this.convertPointFromViewportToPage(point.x, point.y);\n          break;\n        case 'world':\n          resultPoint = this.convertPointFromViewportToWorld(point.x, point.y);\n          break;\n      }\n    }\n    if (from === 'page') {\n      switch (to) {\n        case 'viewport':\n          resultPoint = this.convertPointFromPageToViewport(point.x, point.y);\n          break;\n        case 'world':\n          const viewport = this.convertPointFromPageToViewport(\n            point.x,\n            point.y\n          );\n          resultPoint = this.convertPointFromViewportToWorld(\n            viewport.x,\n            viewport.y\n          );\n          break;\n      }\n    }\n    if (from === 'world') {\n      switch (to) {\n        case 'viewport':\n          resultPoint = this.convertPointFromWorldToViewport(point.x, point.y);\n          break;\n        case 'page':\n          const world = this.convertPointFromWorldToViewport(point.x, point.y);\n          resultPoint = this.convertPointFromViewportToPage(world.x, world.y);\n          break;\n      }\n    }\n    return resultPoint;\n  };\n\n  installPlugin(plugin: IPlugin) {\n    this.plugins.set(plugin.name, plugin);\n    plugin.init(this);\n    plugin.activate();\n  }\n  dispatchEventOnHitLayer(\n    name: string,\n    event: DesignerMouseEvent,\n    dispatchedData?: any\n  ) {\n    // @ts-ignore\n    if (window['debug'] && window['debugLog']) {\n      // @ts-ignore\n      window['debugLog']('CanvasEvent:HitLayer ' + name);\n    }\n\n    let layer: any;\n\n    if (name !== 'drag') {\n      layer = this.getHitLayer(event.worldX, event.worldY);\n    }\n    if (layer) {\n      event.target = layer;\n      this._middlewareRegistry.executeMiddleware(\n        'Canvas.dispatchEventOnHitLayer',\n        event,\n        (event: any) => {\n          if (name === 'mousemove') {\n            if (!this.dragging) {\n              this.dispatchEvent(\n                'Canvas.hoverLayers',\n                new HoverEvent(\n                  'Canvas.hoverLayers',\n                  this,\n                  event.target ? [event.target] : []\n                )\n              );\n            }\n          }\n          layer.dispatchEvent(name, event, dispatchedData);\n        }\n      );\n    } else {\n      this.dispatchEvent(name, event, dispatchedData);\n    }\n  }\n  addComponent(\n    type: string,\n    ReactComponent: React.ComponentClass<any, any>,\n    componentDefinition: IComponentDefinition\n  ) {\n    this.componentMap[type] = {\n      renderer: ReactComponent,\n      definition: componentDefinition,\n    };\n  }\n\n  getComponentDefinition(type: string) {\n    try {\n      return this.componentMap[type].definition;\n    } catch (err) {\n      throw new Error(`Component Definition for ${type} not found`);\n    }\n  }\n\n  getRenderer(type: string): React.ComponentClass<any, any> {\n    try {\n      return this.componentMap[type].renderer;\n    } catch (err) {\n      throw new Error('Renderer not found');\n    }\n  }\n  addDomToWorld(\n    domElement: any,\n    maintainScale: boolean = false,\n    zIndex?: number\n  ): () => void {\n    let wrapperLayer = domElement;\n\n    if (maintainScale) {\n      let canvasDims = this.getBoundingClientRect();\n      wrapperLayer = document.createElement('div');\n      // wrapperLayer.style.background = 'rgba(255, 0,0,0.4)';\n      wrapperLayer.style.height = canvasDims.height + 'px';\n      wrapperLayer.style.width = canvasDims.width + 'px';\n      wrapperLayer.style.top = canvasDims.y + 'px';\n      wrapperLayer.style.left = canvasDims.x + 'px';\n      wrapperLayer.style.pointerEvents = 'none';\n      wrapperLayer.style.position = 'absolute';\n      wrapperLayer.style.zIndex = zIndex ? zIndex : undefined;\n\n      this.on('zoom', (e: any) => {\n        wrapperLayer.style.transform = `scale(${1 / this.getZoom()})`;\n        wrapperLayer.style.zoom = this.getZoom();\n      });\n      wrapperLayer.style.transform = `scale(${1 / this.getZoom()})`;\n      wrapperLayer.style.transformOrigin = `0 0`;\n      wrapperLayer.style.zoom = this.getZoom();\n\n      wrapperLayer.appendChild(domElement);\n    }\n    this._stackWorldDOM.push(wrapperLayer);\n    domElement.style.pointerEvents = 'all';\n    action(() => {\n      this.emit('stackWorldDOM');\n    });\n    return this.removeDomFromWorld.bind(this, wrapperLayer);\n  }\n  removeDomFromWorld(ele: any) {\n    let index = this._stackWorldDOM.indexOf(ele);\n    if (index !== -1) {\n      this._stackWorldDOM.splice(index, 1);\n      action(() => {\n        this.emit('stackWorldDOM');\n      });\n    }\n  }\n  addDomToViewport(domElement: any) {\n    this._stackViewportDOM.push(domElement);\n    domElement.style.pointerEvents = 'all';\n    action(() => {\n      this.emit('stackViewportDOM');\n    });\n    return this.removeDomFromViewport.bind(this, domElement);\n  }\n  removeDomFromViewport(ele: string) {\n    let index = this._stackViewportDOM.indexOf(ele);\n\n    if (index !== -1) {\n      this._stackViewportDOM.splice(index, 1);\n      action(() => {\n        this.emit('stackViewportDOM');\n      });\n    }\n  }\n  dispatchHandledEvent(event: any) {\n    const originalEvent = event.nativeEvent ? event.nativeEvent : event;\n    this.dispatchEventOnHitLayer(\n      event.type,\n      new DesignerMouseEvent(event.type, this, originalEvent, this),\n      event\n    );\n  }\n\n  handleNativeEvent(event: React.MouseEvent | MouseEvent) {\n    this._middlewareRegistry.executeMiddleware(\n      'Canvas.handleNativeEvent',\n      event,\n      (event: any) => {\n        switch (event.type) {\n          case 'click':\n            // if (!this.dragging) {\n            //   this.dispatchHandledEvent(event);\n            // }\n            break;\n          case 'mousemove':\n            if (this.isMouseDown && !this.dragging) {\n              this.setDragging(true);\n            }\n            // if (!this.dragging) {\n            this.dispatchHandledEvent(event);\n            // }\n            break;\n          case 'mousedown':\n            this.setMouseDown(true);\n            this.dispatchHandledEvent(event);\n            break;\n          case 'mouseenter':\n            this.dispatchHandledEvent(event);\n            break;\n          case 'mouseup':\n            // event.type = 'click';\n\n            this.dispatchHandledEvent(event);\n            this.setMouseDown(false);\n            if (!this.dragging) {\n              event = new MouseEvent('click', event);\n              // event.type = 'click';\n              this.dispatchHandledEvent(event);\n            }\n            this.setDragging(false);\n            break;\n          case 'contextmenu':\n          case 'dblclick':\n            this.dispatchHandledEvent(event);\n            break;\n          case 'drop':\n            this.dispatchEvent(\n              event.type,\n              new DesignerDropEvent(event.type, this, event.nativeEvent, this),\n              event\n            );\n            break;\n          default:\n          // this.dispatchCanvasEvent(\n          //   e.type,\n          //   new Event(e.type, this, this),\n          //   data\n          // );\n          // break;\n        }\n      }\n    );\n    // if (beforeHandleNativeEventMiddleware) {\n\n    // });\n    // beforeHandleNativeEventMiddleware[0](next);\n    // console.log('middleware:: here', beforeHandleNativeEventMiddleware);\n    // } else {\n    //   this.handleEvent(e);\n    // }\n  }\n\n  getContainerBoundingBox(layers: Array<Layer>) {\n    return this.getBoundingBox(layers, true);\n  }\n  getContainerBoundingBoxWRTParent(layers: Array<Layer>) {\n    return this.getBoundingBoxWRTParent(layers, true);\n  }\n  getBoundingBox(\n    layers: Array<Layer>,\n    withoutRotation: boolean = false,\n    wrtParent: boolean = false\n  ): IDimensionWithRotation {\n    let box = { x: 0, y: 0, height: 0, width: 0, rotation: 0 };\n    if (isEmpty(layers)) {\n      return box;\n    } else if (layers.length > 1 || withoutRotation) {\n      let layerPoints: any = [];\n\n      layers.map((layer: Layer) => {\n        let dims = layer.getBoundingClientRect();\n        let localBox = {\n          x: dims.rootX,\n          y: dims.rootY,\n          width: dims.width,\n          height: dims.height,\n        };\n        let rotation = layer.rotation;\n\n        // let points = ModelUtils(\n        //   layer.getRotatedDims(),\n        //   0\n        // );\n        let points = layer.getRotatedPolygon().poly;\n        if (wrtParent) {\n          points = ModelUtils.getPointsFromBoundingBox(localBox, rotation);\n        }\n        // layer.getRotatedDims(); //ModelUtils.getPointsFromBoundingBox(localBox, rotation);\n\n        layerPoints = layerPoints.concat(points);\n      });\n\n      let minXLayer: any = minBy(layerPoints, (layer: any) => {\n        return layer[0];\n      });\n      let minYLayer: any = minBy(layerPoints, (layer: any) => {\n        return layer[1];\n      });\n      let maxXLayer: any = maxBy(layerPoints, (layer: any) => {\n        return layer[0];\n      });\n      let maxYLayer: any = maxBy(layerPoints, (layer: any) => {\n        return layer[1];\n      });\n      minXLayer = minXLayer ? minXLayer[0] : 0;\n      minYLayer = minYLayer ? minYLayer[1] : 0;\n      maxXLayer = maxXLayer ? maxXLayer[0] : 0;\n      maxYLayer = maxYLayer ? maxYLayer[1] : 0;\n\n      box.x = minXLayer;\n      box.y = minYLayer;\n      box.width = maxXLayer ? maxXLayer - minXLayer : 0;\n      box.height = maxYLayer ? maxYLayer - minYLayer : 0;\n      box.rotation = 0;\n    } else if (layers.length === 1) {\n      let layer = layers[0];\n      return layer.getRotatedDims();\n    }\n    return box;\n  }\n  getBoundingBoxWRTParent(\n    layers: Array<Layer>,\n    withoutRotation: boolean = false\n  ) {\n    let dims = this.getBoundingBox(layers, withoutRotation, true);\n    let parentDims =\n      layers.length && layers[0].parent\n        ? layers[0].parent.getBoundingClientRect()\n        : { rootX: 0, rootY: 0 };\n    return {\n      ...dims,\n      x: dims.x - parentDims.rootX,\n      y: dims.y - parentDims.rootY,\n      rootX: dims.x,\n      rootY: dims.y,\n    };\n  }\n\n  enableMoveWithGrabHandle() {\n    if (!this.mouseEventsBlocked) {\n      this.moveWithGrabHandle = true;\n      this.setMouseCursor(\n        this.isMouseDown ? '-webkit-grabbing' : '-webkit-grab'\n      );\n      this.blockMouseEvents();\n      action(() => {\n        this.emit('moveWithGrabHandle');\n      });\n    }\n  }\n\n  disableMoveWithGrabHandle() {\n    if (this.moveWithGrabHandle) {\n      this.moveWithGrabHandle = false;\n      this.setMouseCursor('default');\n      this.unblockMouseEvents();\n      action(() => {\n        this.emit('moveWithGrabHandle');\n      });\n    }\n  }\n}\n","import { forEach, isFunction } from 'lodash';\ninterface Points {\n  x: number;\n  y: number;\n}\n\nexport interface StopPoints {\n  stopColor: string;\n  stopOpacity?: string;\n  offset: number;\n}\n\nexport class Gradient {\n  gradientType: 'LinearGradient' | 'RadialGradient' | 'AngularGradient';\n  elipseLength?: number;\n  from: Points;\n  to: Points;\n  stops: Array<StopPoints>;\n  activeIndex?: number = 0;\n  constructor(\n    gradientType: 'LinearGradient' | 'RadialGradient' | 'AngularGradient',\n    from: Points,\n    to: Points,\n    stops: Array<StopPoints>,\n    activeIndex?: number,\n    elipseLength?: number\n  ) {\n    this.gradientType = gradientType;\n    this.from = from;\n    this.to = to;\n    this.stops = stops;\n    this.activeIndex = activeIndex;\n    this.elipseLength = elipseLength;\n  }\n\n  toJS() {\n    const gradientJSON: any = {};\n\n    forEach(this, (value: any, key: any) => {\n      // if (![\"\"].includes(key)) {\n      if (!isFunction(value)) {\n        gradientJSON[key] = value && value.toJS ? value.toJS() : value;\n      }\n      // }\n      // }\n    });\n    return gradientJSON;\n  }\n\n  rotate(cx: number, cy: number, x: number, y: number, angle: number) {\n    let radians = (Math.PI / 180) * angle;\n    let cos = Math.cos(radians);\n    let sin = Math.sin(radians);\n    let nx = cos * (x - cx) + sin * (y - cy) + cx;\n    let ny = cos * (y - cy) - sin * (x - cx) + cy;\n    return { x: Math.round(nx), y: Math.round(ny) };\n  }\n\n  rotateGradient(angle: number) {\n    const cx = (this.from.x + this.to.x) / 2;\n    const cy = (this.from.y + this.to.y) / 2;\n\n    const nFrom = this.rotate(cx, cy, this.from.x, this.from.y, angle);\n    const nTo = this.rotate(cx, cy, this.to.x, this.to.y, angle);\n\n    const rotatedFrom = { x: nFrom.x, y: nFrom.y };\n    const rotatedTo = { x: nTo.x, y: nTo.y };\n\n    this.from = rotatedFrom;\n    this.to = rotatedTo;\n  }\n\n  getGradientString = (palette?: any) => {\n    let colors: any = [];\n\n    if (palette) {\n      forEach(palette, (data: any, index: number) => {\n        colors.push(data.color);\n      });\n    } else {\n      forEach(this.stops, (data: any, index: number) => {\n        colors.push(data.stopColor);\n      });\n    }\n    let vector;\n    if (this.to && this.from) {\n      vector = {\n        x: (this.to.x as number) - (this.from.x as number),\n        y: (this.to.y as number) - (this.from.y as number),\n      };\n    } else {\n      vector = {\n        x: 0,\n        y: 2,\n      };\n    }\n    const angleRad = Math.atan2(vector.y, vector.x);\n    const angleDeg = (angleRad * 180) / Math.PI + 90;\n\n    let realLocations: any = [];\n    if (palette) {\n      forEach(palette, (data: any, index: number) => {\n        realLocations.push(data.pos);\n      });\n    } else {\n      forEach(this.stops, (data: any, index: number) => {\n        realLocations.push(data.offset);\n      });\n    }\n\n    const colorStrings = colors\n      .map(\n        (color: any, i: number) =>\n          `${color} ${Math.round(realLocations[i] * 100)}%`\n      )\n      .join(', ');\n\n    if (this.gradientType && this.gradientType === 'LinearGradient') {\n      return `linear-gradient(${angleDeg}deg, ${colorStrings})`;\n    } else if (this.gradientType && this.gradientType === 'RadialGradient') {\n      return `radial-gradient(${colorStrings})`;\n    } else if (this.gradientType && this.gradientType === 'AngularGradient') {\n      return `conic-gradient(${colorStrings})`;\n    } else {\n      return `linear-gradient(${angleDeg}deg, ${colorStrings})`;\n    }\n  };\n}\n","import { Canvas, IPlugin, Layer } from '../..';\n\nexport default class HoverPlugin implements IPlugin {\n  name = 'HoverPlugin';\n  canvas!: Canvas;\n  dispose: any;\n  forbiddenLayers: Array<Layer> = [];\n  hoverLayer: any;\n  hoverLayers: Array<any> = [];\n  hoverWrapperLayer: any;\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n  hideLayerHover(context: any) {\n    if (!this.forbiddenLayers.includes(context.layer)) {\n      this.forbiddenLayers.push(context.layer);\n    }\n  }\n  showLayerHover(context: any) {\n    if (this.forbiddenLayers.includes(context.layer)) {\n      this.forbiddenLayers.splice(\n        this.forbiddenLayers.indexOf(context.layer),\n        1\n      );\n    }\n  }\n\n  hideAllHoverBoxes(context: any) {\n    this.hoverWrapperLayer.style.display = 'none';\n  }\n  showAllHoverBoxes(context: any) {\n    this.hoverWrapperLayer.style.display = 'block';\n  }\n  showHover(layer: Layer) {\n    return (\n      !this.forbiddenLayers.includes(layer) &&\n      layer.type !== 'canvas' &&\n      !this.canvas.selectedLayers.includes(layer)\n    );\n  }\n  renderBoxes() {\n    for (let index = 0; index < this.canvas.hoveredLayers.length; index++) {\n      const layer = this.canvas.hoveredLayers[index];\n      if (this.showHover(layer)) {\n        let hoverBox;\n        if (this.hoverLayers[index]) {\n          hoverBox = this.hoverLayers[index];\n        } else {\n          hoverBox = document.createElement('div');\n          this.hoverWrapperLayer.appendChild(hoverBox);\n        }\n        hoverBox.style.position = 'absolute';\n        hoverBox.style.pointerEvents = 'none';\n        let dims = layer.getBoundingClientRect();\n\n        const box = this.canvas.getBoundingBox([layer]);\n        hoverBox.style.top = box.y + 'px';\n        hoverBox.style.left = box.x + 'px';\n        hoverBox.style.height = dims.height + 'px';\n        hoverBox.style.width = dims.width + 'px';\n        // hoverBox.style.width = box.rotation + 'px';\n        hoverBox.style.transform = box.rotation\n          ? `rotate(${box.rotation}deg)`\n          : '';\n        hoverBox.id = 'hover' + index;\n        hoverBox.style.border = `${1 / this.canvas.getZoom()}px solid #25B9D1`;\n        this.hoverLayers[index] = hoverBox;\n      } else {\n        if (this.hoverLayers[index] && this.hoverLayers[index].remove) {\n          this.hoverLayers[index].remove();\n          this.hoverLayers.splice(index, 1);\n          index--;\n        }\n      }\n    }\n    let breakIndex = this.canvas.hoveredLayers.length;\n    if (breakIndex < this.hoverLayers.length) {\n      for (let i = breakIndex; i < this.hoverLayers.length; i++) {\n        if (this.hoverLayers[i] && this.hoverLayers[i].remove) {\n          this.hoverLayers[i].remove();\n          this.hoverLayers.splice(i, 1);\n          i--;\n        }\n      }\n    }\n  }\n  activate() {\n    this.hoverWrapperLayer = document.createElement('div');\n    this.dispose = this.canvas.addDomToWorld(this.hoverWrapperLayer, true, 102);\n    this.hoverWrapperLayer.style.pointerEvents = 'none';\n    this.canvas.on('hoveredLayers', (e: any) => {\n      this.renderBoxes();\n    });\n    this.canvas.on('selectedLayers', (e: any) => {\n      this.renderBoxes();\n    });\n    this.canvas.on('zoom', (e: any) => {\n      this.renderBoxes();\n    });\n    this.canvas.addFunction('Hover.hideLayer', this.hideLayerHover.bind(this));\n    this.canvas.addFunction('Hover.showLayer', this.showLayerHover.bind(this));\n    this.canvas.addFunction(\n      'Hover.hideAllHoverBoxes',\n      this.hideAllHoverBoxes.bind(this)\n    );\n    this.canvas.addFunction(\n      'Hover.showAllHoverBoxes',\n      this.showAllHoverBoxes.bind(this)\n    );\n  }\n\n  deactivate() {\n    this.dispose();\n  }\n}\n","import { Layer } from '../../models/Layer';\nimport { Canvas } from 'models/Canvas';\nimport DesignerMouseEvent from '../../events/MouseEvent';\nexport default class DragEvent extends DesignerMouseEvent {\n  pageDx: number;\n  pageDy: number;\n  worldDx: number;\n  worldDy: number;\n  viewportDx: number;\n  viewportDy: number;\n  constructor(\n    name: string,\n    target: Layer,\n    originalEvent: any,\n    payload: any,\n    currentTarget?: Layer\n  ) {\n    super(name, target, originalEvent, currentTarget);\n    const canvas: Canvas = target.getCanvas();\n    this.worldDx = payload.worldDx;\n    this.worldDy = payload.worldDy;\n\n    this.worldX = payload.worldX;\n    this.worldY = payload.worldY;\n\n    let pagePoints = canvas.convertPoint(\n      { x: payload.worldDx, y: payload.worldDy },\n      'world',\n      'page'\n    );\n    this.pageDx = pagePoints.x;\n    this.pageDy = pagePoints.y;\n\n    let viewportPoints = canvas.convertPoint(\n      { x: this.pageDx, y: this.pageDy },\n      'page',\n      'viewport'\n    );\n\n    this.viewportDx = viewportPoints.x;\n    this.viewportDy = viewportPoints.y;\n  }\n}\n","import { Canvas, Layer } from '../../';\nimport { IPlugin } from '../../';\nimport DragEvent from './DragEvent';\n\nexport default class Drag implements IPlugin {\n  name = 'Drag';\n  canvas!: Canvas;\n  dispose: any;\n  mouseDown: boolean = false;\n  dragStarted: boolean = false;\n  target: Layer | undefined;\n  offsetPageX: number = 0;\n  offsetPageY: number = 0;\n  lastPageX: number = 0;\n  lastPageY: number = 0;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n    this.offsetPageX = 0;\n    this.offsetPageY = 0;\n  }\n\n  activate() {\n    let relPos = {\n      x: 0,\n      y: 0,\n    };\n    this.canvas.addEventListener('mousedown', (event: any) => {\n      if (event.originalEvent.button !== 2 && event.originalEvent.which !== 3) {\n        // Ignore right click mousedown\n        this.mouseDown = true;\n        this.dragStarted = false;\n        this.lastPageX = event.worldX;\n        this.lastPageY = event.worldY;\n      }\n    });\n\n    this.canvas.addEventListener('mousemove', (event: any) => {\n      relPos = {\n        x: event.worldX - this.lastPageX,\n        y: event.worldY - this.lastPageY,\n      };\n\n      if (this.mouseDown && !this.dragStarted) {\n        this.dragStarted = true;\n        let payload = {\n          worldDx: relPos.x,\n          worldDy: relPos.y,\n          worldX: this.lastPageX,\n          worldY: this.lastPageY,\n        };\n        const dragStartEvent = new DragEvent(\n          'dragStart',\n          this.canvas,\n          event.originalEvent,\n          payload\n        );\n        this.canvas.dispatchEventOnHitLayer('dragStart', dragStartEvent, event);\n      } else if (this.dragStarted) {\n        let payload = {\n          worldDx: relPos.x,\n          worldDy: relPos.y,\n          worldX: event.worldX,\n          worldY: event.worldY,\n        };\n        const dragEvent = new DragEvent(\n          'drag',\n          this.canvas,\n          event.originalEvent,\n          payload\n        );\n        this.canvas.dispatchEventOnHitLayer('drag', dragEvent, event);\n        this.lastPageX = event.worldX;\n        this.lastPageY = event.worldY;\n      }\n    });\n\n    this.canvas.addEventListener('mouseup', (event: any) => {\n      relPos = {\n        x: event.worldX - this.lastPageX,\n        y: event.worldY - this.lastPageY,\n      };\n      let payload = {\n        worldDx: 0,\n        worldDy: 0,\n        worldX: event.worldX,\n        worldY: event.worldY,\n      };\n      if (this.dragStarted) {\n        const dragEndEvent = new DragEvent(\n          'dragEnd',\n          this.canvas,\n          event.originalEvent,\n          payload\n        );\n        this.canvas.dispatchEventOnHitLayer('dragEnd', dragEndEvent, event);\n      }\n      this.lastPageX = 0;\n      this.lastPageY = 0;\n      this.mouseDown = false;\n      this.dragStarted = false;\n    });\n  }\n\n  deactivate() {\n    this.dispose();\n  }\n}\n","import * as React from 'react';\nimport { View, findNodeHandle } from 'react-native-web';\nimport { Layer } from 'models/Layer';\nconst rerenderProps = [\n  'layout',\n  'children',\n  'props',\n  'style',\n  'visible',\n  'gradient',\n];\n\nexport default class ViewRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  _ref: any = null;\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n    const domNode = findNodeHandle(this._ref);\n    domNode.setAttribute('class', 'view-render ' + domNode.className);\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n    // this.props.layer.parent.off('*', this.onUpdate);\n  }\n\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n  }\n\n  getStyles = (layer: Layer) => {\n    let styles = { ...layer.style.getAll() };\n    delete styles['gradient'];\n    const returnStyles = {\n      ...styles,\n      ...layer.layout.getAll(),\n    };\n    delete returnStyles['pointerEvents'];\n    if (returnStyles.overflow === 'scroll') {\n      returnStyles.overflow = 'hidden';\n    } else {\n      returnStyles.overflow = returnStyles.overflow;\n    }\n    return returnStyles;\n  };\n\n  render() {\n    const layer: Layer = this.props.layer;\n    const { RootRenderer }: any = this.props;\n    const layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    return (\n      <View\n        ref={(component: any) => (this._ref = component)}\n        style={this.getStyles(layer)}\n        {...layerProps}\n        nativeID={layerId}\n      >\n        {layer.children.map((child: any, index: any) => (\n          <RootRenderer {...this.props} key={child.id} layer={child} />\n        ))}\n      </View>\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst ViewComponentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'view',\n    children: [],\n    import: {\n      layerName: 'View',\n      packageName: 'native',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: {\n      top: 50,\n      left: 100,\n      width: 100,\n      height: 100,\n      position: 'absolute',\n    },\n    style: {\n      backgroundColor: '#E6E6E6',\n    },\n    props: {\n      // style: {\n      //   top: 0,\n      //   left: 150,\n      //   width: 150,\n      //   height: 150,\n      //   position: 'absolute',\n      //   backgroundColor: 'rgba(230, 230, 230,1)',\n      // },\n    },\n  },\n  thumbnail:\n    // tslint:disable-next-line:max-line-length\n    '',\n  name: 'Rect',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'ResizingTypeEditor',\n      title: 'ResizingType Editor',\n      value: {},\n    },\n    {\n      type: 'TouchableOpacityEditor',\n      title: 'TouchableOpacity Editor',\n      value: {},\n    },\n    {\n      type: 'ScrollViewEditor',\n      title: 'Scroll View Editor',\n      value: {},\n    },\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n        {\n          propertyName: 'backgroundColor',\n          type: 'color',\n          title: 'Fill',\n          value: {\n            defaultValue: '#fff',\n          },\n          category: 'style',\n        },\n        {\n          type: 'BorderWidthEditor',\n          title: 'BorderWidth Editor',\n          value: {\n            defaultValue: 1,\n          },\n        },\n        {\n          type: 'BorderRadiusEditor',\n          title: 'BorderRadius Editor',\n          value: {},\n        },\n        {\n          type: 'ShadowEditor',\n          title: 'Shadow Editor',\n          value: {},\n          properties: [\n            {\n              type: 'shadowColor',\n              title: 'Shadow Color',\n              value: {\n                defaultValue: 'rgba(0,0,0,1)',\n              },\n            },\n            {\n              type: 'shadowOffset',\n              title: 'Shadow Offset',\n              value: {\n                defaultValue: 3,\n              },\n            },\n            {\n              type: 'shadowOpacity',\n              title: 'Shadow Opacity',\n              value: {\n                defaultValue: 0.25,\n              },\n            },\n            {\n              type: 'elevation',\n              title: 'elevation',\n              value: {\n                defaultValue: 5,\n              },\n            },\n          ],\n        },\n        {\n          propertyName: 'overflow',\n          title: 'Overflow',\n          type: 'enum',\n          value: {\n            options: ['visible', 'hidden', 'scroll'],\n            defaultValue: 'visible',\n          },\n        },\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Layout',\n      value: {},\n      properties: [\n        {\n          type: 'FlexboxEditor',\n          title: 'Flexbox Editor',\n          value: {},\n        },\n        {\n          type: 'MarginPaddingEditor',\n          title: 'MarginPadding Editor',\n          value: {},\n        },\n        {\n          type: 'LayoutEditor',\n          title: 'Layout Editor',\n          value: {},\n        },\n        /*{\n          type: \"LoopEditor\",\n          title: \"Loop Editor\",\n          value: {}\n       }*/\n      ],\n    },\n\n    // {\n    //   type: \"group\",\n    //   title: \"Conditionals\",\n    //   value: {},\n    //   properties: [\n    //     {\n    //       type: \"ResetConditionalEditor\",\n    //       title: \"Conditional Editor\",\n    //       value: {}\n    //     }\n    //   ]\n    // }\n  ],\n};\n\nexport default ViewComponentDefinition;\n","import { Canvas, IPlugin } from '../..';\nimport ViewRenderer from './ViewRenderer';\nimport ViewComponentDefinition from './ViewComponentDefinition';\n\nexport default class ViewRendererPlugin implements IPlugin {\n  name = 'ViewRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addComponent('view', ViewRenderer, ViewComponentDefinition);\n  }\n\n  deactivate() {}\n}\n","import * as React from 'react';\nimport { View } from 'react-native-web';\nimport { Layer } from 'models/Layer';\nconst rerenderProps = [\n  'layout',\n  'children',\n  'props',\n  'style',\n  'visible',\n  'gradient',\n];\nexport default class TouchableOpacityRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  _ref: any;\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n  }\n\n  getStyles = (layer: Layer) => {\n    let styles = { ...layer.style.getAll() };\n    delete styles['gradient'];\n    const returnStyles = {\n      ...styles,\n      ...layer.layout.getAll(),\n    };\n    if (returnStyles.overflow === 'scroll') {\n      returnStyles.overflow = 'hidden';\n    } else {\n      returnStyles.overflow = returnStyles.overflow || 'hidden';\n    }\n    return returnStyles;\n  };\n\n  render() {\n    const layer: Layer = this.props.layer;\n    const { RootRenderer }: any = this.props;\n    const layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    return (\n      <View\n        ref={(c: any) => {\n          this._ref = c;\n        }}\n        style={this.getStyles(layer)}\n        {...layerProps}\n        nativeID={layerId}\n      >\n        {layer.children.map((child: any, index: any) => (\n          <RootRenderer {...this.props} key={child.id} layer={child} />\n        ))}\n      </View>\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst componentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'touchableOpacity',\n    children: [],\n    import: {\n      layerName: 'TouchableOpacity',\n      packageName: 'native',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: {\n      top: 50,\n      left: 100,\n      width: 100,\n      height: 100,\n      position: 'absolute',\n    },\n    style: {\n      backgroundColor: '#E6E6E6',\n    },\n    props: {\n      //\n    },\n  },\n  thumbnail:\n    // tslint:disable-next-line:max-line-length\n    '',\n  name: 'Rect',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'ResizingTypeEditor',\n      title: 'ResizingType Editor',\n      value: {},\n    },\n    {\n      type: 'TouchableOpacityEditor',\n      title: 'TouchableOpacity Editor',\n      value: {},\n    },\n    {\n      type: 'NavigationEditor',\n      title: 'Navigation Editor',\n      value: {},\n    },\n\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n        {\n          propertyName: 'backgroundColor',\n          type: 'color',\n          title: 'Fill',\n          value: {\n            defaultValue: '#fff',\n          },\n          additionalOptions: {\n            showGradient: false,\n          },\n          category: 'style',\n        },\n        {\n          type: 'BorderWidthEditor',\n          title: 'BorderWidth Editor',\n          value: {},\n        },\n        {\n          type: 'BorderRadiusEditor',\n          title: 'BorderRadius Editor',\n          value: {},\n        },\n        {\n          type: 'ShadowEditor',\n          title: 'Shadow Editor',\n          value: {},\n        },\n        {\n          propertyName: 'overflow',\n          title: 'Overflow',\n          type: 'enum',\n          value: {\n            options: ['visible', 'hidden', 'scroll'],\n            defaultValue: 'visible',\n          },\n        },\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Layout',\n      value: {},\n      properties: [\n        {\n          type: 'FlexboxEditor',\n          title: 'Flexbox Editor',\n          value: {},\n        },\n        {\n          type: 'MarginPaddingEditor',\n          title: 'MarginPadding Editor',\n          value: {},\n        },\n        {\n          type: 'LayoutEditor',\n          title: 'Layout Editor',\n          value: {},\n        },\n        /*{\n          type: \"LoopEditor\",\n          title: \"Loop Editor\",\n          value: {}\n       }*/\n      ],\n    },\n    // {\n    //   type: \"group\",\n    //   title: \"Conditionals\",\n    //   value: {},\n    //   properties: [\n    //     {\n    //       type: \"ResetConditionalEditor\",\n    //       title: \"Conditional Editor\",\n    //       value: {}\n    //     }\n    //   ]\n    // }\n    // {\n    //   type: \"group\",\n    //   title: \"Callbacks\",\n    //   value: {},\n    //   properties: [\n    //     {\n    //       type: \"CallbackEditor\",\n    //       propertyName: \"onPress\",\n    //       title: \"onPress\",\n    //       value: {},\n    //       category: \"props\"\n    //     }\n    //   ]\n    // }\n  ],\n};\n\nexport default componentDefinition;\n","import { Canvas, IPlugin } from '../..';\nimport TouchableOpacityRenderer from './TouchableOpacityRenderer';\nimport TouchableOpacityComponentDefinition from './TouchableOpacityComponentDefinition';\n\nexport default class TouchableOpacityRendererPlugin implements IPlugin {\n  name = 'TouchableOpacityRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addComponent(\n      'touchableOpacity',\n      TouchableOpacityRenderer,\n      TouchableOpacityComponentDefinition\n    );\n  }\n\n  deactivate() {}\n}\n","import * as React from 'react';\nimport { View } from 'react-native-web';\nimport { Layer } from 'models/Layer';\nconst rerenderProps = [\n  'layout',\n  'children',\n  'props',\n  'style',\n  'visible',\n  'gradient',\n];\nexport default class ScrollViewRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  _ref: any;\n\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n  }\n\n  getStyles = (layer: Layer) => {\n    let styles = { ...layer.style.getAll() };\n    delete styles['gradient'];\n    const returnStyles = {\n      ...styles,\n      ...layer.layout.getAll(),\n    };\n    if (returnStyles.overflow === 'scroll') {\n      returnStyles.overflow = 'hidden';\n    } else {\n      returnStyles.overflow = returnStyles.overflow || 'hidden';\n    }\n    return returnStyles;\n  };\n\n  render() {\n    const layer: Layer = this.props.layer;\n    const { RootRenderer }: any = this.props;\n    const layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    return (\n      <View\n        ref={(c: any) => {\n          this._ref = c;\n        }}\n        style={this.getStyles(layer)}\n        {...layerProps}\n        nativeID={layerId}\n      >\n        {layer.children.map((child: any, index: any) => (\n          <RootRenderer {...this.props} key={child.id} layer={child} />\n        ))}\n      </View>\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst componentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'scrollView',\n    children: [],\n    import: {\n      layerName: 'ScrollView',\n      packageName: 'native',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: {\n      top: 150,\n      left: 150,\n      width: 150,\n      height: 150,\n      position: 'absolute',\n    },\n    style: {\n      backgroundColor: 'rgba(230, 230, 230,1)',\n    },\n    props: {\n      contentContainerStyle: {\n        width: 150,\n        height: 150,\n      },\n    },\n  },\n  thumbnail:\n    // tslint:disable-next-line:max-line-length\n    '',\n  name: 'Rect',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'ResizingTypeEditor',\n      title: 'ResizingType Editor',\n      value: {},\n    },\n    {\n      type: 'ScrollViewEditor',\n      title: 'Scroll View Editor',\n      value: {},\n    },\n\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n        {\n          propertyName: 'backgroundColor',\n          type: 'color',\n          title: 'Fill',\n          value: {\n            defaultValue: '#fff',\n          },\n          additionalOptions: {\n            showGradient: false,\n          },\n          category: 'style',\n        },\n        {\n          type: 'BorderWidthEditor',\n          title: 'BorderWidth Editor',\n          value: {},\n        },\n        {\n          type: 'BorderRadiusEditor',\n          title: 'BorderRadius Editor',\n          value: {},\n        },\n        {\n          type: 'ShadowEditor',\n          title: 'Shadow Editor',\n          value: {},\n        },\n        {\n          propertyName: 'overflow',\n          title: 'Overflow',\n          type: 'enum',\n          value: {\n            options: ['visible', 'hidden'],\n            defaultValue: 'visible',\n          },\n        },\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Layout',\n      value: {},\n      properties: [\n        {\n          type: 'FlexboxEditor',\n          title: 'Flexbox Editor',\n          value: {},\n        },\n        {\n          type: 'MarginPaddingEditor',\n          title: 'MarginPadding Editor',\n          value: {},\n        },\n        {\n          type: 'LayoutEditor',\n          title: 'Layout Editor',\n          value: {},\n        },\n        /*{\n          type: \"LoopEditor\",\n          title: \"Loop Editor\",\n          value: {}\n       }*/\n      ],\n    },\n  ],\n};\n\nexport default componentDefinition;\n","import { Canvas, IPlugin } from '../..';\nimport ScrollViewRenderer from './ScrollViewRenderer';\nimport ScrollViewComponentDefinition from './ScrollViewComponentDefinition';\n\nexport default class ScrollViewRendererPlugin implements IPlugin {\n  name = 'ScrollViewRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addComponent(\n      'scrollView',\n      ScrollViewRenderer,\n      ScrollViewComponentDefinition\n    );\n  }\n\n  deactivate() {}\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\nimport { Canvas } from 'models/Canvas';\nexport default class RenderEvent extends Event {\n  target: any;\n  constructor(name: string, target: any) {\n    super(name, target);\n  }\n}\n","import * as React from 'react';\nimport { Text } from 'react-native-web';\nimport includes from 'lodash/includes';\nimport replace from 'lodash/replace';\nimport { Layer } from 'models/Layer';\nimport RenderEvent from '../../events/RenderEvent';\n\nconst rerenderProps = [\n  'layout',\n  'children',\n  'props',\n  'innerText',\n  'style',\n  'visible',\n];\nexport default class TextRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  textRef: any;\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this.textRef);\n\n    this.whiteSpaceTo('noWrap');\n    this.props.layer.dispatchEvent(\n      'domDidMount',\n      new RenderEvent('domDidMount', this)\n    );\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this.textRef);\n\n    this.props.layer.dispatchEvent(\n      'domDidUpdate',\n      new RenderEvent('domDidUpdate', this)\n    );\n  }\n\n  whiteSpaceTo(value: any) {\n    // Redacted: animation related code\n    this.textRef.setNativeProps({\n      whiteSpace: value,\n    });\n  }\n\n  getStyles = (layer: Layer) => {\n    // let maxWidth = get(layer, 'parent.width', undefined);\n    let updatedStyle = {\n      color: 'black',\n      ...layer.style.getAll(),\n      ...layer.layout.getAll(),\n      WebkitFontSmoothing: 'antialiased',\n      wordBreak: 'break-all',\n    };\n    delete updatedStyle['fontPostscriptName'];\n    delete updatedStyle['wordBreak'];\n    // TODO: heavy jugaad\n    // if (layer.parent && maxWidth) {\n    //   updatedStyle.maxWidth = Math.max(maxWidth, updatedStyle.width);\n    // }\n    if (updatedStyle.textDecoration) {\n      updatedStyle.textDecorationLine = updatedStyle.textDecoration;\n    }\n    return updatedStyle;\n  };\n\n  render() {\n    const layer: Layer = this.props.layer;\n    let { innerText } = layer;\n    if (innerText && includes(innerText, \"{'\\n'}\")) {\n      innerText = replace(innerText, new RegExp(\"{'\\n'}\", 'g'), '\\n');\n    }\n    if (innerText && includes(innerText, \"{'\\t'}\")) {\n      innerText = replace(innerText, new RegExp(\"{'\\t'}\", 'g'), '\\t');\n    }\n    const layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    const style = this.getStyles(layer);\n\n    let whiteSpace = undefined;\n    let height = undefined;\n    let width = undefined;\n\n    if (layer.isAutoWidth()) {\n      whiteSpace = 'pre';\n    }\n\n    if (layer.isFlexChild()) {\n      height = 'fit-content';\n      width = 'fit-content';\n    } else {\n      if (!layer.isFillHeight()) {\n        height = 'fit-content';\n      }\n      if (!layer.isFillWidth()) {\n        width = 'fit-content';\n      }\n    }\n\n    return (\n      <Text\n        webkit=\"true\"\n        {...layerProps}\n        style={{ fontSize: 14, height, width, ...style, whiteSpace }}\n        nativeID={layerId}\n        ref={(c: any) => {\n          this.textRef = c;\n        }}\n      >\n        {innerText}\n      </Text>\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst componentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'text',\n    children: [\n      {\n        type: 'literal',\n        value: 'Lorem Ipsum',\n      },\n    ],\n    import: {\n      layerName: 'Text',\n      packageName: 'native',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: {\n      top: 0,\n      left: 0,\n      position: 'absolute',\n    },\n    style: {\n      fontFamily: 'Roboto',\n      fontPostscriptName: 'roboto-regular',\n      fontStyle: 'normal',\n      fontWeight: '400',\n\n      color: '#121212',\n    },\n    props: {},\n  },\n  thumbnail:\n    // tslint:disable-next-line:max-line-length\n    '',\n  name: 'Text',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'ResizingTypeEditor',\n      title: 'ResizingType Editor',\n      value: {},\n    },\n    {\n      type: 'TextToTextInputEditor',\n      title: 'Text To TextInput Editor',\n      value: {},\n    },\n\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n        {\n          type: 'TextPropEditor',\n          title: 'Text Prop Editor',\n          value: {},\n        },\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Layout',\n      value: {},\n      properties: [\n        {\n          type: 'MarginPaddingEditor',\n          title: 'MarginPadding Editor',\n          value: {},\n        },\n        /*{\n          type: \"LoopEditor\",\n          title: \"Loop Editor\",\n          value: {}\n       }*/\n      ],\n    },\n    // {\n    //   type: \"group\",\n    //   title: \"Conditionals\",\n    //   value: {},\n    //   properties: [\n    //     {\n    //       type: \"ResetConditionalEditor\",\n    //       title: \"Conditional Editor\",\n    //       value: {}\n    //     }\n    //   ]\n    // }\n  ],\n};\n\nexport default componentDefinition;\n","import { Canvas } from '../..';\nimport { IPlugin } from '../..';\nimport TextRenderer from './TextRenderer';\nimport TextComponentDefinition from './TextComponentDefinition';\n\nexport default class TextRendererPlugin implements IPlugin {\n  name = 'TextRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addComponent('text', TextRenderer, TextComponentDefinition);\n  }\n\n  deactivate() {}\n}\n","import * as React from 'react';\nimport { TextInput } from 'react-native-web';\nimport { Layer } from 'models/Layer';\nimport { pick } from 'lodash';\n\nconst rerenderProps = ['layout', 'children', 'props', 'style', 'visible'];\nexport default class TextInputRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  _ref: any;\n\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n  }\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  getStyles = (layer: Layer) => {\n    const appliedStyles = { ...layer.style.getAll(), ...layer.layout.getAll() };\n    delete appliedStyles['fontPostscriptName'];\n    delete appliedStyles['wordBreak'];\n    return appliedStyles;\n  };\n\n  render() {\n    const layer: Layer = this.props.layer;\n    const layerProps = { ...layer.props.getAll() };\n    const filteredProps = pick(layerProps, [\n      'defaultValue',\n      'numberOfLines',\n      'multiline',\n      'maxLength',\n      'placeholder',\n      'placeholderTextColor',\n      'value',\n    ]);\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    return (\n      <TextInput\n        ref={(c: any) => {\n          this._ref = c;\n        }}\n        {...filteredProps}\n        style={this.getStyles(layer)}\n        nativeID={layerId}\n      />\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst componentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'textInput',\n    children: [],\n    import: {\n      layerName: 'TextInput',\n      packageName: 'native',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: {\n      top: 0,\n      left: 0,\n      position: 'absolute',\n    },\n    style: {\n      fontFamily: 'Roboto',\n      fontPostscriptName: 'roboto-regular',\n      fontStyle: 'normal',\n      fontWeight: '400',\n      color: '#121212',\n    },\n    props: {\n      placeholder: 'placeholder',\n    },\n  },\n  thumbnail:\n    // tslint:disable-next-line:max-line-length\n    '',\n  name: 'TextInput',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'ResizingTypeEditor',\n      title: 'ResizingType Editor',\n      value: {},\n    },\n\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n        {\n          type: 'TextPropEditor',\n          title: 'Text Prop Editor',\n          value: {},\n        },\n        {\n          propertyName: 'backgroundColor',\n          type: 'color',\n          title: 'Fill',\n          value: {\n            defaultValue: '#fff',\n          },\n          additionalOptions: {\n            showGradient: false,\n          },\n          category: 'style',\n        },\n        {\n          type: 'BorderWidthEditor',\n          title: 'BorderWidth Editor',\n          value: {\n            defaultValue: 1,\n          },\n        },\n        {\n          type: 'BorderRadiusEditor',\n          title: 'BorderRadius Editor',\n          value: {},\n        },\n        {\n          type: 'ShadowEditor',\n          title: 'Shadow Editor',\n          value: {},\n          properties: [\n            {\n              type: 'shadowColor',\n              title: 'Shadow Color',\n              value: {\n                defaultValue: 'rgba(0,0,0,1)',\n              },\n            },\n            {\n              type: 'shadowOffset',\n              title: 'Shadow Offset',\n              value: {\n                defaultValue: 3,\n              },\n            },\n            {\n              type: 'shadowOpacity',\n              title: 'Shadow Opacity',\n              value: {\n                defaultValue: 0.25,\n              },\n            },\n            {\n              type: 'elevation',\n              title: 'elevation',\n              value: {\n                defaultValue: 5,\n              },\n            },\n          ],\n        },\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Layout',\n      value: {},\n      properties: [\n        {\n          type: 'MarginPaddingEditor',\n          title: 'MarginPadding Editor',\n          value: {},\n        },\n        /*{\n          type: \"LoopEditor\",\n          title: \"Loop Editor\",\n          value: {}\n       }*/\n      ],\n    },\n    {\n      type: 'TextToTextInputEditor',\n      title: 'Text To TextInput Editor',\n      value: {},\n    },\n    // {\n    //   type: \"group\",\n    //   title: \"Conditionals\",\n    //   value: {},\n    //   properties: [\n    //     {\n    //       type: \"ResetConditionalEditor\",\n    //       title: \"Conditional Editor\",\n    //       value: {}\n    //     }\n    //   ]\n    // },\n    {\n      type: 'group',\n      title: 'TextInput',\n      value: {},\n      properties: [\n        {\n          propertyName: 'placeholder',\n          type: 'string',\n          title: 'Placeholder',\n          value: {\n            placeholder: '',\n            defaultValue: '',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'textBreakStrategy',\n          title: 'Text Break Strategy',\n          type: 'enum',\n          value: {\n            options: ['simple', 'highQuality', 'balanced'],\n            defaultValue: 'simple',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'clearButtonMode',\n          type: 'enum',\n          title: 'Clear Button Mode',\n          value: {\n            options: ['never', 'while-editing', 'unless-editing', 'always'],\n            defaultValue: 'never',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'keyboardAppearance',\n          title: 'Keyboard Appearance',\n          type: 'enum',\n          value: {\n            options: ['default', 'light', 'dark'],\n            defaultValue: 'default',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'dataDetector',\n          title: 'Data Detector Types',\n          type: 'enum',\n          value: {\n            options: [\n              'phoneNumber',\n              'link',\n              'address',\n              'calendarEvent',\n              'none',\n              'all',\n              'phoneNumber',\n              'link',\n              'address',\n              'calendarEvent',\n              'none',\n              'all',\n            ],\n            defaultValue: 'none',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'placeholderTextColor',\n          type: 'bareColor',\n          title: 'Placeholder Text Color',\n          value: {\n            defaultValue: '#fff',\n          },\n          additionalOptions: {\n            showGradient: false,\n            uiOptions: {\n              size: 's',\n            },\n          },\n          category: 'props',\n        },\n        // {\n        //   propertyName: 'underlineColorAndroid',\n        //   type: 'bareColor',\n        //   title: 'Underline Color',\n        //   value: {\n        //     defaultValue: '#fff',\n        //   },\n        //   additionalOptions: {\n        //     showGradient: false,\n        //     uiOptions: {\n        //       size: 's',\n        //     },\n        //   },\n        //   category: 'props',\n        // },\n        {\n          propertyName: 'selectionColor',\n          type: 'bareColor',\n          title: 'Selection color',\n          value: {\n            defaultValue: '#fff',\n          },\n          additionalOptions: {\n            showGradient: false,\n            uiOptions: {\n              size: 's',\n            },\n          },\n          category: 'props',\n        },\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Other Props',\n      value: {},\n      properties: [\n        {\n          propertyName: 'autoCapitalize',\n          title: 'Auto Capitalize',\n          type: 'enum',\n          value: {\n            options: ['none', 'sentences', 'words', 'characters'],\n            defaultValue: 'none',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'keyboardType',\n          type: 'enum',\n          title: 'Keyboard Type',\n          value: {\n            options: [\n              'default',\n              'email-address',\n              'numeric',\n              'phone-pad',\n              'ascii-capable',\n              'numbers-and-punctuation',\n              'url',\n              'number-pad',\n              'name-phone-pad',\n              'decimal-pad',\n              'twitter',\n              'web-search',\n            ],\n            defaultValue: 'default',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'returnKeyType',\n          title: 'Return Key Type',\n          type: 'enum',\n          value: {\n            options: [\n              'done',\n              'go',\n              'next',\n              'search',\n              'send',\n              'none',\n              'previous',\n              'default',\n              'emergency-call',\n              'google',\n              'join',\n              'route',\n              'yahoo',\n            ],\n            defaultValue: 'default',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'defaultValue',\n          type: 'string',\n          title: 'Default value',\n          value: {\n            defaultValue: '',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'maxLength',\n          type: 'number',\n          title: 'Max length',\n          value: {\n            defaultValue: 140,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'inlineImageLeft',\n          type: 'string',\n          title: 'Inline Image Left',\n          value: {\n            defaultValue: '',\n          },\n        },\n        {\n          propertyName: 'inlineImagePadding',\n          type: 'number',\n          title: 'Inline Image Padding',\n          value: {\n            defaultValue: 0,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'numberOfLines',\n          type: 'number',\n          title: 'Number of Lines',\n          value: {\n            defaultValue: 1,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'returnKeyLabel',\n          type: 'string',\n          title: 'Return Key Label',\n          value: {\n            defaultValue: '',\n          },\n          category: 'props',\n        },\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Booleans',\n      value: {},\n      properties: [\n        {\n          propertyName: 'clearTextOnFocus',\n          type: 'boolean',\n          title: 'Clear Text onFocus',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'enablesReturnKeyAutomatically',\n          type: 'boolean',\n          title: 'Enables Return Key Automatically',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'spellCheck',\n          type: 'boolean',\n          title: 'Spell Check',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'disableFullscreenUI',\n          type: 'boolean',\n          title: 'Disable Full Screen UI',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'autoCorrect',\n          type: 'boolean',\n          title: 'Auto Correct',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'autoFocus',\n          type: 'boolean',\n          title: 'Auto Focus',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'blurOnSubmit',\n          type: 'boolean',\n          title: 'Blur on submit',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'caretHidden',\n          type: 'boolean',\n          title: 'Caret hidden',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n\n        {\n          propertyName: 'editable',\n          type: 'boolean',\n          title: 'Editable',\n          value: {\n            defaultValue: true,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'multiline',\n          type: 'boolean',\n          title: 'Multiline',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n\n        {\n          propertyName: 'secureTextEntry',\n          type: 'boolean',\n          title: 'Password Input',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'selectTextOnFocus',\n          type: 'boolean',\n          title: 'Select text on focus',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n      ],\n    },\n  ],\n};\n\nexport default componentDefinition;\n","import { Canvas } from '../..';\nimport { IPlugin } from '../..';\nimport TextInputRenderer from './TextInputRenderer';\nimport TextInputComponentDefinition from './TextInputComponentDefinition';\n\nexport default class TextInputRendererPlugin implements IPlugin {\n  name = 'TextInputRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addComponent(\n      'textInput',\n      TextInputRenderer,\n      TextInputComponentDefinition\n    );\n  }\n\n  deactivate() {}\n}\n","import * as React from 'react';\nimport { Image } from 'react-native-web';\nimport { get } from 'lodash';\nimport Svg, { Path, Defs, Mask, Image as SVGImage } from 'svgs';\nimport { Layer } from 'models/Layer';\nimport { generateSVGPath } from '@builderx-core/conversions';\nimport { generateRandomString } from '../../models/utils';\nconst rerenderProps = ['layout', 'children', 'props', 'style', 'visible'];\nexport default class ImageRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  _ref: any;\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    if (this._ref) {\n      this.props.layer.setDomRef(this._ref);\n    } else {\n      this.props.layer.setDomRef(this);\n    }\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    if (this._ref) {\n      this.props.layer.setDomRef(this._ref);\n    } else {\n      this.props.layer.setDomRef(this);\n    }\n  }\n  get maskPath() {\n    const layer: Layer = this.props.layer;\n    let imageMask = layer.props.get('mask');\n    if (!imageMask) {\n      return '';\n    }\n    return generateSVGPath(\n      imageMask || [],\n      1,\n      true,\n      layer.props.get('viewBox')\n    );\n  }\n  render() {\n    const layer: Layer = this.props.layer;\n    let layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    let transform = layer.rotation ? `rotate(${layer.rotation}deg)` : undefined;\n    let imageStyle = {\n      ...layer.style.getAll(),\n      ...layer.layout.getAll(),\n      transform,\n    };\n    let sourceUri: string = get(layerProps, 'source.uri', undefined);\n    const imageURI = layer.props.get('blobURL')\n      ? layer.props.get('blobURL')\n      : sourceUri\n      ? sourceUri\n      : undefined;\n    if (this.maskPath) {\n      let imageMaskId = generateRandomString(6);\n      return (\n        <Svg\n          // @ts-ignore\n          id={layerId}\n          style={imageStyle}\n          key={layer.id}\n          viewBox={layerProps.viewBox}\n          preserveAspectRatio=\"none\"\n          ref={(c: any) => {\n            this._ref = c;\n          }}\n        >\n          <Defs>\n            <Mask id={imageMaskId} x=\"0\" y=\"0\">\n              <Path\n                fill=\"white\" // DOC: hard-coded acc. to the masking behaviour in sketch\n                d={this.maskPath}\n              />\n            </Mask>\n          </Defs>\n          <SVGImage\n            x={layerProps.svgDims.x}\n            y={layerProps.svgDims.y}\n            width={layerProps.svgDims.width}\n            height={layerProps.svgDims.height}\n            href={imageURI}\n            preserveAspectRatio=\"none\"\n            mask={`url(#${imageMaskId})`}\n          />\n        </Svg>\n      );\n    } else if (layerProps.resizeMode === 'center') {\n      return (\n        <img\n          ref={(c: any) => {\n            this._ref = c;\n          }}\n          src={imageURI}\n          {...layerProps}\n          style={{\n            ...imageStyle,\n            objectFit: 'none',\n          }}\n          id={layerId}\n        />\n      );\n    }\n    return (\n      <Image\n        {...layerProps}\n        style={imageStyle}\n        source={{\n          uri: imageURI,\n        }}\n        resizeMode={\n          layerProps['resizeMode'] ? layerProps['resizeMode'] : undefined\n        }\n        nativeID={layerId}\n      />\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst componentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'image',\n    import: {\n      layerName: 'Image',\n      packageName: 'native',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: {\n      top: 50,\n      left: 50,\n      width: 200,\n      height: 200,\n      position: 'absolute',\n    },\n    style: {},\n    props: {\n      source: {\n        uri: ``,\n      },\n      resizeMode: 'contain',\n    },\n    children: [],\n  },\n  thumbnail:\n    // tslint:disable-next-line:max-line-length\n    '',\n  name: 'Image',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'ResizingTypeEditor',\n      title: 'ResizingType Editor',\n      value: {},\n    },\n\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n        {\n          propertyName: 'backgroundColor',\n          type: 'color',\n          title: 'Fill',\n          value: {\n            defaultValue: '#fff',\n          },\n          additionalOptions: {\n            showGradient: false,\n          },\n          category: 'style',\n        },\n        {\n          type: 'BorderWidthEditor',\n          title: 'BorderWidth Editor',\n          value: {\n            defaultValue: 1,\n          },\n        },\n        {\n          type: 'BorderRadiusEditor',\n          title: 'BorderRadius Editor',\n          value: {},\n        },\n        {\n          type: 'AccessibilityLabel',\n          title: 'Accessibility Label',\n          value: {},\n        },\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Image',\n      value: {},\n      properties: [\n        {\n          type: 'ImageEditor',\n          title: 'Image',\n          value: {},\n        },\n      ],\n    },\n    // {\n    //   type: \"group\",\n    //   title: \"Conditionals\",\n    //   value: {},\n    //   properties: [\n    //     {\n    //       type: \"ResetConditionalEditor\",\n    //       title: \"Conditional Editor\",\n    //       value: {}\n    //     }\n    //   ]\n    // },\n    {\n      type: 'group',\n      title: 'Layout',\n      value: {},\n      properties: [\n        {\n          type: 'FlexboxEditor',\n          title: 'Flexbox Editor',\n          value: {},\n        },\n        {\n          type: 'MarginPaddingEditor',\n          title: '',\n          value: {},\n        },\n        /*{\n          type: \"LoopEditor\",\n          title: \"Loop Editor\",\n          value: {}\n       }*/\n      ],\n    },\n  ],\n};\n\nexport default componentDefinition;\n","import { Canvas, IPlugin } from '../..';\nimport ImageRenderer from './ImageRenderer';\nimport ImageComponentDefinition from './ImageComponentDefinition';\n\nexport default class ImageRendererPlugin implements IPlugin {\n  name = 'ImageRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addComponent('image', ImageRenderer, ImageComponentDefinition);\n  }\n\n  deactivate() {}\n}\n","import * as React from 'react';\nimport { Layer } from 'models/Layer';\nimport Svg, { Path, Defs, Mask, LinearGradient, Stop } from 'svgs';\nimport { generateSVGPath } from '@builderx-core/conversions';\nimport { generateRandomString } from '../../models/utils';\nimport { isEmpty } from 'lodash';\n\nconst rerenderProps = ['layout', 'children', 'props', 'style', 'visible'];\nexport default class PathRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  _ref: any;\n\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this);\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this);\n  }\n\n  get svgPath() {\n    const layer: Layer = this.props.layer;\n    let pathProps = layer.props.getAll();\n    return generateSVGPath(\n      pathProps.points,\n      pathProps.strokeWidth,\n      pathProps.isClosed,\n      pathProps.viewBox\n    );\n  }\n  get maskPath() {\n    const layer: Layer = this.props.layer;\n    let imageMask = layer.props.get('mask');\n    if (!imageMask) {\n      return '';\n    }\n    return generateSVGPath(\n      imageMask || [],\n      1,\n      true,\n      layer.props.get('viewBox')\n    );\n  }\n  render() {\n    const layer: Layer = this.props.layer;\n    const layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    let transform = layer.rotation ? `rotate(${layer.rotation}deg)` : undefined;\n    let pathStyle = {\n      ...layer.style.getAll(),\n      ...layer.layout.getAll(),\n      transform,\n    };\n    delete pathStyle['backgroundImage'];\n\n    const gradient = layer.style.get('gradient') || {};\n    const mask = layer.props.get('mask');\n    let maskId = generateRandomString(6);\n    const gradientId = generateRandomString(6);\n    return (\n      <Svg\n        // @ts-ignore\n        id={layerId}\n        style={pathStyle}\n        viewBox={layerProps.viewBox}\n        preserveAspectRatio=\"none\"\n      >\n        {!isEmpty(gradient) || (mask && !isEmpty(mask)) ? (\n          <Defs>\n            {mask && !isEmpty(mask) && (\n              <Mask id={maskId} x=\"0\" y=\"0\">\n                <Path\n                  fill=\"white\" // DOC: hard-coded acc. to the masking behaviour in sketch\n                  d={this.maskPath}\n                />\n              </Mask>\n            )}\n            {!isEmpty(gradient) && (\n              <LinearGradient\n                id={gradientId}\n                x1={gradient.from.x}\n                y1={gradient.from.y}\n                x2={gradient.to.x}\n                y2={gradient.to.y}\n              >\n                {gradient.stops.map((stop: any, index: any) => {\n                  return (\n                    <Stop\n                      key={`gradient-${gradient.id}-stop-${index}`}\n                      offset={stop.offset}\n                      stopColor={stop.stopColor}\n                    />\n                  );\n                })}\n              </LinearGradient>\n            )}\n          </Defs>\n        ) : null}\n        <Path\n          stroke={layerProps.stroke}\n          // transform={layerProps.rotation ? transform : undefined}\n          fill={!isEmpty(gradient) ? `url(#${gradientId})` : layerProps.fill}\n          strokeWidth={layerProps.strokeWidth}\n          fillOpacity={layerProps.fillOpacity}\n          strokeOpacity={layerProps.strokeOpacity}\n          clipPath={layerProps.clipPath}\n          d={this.svgPath}\n          // rotation={layerProps.rotation}\n          mask={mask && !isEmpty(mask) ? `url(#${maskId})` : undefined}\n        />\n      </Svg>\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst componentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'path',\n    children: [],\n    import: {\n      layerName: 'Path',\n      packageName: 'react-native-svg',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: {\n      top: 50,\n      left: 50,\n      width: 50,\n      height: 50,\n      position: 'absolute',\n    },\n    style: {},\n    props: {\n      points: [],\n      isClosed: true,\n      strokeWidth: 0,\n      stroke: 'rgba(230, 230, 230,1)',\n      fill: 'rgba(230, 230, 230,1)',\n    },\n  },\n  thumbnail:\n    // tslint:disable-next-line:max-line-length\n    '',\n  name: 'Path',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    // {\n    //   type: \"LoopEditor\",\n    //   title: \"Loop Editor\",\n    //   value: {}\n    // },\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n        {\n          type: 'PathCurveTypeEditor',\n          title: 'Point Mode',\n          value: {},\n        },\n        {\n          propertyName: 'fill',\n          type: 'simpleColor',\n          title: 'Fill',\n          value: {\n            defaultValue: '#fff',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'stroke',\n          type: 'simpleColor',\n          title: 'Stroke',\n          value: {\n            defaultValue: '#fff',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'strokeWidth',\n          type: 'range',\n          title: 'Stroke Width',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 100,\n          },\n          category: 'props',\n        },\n      ],\n    },\n  ],\n};\n\nexport default componentDefinition;\n","import { Canvas, IPlugin } from '../..';\nimport PathRenderer from './PathRenderer';\nimport PathComponentDefinition from './PathComponentDefinition';\n\nexport default class PathRendererPlugin implements IPlugin {\n  name = 'PathRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addComponent('path', PathRenderer, PathComponentDefinition);\n  }\n\n  deactivate() {}\n}\n","//@ts-nocheck\nimport EntypoIcon from 'react-native-vector-icons/dist/Entypo';\nimport AntDesignIcon from 'react-native-vector-icons/dist/AntDesign';\nimport EvilIconsIcon from 'react-native-vector-icons/dist/EvilIcons';\nimport FeatherIcon from 'react-native-vector-icons/dist/Feather';\nimport FontAwesomeIcon from 'react-native-vector-icons/dist/FontAwesome';\nimport FoundationIcon from 'react-native-vector-icons/dist/Foundation';\nimport IoniconsIcon from 'react-native-vector-icons/dist/Ionicons';\nimport MaterialCommunityIconsIcon from 'react-native-vector-icons/dist/MaterialCommunityIcons';\nimport MaterialIconsIcon from 'react-native-vector-icons/dist/MaterialIcons';\nimport OcticonsIcon from 'react-native-vector-icons/dist/Octicons';\nimport SimpleLineIconsIcon from 'react-native-vector-icons/dist/SimpleLineIcons';\nimport ZocialIcon from 'react-native-vector-icons/dist/Zocial';\nimport EntypoFont from 'react-native-vector-icons/Fonts/Entypo.ttf';\nimport AntDesignFont from 'react-native-vector-icons/Fonts/AntDesign.ttf';\nimport EvilIconsFont from 'react-native-vector-icons/Fonts/EvilIcons.ttf';\nimport FeatherFont from 'react-native-vector-icons/Fonts/Feather.ttf';\nimport FontAwesomeFont from 'react-native-vector-icons/Fonts/FontAwesome.ttf';\nimport FoundationFont from 'react-native-vector-icons/Fonts/Foundation.ttf';\nimport IoniconsFont from 'react-native-vector-icons/Fonts/Ionicons.ttf';\nimport MaterialCommunityIconsFont from 'react-native-vector-icons/Fonts/MaterialCommunityIcons.ttf';\nimport MaterialIconsFont from 'react-native-vector-icons/Fonts/MaterialIcons.ttf';\nimport OcticonsFont from 'react-native-vector-icons/Fonts/Octicons.ttf';\nimport SimpleLineIconsFont from 'react-native-vector-icons/Fonts/SimpleLineIcons.ttf';\nimport ZocialFont from 'react-native-vector-icons/Fonts/Zocial.ttf';\n\nexport const Icons: Array<string, any> = {\n  EntypoIcon: EntypoIcon,\n  AntDesignIcon: AntDesignIcon,\n  EvilIconsIcon: EvilIconsIcon,\n  FeatherIcon: FeatherIcon,\n  FontAwesomeIcon: FontAwesomeIcon,\n  FoundationIcon: FoundationIcon,\n  IoniconsIcon: IoniconsIcon,\n  MaterialCommunityIconsIcon: MaterialCommunityIconsIcon,\n  MaterialIconsIcon: MaterialIconsIcon,\n  OcticonsIcon: OcticonsIcon,\n  SimpleLineIconsIcon: SimpleLineIconsIcon,\n  ZocialIcon: ZocialIcon,\n};\nexport const Fonts: Array<string, any> = {\n  EntypoFont: EntypoFont,\n  AntDesignFont: AntDesignFont,\n  EvilIconsFont: EvilIconsFont,\n  FeatherFont: FeatherFont,\n  FontAwesomeFont: FontAwesomeFont,\n  FoundationFont: FoundationFont,\n  IoniconsFont: IoniconsFont,\n  MaterialCommunityIconsFont: MaterialCommunityIconsFont,\n  MaterialIconsFont: MaterialIconsFont,\n  OcticonsFont: OcticonsFont,\n  SimpleLineIconsFont: SimpleLineIconsFont,\n  ZocialFont: ZocialFont,\n};\n","import * as React from 'react';\nimport { Layer } from 'models/Layer';\nimport { Icons } from './IconMap';\nimport RenderEvent from '../../events/RenderEvent';\n\nconst rerenderProps = [\n  'layout',\n  'children',\n  'props',\n  'style',\n  'innerText',\n  'visible',\n];\nexport default class IconRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  _ref: any;\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n    this.props.layer.dispatchEvent(\n      'domDidMount',\n      new RenderEvent('domDidMount', this)\n    );\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  componentWillUpdate() {\n    this.props.layer.dispatchEvent(\n      'domWillUpdate',\n      new RenderEvent('domWillUpdate', this)\n    );\n  }\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n\n    this.props.layer.dispatchEvent(\n      'domDidUpdate',\n      new RenderEvent('domDidUpdate', this)\n    );\n  }\n\n  render() {\n    const layer: Layer = this.props.layer;\n    const layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    let iconStyle = { ...layer.style.getAll(), ...layer.layout.getAll() };\n    iconStyle = {\n      ...iconStyle,\n      overflow: iconStyle.overflow ? iconStyle.overflow : 'hidden',\n      height: 'fit-content',\n      width: 'fit-content',\n    };\n    delete iconStyle['fontPostscriptName'];\n    const iconType = layerProps.type ? layerProps.type : 'Entypo';\n    const Icon = Icons[`${iconType}Icon`] || Icons[`EntypoIcon`];\n    return (\n      <Icon\n        ref={(c: any) => {\n          this._ref = c;\n        }}\n        {...layerProps}\n        style={iconStyle}\n        nativeID={layerId}\n      />\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\nconst IconComponentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'icon',\n    children: [],\n    import: {\n      layerName: 'Icon',\n      packageName: '@builderx/icons',\n      isDefaultImport: true,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: {\n      top: 150,\n      left: 150,\n      position: 'absolute',\n    },\n    style: {\n      color: 'rgba(128,128,128,1)',\n      fontSize: 40,\n    },\n    props: {\n      type: 'MaterialCommunityIcons',\n      name: 'home',\n    },\n  },\n  thumbnail: '',\n  name: 'Icon',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n      additionalOptions: {\n        hideSize: true,\n      },\n    },\n    {\n      type: 'ResizingTypeEditor',\n      title: 'ResizingType Editor',\n      value: {},\n      additionalOptions: {\n        hideSize: true,\n      },\n    },\n    {\n      type: 'IconEditor',\n      title: 'Icon Editor',\n      value: {},\n    },\n    {\n      type: 'group',\n      title: 'Layout',\n      value: {},\n      properties: [\n        {\n          type: 'FlexboxEditor',\n          title: 'Flexbox Editor',\n          value: {},\n        },\n        {\n          type: 'MarginPaddingEditor',\n          title: 'MarginPadding Editor',\n          value: {},\n        },\n        /*{\n          type: \"LoopEditor\",\n          title: \"Loop Editor\",\n          value: {}\n       }*/\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'color',\n          type: 'color',\n          title: 'Color',\n          value: {\n            defaultValue: 'rgba(128,128,128,1)',\n          },\n          category: 'style',\n        },\n        {\n          propertyName: 'fontSize',\n          type: 'range',\n          title: 'Size',\n          value: {\n            defaultValue: 40,\n            min: 0,\n            max: 200,\n          },\n          category: 'style',\n        },\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n      ],\n    },\n  ],\n};\n\nexport default IconComponentDefinition;\n","import { Canvas, IPlugin } from '../..';\nimport IconRenderer from './IconRenderer';\nimport IconComponentDefinition from './IconComponentDefinition';\n\nexport default class IconRendererPlugin implements IPlugin {\n  name = 'IconRendererPlugin';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addComponent('icon', IconRenderer, IconComponentDefinition);\n  }\n\n  deactivate() {}\n}\n","import * as React from 'react';\nimport { Layer } from 'models/Layer';\nimport { Switch } from 'react-native-web';\nimport RenderEvent from '../../../events/RenderEvent';\n\nconst rerenderProps = ['layout', 'props', 'style', 'visible'];\nexport default class AndroidSwitchRenderer extends React.PureComponent<\n  any,\n  any\n> {\n  _ref: any;\n\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n\n    this.props.layer.dispatchEvent(\n      'domDidMount',\n      new RenderEvent('domDidMount', this)\n    );\n  }\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n\n    this.props.layer.dispatchEvent(\n      'domDidUpdate',\n      new RenderEvent('domDidUpdate', this)\n    );\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  render() {\n    const layer: Layer = this.props.layer;\n    const switchStyle = { ...layer.style.getAll(), ...layer.layout.getAll() };\n    const layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    return (\n      <Switch\n        ref={(c: any) => {\n          this._ref = c;\n        }}\n        {...layerProps}\n        activeThumbColor={layerProps.thumbTintColor}\n        trackColor={{\n          true: layerProps.onTintColor,\n          false: layerProps.tintColor,\n        }}\n        style={{ ...switchStyle, width: undefined, height: undefined }}\n        nativeID={layerId}\n      />\n    );\n  }\n}\n","import styled from 'styled-components';\nimport * as React from 'react';\n\nexport default styled.input<any & React.HTMLProps<HTMLInputElement>>`\n  cursor: ${(props: any) =>\n    props.disabled !== undefined && props.disabled ? 'not-allowed' : 'pointer'};\n  -webkit-appearance: none;\n  font-size: 5px;\n  position: relative;\n  display: inline-block;\n  width: 9em;\n  height: 4.6em;\n  line-height: 4.6em;\n  border-radius: 2.3em;\n  margin: 0;\n  padding: 0;\n  transform: ${(props: any) =>\n    props.style.transform\n      ? `rotate(${props.style.transform[0].rotate})`\n      : `rotate(0deg);`};\n  box-shadow: ${(props: any) =>\n    props.disabled\n      ? 'inset 0 0 0 0.2em #bbb;'\n      : props.tintColor\n      ? 'inset 0 0 0 0.2em ' + props.tintColor\n      : 'inset 0 0 0 0.2em #ddd;'};\n  outline: 1px solid transparent !important;\n  border: none;\n  background: transparent;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n  -webkit-touch-callout: none;\n  :checked {\n    content: '';\n    box-shadow: ${(props: any) =>\n      props.disabled\n        ? 'inset 0 0 0 2.62857em #ddd !important;'\n        : props.onTintColor\n        ? 'inset 0 0 0 2.62857em ' + props.onTintColor + '!important;'\n        : 'inset 0 0 0 2.62857em #00c169 !important;'};\n    padding-left: 4.4em;\n  }\n  :before {\n    content: '';\n    display: inline-block;\n    height: 4.2em;\n    width: 4.2em;\n    margin: 0.2em 0 0 0.2em;\n    background-color: ${(props: any) =>\n      props.disabled\n        ? '#ccc'\n        : props.thumbTintColor\n        ? props.thumbTintColor\n        : '#fff'};\n    border-radius: 2.1em;\n    box-shadow: 0 0.2em 0.4em 0 rgba(0, 0, 0, 0.2),\n      0 0 0.1em 0.1em rgba(0, 0, 0, 0.1);\n  }\n`;\n","import * as React from 'react';\nimport { Layer } from 'models/Layer';\nimport IOSSwitch from './IOSSwitch';\nimport RenderEvent from '../../../events/RenderEvent';\nconst rerenderProps = ['layout', 'props', 'style', 'visible'];\nexport default class IOSSwitchRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  _ref: any;\n\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n\n    this.props.layer.dispatchEvent(\n      'domDidMount',\n      new RenderEvent('domDidMount', this)\n    );\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n\n    this.props.layer.dispatchEvent(\n      'domDidUpdate',\n      new RenderEvent('domDidUpdate', this)\n    );\n  }\n\n  render() {\n    const layer = this.props.layer;\n    const switchStyle = { ...layer.style.getAll(), ...layer.layout.getAll() };\n    const layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    return (\n      <IOSSwitch\n        ref={(c: any) => {\n          this._ref = c;\n        }}\n        type=\"checkbox\"\n        {...layerProps}\n        checked={layerProps.value}\n        onChange={() => {\n          //\n        }}\n        style={{ ...switchStyle, width: undefined, height: undefined }}\n        nativeID={layerId}\n      />\n    );\n  }\n}\n","import * as React from 'react';\nimport AndroidRenderer from './android/AndroidSwitchRenderer';\nimport IOSRenderer from './iOS/IOSSwitchRenderer';\nimport { Layer } from 'models/Layer';\nimport RenderEvent from '../../events/RenderEvent';\n\nconst rerenderProps = ['layout', 'props', 'style', 'visible'];\nexport default class SwitchRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n  }\n\n  render() {\n    let platform = 'iOS';\n    const deviceData = this.props.layer.executeFunction('getDeviceData');\n\n    if (deviceData) {\n      platform = deviceData.platform;\n    }\n\n    return platform === 'Android' ? (\n      <AndroidRenderer {...this.props} />\n    ) : (\n      <IOSRenderer {...this.props} />\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst AndroidSwitchComponentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'switch',\n    import: {\n      layerName: 'Switch',\n      packageName: 'react-native',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: {\n      position: 'absolute',\n      top: 50,\n      left: 50,\n    },\n    style: {},\n    props: {\n      value: true,\n    },\n    children: [],\n  },\n  thumbnail: '',\n  name: 'Switch',\n\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n      additionalOptions: {\n        hideSize: true,\n      },\n    },\n    {\n      type: 'ResizingTypeEditor',\n      title: 'ResizingType Editor',\n      value: {},\n      additionalOptions: {\n        hideSize: true,\n      },\n    },\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Switch',\n      value: {},\n      properties: [\n        {\n          propertyName: 'value',\n          category: 'props',\n          type: 'boolean',\n          title: 'Value',\n          value: {\n            defaultValue: false,\n          },\n        },\n        {\n          propertyName: 'disabled',\n          category: 'props',\n          type: 'boolean',\n          title: 'Disabled',\n          value: {\n            defaultValue: false,\n          },\n        },\n        {\n          propertyName: 'thumbTintColor',\n          type: 'bareColor',\n          title: 'Grip',\n          value: {\n            defaultValue: '#fff',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'onTintColor',\n          type: 'bareColor',\n          title: 'Turned On',\n          value: {\n            defaultValue: '#fff',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'tintColor',\n          type: 'bareColor',\n          title: 'Turned Off',\n          value: {\n            defaultValue: '#fff',\n          },\n          category: 'props',\n        },\n      ],\n    },\n  ],\n};\n\nexport default AndroidSwitchComponentDefinition;\n","import { Canvas } from '../..';\nimport { IPlugin } from '../..';\nimport SwitchRenderer from './SwitchRenderer';\nimport SwitchComponentDefinition from './SwitchComponentDefinition';\n\nexport default class IOSSwitchRendererPlugin implements IPlugin {\n  name = 'IOSSwitchRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addComponent(\n      'switch',\n      SwitchRenderer,\n      SwitchComponentDefinition\n    );\n  }\n\n  deactivate() {}\n}\n","import * as React from 'react';\nimport { Layer } from 'models/Layer';\nimport { ActivityIndicator } from 'react-native-web';\nimport RenderEvent from '../../../events/RenderEvent';\nconst rerenderProps = ['layout', 'props', 'style', 'visible'];\nexport default class AndroidActivityIndicatorRenderer extends React.PureComponent<\n  any,\n  any\n> {\n  _ref: any;\n\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n\n    this.props.layer.dispatchEvent(\n      'domDidMount',\n      new RenderEvent('domDidMount', this)\n    );\n  }\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n\n    this.props.layer.dispatchEvent(\n      'domDidUpdate',\n      new RenderEvent('domDidUpdate', this)\n    );\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  render() {\n    const layer: Layer = this.props.layer;\n    const layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    const activityIndicatorStyle = {\n      ...layer.style.getAll(),\n      ...layer.layout.getAll(),\n    };\n    const height = layerProps.size === 'large' ? 40 : 22;\n    const width = layerProps.size === 'large' ? 39 : 22;\n\n    return (\n      <ActivityIndicator\n        ref={(c: any) => {\n          this._ref = c;\n        }}\n        {...layerProps}\n        style={{ ...activityIndicatorStyle, height, width }}\n        nativeID={layerId}\n      />\n    );\n  }\n}\n","import * as React from 'react';\nimport styled, { keyframes } from 'styled-components';\n\nconst defaultSpinnerColor = '#353940';\n\nexport const keyFrameFade = keyframes`\nfrom {\n  opacity: 1;\n}\nto {\n  opacitfy: 0.25;\n}\n`;\n\nconst Bar = styled.div<any & React.HTMLProps<HTMLDivElement>>`\n  width: 6%;\n  height: 16%;\n  background: #000;\n  position: absolute;\n  left: 49%;\n  top: 43%;\n  opacity: 0;\n  -webkit-border-radius: 50px;\n  -webkit-box-shadow: 0 0 3px rgba(0, 0, 0, 0.2);\n  -webkit-animation: ${keyFrameFade} 1s linear infinite;\n  background: ${(props: any) =>\n    props.color ? props.color : defaultSpinnerColor};\n`;\n\nconst SpinnerWrapper = styled.div<any & React.HTMLProps<HTMLDivElement>>`\n  position: relative;\n  display: inline-block;\n`;\n\nconst IOSSpinner = React.forwardRef((props: any, ref: any) => {\n  const { size, color, ...remainingProps } = props;\n  const height = size === 'large' ? 40 : 22;\n  const width = size === 'large' ? 40 : 22;\n  return (\n    <SpinnerWrapper\n      ref={ref}\n      style={{ height: height, width: width }}\n      {...remainingProps}\n    >\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(0deg) translate(0, -130%)',\n          animationDelay: '0s',\n        }}\n      />\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(30deg) translate(0, -130%)',\n          animationDelay: '-0.9167s',\n        }}\n      />\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(60deg) translate(0, -130%)',\n          animationDelay: '-0.833s',\n        }}\n      />\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(90deg) translate(0, -130%)',\n          animationDelay: '-0.7497s',\n        }}\n      />\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(120deg) translate(0, -130%)',\n          animationDelay: '-0.667s',\n        }}\n      />\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(150deg) translate(0, -130%)',\n          animationDelay: '-0.5837s',\n        }}\n      />\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(180deg) translate(0, -130%)',\n          animationDelay: '-0.5s',\n        }}\n      />\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(210deg) translate(0, -130%)',\n          animationDelay: '-0.4167s',\n        }}\n      />\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(240deg) translate(0, -130%)',\n          animationDelay: '-0.333s',\n        }}\n      />\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(270deg) translate(0, -130%)',\n          animationDelay: '-0.2497s',\n        }}\n      />\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(300deg) translate(0, -130%)',\n          animationDelay: '-0.167s',\n        }}\n      />\n      <Bar\n        color={color}\n        style={{\n          transform: 'rotate(330deg) translate(0, -130%)',\n          animationDelay: '-0.0833s',\n        }}\n      />\n    </SpinnerWrapper>\n  );\n});\nexport default IOSSpinner;\n","import * as React from 'react';\nimport { Layer } from 'models/Layer';\nimport IOSSpinner from './IOSSpinner';\nimport RenderEvent from '../../../events/RenderEvent';\n\nconst rerenderProps = ['layout', 'props', 'style', 'visible'];\nexport default class IOSActivityIndicatorRenderer extends React.PureComponent<\n  any,\n  any\n> {\n  _ref: any;\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n    this.props.layer.dispatchEvent(\n      'domDidMount',\n      new RenderEvent('domDidMount', this)\n    );\n  }\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n    this.props.layer.dispatchEvent(\n      'domDidUpdate',\n      new RenderEvent('domDidUpdate', this)\n    );\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  render() {\n    const layer: Layer = this.props.layer;\n    const layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    const layerStyle = {\n      ...layer.style.getAll(),\n      ...layer.layout.getAll(),\n    };\n    const height = layerProps.size === 'large' ? 40 : 22;\n    const width = layerProps.size === 'large' ? 39 : 22;\n    return (\n      <IOSSpinner\n        ref={(c: any) => {\n          this._ref = c;\n        }}\n        {...layerProps}\n        color={layerProps.color}\n        style={{ ...layerStyle, height, width }}\n        className={layerId}\n      />\n    );\n  }\n}\n","import * as React from 'react';\nimport AndroidRenderer from './android/AndroidActivityIndicatorRenderer';\nimport IOSRenderer from './iOS/IOSActivityIndicatorRenderer';\nimport RenderEvent from '../../events/RenderEvent';\nimport { Layer } from 'models/Layer';\n\nconst rerenderProps = ['layout', 'props', 'style', 'visible'];\nexport default class ActivityIndicatorRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n  }\n\n  render() {\n    let platform = 'iOS';\n    const deviceData = this.props.layer.executeFunction('getDeviceData');\n\n    if (deviceData) {\n      platform = deviceData.platform;\n    }\n\n    return platform === 'Android' ? (\n      <AndroidRenderer {...this.props} />\n    ) : (\n      <IOSRenderer {...this.props} />\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst ActivityIndicatorComponentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'activityIndicator',\n    import: {\n      layerName: 'ActivityIndicator',\n      packageName: 'react-native',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: { position: 'absolute', top: 50, left: 50 },\n    style: {},\n    props: {},\n    children: [],\n  },\n  thumbnail: '',\n  name: 'ActivityIndicator',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n      additionalOptions: {\n        hideSize: true,\n      },\n    },\n    {\n      type: 'ResizingTypeEditor',\n      title: 'ResizingType Editor',\n      value: {},\n      additionalOptions: {\n        hideSize: true,\n      },\n    },\n    {\n      type: 'group',\n      title: 'Activity Indicator',\n      value: {},\n      properties: [\n        {\n          propertyName: 'color',\n          type: 'simpleColor',\n          title: 'Color',\n          value: {\n            defaultValue: '#fff',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'size',\n          type: 'enum',\n          title: 'Size',\n          value: {\n            options: ['small', 'large'],\n            defaultValue: 'small',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n      ],\n    },\n  ],\n};\n\nexport default ActivityIndicatorComponentDefinition;\n","import { Canvas } from '../..';\nimport { IPlugin } from '../..';\nimport ActivityIndicatorRenderer from './ActivityIndicatorRenderer';\nimport ActivityIndicatorComponentDefinition from './ActivityIndicatorComponentDefinition';\n\nexport default class ActivityIndicatorRendererPlugin implements IPlugin {\n  name = 'ActivityIndicatorRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addComponent(\n      'activityIndicator',\n      ActivityIndicatorRenderer,\n      ActivityIndicatorComponentDefinition\n    );\n  }\n\n  deactivate() {}\n}\n","import * as React from 'react';\nimport { Layer } from 'models/Layer';\nimport get from 'lodash/get';\nimport Svg, { Ellipse } from 'svgs';\nconst rerenderProps = [\n  'layout',\n  'children',\n  'props',\n  'style',\n  'visible',\n  'gradient',\n];\n\nexport default class EllipseRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  _ref: any;\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this);\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this);\n  }\n\n  render() {\n    const layer: Layer = this.props.layer;\n    let ellipseProps = { ...layer.props.getAll() };\n    const layerId = ellipseProps['id'];\n    delete ellipseProps['id'];\n    let transform = layer.rotation ? `rotate(${layer.rotation}deg)` : undefined;\n    let ellipseStyle = {\n      ...layer.style.getAll(),\n      ...layer.layout.getAll(),\n      transform,\n    };\n    let strokeWidth = Number(get(ellipseProps, 'strokeWidth', 0));\n    let appliedProps = {\n      cx: ellipseProps.cx,\n      cy: ellipseProps.cy,\n      rx: ellipseProps.rx,\n      ry: ellipseProps.ry,\n      fill: get(ellipseProps, 'fill', 'transparent'),\n      // fill: gradientType ? `url(#${gradientId})` : extractedProps.fill,\n      fillOpacity: ellipseProps.fillOpacity,\n      strokeOpacity: ellipseProps.strokeOpacity,\n      stroke: ellipseProps.stroke,\n      strokeWidth,\n    };\n    return (\n      <Svg\n        ref={(c: any) => {\n          this._ref = c;\n        }}\n        // @ts-ignore\n        getRef={(c: any) => {\n          console.log(c, 'ref here');\n        }}\n        // @ts-ignore\n        id={layerId}\n        style={ellipseStyle}\n        viewBox={ellipseProps.viewBox}\n        preserveAspectRatio=\"none\"\n      >\n        <Ellipse {...appliedProps} />\n      </Svg>\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst componentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'ellipse',\n    import: {\n      layerName: 'Ellipse',\n      packageName: 'react-native-svg',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: {\n      top: 50,\n      left: 50,\n      width: 100,\n      height: 100,\n      position: 'absolute',\n    },\n    style: {},\n    props: {\n      stroke: 'rgba(230, 230, 230,1)',\n      strokeWidth: 0,\n      fill: 'rgba(230, 230, 230,1)',\n    },\n    children: [],\n  },\n  thumbnail:\n    // tslint:disable-next-line:max-line-length\n    '',\n  name: 'Ellipse',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n        {\n          propertyName: 'fill',\n          type: 'simpleColor',\n          title: 'Fill',\n          value: {\n            defaultValue: '#fff',\n          },\n          additionalOptions: {\n            showGradient: false,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'stroke',\n          type: 'simpleColor',\n          title: 'Stroke',\n          value: {\n            defaultValue: '#000',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'strokeWidth',\n          type: 'range',\n          title: 'Width',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 100,\n          },\n          category: 'props',\n        },\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Layout',\n      value: {},\n      properties: [\n        {\n          type: 'FlexboxEditor',\n          title: 'Flexbox Editor',\n          value: {},\n        },\n        {\n          type: 'MarginPaddingEditor',\n          title: '',\n          value: {},\n        },\n        /*{\n          type: \"LoopEditor\",\n          title: \"Loop Editor\",\n          value: {}\n       }*/\n      ],\n    },\n  ],\n};\n\nexport default componentDefinition;\n","import { Canvas } from '../..';\nimport { IPlugin } from '../..';\nimport EllipseRenderer from './EllipseRenderer';\nimport EllipseComponentDefinition from './EllipseComponentDefinition';\n\nexport default class EllipseRendererPlugin implements IPlugin {\n  name = 'EllipseRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n\n    // canvas.registerDataStore(\"MyPlugin\")\n  }\n\n  activate() {\n    this.canvas.addComponent(\n      'ellipse',\n      EllipseRenderer,\n      EllipseComponentDefinition\n    );\n    // this.canvas.addEventListener('click', e => {\n    //   console.log(e);\n    // });\n  }\n\n  deactivate() {}\n}\n","import styled from 'styled-components';\n\ninterface ProgressBarPropTypes {\n  value: number;\n  minimumTrackTintColor: string | undefined;\n  maximumTrackTintColor: string | undefined;\n}\ninterface ButtonPropTypes {\n  value: number;\n  disabled?: boolean;\n  thumbTintColor: string | undefined;\n}\n\nexport const SliderWrapper = styled.div``;\n\nexport const AndroidSliderButton = styled.div<\n  ButtonPropTypes & React.HTMLProps<HTMLDivElement>\n>`\n  -webkit-appearance: none;\n  background-color: #666;\n  width: 14px;\n  height: 14px;\n  // z-index:2;\n  border-radius: 50%;\n  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2);\n  cursor: pointer;\n  position: relative;\n  top: -5.5px;\n  background: ${(props: any) => {\n    const { disabled, thumbTintColor } = props;\n    return disabled ? '#666' : thumbTintColor ? thumbTintColor : '#00897b';\n  }};\n  left: ${(props: any) => {\n    const { value } = props;\n    return value ? `${value}px` : '0px';\n  }};\n  box-shadow: ${(props: any) =>\n    props.disabled ? '0px 2px 4px transparent' : '0px 2px 4px rgba(0,0,0,.2)'};\n`;\n\nexport const AndroidSliderProgressBar = styled.div<\n  ProgressBarPropTypes & React.HTMLProps<HTMLDivElement>\n>`\n  height: 2px;\n  border-radius: 2px;\n  position: relative;\n  -webkit-appearance: none;\n\n  background-image: ${(props: any) => {\n    const { value, minimumTrackTintColor, maximumTrackTintColor } = props;\n    return value\n      ? `-webkit-gradient(\n              linear,\n              left top,\n              right top,\n              color-stop(${value}, ${\n          minimumTrackTintColor ? minimumTrackTintColor : '#00897b'\n        }),\n              color-stop(${value}, ${\n          maximumTrackTintColor ? maximumTrackTintColor : '#b7b7b7'\n        }))`\n      : `-webkit-gradient(\n              linear,\n              left top,\n              right top,\n              color-stop(0, #00897b),\n              color-stop(0, #b7b7b7))`;\n  }};\n`;\n\nexport const IOSSliderButton = styled.div<\n  ButtonPropTypes & React.HTMLProps<HTMLDivElement>\n>`\n  webkit-appearance: none;\n  background-color: #666;\n  display: block;\n  width: 28px;\n  height: 28px;\n  // z-index:2;\n  border-radius: 50%;\n  background: #fff;\n  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2);\n  cursor: pointer;\n  position: relative;\n  top: -12.5px;\n\n  left: ${(props: any) => {\n    const { value } = props;\n    return value ? `${value}px` : '0px';\n  }};\n`;\nexport const IOSSliderProgressBar = styled.div<\n  ProgressBarPropTypes & React.HTMLProps<HTMLDivElement>\n>`\n  height: 2px;\n  border-radius: 2px;\n  position: relative;\n  top: -2px;\n  -webkit-appearance: none;\n\n  background-image: ${(props: any) => {\n    const { value, minimumTrackTintColor, maximumTrackTintColor } = props;\n    return value\n      ? `-webkit-gradient(\n          linear,\n          left top,\n          right top,\n          color-stop(${value}, ${\n          minimumTrackTintColor ? minimumTrackTintColor : '#007aff'\n        }),\n          color-stop(${value}, ${\n          maximumTrackTintColor ? maximumTrackTintColor : '#b7b7b7'\n        }))`\n      : `-webkit-gradient(\n          linear,\n          left top,\n          right top,\n          color-stop(0, #007aff),\n          color-stop(0, #b7b7b7))`;\n  }};\n`;\n","import * as React from 'react';\nimport { isNil } from 'lodash';\nimport {\n  SliderWrapper,\n  AndroidSliderButton,\n  AndroidSliderProgressBar,\n  IOSSliderButton,\n  IOSSliderProgressBar,\n} from './SliderStyledComponents';\n\ntype propType = {\n  value?: number;\n  maximumValue?: number;\n  minimumValue?: number;\n  style?: any;\n  minimumTrackTintColor?: string;\n  maximumTrackTintColor?: string;\n  thumbTintColor?: string;\n  disabled?: boolean;\n  platform: string;\n  className?: string;\n};\n\nexport default class Slider extends React.PureComponent<propType, any> {\n  render() {\n    const isAndroid = this.props.platform === 'Android';\n    const SliderProgressBar = isAndroid\n      ? AndroidSliderProgressBar\n      : IOSSliderProgressBar;\n    const SliderButton = isAndroid ? AndroidSliderButton : IOSSliderButton;\n\n    const value = isNil(this.props.value) ? 0 : this.props.value;\n    const maximumValue = isNil(this.props.maximumValue)\n      ? 100\n      : this.props.maximumValue;\n    const minimumValue = this.props.minimumValue || 0;\n    const sliderRange = maximumValue - minimumValue;\n    const sliderValue = value - minimumValue >= 0 ? value - minimumValue : 0;\n    const sliderButtonPosition =\n      ((this.props.style.width || 0) - (isAndroid ? 12 : 28)) *\n      (sliderValue / sliderRange);\n    return (\n      <SliderWrapper\n        style={{\n          ...this.props.style,\n          paddingTop: this.props.style.height ? this.props.style.height / 2 : 0,\n        }}\n        className={this.props.className ? this.props.className : undefined}\n      >\n        <SliderProgressBar\n          style={{\n            width: '100%',\n            height: 2,\n            opacity: this.props.disabled ? (isAndroid ? 0.7 : 0.5) : 1,\n          }}\n          value={sliderValue / sliderRange}\n          minimumTrackTintColor={this.props.minimumTrackTintColor}\n          maximumTrackTintColor={this.props.maximumTrackTintColor}\n        >\n          <SliderButton\n            value={sliderButtonPosition}\n            thumbTintColor={isAndroid ? this.props.thumbTintColor : undefined}\n          />\n        </SliderProgressBar>\n      </SliderWrapper>\n    );\n  }\n}\n","import * as React from 'react';\nimport { Layer } from 'models/Layer';\nimport Slider from './Slider';\n\nconst rerenderProps = ['layout', 'props', 'style', 'visible'];\nexport default class SliderRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  _ref: any;\n\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n  }\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  render() {\n    const layer: Layer = this.props.layer;\n    let sliderProps = { ...layer.props.getAll() };\n    let sliderStyle = {\n      ...layer.style.getAll(),\n      ...layer.layout.getAll(),\n      width: layer.getBoundingClientRect().width,\n      height: layer.getBoundingClientRect().height,\n    };\n\n    let platform = 'iOS';\n    const deviceData = this.props.layer.executeFunction('getDeviceData');\n\n    if (deviceData) {\n      platform = deviceData.platform;\n    }\n\n    return (\n      <Slider\n        ref={(c: any) => {\n          this._ref = c;\n        }}\n        {...sliderProps}\n        platform={platform}\n        style={sliderStyle}\n      />\n    );\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst SliderComponentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'slider',\n    import: {\n      layerName: 'Slider',\n      packageName: 'react-native',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: {\n      position: 'absolute',\n      top: 50,\n      left: 50,\n      height: 50,\n      width: 50,\n    },\n    style: {},\n    props: {\n      value: 50,\n    },\n    children: [],\n  },\n  thumbnail: '',\n  name: 'Slider',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'ResizingTypeEditor',\n      title: 'ResizingType Editor',\n      value: {},\n    },\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n      ],\n    },\n    {\n      type: 'group',\n      title: 'Slider',\n      value: {},\n      properties: [\n        {\n          propertyName: 'disabled',\n          type: 'boolean',\n          title: 'Disabled',\n          value: {\n            defaultValue: false,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'value',\n          type: 'range',\n          title: 'Value',\n          value: {\n            defaultValue: 0,\n            min: 0,\n            max: 100,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'minimumValue',\n          type: 'number',\n          title: 'Minimum Value',\n          value: {\n            defaultValue: 0,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'maximumValue',\n          type: 'number',\n          title: 'Maximum Value',\n          value: {\n            defaultValue: 100,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'step',\n          type: 'number',\n          title: 'Step',\n          value: {\n            defaultValue: 0,\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'minimumTrackTintColor',\n          type: 'bareColor',\n          title: 'Minimum Track',\n          value: {\n            defaultValue: '#000',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'maximumTrackTintColor',\n          type: 'bareColor',\n          title: 'Maximum Track',\n          value: {\n            defaultValue: '#000',\n          },\n          category: 'props',\n        },\n        {\n          propertyName: 'thumbTintColor',\n          type: 'bareColor',\n          title: 'Thumb',\n          value: {\n            defaultValue: '#000',\n          },\n          category: 'props',\n        },\n      ],\n    },\n  ],\n};\n\nexport default SliderComponentDefinition;\n","import { Canvas } from '../..';\nimport { IPlugin } from '../..';\nimport SliderRenderer from './SliderRenderer';\nimport SliderComponentDefinition from './SliderComponentDefinition';\n\nexport default class SliderRendererPlugin implements IPlugin {\n  name = 'SliderRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n\n    // canvas.registerDataStore(\"MyPlugin\")\n  }\n\n  activate() {\n    this.canvas.addComponent(\n      'slider',\n      SliderRenderer,\n      SliderComponentDefinition\n    ); // this.canvas.addEventListener('click', e => {\n    //   console.log(e);\n    // });\n  }\n\n  deactivate() {}\n}\n","import * as React from 'react';\nimport { Image } from 'react-native-web';\nimport { Layer } from 'models/Layer';\n\nconst rerenderProps = ['layout', 'children', 'props', 'style', 'visible'];\nexport default class MapViewRenderer extends React.PureComponent<\n  { layer: Layer },\n  any\n> {\n  _ref: any;\n\n  onUpdate = () => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n  }\n  componentWillUnmount() {\n    this.props.layer.off(rerenderProps, this.onUpdate);\n  }\n\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(rerenderProps, this.onUpdate);\n    this.props.layer.on(rerenderProps, this.onUpdate);\n    this.props.layer.setDomRef(this._ref);\n  }\n\n  render() {\n    const layer: Layer = this.props.layer;\n    const layerProps = { ...layer.props.getAll() };\n    const layerId = layerProps['id'];\n    delete layerProps['id'];\n    const mapViewStyles = { ...layer.style.getAll(), ...layer.layout.getAll() };\n    let mapStyle = layerProps.customMapStyle\n      ? layerProps.customMapStyle\n      : 'Standard';\n\n    const canvas = layer.getCanvas();\n\n    try {\n      return (\n        <Image\n          ref={(c: any) => {\n            this._ref = c;\n          }}\n          {...layerProps}\n          style={{\n            resizeMode: 'cover',\n            ...mapViewStyles,\n          }}\n          source={{ uri: `${canvas.assetURL}/${mapStyle}.png` }}\n          nativeID={layerId}\n        />\n      );\n    } catch (Error) {\n      return (\n        <Image\n          ref={(c: any) => {\n            this._ref = c;\n          }}\n          {...layerProps}\n          style={{\n            resizeMode: 'cover',\n            ...mapViewStyles,\n          }}\n          source={{ uri: `${canvas.assetURL}/Standard.png` }}\n          nativeID={layerId}\n        />\n      );\n    }\n  }\n}\n","import { IComponentDefinition } from '../../interfaces';\n\nconst MapViewComponentDefinition: IComponentDefinition = {\n  version: '0.0.1',\n  template: {\n    type: 'mapView',\n    import: {\n      layerName: 'MapView',\n      packageName: 'expo',\n      isDefaultImport: false,\n      asName: '',\n    },\n    locked: false,\n    template: {\n      centerVertical: false,\n      centerHorizontal: false,\n    },\n    layout: { position: 'absolute', top: 50, left: 50 },\n    style: {},\n    props: {\n      provider: 'MapView.PROVIDER_GOOGLE',\n      initialRegion: {\n        latitude: 37.78825,\n        longitude: -122.4324,\n        latitudeDelta: 0.0922,\n        longitudeDelta: 0.0421,\n      },\n      customMapStyle: 'Standard',\n    },\n    children: [],\n  },\n  thumbnail: '',\n  name: 'MapView',\n  controlsProperty: [\n    {\n      type: 'AlignmentEditor',\n      title: 'Alignment Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'OrientationEditor',\n      title: 'Orientation Editor',\n      value: {},\n      showForMultiple: true,\n    },\n    {\n      type: 'ResizingTypeEditor',\n      title: 'ResizingType Editor',\n      value: {},\n    },\n    {\n      type: 'group',\n      title: 'Styling',\n      value: {},\n      properties: [\n        {\n          propertyName: 'opacity',\n          type: 'range',\n          title: 'Opacity',\n          value: {\n            defaultValue: 1,\n            min: 0,\n            max: 1,\n          },\n          category: 'style',\n        },\n        {\n          propertyName: 'customMapStyle',\n          title: 'Map View Style',\n          type: 'enum',\n          value: {\n            options: [\n              'Standard',\n              'Silver',\n              'Retro',\n              'Dark',\n              'Night',\n              'Aubergine',\n            ],\n            defaultValue: 'Standard',\n          },\n          category: 'props',\n        },\n      ],\n    },\n  ],\n};\n\nexport default MapViewComponentDefinition;\n","import { Canvas } from '../..';\nimport { IPlugin } from '../..';\nimport MapViewRenderer from './MapViewRenderer';\nimport MapViewComponentDefinition from './MapViewComponentDefinition';\n\nexport default class MapViewRendererPlugin implements IPlugin {\n  name = 'MapViewRenderer';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addComponent(\n      'mapView',\n      MapViewRenderer,\n      MapViewComponentDefinition\n    );\n  }\n\n  deactivate() {}\n}\n","import * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Canvas, IPlugin, MouseEvent, IContext } from '../..';\nimport { contextMenu, MainMenu } from 'builderx-module-context-menu';\nimport { generateRandomString } from '../../models/utils';\nimport 'builderx-module-context-menu/src/lib/components/utils/ContextMenu.css';\n\nexport default class PopoverMenuPlugin implements IPlugin {\n  name = 'PopoverMenu';\n  canvas!: Canvas;\n  dispose: any;\n  containerElement: any;\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n  showMenu(context: IContext, json: any, event: MouseEvent) {\n    this.dispose();\n    event.originalEvent.preventDefault();\n    this.containerElement = document.createElement('div');\n    this.dispose = this.canvas.addDomToViewport(this.containerElement);\n    const randomId = generateRandomString(4);\n    const menuReactElement = (\n      <MainMenu menuId={`menuId-${randomId}`} data={json} />\n    );\n    ReactDOM.render(menuReactElement, this.containerElement);\n    contextMenu.show({\n      id: `menuId-${randomId}`,\n      event: event.originalEvent,\n    });\n  }\n  activate() {\n    this.containerElement = document.createElement('div');\n    this.dispose = this.canvas.addDomToViewport(this.containerElement);\n    this.canvas.addFunction('showPopoverMenu', this.showMenu.bind(this));\n  }\n\n  deactivate() {\n    this.canvas.removeFunction('showPopoverMenu');\n    this.dispose();\n  }\n}\n","import ISnapPoints from './interfaces/ISnapPoints';\nimport ISnapXPoint from './interfaces/ISnapXPoint';\nimport ISnapYPoint from './interfaces/ISnapYPoint';\nimport * as _ from 'lodash';\nimport { Layer } from 'models/Layer';\nimport { IContext } from 'interfaces';\nimport Config from './interfaces/Config';\n\nexport default function getAllSiblingLayerPoints(\n  config: Config,\n  context: IContext,\n  layers: Array<Layer>,\n  parent: any\n): ISnapPoints {\n  let snapPoints: ISnapPoints = {\n    x: [],\n    y: [],\n  };\n\n  // if (!layers || layers.length === 0) {\n  //   return snapPoints;\n  // }\n\n  // let selectedLayer = layers[0];\n  if (!parent || !config.snap || !config.siblingSnap) {\n    return {\n      x: [],\n      y: [],\n    };\n  }\n\n  if (parent) {\n    _.forEach(parent.children, async layer => {\n      if (layers.includes(layer)) {\n        return;\n      }\n      // TODO: Figure out what this was for\n      // if (\n      //   layers.indexOf(layer) > -1 ||\n      //   layer.domainCompiledRef.type === 'fileHeader'\n      // ) {\n      //   return;\n      // }\n      let layerPoints: ISnapPoints = getLayerPoints(context, layer);\n\n      snapPoints.x = snapPoints.x.concat(layerPoints.x);\n      snapPoints.y = snapPoints.y.concat(layerPoints.y);\n    });\n  }\n  return snapPoints;\n}\n\nfunction getLayerPoints(context: IContext, layer: Layer): ISnapPoints {\n  let x: Array<ISnapXPoint> = [];\n  let y: Array<ISnapYPoint> = [];\n\n  let minX = undefined;\n  let maxX = undefined;\n\n  let minY = undefined;\n  let maxY = undefined;\n\n  let layerBox = context.canvas.getBoundingBoxWRTParent([layer], true);\n\n  let xSnapPoint1: ISnapXPoint = {\n    value: layerBox.x,\n    rootValue: layerBox.rootX,\n    minY: minY,\n    maxY: maxY,\n    snapTo: { center: true, start: true, end: true },\n  };\n  let xSnapPoint2: ISnapXPoint = {\n    value: layerBox.x + layerBox.width,\n    rootValue: layerBox.rootX + layerBox.width,\n    minY: minY,\n    maxY: maxY,\n    snapTo: { center: true, start: true, end: true },\n  };\n  let xSnapPoint3: ISnapXPoint = {\n    value: layerBox.x + layerBox.width / 2,\n    rootValue: layerBox.rootX + layerBox.width / 2,\n\n    minY: minY,\n    maxY: maxY,\n    snapTo: { center: true, start: true, end: true },\n  };\n\n  let ySnapPoint1: ISnapYPoint = {\n    value: layerBox.y,\n    rootValue: layerBox.rootY,\n    minX: minX,\n    maxX: maxX,\n    snapTo: { center: true, start: true, end: true },\n  };\n  let ySnapPoint2: ISnapYPoint = {\n    value: layerBox.y + layerBox.height,\n    rootValue: layerBox.rootY + layerBox.height,\n    minX: minX,\n    maxX: maxX,\n    snapTo: { center: true, start: true, end: true },\n  };\n  let ySnapPoint3: ISnapYPoint = {\n    value: layerBox.y + layerBox.height / 2,\n    rootValue: layerBox.rootY + layerBox.height / 2,\n    minX: minX,\n    maxX: maxX,\n    snapTo: { center: true, start: true, end: true },\n  };\n\n  x.push(xSnapPoint1);\n  x.push(xSnapPoint2);\n  x.push(xSnapPoint3);\n  y.push(ySnapPoint1);\n  y.push(ySnapPoint2);\n  y.push(ySnapPoint3);\n\n  return {\n    x,\n    y,\n  };\n}\n","import ISnapPoints from './interfaces/ISnapPoints';\nimport ISnapXPoint from './interfaces/ISnapXPoint';\nimport ISnapYPoint from './interfaces/ISnapYPoint';\nimport { IContext } from 'interfaces';\nimport { Layer } from '../../models/Layer';\nimport Config from './interfaces/Config';\n\n// TODO: Add typing to it\n// the arguments need to be the highest parent or whichever is the artboard\nexport default function getParentSnapPoints(\n  config: Config,\n  context: IContext,\n  layers: Array<Layer>\n): ISnapPoints {\n  if (!layers || layers.length === 0 || !config.snap || !config.parentSnap) {\n    return {\n      x: [],\n      y: [],\n    };\n  }\n  const layer = layers[0];\n  let x: Array<ISnapXPoint> = [];\n  let y: Array<ISnapXPoint> = [];\n\n  let minX = undefined;\n  let maxX = undefined;\n\n  let minY = undefined;\n  let maxY = undefined;\n\n  let layerDimensions = layer.getBoundingClientRect();\n\n  let xSnapPoint1: ISnapXPoint = {\n    value: 0,\n    rootValue: layerDimensions.rootX,\n    minY: minY,\n    maxY: maxY,\n    snapTo: {\n      center: false,\n      start: true,\n      end: false,\n    },\n  };\n  let xSnapPoint2: ISnapXPoint = {\n    value: layerDimensions.width,\n    rootValue: layerDimensions.rootX + layerDimensions.width,\n    minY: minY,\n    maxY: maxY,\n    snapTo: { center: false, start: false, end: true },\n  };\n  let xSnapPoint3: ISnapXPoint = {\n    value: layerDimensions.width / 2,\n    rootValue: layerDimensions.rootX + layerDimensions.width / 2,\n    minY: minY,\n    maxY: maxY,\n    snapTo: { center: true, start: true, end: true },\n  };\n\n  let ySnapPoint1: ISnapYPoint = {\n    value: 0,\n    rootValue: layerDimensions.rootY,\n    minX: minX,\n    maxX: maxX,\n    snapTo: { center: false, start: true, end: false },\n  };\n  let ySnapPoint2: ISnapYPoint = {\n    value: layerDimensions.height,\n    rootValue: layerDimensions.rootY + layerDimensions.height,\n    minX: minX,\n    maxX: maxX,\n    snapTo: { center: false, start: false, end: true },\n  };\n  let ySnapPoint3: ISnapYPoint = {\n    value: layerDimensions.height / 2,\n    rootValue: layerDimensions.rootY + layerDimensions.height / 2,\n    minX: minX,\n    maxX: maxX,\n    snapTo: { center: true, start: true, end: true },\n  };\n\n  x.push(xSnapPoint1);\n  x.push(xSnapPoint2);\n  x.push(xSnapPoint3);\n  y.push(ySnapPoint1);\n  y.push(ySnapPoint2);\n  y.push(ySnapPoint3);\n\n  return {\n    x,\n    y,\n  };\n}\n","import * as _ from 'lodash';\nimport ISnapPoints from './interfaces/ISnapPoints';\nimport ISnapXPoint from './interfaces/ISnapXPoint';\nimport ISnapYPoint from './interfaces/ISnapYPoint';\nimport { Layer } from '../../models/Layer';\nimport { IDimensionWithRoot } from '../../interfaces/IDimensionWithRoot';\nimport { IContext } from 'interfaces';\nimport Config from './interfaces/Config';\n\n// The box closer to the start of the axis should be sent as box1 and other one as box2\nfunction getDistance(\n  axis: String,\n  box1: IDimensionWithRoot,\n  box2: IDimensionWithRoot\n): number {\n  if (axis === 'x') {\n    return box2.x - (box1.x + box1.width);\n  } else {\n    return box2.y - (box1.y + box1.height);\n  }\n}\n\nfunction getDistanceBetweenLayers(\n  axis: String,\n  layer1: Layer,\n  layer2: Layer\n): number {\n  let distance = 0;\n\n  let box1 = layer1.getBoundingClientRect();\n  let box2 = layer2.getBoundingClientRect();\n\n  if (axis === 'x') {\n    // In case of overlap\n    if (box1.x < box2.x && box1.x + box1.width > box2.x) {\n      return -1;\n    }\n\n    // In case of overlap\n    if (box2.x < box1.x && box2.x + box2.width > box1.x) {\n      return -1;\n    }\n\n    if (box1.x < box2.x) {\n      distance = getDistance('x', box1, box2);\n    } else {\n      distance = getDistance('x', box2, box1);\n    }\n  } else {\n    if (box1.y < box2.y && box1.y + box1.height > box2.y) {\n      return -1;\n    }\n\n    // In case of overlap\n    if (box2.y < box1.y && box2.y + box2.height > box1.y) {\n      return -1;\n    }\n\n    if (box1.y < box2.y) {\n      distance = getDistance('y', box1, box2);\n    } else {\n      distance = getDistance('y', box2, box1);\n    }\n  }\n\n  return distance;\n}\n\nfunction isAlignedOnAxis(\n  axis: string,\n  layerDims: IDimensionWithRoot,\n  otherLayerDims: IDimensionWithRoot\n) {\n  if (axis === 'x') {\n    if (\n      otherLayerDims.rootY > layerDims.rootY + layerDims.height ||\n      layerDims.rootY > otherLayerDims.rootY + otherLayerDims.height\n    ) {\n      return false;\n    }\n    return true;\n  } else if (axis === 'y') {\n    if (\n      otherLayerDims.rootX > layerDims.rootX + layerDims.width ||\n      layerDims.rootX > otherLayerDims.rootX + otherLayerDims.width\n    ) {\n      return false;\n    }\n    return true;\n  }\n  return false;\n}\n\nfunction getOverlapBetweenLayers(\n  axis: 'x' | 'y',\n  layerDims: IDimensionWithRoot,\n  otherLayerDims: IDimensionWithRoot\n): { max: number; min: number } {\n  let extremities = {\n    min: 0,\n    max: 0,\n  };\n  if (axis === 'y') {\n    extremities.min =\n      layerDims.rootX > otherLayerDims.rootX\n        ? layerDims.rootX\n        : otherLayerDims.rootX;\n    extremities.max =\n      layerDims.rootX + layerDims.width >\n      otherLayerDims.rootX + otherLayerDims.width\n        ? otherLayerDims.rootX + otherLayerDims.width\n        : layerDims.rootX + layerDims.width;\n  } else {\n    extremities.min =\n      layerDims.rootY > otherLayerDims.rootY\n        ? layerDims.rootY\n        : otherLayerDims.rootY;\n    extremities.max =\n      layerDims.rootY + layerDims.height >\n      otherLayerDims.rootY + otherLayerDims.height\n        ? otherLayerDims.rootY + otherLayerDims.height\n        : layerDims.rootY + layerDims.height;\n  }\n\n  return extremities;\n}\n\nfunction getDisconnectedGutterPointsForX(\n  snapXPoints: Array<ISnapXPoint>,\n  restrictedLayers: Array<Layer>,\n  originalAllLayers: Array<Layer>,\n  distance: number\n): Array<ISnapXPoint> {\n  let points: Array<ISnapXPoint> = [];\n  let axis = 'x';\n  let layer1 = restrictedLayers[0];\n  let dims1 = layer1.getBoundingClientRect();\n  let layer2 = restrictedLayers[1];\n  let dims2 = layer2.getBoundingClientRect();\n\n  let allLayers: Array<Layer> = originalAllLayers.filter((layer: Layer) => {\n    return !restrictedLayers.includes(layer);\n  });\n\n  allLayers.forEach((layer: Layer) => {\n    let dims = layer.getBoundingClientRect();\n    if (\n      isAlignedOnAxis(axis, dims1, dims) &&\n      isAlignedOnAxis(axis, dims2, dims)\n    ) {\n      let leftMostPoint = dims.x - distance;\n      let leftMostRootPoint = dims.rootX - distance;\n      let rightMostPoint = dims.x + dims.width + distance;\n      let rightMostRootPoint = dims.rootX + dims.width + distance;\n      let minY = dims.rootY;\n      let maxY = dims.rootY + dims.height;\n\n      addToSnapXPoint(\n        snapXPoints,\n        rightMostPoint,\n        rightMostRootPoint,\n        minY,\n        maxY,\n        distance\n      );\n      addToSnapXPoint(\n        snapXPoints,\n        leftMostPoint,\n        leftMostRootPoint,\n        minY,\n        maxY,\n        distance\n      );\n    }\n  });\n  return points;\n}\n\nfunction getDisconnectedGutterPointsForY(\n  snapYPoints: Array<ISnapXPoint>,\n  restrictedLayers: Array<Layer>,\n  originalAllLayers: Array<Layer>,\n  distance: number\n): Array<ISnapYPoint> {\n  let points: Array<ISnapYPoint> = [];\n  let axis = 'y';\n  let layer1 = restrictedLayers[0];\n  let dims1 = layer1.getBoundingClientRect();\n  let layer2 = restrictedLayers[1];\n  let dims2 = layer2.getBoundingClientRect();\n\n  let allLayers: Array<Layer> = originalAllLayers.filter((layer: Layer) => {\n    return !restrictedLayers.includes(layer);\n  });\n\n  allLayers.forEach((layer: Layer) => {\n    let dims = layer.getBoundingClientRect();\n    if (\n      isAlignedOnAxis(axis, dims1, dims) &&\n      isAlignedOnAxis(axis, dims2, dims)\n    ) {\n      let topMostPoint = dims.y - distance;\n      let topMostRootPoint = dims.rootY - distance;\n      let bottomMostPoint = dims.y + dims.height + distance;\n      let bottomMostRootPoint = dims.rootY + dims.height + distance;\n      let minX = dims.rootX;\n      let maxX = dims.rootX + dims.width;\n\n      addToSnapYPoint(\n        snapYPoints,\n        bottomMostPoint,\n        bottomMostRootPoint,\n        minX,\n        maxX,\n        distance\n      );\n      addToSnapYPoint(\n        snapYPoints,\n        topMostPoint,\n        topMostRootPoint,\n        minX,\n        maxX,\n        distance\n      );\n    }\n  });\n  return points;\n}\n\nfunction addToSnapXPoint(\n  snapXPoints: Array<ISnapXPoint>,\n  value: number,\n  rootValue: number,\n  min: number,\n  max: number,\n  distance: number\n) {\n  if (\n    !_.find(snapXPoints, (val: any) => {\n      return (\n        val.value === value &&\n        val.rootValue === rootValue &&\n        val.minY === min &&\n        val.maxY === max\n      );\n    })\n  ) {\n    snapXPoints.push({\n      value: value,\n      rootValue: rootValue,\n      minY: min,\n      maxY: max,\n      snapLines: {\n        distance,\n      },\n    });\n  }\n}\n\nfunction addToSnapYPoint(\n  snapYPoints: Array<ISnapYPoint>,\n  value: number,\n  rootValue: number,\n  min: number,\n  max: number,\n  distance: number\n) {\n  if (\n    !_.find(snapYPoints, (val: any) => {\n      return (\n        val.value === value &&\n        val.rootValue === rootValue &&\n        val.minY === min &&\n        val.maxY === max\n      );\n    })\n  ) {\n    snapYPoints.push({\n      value: value,\n      rootValue: rootValue,\n      minX: min,\n      maxX: max,\n      snapLines: {\n        distance,\n      },\n    });\n  }\n}\n\nexport default function getGutterSnapPoints(\n  config: Config,\n  context: IContext,\n  layers: Array<Layer>\n): ISnapPoints {\n  if (!layers || layers.length === 0 || !config.snap || !config.gutterSnap) {\n    return {\n      x: [],\n      y: [],\n    };\n  }\n  const layer = layers[0];\n  let snapXPoints: Array<ISnapXPoint> = [];\n  let snapYPoints: Array<ISnapYPoint> = [];\n\n  if (!layer.parent) {\n    return {\n      x: [],\n      y: [],\n    };\n  }\n  let parent = layer.parent as Layer;\n  parent.children.forEach((layer1: Layer) => {\n    // Don't need the distance with this layer as it is being moved\n    if (layers.includes(layer1)) {\n      return;\n    }\n\n    parent.children.forEach((layer2: Layer) => {\n      // No need of comparison between the same layers\n      if (layer1 === layer2) return;\n\n      // No need to do comparison as this layer is being moved\n      if (layers.includes(layer2)) return;\n\n      if (\n        isAlignedOnAxis(\n          'x',\n          layer1.getBoundingClientRect(),\n          layer2.getBoundingClientRect()\n        )\n      ) {\n        let distance = getDistanceBetweenLayers('x', layer1, layer2);\n        if (distance > 0) {\n          let allGutterPoints = getDisconnectedGutterPointsForX(\n            snapXPoints,\n            [layer1, layer2, ...layers],\n            parent.children,\n            distance\n          );\n          snapXPoints.push(...allGutterPoints);\n          let overlapX: {\n            min: number;\n            max: number;\n          } = getOverlapBetweenLayers(\n            'x',\n            layer1.getBoundingClientRect(),\n            layer2.getBoundingClientRect()\n          );\n\n          let box1 = layer1.getBoundingClientRect();\n          let box2 = layer2.getBoundingClientRect();\n\n          let rightMostPoint = 0;\n          let rightMostRootPoint = 0;\n          let leftMostPoint = 0;\n          let leftMostRootPoint = 0;\n\n          let right: IDimensionWithRoot;\n          let left: IDimensionWithRoot;\n          if (box1.x + box1.width > box2.x + box2.width) {\n            right = box1;\n            left = box2;\n            rightMostPoint = box1.x + box1.width;\n            rightMostRootPoint = box1.rootX + box1.width;\n            leftMostPoint = box2.x - distance;\n            leftMostRootPoint = box2.rootX - distance;\n          } else {\n            right = box2;\n            left = box1;\n            rightMostPoint = box2.x + box2.width;\n            rightMostRootPoint = box2.rootX + box2.width;\n            leftMostPoint = box1.x - distance;\n            leftMostRootPoint = box1.rootX - distance;\n          }\n\n          rightMostPoint = rightMostPoint + distance;\n          rightMostRootPoint = rightMostRootPoint + distance;\n\n          addToSnapXPoint(\n            snapXPoints,\n            rightMostPoint,\n            rightMostRootPoint,\n            overlapX.min,\n            overlapX.max,\n            distance\n          );\n          addToSnapXPoint(\n            snapXPoints,\n            leftMostPoint,\n            leftMostRootPoint,\n            overlapX.min,\n            overlapX.max,\n            distance\n          );\n        }\n      }\n\n      if (\n        isAlignedOnAxis(\n          'y',\n          layer1.getBoundingClientRect(),\n          layer2.getBoundingClientRect()\n        )\n      ) {\n        let distance = getDistanceBetweenLayers('y', layer1, layer2);\n        if (distance > 0) {\n          let allGutterPoints = getDisconnectedGutterPointsForY(\n            snapYPoints,\n            [layer1, layer2, ...layers],\n            parent.children,\n            distance\n          );\n          snapYPoints.push(...allGutterPoints);\n          let overlapY: {\n            min: number;\n            max: number;\n          } = getOverlapBetweenLayers(\n            'y',\n            layer1.getBoundingClientRect(),\n            layer2.getBoundingClientRect()\n          );\n\n          let box1 = layer1.getBoundingClientRect();\n          let box2 = layer2.getBoundingClientRect();\n\n          let bottomMostPoint = 0;\n          let bottomMostRootPoint = 0;\n          let topMostPoint = 0;\n          let topMostRootPoint = 0;\n\n          let top: IDimensionWithRoot;\n          let bottom: IDimensionWithRoot;\n          if (box1.y + box1.height > box2.y + box2.height) {\n            bottom = box1;\n            top = box2;\n            bottomMostPoint = box1.y + box1.height;\n            bottomMostRootPoint = box1.rootY + box1.height;\n            topMostPoint = box2.y - distance;\n            topMostRootPoint = box2.rootY - distance;\n          } else {\n            top = box1;\n            bottom = box2;\n            bottomMostPoint = box2.y + box2.height;\n            bottomMostRootPoint = box2.rootY + box2.height;\n            topMostPoint = box1.y - distance;\n            topMostRootPoint = box1.rootY - distance;\n          }\n\n          bottomMostPoint = bottomMostPoint + distance;\n          bottomMostRootPoint = bottomMostRootPoint + distance;\n\n          addToSnapYPoint(\n            snapYPoints,\n            bottomMostPoint,\n            bottomMostRootPoint,\n            overlapY.min,\n            overlapY.max,\n            distance\n          );\n\n          addToSnapYPoint(\n            snapYPoints,\n            topMostPoint,\n            topMostRootPoint,\n            overlapY.min,\n            overlapY.max,\n            distance\n          );\n        }\n      }\n    });\n  });\n  return { x: snapXPoints, y: snapYPoints };\n}\n","import { IContext } from 'interfaces';\nimport ISnapXPoint from './interfaces/ISnapXPoint';\nimport ISnapYPoint from './interfaces/ISnapYPoint';\nimport Config from './interfaces/Config';\n\nfunction gridSnapPoint(\n  delta: number,\n  startPoint: number,\n  gridSpace: number,\n  stretch: number,\n  handle?: any\n): any {\n  let snappedSide = {\n    coordinate: NaN,\n    start: false,\n    center: false,\n    end: false,\n  };\n\n  let point1 = startPoint + delta;\n  point1 = Math.round(point1 / gridSpace) * gridSpace;\n  const delta1 = point1 - startPoint;\n\n  let point2 = startPoint + stretch + delta;\n  point2 = Math.round(point2 / gridSpace) * gridSpace;\n  const delta2 = point2 - stretch - startPoint;\n\n  let outputDelta = delta1;\n\n  snappedSide.coordinate = point1;\n  snappedSide.start = true;\n  outputDelta = delta1;\n\n  if (handle) {\n    if (handle.indexOf('L') === -1 && handle.indexOf('T') === -1) {\n      snappedSide.coordinate = point2;\n      snappedSide.end = true;\n      outputDelta = delta2;\n    }\n  } else {\n    if (\n      Math.abs(delta + startPoint - point1) >\n      Math.abs(delta + startPoint + stretch - point2)\n    ) {\n      snappedSide.coordinate = point2;\n      snappedSide.end = true;\n      outputDelta = delta2;\n    }\n  }\n\n  return {\n    value: snappedSide.coordinate,\n    rootValue: snappedSide.coordinate,\n    snappedSide: snappedSide,\n    snapType: 'grid',\n    delta: outputDelta,\n  };\n}\n\nexport default function snapToGrid(\n  config: Config,\n  context: IContext,\n  startX: number,\n  totalDeltaX: number,\n  startY: number,\n  totalDeltaY: number,\n  stretchX: number,\n  stretchY: number,\n  handle?: any\n): { x: any; y: any } | undefined {\n  if (!config.snap || !config.gridSnap) {\n    return;\n  }\n\n  const gridOffset = context.canvas.executeFunction('getGridOffset');\n\n  let x: any;\n  let y: any;\n\n  let snapBounds = context.canvas.executeFunction('getGridSize');\n\n  if (!snapBounds) {\n    snapBounds = {\n      x: 20,\n      y: 20,\n    };\n  }\n\n  if (!snapBounds) {\n    return {\n      x: {\n        value: startX + totalDeltaX,\n        rootValue: startX + totalDeltaX,\n      },\n      y: {\n        value: startY + totalDeltaY,\n        rootValue: startY + totalDeltaY,\n      },\n    };\n  }\n\n  let xSnapPoint = gridSnapPoint(\n    totalDeltaX,\n    startX - gridOffset.x,\n    snapBounds.x,\n    stretchX,\n    handle\n  );\n\n  x = xSnapPoint;\n  let ySnapPoints = gridSnapPoint(\n    totalDeltaY,\n    startY - gridOffset.y,\n    snapBounds.y,\n    stretchY,\n    handle\n  );\n  // snappedSideY.coordinate = ySnapPoint;\n  y = ySnapPoints;\n\n  return {\n    x,\n    y,\n  };\n}\n","import ISnapPoints from './interfaces/ISnapPoints';\nimport ISnapXPoint from './interfaces/ISnapXPoint';\nimport { IDimensionWithRoot, IContext } from 'interfaces';\nimport { minBy } from 'lodash';\nimport ModelUtils from './../../models/utils';\nimport ISnapYPoint from './interfaces/ISnapYPoint';\nexport function snapToPoints(\n  context: IContext,\n  snapPoints: {\n    parentSnapPoints: ISnapPoints;\n    siblingSnapPoints: ISnapPoints;\n    gutterSnapPoints: ISnapPoints;\n    rulerSnapPoints: { x: Array<number>; y: Array<number> };\n    gridSnap: boolean;\n  },\n  startPoint: any,\n  totalDelta: any,\n  dims: IDimensionWithRoot,\n  absoluteDelta: any = [0, 0],\n  startAbsolutePoint: any = [0, 0],\n  parentAbsoluteRotation: number,\n  boundingBoxWRTWorld: any,\n  handle?: any\n) {\n  //\n\n  let meta: any = {\n    snappedSide: {\n      x: undefined,\n      y: undefined,\n    },\n  };\n\n  let x = totalDelta[0];\n  let y = totalDelta[1];\n\n  if (snapPoints) {\n    const snappedData = snapPoint(\n      context,\n      snapPoints,\n      startPoint,\n      totalDelta,\n      dims,\n      absoluteDelta,\n      startAbsolutePoint,\n      parentAbsoluteRotation,\n      boundingBoxWRTWorld,\n      handle\n    );\n    x = snappedData.delta.x;\n    y = snappedData.delta.y;\n\n    meta.snappedSide.x = snappedData.meta.x;\n    meta.snappedSide.y = snappedData.meta.y;\n  }\n  let delta = {\n    x: x,\n    y: y,\n  };\n\n  return {\n    x,\n    y,\n    delta,\n    meta,\n  };\n}\nexport default function snapPoint(\n  context: IContext,\n  snapPoints: {\n    parentSnapPoints: ISnapPoints;\n    siblingSnapPoints: ISnapPoints;\n    gutterSnapPoints: ISnapPoints;\n    rulerSnapPoints: { x: Array<number>; y: Array<number> };\n    gridSnap: boolean;\n  },\n  startPoint: any,\n  totalDelta: any,\n  dims: IDimensionWithRoot,\n  absoluteDelta: any,\n  startAbsolutePoint: any,\n  parentAbsoluteRotation: number,\n  boundingBoxWRTWorld: any,\n  handle?: any\n): {\n  value: number;\n  delta: any;\n  meta: any;\n} {\n  let stretchX = dims.width;\n  let stretchY = dims.height;\n\n  let rulerCoordinatesX = snapPoints.rulerSnapPoints.y;\n  let rulerCoordinatesY = snapPoints.rulerSnapPoints.x;\n\n  let documentCoordinatesX = snapPoints.parentSnapPoints.x;\n  let documentCoordinatesY = snapPoints.parentSnapPoints.y;\n\n  let layerCoordinatesX = snapPoints.siblingSnapPoints.x;\n  let layerCoordinatesY = snapPoints.siblingSnapPoints.y;\n\n  // let gutterCoordinates =\n  //   axis === 'x'\n  //     ? snapPoints.gutterSnapPoints.x\n  //     : snapPoints.gutterSnapPoints.y;\n\n  let snapBounds =\n    context.canvas.executeFunction('getSnapBound') / context.canvas.getZoom();\n  let coordinateValueX = startPoint[0] + totalDelta[0];\n  let coordinateValueY = startPoint[1] + totalDelta[1];\n\n  let parentSnappedDataX = getPointForParentSnap(\n    documentCoordinatesX,\n    coordinateValueX,\n    stretchX,\n    snapBounds\n  );\n\n  let parentSnappedDataY = getPointForParentSnap(\n    documentCoordinatesY,\n    coordinateValueY,\n    stretchY,\n    snapBounds\n  );\n\n  parentSnappedDataX.snapType = 'documentBounds';\n  parentSnappedDataY.snapType = 'documentBounds';\n  parentSnappedDataX.delta = parentSnappedDataX.value - startPoint[0];\n  parentSnappedDataY.delta = parentSnappedDataY.value - startPoint[1];\n\n  const siblingDataX = getPointForSiblingSnap(\n    layerCoordinatesX,\n    coordinateValueX,\n    stretchX,\n    snapBounds,\n    true\n  );\n  siblingDataX.snapType = 'sibling';\n\n  const siblingDataY = getPointForSiblingSnap(\n    layerCoordinatesY,\n    coordinateValueY,\n    stretchY,\n    snapBounds\n  );\n  siblingDataY.snapType = 'sibling';\n\n  siblingDataX.delta = siblingDataX.value - startPoint[0];\n  siblingDataY.delta = siblingDataY.value - startPoint[1];\n\n  let rulersDataX = getPointForRulerLines(\n    rulerCoordinatesX,\n    startAbsolutePoint[0] + absoluteDelta[0],\n    stretchX,\n    snapBounds\n  );\n  let rulersDataY = getPointForRulerLines(\n    rulerCoordinatesY,\n    startAbsolutePoint[1] + absoluteDelta[1],\n    stretchY,\n    snapBounds\n  );\n\n  rulersDataX.snapType = 'ruler';\n  rulersDataY.snapType = 'ruler';\n  rulersDataX.delta = rulersDataX.value - startAbsolutePoint[0];\n  rulersDataY.delta = rulersDataY.value - startAbsolutePoint[1];\n\n  const rotateDelta = ModelUtils.rotatePoint(\n    [rulersDataX.delta, rulersDataY.delta],\n    360 - parentAbsoluteRotation,\n    [0, 0]\n  );\n\n  rulersDataX.delta = rotateDelta[0];\n  rulersDataY.delta = rotateDelta[1];\n\n  // grid snapping\n  let gridDataX: any = {\n    delta: 0,\n    snappedSide: {\n      coordinate: NaN,\n      start: true,\n      center: false,\n      end: true,\n    },\n  };\n  let gridDataY: any = {\n    delta: 0,\n    snappedSide: {\n      coordinate: NaN,\n      start: true,\n      center: false,\n      end: true,\n    },\n  };\n\n  // console.log(\n  //   gridOffset.x,\n  //   gridOffset.y,\n  //   startAbsolutePoint[1],\n  //   startAbsolutePoint[0],\n  //   'grid snap points here'\n  // );\n  let gridSnapPoints: {\n    x: ISnapXPoint;\n    y: ISnapYPoint;\n  } = context.canvas.executeFunction(\n    'snapToGrid',\n    boundingBoxWRTWorld.x,\n    absoluteDelta[0],\n    boundingBoxWRTWorld.y,\n    absoluteDelta[1],\n    stretchX,\n    stretchY,\n    handle\n  );\n\n  if (gridSnapPoints) {\n    gridDataX = gridSnapPoints.x;\n    gridDataY = gridSnapPoints.y;\n    const rotateDeltaGrid = ModelUtils.rotatePoint(\n      [gridDataX.delta, gridDataY.delta],\n      360 - parentAbsoluteRotation,\n      [0, 0]\n    );\n\n    gridDataX.delta = rotateDeltaGrid[0];\n    gridDataY.delta = rotateDeltaGrid[1];\n  }\n\n  // console.log(gridSnapPoints, 'grid snap points');\n\n  let minSnappedDataX = minBy(\n    [rulersDataX, gridDataX, siblingDataX, parentSnappedDataX],\n    data => {\n      let point = startPoint[0];\n\n      if (data.snappedSide.end) {\n        point = startPoint[0] + stretchX;\n      }\n\n      if (data.snappedSide.center) {\n        point = startPoint[0] + stretchX / 2;\n      }\n\n      // console.log(\n      //   point,\n      //   data.delta,\n      //   totalDelta[0],\n      //   coordinateValueX,\n      //   data.snapType,\n      //   data.snappedSide.coordinate,\n      //   Math.abs(data.snappedSide.coordinate - coordinateValueX),\n      //   '&&&&&&&&'\n      // );\n      if (!isNaN(data.snappedSide.coordinate))\n        return Math.abs(data.delta - totalDelta[0]);\n      else return Number.MAX_VALUE;\n    }\n  );\n\n  // console.log(minSnappedDataX, '&&&&&&&& ******');\n  let minSnappedDataY = minBy(\n    [rulersDataY, gridDataY, siblingDataY, parentSnappedDataY],\n    data => {\n      let point = startPoint[1];\n\n      if (data.snappedSide.end) {\n        point = startPoint[1] + stretchY;\n      }\n\n      if (data.snappedSide.center) {\n        point = startPoint[1] + stretchY / 2;\n      }\n\n      if (!isNaN(data.snappedSide.coordinate))\n        return Math.abs(data.delta - totalDelta[1]);\n      else return Number.MAX_VALUE;\n    }\n  );\n\n  return {\n    value: minSnappedDataX.value,\n    delta: {\n      x: minSnappedDataX.delta,\n      y: minSnappedDataY.delta,\n    },\n    meta: {\n      x: {\n        snappedSide: minSnappedDataX.snappedSide,\n        snapType: minSnappedDataX.snapType,\n      },\n      y: {\n        snappedSide: minSnappedDataY.snappedSide,\n        snapType: minSnappedDataY.snapType,\n      },\n    },\n  };\n}\n\nfunction getPointForParentSnap(\n  documentCoordinates: Array<ISnapXPoint>,\n  coordinateValue: number,\n  stretch: number,\n  snapBounds: number = 0\n): any {\n  // TODO: think of a better logic\n  let distance = Number.MAX_VALUE;\n  // let snappedSide;\n  let coordinate;\n  let snappedSide = {\n    coordinate: NaN,\n    start: false,\n    center: false,\n    end: false,\n    snappedPoint: {\n      value: NaN,\n      rootValue: NaN,\n    },\n  };\n  const originalCoordinateValue = coordinateValue;\n  for (let coordinate of documentCoordinates) {\n    let newData = calculateCoordinate(\n      originalCoordinateValue,\n      coordinateValue,\n      coordinate,\n      snapBounds,\n      stretch,\n      distance,\n      snappedSide\n    );\n    coordinateValue = newData.coordinateValue;\n\n    distance = newData.distance;\n    snappedSide = newData.snapped;\n    coordinate = coordinate;\n\n    // snappedSide.snappedPoint = newData.snappedPoint;\n  }\n  return { value: coordinateValue, snappedSide };\n}\n\nfunction getPointForSiblingSnap(\n  layerCoordinates: Array<ISnapXPoint>,\n  coordinateValue: number,\n  stretch: number,\n  snapBounds: number = 0,\n  showLog?: boolean\n): any {\n  // TODO: think of a better logic\n  let distance = Number.MAX_VALUE;\n\n  let snappedSide = {\n    coordinate: NaN,\n    start: false,\n    center: false,\n    end: false,\n    snappedPoint: {\n      value: NaN,\n      rootValue: NaN,\n    },\n  };\n\n  let originalCoordinateValue = coordinateValue;\n  for (let coordinate of layerCoordinates) {\n    let newData = calculateCoordinate(\n      originalCoordinateValue,\n      coordinateValue,\n      coordinate,\n      snapBounds,\n      stretch,\n      distance,\n      snappedSide,\n      showLog\n    );\n    coordinateValue = newData.coordinateValue;\n    // coordinateValueFinal = newData.coordinateValue;\n    distance = newData.distance;\n\n    snappedSide = newData.snapped;\n\n    // snappedSide = newData.snapped;\n  }\n\n  return { value: coordinateValue, snappedSide };\n}\n\nfunction getPointForRulerLines(\n  rulerCoordinates: Array<any>,\n  coordinateValue: number,\n  stretch: number,\n  snapBounds: number = 0\n): any {\n  let snappedSide = {\n    coordinate: NaN,\n    start: false,\n    center: false,\n    end: false,\n    snappedPoint: {\n      value: NaN,\n      rootValue: NaN,\n    },\n  };\n\n  let distance = Number.MAX_VALUE;\n\n  let originalCoordinateValue = coordinateValue;\n  for (let coordinate of rulerCoordinates) {\n    let newData = calculateCoordinate(\n      originalCoordinateValue,\n      coordinateValue,\n      coordinate,\n      snapBounds,\n      stretch,\n      distance,\n      snappedSide\n    );\n\n    // if (newData) {\n\n    // }\n\n    snappedSide = newData.snapped;\n    coordinateValue = newData.coordinateValue;\n    distance = newData.distance;\n  }\n  return { value: coordinateValue, snappedSide };\n}\n\nfunction getDistance(value1: number, value2: number): number {\n  return Math.abs(value1 - value2);\n}\n\nfunction getPointForGutterSnap(\n  gutterCoordinates: Array<any>,\n  axis: 'x' | 'y',\n  coordinateValue: number,\n  stretch: number,\n  snapBounds: number = 0,\n  dims: IDimensionWithRoot\n): any {\n  // TODO: think of a better logic\n  // let distance = Number.MAX_VALUE;\n  // let snappedSide;\n  // for (let coordinate of gutterCoordinates) {\n  //   if (!isAlignedToAxis(dims, coordinate, axis)) {\n  //     return coordinateValue;\n  //   }\n  //   let newData = calculateCoordinate(\n  //     coordinateValue,\n  //     coordinate,\n  //     snapBounds,\n  //     stretch,\n  //     distance\n  //   );\n  //   coordinateValue = newData.coordinateValue;\n  //   distance = newData.distance;\n  //   snappedSide = newData.snapped;\n  // }\n  // return { value: coordinateValue, snappedSide };\n}\n\nfunction calculateCoordinate(\n  originalCoordinateValue: number,\n  coordinateValue: number,\n  coordinate: ISnapXPoint,\n  snapMagnet: number,\n  stretch: number,\n  distance: number,\n  snappedSide: any,\n  showLog?: boolean\n): {\n  coordinateValue: number;\n  distance: number;\n  snapped: any;\n  // snappedPoint: any;\n} {\n  let snapTo = {\n    start: true,\n    center: true,\n    end: true,\n  };\n\n  let snapped = snappedSide;\n  snapped.coordinateValue = coordinateValue;\n  snapped.distance = distance;\n\n  if (coordinate.snapTo) {\n    snapTo = coordinate.snapTo;\n  }\n\n  if (\n    Math.abs(originalCoordinateValue - coordinate.value) <= snapMagnet &&\n    snapTo.start &&\n    distance >= getDistance(originalCoordinateValue, coordinate.value)\n  ) {\n    // coordinateValue = coordinate.value;\n    // distance = getDistance(coordinateValue, coordinate.value);\n    snapped.start = true;\n    snapped.coordinate = coordinate.value;\n    snapped.snappedPoint = {\n      value: coordinate.value,\n      rootValue: coordinate.rootValue,\n    };\n    snapped.distance = getDistance(originalCoordinateValue, coordinate.value);\n    snapped.coordinateValue = coordinate.value;\n  }\n  if (\n    Math.abs(originalCoordinateValue + stretch / 2 - coordinate.value) <=\n      snapMagnet &&\n    snapTo.center &&\n    distance >=\n      getDistance(originalCoordinateValue + stretch / 2, coordinate.value)\n  ) {\n    // coordinateValue = coordinate.value - stretch / 2;\n    // distance = getDistance(coordinateValue + stretch / 2, coordinate.value);\n    // let snapped = snappedSide;\n    snapped.distance = getDistance(\n      originalCoordinateValue + stretch / 2,\n      coordinate.value\n    );\n    snapped.coordinateValue = coordinate.value - stretch / 2;\n\n    snapped.center = true;\n    snapped.coordinate = coordinate.value;\n    snapped.snappedPoint = {\n      value: coordinate.value,\n      rootValue: coordinate.rootValue,\n    };\n    // snappedArray.push(snapped);\n  }\n  if (\n    Math.abs(originalCoordinateValue + stretch - coordinate.value) <=\n      snapMagnet &&\n    snapTo.end &&\n    distance >= getDistance(originalCoordinateValue + stretch, coordinate.value)\n  ) {\n    // coordinateValue = coordinate.value - stretch;\n    // distance = getDistance(coordinateValue + stretch, coordinate.value);\n    // let snapped = snappedSide;\n\n    snapped.distance = getDistance(\n      originalCoordinateValue + stretch,\n      coordinate.value\n    );\n    snapped.coordinateValue = coordinate.value - stretch;\n\n    snapped.end = true;\n    snapped.coordinate = coordinate.value;\n\n    snapped.snappedPoint = {\n      value: coordinate.value,\n      rootValue: coordinate.rootValue,\n    };\n    // snappedArray.push(snapped);\n  }\n\n  return {\n    coordinateValue: snapped.coordinateValue,\n    distance: snapped.distance,\n    snapped: snapped,\n  };\n}\n\nfunction isAlignedToAxis(\n  dims: IDimensionWithRoot,\n  coordinates: any,\n  axis: 'x' | 'y'\n): boolean {\n  if (axis === 'x') {\n    if (\n      dims.rootY > coordinates.minY + (coordinates.maxY - coordinates.minY) ||\n      coordinates.minY > dims.rootY + dims.height\n    ) {\n      return false;\n    }\n    return true;\n  } else {\n    if (\n      dims.rootX > coordinates.minX + (coordinates.maxX - coordinates.minX) ||\n      coordinates.minX > dims.rootX + dims.width\n    ) {\n      return false;\n    }\n    return true;\n  }\n}\n","import { Canvas } from '../../models/Canvas';\nimport { Layer } from '../../models/Layer';\nimport ISnapPoints from './interfaces/ISnapPoints';\nimport ModelUtils from './../../models/utils';\nimport _, { forEach } from 'lodash';\nimport { IContext } from 'interfaces';\nimport Config from './interfaces/Config';\n\nfunction filterSnapPointX(snapPoint: any, handle: any) {\n  //\n  snapPoint.snapTo.center = false;\n  snapPoint.snapTo.start = true;\n  snapPoint.snapTo.end = true;\n\n  if (handle.indexOf('R') !== -1) {\n    snapPoint.snapTo.start = false;\n  }\n  if (handle.indexOf('L') !== -1) {\n    snapPoint.snapTo.end = false;\n  }\n}\nfunction filterSnapPointY(snapPoint: any, handle: any) {\n  snapPoint.snapTo.center = false;\n  snapPoint.snapTo.start = true;\n  snapPoint.snapTo.end = true;\n  if (handle.indexOf('B') !== -1) {\n    snapPoint.snapTo.start = false;\n  }\n  if (handle.indexOf('T') !== -1) {\n    snapPoint.snapTo.end = false;\n  }\n}\n\nexport default function getSnapPoints(\n  config: Config,\n  context: IContext,\n  selectedLayers: Array<Layer>,\n  parent: any = undefined,\n  handle?: any\n) {\n  let snapPoints: ISnapPoints = {\n    x: [],\n    y: [],\n  };\n\n  if (!parent || !config.snap) {\n    return {\n      parentSnapPoints: snapPoints,\n      siblingSnapPoints: snapPoints,\n      gutterSnapPoints: snapPoints,\n      rulerSnapPoints: snapPoints,\n      gridSnap: undefined,\n    };\n  }\n  let layers: any = [];\n\n  if (parent) {\n    layers = parent.children;\n  }\n  // TODO: Suraj review\n  if (layers.length === 0 && !parent) {\n    return {\n      parentSnapPoints: snapPoints,\n      siblingSnapPoints: snapPoints,\n      gutterSnapPoints: snapPoints,\n      rulerSnapPoints: snapPoints,\n      gridSnap: config.gridSnap,\n    };\n  }\n\n  let layerParent = parent;\n  if (!layerParent) {\n    layerParent = layers[0].parent;\n  }\n\n  // document bound snap points\n  let documentBound: Layer = layerParent;\n  let parentSnapPoints = snapPoints;\n  if (documentBound && config.parentSnap) {\n    // @ts-ignore\n    parentSnapPoints = documentBound.executeFunction('getParentSnapPoints', [\n      documentBound,\n    ]);\n  }\n\n  snapPoints.x = snapPoints.x.concat(parentSnapPoints.x);\n  snapPoints.y = snapPoints.y.concat(parentSnapPoints.y);\n\n  // layers snap points\n  let siblingSnapPoints: ISnapPoints = { x: [], y: [] };\n\n  if (config.siblingSnap && layers[0]) {\n    siblingSnapPoints = layers[0].executeFunction(\n      'getSiblingSnapPoints',\n      selectedLayers,\n      parent\n    );\n  }\n\n  let gutterSnapPoints: ISnapPoints = { x: [], y: [] };\n\n  if (config.gutterSnap && parent && layers[0]) {\n    // @ts-ignore\n    gutterSnapPoints = layers[0].executeFunction(\n      'getGutterSnapPoints',\n      selectedLayers\n    );\n  }\n\n  let rulerSnapPoints: { x: Array<any>; y: Array<any> } = {\n    x: [],\n    y: [],\n  };\n\n  if (config.rulerSnap) {\n    rulerSnapPoints = context.canvas.executeFunction(\n      'RulerLines.getLineCoordinates'\n    );\n\n    const boundingBox = context.canvas.getBoundingBox([parent], true);\n\n    forEach(rulerSnapPoints.x, (coordinate, index) => {\n      let point = coordinate - boundingBox.y;\n      rulerSnapPoints.x[index] = { value: point, rootValue: coordinate };\n    });\n    forEach(rulerSnapPoints.y, (coordinate, index) => {\n      const point = coordinate - boundingBox.x;\n      rulerSnapPoints.y[index] = { value: point, rootValue: coordinate };\n    });\n  }\n  // window['ModelUtils'] = ModelUtils;\n\n  // filtered snap point based on handle\n\n  if (handle) {\n    parentSnapPoints.x.forEach((snapPoint: any) => {\n      filterSnapPointX(snapPoint, handle);\n    });\n\n    parentSnapPoints.y.forEach((snapPoint: any) => {\n      filterSnapPointY(snapPoint, handle);\n    });\n\n    siblingSnapPoints.x.forEach((snapPoint: any) => {\n      // console.log(snapPoint, 'snap pont');\n      // snapPoint.snapTo.center = false;\n\n      filterSnapPointX(snapPoint, handle);\n    });\n\n    siblingSnapPoints.y.forEach((snapPoint: any) => {\n      // snapPoint.snapTo.center = false;\n\n      filterSnapPointY(snapPoint, handle);\n    });\n  }\n\n  // console.log(paren)\n  return {\n    parentSnapPoints,\n    siblingSnapPoints,\n    gutterSnapPoints,\n    rulerSnapPoints,\n    gridSnap: config.gridSnap,\n  };\n}\n","import { IPlugin, IContext, Canvas } from '../..';\nimport getSiblingPoints from './getSiblingPoints';\nimport getParentSnapPoints from './getParentSnapPoints';\nimport getGutterSnapPoints from './getGutterPoints';\nimport snapToGrid from './snapToGrid';\nimport snapPoint, { snapToPoints } from './snapPoint';\nimport getSnapPoints from './getSnapPoints';\nimport Config from './interfaces/Config';\n\nexport default class SnapPointsCalculator implements IPlugin {\n  name = 'SnapPointsCalculator';\n  canvas!: Canvas;\n  config!: Config;\n  snapBound: number = 5;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.config = {\n      snap: false,\n      parentSnap: false,\n      siblingSnap: false,\n      gutterSnap: false,\n      gridSnap: false,\n      rulerSnap: false,\n    };\n  }\n\n  setSnapBound = (context: IContext, bound: any) => {\n    this.snapBound = bound;\n  };\n  getSnapBound = (context: IContext) => {\n    return this.snapBound;\n  };\n\n  getConfig = (): Config => {\n    return this.config;\n  };\n\n  setConfig = (context: IContext, config: Config) => {\n    this.config = {\n      // snap: config.snap ? config.snap : this.config.snap,\n      // parentSnap: config.parentSnap\n      //   ? config.parentSnap\n      //   : this.config.parentSnap,\n      // siblingSnap: config.siblingSnap\n      //   ? config.siblingSnap\n      //   : this.config.siblingSnap,\n      // gutterSnap: config.gutterSnap\n      //   ? config.gutterSnap\n      //   : this.config.gutterSnap,\n      // gridSnap: config.gridSnap ? config.gridSnap : this.config.gridSnap,\n      // rulerSnap: config.rulerSnap ? config.rulerSnap : this.config.rulerSnap,\n      ...this.config,\n      ...config,\n    };\n  };\n\n  activate() {\n    this.canvas.addFunction('getSnapConfig', this.getConfig);\n    this.canvas.addFunction('setSnapConfig', this.setConfig);\n\n    this.canvas.addFunction('getSiblingSnapPoints', (...args: any[]) =>\n      // @ts-ignore\n      getSiblingPoints(this.config, ...args)\n    );\n    this.canvas.addFunction('getParentSnapPoints', (...args: any[]) =>\n      // @ts-ignore\n      getParentSnapPoints(this.config, ...args)\n    );\n    this.canvas.addFunction('getGutterSnapPoints', (...args: any[]) =>\n      // @ts-ignore\n      getGutterSnapPoints(this.config, ...args)\n    );\n    this.canvas.addFunction('snapToGrid', (...args: any[]) =>\n      // @ts-ignore\n      snapToGrid(this.config, ...args)\n    );\n    this.canvas.addFunction('snapToPoints', snapToPoints);\n    this.canvas.addFunction('getSnapPoints', (...args: any[]) =>\n      // @ts-ignore\n      getSnapPoints(this.config, ...args)\n    );\n    this.canvas.addFunction('setSnapBound', this.setSnapBound);\n    this.canvas.addFunction('getSnapBound', this.getSnapBound);\n  }\n\n  deactivate() {\n    this.canvas.removeFunction('getSiblingSnapPoints');\n    this.canvas.removeFunction('getParentSnapPoints');\n    this.canvas.removeFunction('getGutterSnapPoints');\n    this.canvas.removeFunction('snapToGrid');\n    this.canvas.removeFunction('snapToPoints');\n    this.canvas.removeFunction('getSnapPoints');\n    this.canvas.removeFunction('setSnapBound');\n    this.canvas.removeFunction('getSnapBound');\n  }\n}\n","import { Canvas, IPlugin, Layer } from '../..';\n\nexport default class ConstructionLinesPlugin implements IPlugin {\n  name = 'ConstructionLinesPlugin';\n  canvas!: Canvas;\n  dispose: any;\n  canvasDOMElement!: HTMLCanvasElement;\n  constructionLinesWrapper!: HTMLDivElement;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n\n  activate() {\n    this.canvas.addFunction(\n      'showConstructionLines',\n      this.showConstructionLines.bind(this)\n    );\n    this.canvas.addFunction(\n      'hideConstructionLines',\n      this.hideConstructionLines.bind(this)\n    );\n\n    this.canvas.addEventListener('setLayout', this.setDimensions.bind(this));\n\n    this.constructionLinesWrapper = document.createElement('div');\n    this.constructionLinesWrapper.className = 'construction-line-wrapper';\n    this.dispose = this.canvas.addDomToWorld(this.constructionLinesWrapper);\n    this.canvasDOMElement = document.createElement('canvas');\n\n    this.setDimensions();\n    // this.canvasDOMElement.setAttribute(\n    //   'height',\n    //   this.canvas.getBoundingClientRect().height.toString() + 'px'\n    // );\n    // this.canvasDOMElement.setAttribute(\n    //   'width',\n    //   this.canvas.getBoundingClientRect().width.toString() + 'px'\n    // );\n    this.canvasDOMElement.style.pointerEvents = 'none';\n    const context = this.canvasDOMElement.getContext('2d');\n    this.constructionLinesWrapper.style.pointerEvents = 'none';\n    this.constructionLinesWrapper.appendChild(this.canvasDOMElement);\n    const collisionScope = this.canvas.collisionScope;\n    this.attachListeners(this.canvas);\n    if (context && collisionScope) {\n      context.strokeStyle = '#f00';\n      context.beginPath();\n      collisionScope.drawBVH(context);\n      context.stroke();\n    }\n  }\n\n  attachListeners(layer: Layer) {\n    layer.on('*', this.updateLines);\n\n    layer.on(['children'], () => {\n      layer.children.forEach((child: Layer) => {\n        this.attachListeners(child);\n      });\n    });\n\n    layer.children.forEach((child: Layer) => {\n      this.attachListeners(child);\n    });\n  }\n\n  updateLines = () => {\n    const context = this.canvasDOMElement.getContext('2d');\n    const collisionScope = this.canvas.collisionScope;\n    if (context && collisionScope) {\n      context.clearRect(\n        0,\n        0,\n        this.canvasDOMElement.width,\n        this.canvasDOMElement.height\n      );\n      context.strokeStyle = '#f00';\n      context.beginPath();\n      collisionScope.drawBVH(context);\n      context.stroke();\n    }\n  };\n\n  deactivate() {\n    this.dispose();\n    this.canvas.removeFunction('showConstructionLines');\n    this.canvas.removeFunction('hideConstructionLines');\n    this.canvas.removeEventListener('setLayout', this.setDimensions);\n  }\n\n  showConstructionLines = () => {\n    this.constructionLinesWrapper.style.display = 'block';\n  };\n\n  setDimensions = () => {\n    this.canvasDOMElement.setAttribute(\n      'height',\n      this.canvas.getBoundingClientRect().height.toString() + 'px'\n    );\n    this.canvasDOMElement.setAttribute(\n      'width',\n      this.canvas.getBoundingClientRect().width.toString() + 'px'\n    );\n  };\n  hideConstructionLines = () => {\n    this.constructionLinesWrapper.style.display = 'none';\n  };\n}\n","import { Canvas, IPlugin } from '../../';\n\nexport default class ScrollMousePositionPlugin implements IPlugin {\n  name = 'ScrollMousePositionPlugin';\n  canvas!: Canvas;\n  dispose: any;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n\n  activate() {\n    const wrapperLayer = document.createElement('div');\n    this.dispose = this.canvas.addDomToViewport(wrapperLayer);\n\n    const positionElement = document.createElement('div');\n    wrapperLayer.appendChild(positionElement);\n    positionElement.style.position = 'absolute';\n    positionElement.style.top = '10px';\n    positionElement.style.right = '10px';\n    positionElement.style.height = '95px';\n    positionElement.style.width = '245px';\n    positionElement.style.pointerEvents = 'none';\n    positionElement.style.backgroundColor = 'skyblue';\n    positionElement.style.zIndex = '10';\n    let mousePosWorldNode = document.createTextNode(\n      ` Mouse World: {x:0, y:0} `\n    );\n    positionElement.appendChild(mousePosWorldNode);\n    positionElement.appendChild(document.createElement('br'));\n    let mousePosViewportNode = document.createTextNode(\n      `Mouse Viewport: {x: 0, y:0} `\n    );\n    positionElement.appendChild(mousePosViewportNode);\n\n    positionElement.appendChild(document.createElement('br'));\n    let pagePosPageNode = document.createTextNode(`Mouse Page: {x: 0, y:0} `);\n    positionElement.appendChild(pagePosPageNode);\n    positionElement.appendChild(document.createElement('br'));\n\n    let scroll = this.canvas.getScroll();\n    let scrollPosNode = document.createTextNode(\n      `Scroll: {x:${scroll.x}, y:${scroll.y}}`\n    );\n    positionElement.appendChild(scrollPosNode);\n    positionElement.appendChild(document.createElement('br'));\n\n    let zoom = this.canvas.getZoom();\n    let zoomNode = document.createTextNode(`Zoom: ${Number(zoom.toFixed(2))}`);\n    positionElement.appendChild(zoomNode);\n\n    this.canvas.on('scroll', () => {\n      scroll = this.canvas.getScroll();\n      scrollPosNode.nodeValue = `Scroll: {x:${Number(\n        scroll.x.toFixed(2)\n      )}, y:${Number(scroll.y.toFixed(2))}}`;\n    });\n    this.canvas.on('zoom', (e: any) => {\n      zoom = this.canvas.getZoom();\n      zoomNode.nodeValue = `Zoom: ${Number(zoom.toFixed(2))}`;\n    });\n    this.canvas.addEventListener('mousemove', (e: any) => {\n      mousePosWorldNode.nodeValue = `Mouse W: {x:${Number(\n        e.worldX.toFixed(2)\n      )}, y:${Number(e.worldY.toFixed(2))}}`;\n      mousePosViewportNode.nodeValue = `Mouse VP: {x:${Number(\n        e.viewportX.toFixed(2)\n      )}, y:${Number(e.viewportY.toFixed(2))}}`;\n\n      pagePosPageNode.nodeValue = `Mouse P: {x:${Number(\n        e.pageX.toFixed(2)\n      )}, y:${Number(e.pageY.toFixed(2))}}`;\n    });\n  }\n\n  deactivate() {\n    this.dispose();\n  }\n}\n","import { Box } from '../types';\nimport { round } from 'lodash';\nexport function isContained(axis: string, box: Box, helperBox: Box): boolean {\n  if (axis === 'x') {\n    const leftContained = box.x <= helperBox.x;\n    const rightContained =\n      round(box.x + box.width, 2) >= round(helperBox.x + helperBox.width, 2);\n    if (leftContained && rightContained) {\n      return true;\n    }\n  }\n\n  if (axis === 'y') {\n    const topContained = box.y <= helperBox.y;\n    const bottomContained =\n      round(box.y + box.height, 2) >= round(helperBox.y + helperBox.height, 2);\n    if (topContained && bottomContained) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function isAlignedonAxis(axis: string, box: any, helperBox: any) {\n  if (axis === 'x') {\n    if (\n      helperBox.y > box.y + box.height ||\n      box.y > helperBox.y + helperBox.height\n    ) {\n      return false;\n    }\n    return true;\n  } else if (axis === 'y') {\n    if (\n      helperBox.x > box.x + box.width ||\n      box.x > helperBox.x + helperBox.width\n    ) {\n      return false;\n    }\n    return true;\n  }\n  return false;\n}\n\nexport function getDirection(axis: string, box: Box, helperBox: Box): string {\n  if (axis === 'x') {\n    if (helperBox.x > box.x) {\n      return 'left';\n    }\n    return 'right';\n  } else if (axis === 'y') {\n    if (helperBox.y > box.y) {\n      return 'top';\n    }\n    return 'bottom';\n  }\n  return 'No Axis';\n}\n","import { PropTypes, Box } from '../types';\nimport { isContained, isAlignedonAxis, getDirection } from '../utils';\n\nconst getLeftEnd = (xContained: boolean, yContained: boolean, box: Box) => {\n  if (xContained && yContained) {\n    return box.x;\n  }\n  return box.x + box.width;\n};\nconst getLeftWidth = (\n  xContained: boolean,\n  yContained: boolean,\n  box: Box,\n  helperBox: Box\n) => {\n  if (xContained && yContained) {\n    return helperBox.x - box.x;\n  }\n  return helperBox.x - box.x - box.width;\n};\nconst getTop = (helperBox: Box) => {\n  return helperBox.y + Math.floor(helperBox.height / 2);\n};\n\nconst getRightEnd = (helperBox: Box) => {\n  return helperBox.x + helperBox.width;\n};\n\nconst getRightWidth = (\n  xContained: boolean,\n  yContained: boolean,\n  box: Box,\n  helperBox: Box\n) => {\n  if (xContained && yContained) {\n    return box.x + box.width - (helperBox.x + helperBox.width);\n  }\n  return box.x - helperBox.x - helperBox.width;\n};\n\nconst drawXLines = (props: PropTypes) => {\n  let { box, helperBox } = props;\n  let xContained = isContained('x', box, helperBox);\n  let yContained = isContained('y', box, helperBox);\n  let xAligned = isAlignedonAxis('x', box, helperBox);\n  let leftAligned = false;\n  let rightAligned = false;\n  let direction = getDirection('x', box, helperBox);\n  if (xAligned) {\n    if (direction === 'left') {\n      leftAligned = true;\n    } else if (direction === 'right') {\n      rightAligned = true;\n    }\n  }\n  let leftEnd = getLeftEnd(xContained, yContained, props.box);\n  let leftWidth = getLeftWidth(\n    xContained,\n    yContained,\n    props.box,\n    props.helperBox\n  );\n  let top = getTop(props.helperBox);\n  let rightEnd = getRightEnd(props.helperBox);\n  let rightWidth = getRightWidth(\n    xContained,\n    yContained,\n    props.box,\n    props.helperBox\n  );\n  let leftDistance =\n    xContained && yContained\n      ? helperBox.x - box.x\n      : helperBox.x - box.x - box.width;\n  let rightDistance =\n    xContained && yContained\n      ? box.x + box.width - (helperBox.x + helperBox.width)\n      : box.x - helperBox.x - helperBox.width;\n  let leftShow =\n    (leftAligned || (xContained && yContained)) && leftDistance > 0;\n  let rightShow =\n    (rightAligned || (xContained && yContained)) && rightDistance > 0;\n  const lines = [];\n  if (leftShow) {\n    leftDistance = Math.round(leftDistance);\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'y',\n        leftEnd,\n        'measurementXLine1-edge',\n        top - 2.5,\n        top + 3,\n        false\n      )\n    );\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'x',\n        top,\n        'measurementXLine1',\n        leftEnd,\n        leftEnd + leftWidth,\n        false,\n        leftDistance\n      )\n    );\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'y',\n        leftEnd + leftWidth - 1,\n        'measurementXLine1-edge',\n        top - 2.5,\n        top + 3,\n        false\n      )\n    );\n  }\n  if (rightShow) {\n    rightDistance = Math.round(rightDistance);\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'y',\n        rightEnd,\n        'measurementXLine1-edge',\n        top - 2.5,\n        top + 3,\n        false\n      )\n    );\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'x',\n        top,\n        'measurementXLine2',\n        rightEnd,\n        rightWidth + rightEnd,\n        false,\n        rightDistance\n      )\n    );\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'y',\n        rightWidth + rightEnd - 1,\n        'measurementXLine1-edge',\n        top - 2.5,\n        top + 3,\n        false\n      )\n    );\n  }\n  return lines;\n};\n\nexport default drawXLines;\n","import { PropTypes, Box } from '../types';\nimport { isContained, isAlignedonAxis, getDirection } from '../utils';\n\nconst getTopEnd = (xContained: boolean, yContained: boolean, box: Box) => {\n  if (xContained && yContained) {\n    return box.y;\n  }\n  return box.y + box.height;\n};\n\nconst getTopHeight = (\n  xContained: boolean,\n  yContained: boolean,\n  box: Box,\n  helperBox: Box\n) => {\n  if (xContained && yContained) {\n    return helperBox.y - box.y;\n  }\n  return helperBox.y - box.y - box.height;\n};\n\nconst getLeft = (helperBox: Box) => {\n  return helperBox.x + Math.floor(helperBox.width / 2);\n};\n\nconst getBottomEnd = (helperBox: Box) => {\n  return helperBox.y + helperBox.height;\n};\n\nconst getBottomHeight = (\n  xContained: boolean,\n  yContained: boolean,\n  box: Box,\n  helperBox: Box\n) => {\n  if (xContained && yContained) {\n    return box.y + box.height - (helperBox.y + helperBox.height);\n  }\n  return box.y - helperBox.y - helperBox.height;\n};\n\nconst drawYLines = (props: PropTypes) => {\n  let { box, helperBox } = props;\n  let xContained = isContained('x', box, helperBox);\n  let yContained = isContained('y', box, helperBox);\n  let yAligned = isAlignedonAxis('y', box, helperBox);\n  let topAligned = false;\n  let bottomAligned = false;\n  let direction = getDirection('y', box, helperBox);\n  if (yAligned) {\n    if (direction === 'top') {\n      topAligned = true;\n    } else if (direction === 'bottom') {\n      bottomAligned = true;\n    }\n  }\n  let topEnd = getTopEnd(xContained, yContained, props.box);\n  let topHeight = getTopHeight(\n    xContained,\n    yContained,\n    props.box,\n    props.helperBox\n  );\n  let left = getLeft(props.helperBox);\n  let bottomEnd = getBottomEnd(props.helperBox);\n  let bottomHeight = getBottomHeight(\n    xContained,\n    yContained,\n    props.box,\n    props.helperBox\n  );\n\n  let topDistance =\n    xContained && yContained\n      ? helperBox.y - box.y\n      : helperBox.y - box.y - box.height;\n  let topShow = (topAligned || (xContained && yContained)) && topDistance > 0;\n\n  let bottomDistance =\n    xContained && yContained\n      ? box.y + box.height - (helperBox.y + helperBox.height)\n      : box.y - helperBox.y - helperBox.height;\n\n  let bottomShow =\n    (bottomAligned || (xContained && yContained)) && bottomDistance > 0;\n  const lines = [];\n  if (topShow) {\n    topDistance = Math.round(topDistance);\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'x',\n        topEnd,\n        'measurementXLine1-edge',\n        left - 2.5,\n        left + 3,\n        false\n      )\n    );\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'y',\n        left,\n        'measurementYLine1',\n        topEnd,\n        topEnd + topHeight,\n        false,\n        topDistance\n      )\n    );\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'x',\n        topEnd + topHeight - 1,\n        'measurementXLine1-edge',\n        left - 2.5,\n        left + 3,\n        false\n      )\n    );\n  }\n  if (bottomShow) {\n    bottomDistance = Math.round(bottomDistance);\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'x',\n        bottomEnd,\n        'measurementXLine1-edge',\n        left - 2.5,\n        left + 3,\n        false\n      )\n    );\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'y',\n        left,\n        'measurementYLine2',\n        bottomEnd,\n        bottomEnd + bottomHeight,\n        false,\n        bottomDistance\n      )\n    );\n    lines.push(\n      props.canvas.executeFunction(\n        'drawLine',\n        'x',\n        bottomEnd + bottomHeight - 1,\n        'measurementXLine1-edge',\n        left - 2.5,\n        left + 3,\n        false\n      )\n    );\n  }\n  return lines;\n};\n\nexport default drawYLines;\n","import { Canvas } from '../../';\nimport { IPlugin, Layer } from '../../';\nimport drawXLines from './components/XLines';\nimport drawYLines from './components/YLines';\nimport { get } from 'lodash';\nimport { Box } from './types';\n\nexport default class MeasurementLinesPlugin implements IPlugin {\n  name = 'MeasurementLinesPlugin';\n  namespace = 'MeasurementLines';\n  canvas!: Canvas;\n  dispose: any;\n  show: boolean = false;\n  lines: Array<any> = [];\n  currentHoveredLayer: any;\n  temporarilyHidden: boolean = false;\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n  display() {\n    if (this.show) {\n      const hoveredLayers = this.canvas.hoveredLayers.filter(\n        (layer: Layer) => layer.type !== 'canvas'\n      );\n      const emptyBox = { x: 0, y: 0, height: 0, width: 0 };\n      let box: Box = emptyBox;\n      let helperBox: Box = emptyBox;\n      let hoveredDims;\n      let parentHoveredLayer;\n      if (hoveredLayers.length) {\n        hoveredDims = this.canvas.getBoundingBox([hoveredLayers[0]]);\n        this.currentHoveredLayer = hoveredLayers[0];\n        parentHoveredLayer = get(hoveredLayers, '[0].parent');\n      }\n      if (this.canvas.selectedLayers.length && hoveredDims) {\n        helperBox = this.canvas.getBoundingBox(this.canvas.selectedLayers);\n        box = hoveredDims;\n      } else if (\n        parentHoveredLayer &&\n        parentHoveredLayer.type !== 'canvas' &&\n        hoveredDims\n      ) {\n        helperBox = hoveredDims;\n        box = this.canvas.getBoundingBox([parentHoveredLayer]);\n      } else if (this.canvas.selectedLayers.length) {\n        helperBox = this.canvas.getBoundingBox(this.canvas.selectedLayers);\n        let parent = get(this.canvas, 'selectedLayers[0].parent');\n        box =\n          parent && parent.type !== 'canvas'\n            ? this.canvas.getBoundingBox([parent])\n            : emptyBox;\n      }\n      const xLines = drawXLines({\n        box,\n        helperBox,\n        canvas: this.canvas,\n      });\n      const yLines = drawYLines({\n        box,\n        helperBox,\n        canvas: this.canvas,\n      });\n      if (this.lines && this.lines.length > 0) {\n        this.lines.forEach(line => {\n          line.parentNode.removeChild(line);\n        });\n        this.lines = [];\n      }\n      this.lines = [...xLines, ...yLines];\n    }\n  }\n  showLines() {\n    this.show = true;\n    this.temporarilyHidden = false;\n    this.display();\n  }\n  hideLines() {\n    this.show = false;\n    if (this.lines && this.lines.length > 0) {\n      this.lines.forEach(line => {\n        line.parentNode.removeChild(line);\n      });\n      this.lines = [];\n    }\n    this.currentHoveredLayer = undefined;\n  }\n  activate() {\n    this.canvas.addFunction(\n      `${this.namespace}.show`,\n      this.showLines.bind(this)\n    );\n    this.canvas.addFunction(\n      `${this.namespace}.hide`,\n      this.hideLines.bind(this)\n    );\n    this.canvas.addEventListener('keyUp', (data: any) => {\n      let event = data.originalEvent ? data.originalEvent : data;\n      if (event.keyCode === 18) {\n        this.temporarilyHidden = false;\n        this.hideLines();\n      }\n    });\n    this.canvas.addEventListener('blur', (data: any) => {\n      this.hideLines();\n    });\n    this.canvas.addEventListener('keyDown', (data: any) => {\n      let event = data.originalEvent ? data.originalEvent : data;\n      if (event.keyCode === 18) {\n        this.showLines();\n      }\n    });\n    this.canvas.on('mouseEventsBlocked', () => {\n      if (this.canvas.mouseEventsBlocked && this.show) {\n        this.temporarilyHidden = true;\n        this.hideLines();\n      } else if (this.temporarilyHidden) {\n        this.temporarilyHidden = false;\n        this.showLines();\n      }\n    });\n    this.canvas.on('hoveredLayers', () => {\n      if (\n        this.show &&\n        this.canvas.hoveredLayers.length > 0 &&\n        this.canvas.hoveredLayers[0].type !== 'canvas' &&\n        this.canvas.hoveredLayers[0] !== this.currentHoveredLayer\n      ) {\n        this.display();\n      }\n    });\n  }\n\n  deactivate() {\n    this.canvas.removeFunction(`${this.namespace}.show`);\n    this.canvas.removeFunction(`${this.namespace}.hide`);\n    this.dispose();\n  }\n}\n","import { Event, Layer } from './../../..';\n\nexport default class MouseRectEvent extends Event {\n  payload: Array<Layer>;\n  constructor(\n    name: string,\n    target: Layer,\n    payload: Array<Layer>,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.payload = payload;\n  }\n}\n","import { Canvas, Layer } from '../../';\nimport { IPlugin } from '../../';\nimport MouseRectEvent from './events';\nimport { IDimension } from 'interfaces';\n\nexport default class MouseRectPlugin implements IPlugin {\n  name = 'MouseRectPlugin';\n  namespace = 'MouseRect';\n  canvas!: Canvas;\n  dispose: any;\n  dragStarted: boolean = false;\n  dragStart: any = {\n    x: 0,\n    y: 0,\n  };\n  dims: IDimension = { x: 0, y: 0, height: 0, width: 0 };\n  wrapperLayer: any;\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n  getLayers = () => {\n    const hitRectResult = this.canvas.getHitRectResult(\n      this.dims.x,\n      this.dims.y,\n      this.dims.width,\n      this.dims.height\n    );\n    return this.canvas.executeMiddleware(\n      'MouseRect.getHitRectResult',\n      hitRectResult,\n      (hitRectResult: Array<Layer>) => {\n        return hitRectResult;\n      }\n    );\n  };\n  activate() {\n    let zoom = this.canvas.getZoom();\n\n    this.wrapperLayer = document.createElement('div');\n\n    this.dispose = this.canvas.addDomToWorld(this.wrapperLayer, true, 105);\n\n    this.wrapperLayer.style.position = 'absolute';\n    this.wrapperLayer.style.border = `${1 /\n      this.canvas.getZoom()}px solid #25B9D1`;\n    this.wrapperLayer.style.top = '0px';\n    this.wrapperLayer.style.left = '0px';\n    this.wrapperLayer.style.height = '0px';\n    this.wrapperLayer.style.width = '0px';\n    this.wrapperLayer.style.display = 'none';\n    this.wrapperLayer.style.backgroundColor = 'rgba(121,121,121,0.09)';\n    this.wrapperLayer.style.pointerEvents = 'none';\n\n    this.canvas.addEventListener('dragStart', (event: any) => {\n      return this.canvas.executeMiddleware(\n        'MouseRect.dragStart',\n        event,\n        (event: any) => {\n          this.dragStarted = true;\n          this.dragStart = {\n            x: event.worldX,\n            y: event.worldY,\n          };\n\n          this.wrapperLayer.style.display = '';\n          this.wrapperLayer.style.left = this.dragStart.x + 'px';\n          this.wrapperLayer.style.top = this.dragStart.y + 'px';\n        }\n      );\n    });\n    this.canvas.addEventListener('drag', (event: any) => {\n      if (this.dragStarted) {\n        this.dims.x =\n          event.worldX < this.dragStart.x ? event.worldX : this.dragStart.x;\n        this.dims.y =\n          event.worldY < this.dragStart.y ? event.worldY : this.dragStart.y;\n        this.dims.height = Math.abs(event.worldY - this.dragStart.y);\n        this.dims.width = Math.abs(event.worldX - this.dragStart.x);\n        this.wrapperLayer.style.left = this.dims.x + 'px';\n        this.wrapperLayer.style.top = this.dims.y + 'px';\n        this.wrapperLayer.style.height = this.dims.height + 'px';\n        this.wrapperLayer.style.width = this.dims.width + 'px';\n\n        const drawEvent = new MouseRectEvent(\n          `${this.namespace}.draw`,\n          this.canvas,\n          this.getLayers(),\n          this.canvas\n        );\n        this.canvas.dispatchEvent(`${this.namespace}.draw`, drawEvent);\n      }\n    });\n\n    this.canvas.addEventListener('dragEnd', (event: any) => {\n      if (this.dragStarted) {\n        this.wrapperLayer.style.top = '0px';\n        this.wrapperLayer.style.left = '0px';\n        this.wrapperLayer.style.height = '0px';\n        this.wrapperLayer.style.width = '0px';\n        this.wrapperLayer.style.display = 'none';\n        const drawEndEvent = new MouseRectEvent(\n          `${this.namespace}.drawEnd`,\n          this.canvas,\n          this.getLayers(),\n          this.canvas\n        );\n        this.canvas.dispatchEvent(`${this.namespace}.drawEnd`, drawEndEvent);\n        this.dragStarted = false;\n      }\n    });\n    this.canvas.on('zoom', (e: any) => {\n      let zoom = this.canvas.getZoom();\n\n      this.wrapperLayer.style.border = `${1 / zoom}px solid #25B9D1`;\n    });\n  }\n\n  deactivate() {\n    this.dispose();\n  }\n}\n","import * as React from 'react';\nimport {\n  Editor,\n  EditorState,\n  ContentState,\n  getDefaultKeyBinding,\n  Modifier,\n} from 'draft-js';\nimport { Layer, TextEditorEvent } from '../../';\nimport './Draft.css';\nimport { IDimensionWithRoot } from 'interfaces';\nimport { isNil } from 'lodash';\n\ntype propType = {\n  layer: Layer;\n  onEvent: (event: TextEditorEvent) => void;\n};\n\nexport default class TextEditor extends React.Component<propType, any> {\n  isBlurred: boolean = false;\n  text: string = '';\n  dims: IDimensionWithRoot = this.props.layer.getBoundingClientRect();\n  editorRef: any;\n  isText: boolean = this.props.layer.type === 'text';\n  isAuto: boolean =\n    this.props.layer &&\n    this.props.layer.layout &&\n    isNil(this.props.layer.layout.get('width'));\n  constructor(props: any) {\n    super(props);\n    this.text = this.isText\n      ? this.props.layer.innerText\n      : this.props.layer.props\n      ? this.props.layer.props.get('placeholder')\n      : ' ';\n    this.state = {\n      editorState: EditorState.moveFocusToEnd(\n        EditorState.createWithContent(\n          ContentState.createFromText(this.text || '')\n        )\n      ),\n    };\n  }\n  componentDidMount() {\n    this.onFocus();\n    document.addEventListener('keydown', this.handleNumpadEnter);\n    document.execCommand('selectAll', false, undefined);\n  }\n  isNumpadEnter(e: any) {\n    return e.key === 'Enter' && e.location === 3 && e.which === 13;\n  }\n  onBlur = () => {\n    this.isBlurred = true;\n    const event = new TextEditorEvent(\n      'onEditorBlur',\n      this.props.layer,\n      this.state.editorState.getCurrentContent().getPlainText(),\n      this.isBlurred\n    );\n    this.props.onEvent(event);\n  };\n\n  onFocus = () => {\n    this.isBlurred = false;\n    const event = new TextEditorEvent(\n      'onEditorFocus',\n      this.props.layer,\n      this.state.editorState.getCurrentContent().getPlainText()\n    );\n    this.props.onEvent(event);\n  };\n  handleNumpadEnter = (e: any) => {\n    if (this.isNumpadEnter(e)) {\n      this.onBlur();\n    }\n  };\n  removePositionalAttribute = (style: any) => {\n    let newStyle = { ...style };\n    delete newStyle['left'];\n    delete newStyle['top'];\n    delete newStyle['width'];\n    delete newStyle['height'];\n    delete newStyle['flex'];\n    delete newStyle['margin'];\n    delete newStyle['marginTop'];\n    delete newStyle['marginRight'];\n    delete newStyle['marginBottom'];\n    delete newStyle['marginLeft'];\n    if (!newStyle['fontFamily'] || newStyle['fontFamily'] === 'System') {\n      newStyle['fontFamily'] = 'system-ui';\n    }\n    return newStyle;\n  };\n  onChange = (editorState: any) => {\n    if (this.isBlurred) {\n      return;\n    }\n    if (editorState.getCurrentContent().getPlainText() !== this.text) {\n      const event = new TextEditorEvent(\n        'onEditorChange',\n        this.props.layer,\n        this.state.editorState.getCurrentContent().getPlainText(),\n        this.isBlurred\n      );\n      this.props.onEvent(event);\n    }\n    this.setState({ editorState });\n  };\n  myBlockStyleFn = (contentBlock: any) => {\n    const type = contentBlock.getType();\n    if (type === 'unstyled') {\n      return 'defaultTextStyle';\n    }\n    return '';\n  };\n  getStringStyle = (propertyName: string) => {\n    let property = this.props.layer.layout.isValidKey(propertyName)\n      ? this.props.layer.layout.get(propertyName)\n      : this.props.layer.style.get(propertyName);\n    return typeof property === 'number' ? property.toString() + 'px' : property;\n  };\n  handleTab = (event: any) => {\n    event.preventDefault();\n    if (this.isBlurred) {\n      return;\n    }\n    let newContentState = Modifier.replaceText(\n      this.state.editorState.getCurrentContent(),\n      this.state.editorState.getSelection(),\n      '\\t'\n    );\n    const editorState = EditorState.push(\n      this.state.editorState,\n      newContentState,\n      'insert-characters'\n    );\n    if (editorState.getCurrentContent().getPlainText() !== this.text) {\n      const event = new TextEditorEvent(\n        'onEditorChange',\n        this.props.layer,\n        this.state.editorState.getCurrentContent().getPlainText(),\n        this.isBlurred\n      );\n      this.props.onEvent(event);\n    }\n    this.setState({ editorState });\n  };\n  handleKeyBinding = (event: any) => {\n    if (event.keyCode === 27) {\n      this.onBlur();\n    }\n    return getDefaultKeyBinding(event);\n  };\n  render() {\n    let style = this.removePositionalAttribute({\n      ...this.props.layer.style.getAll(),\n      ...this.props.layer.layout.getAll(),\n    });\n    return (\n      <div\n        className=\"editorWrapper\"\n        style={{\n          ...style,\n          display: '',\n          visibility: 'visible',\n          position: 'absolute',\n          transform: this.props.layer.rotation\n            ? `rotate(${this.props.layer.rotation}deg)`\n            : undefined,\n          top:\n            this.dims.rootY +\n            (!this.isText\n              ? this.dims.height / 2 - 7.6 // No clue how, but it works\n              : 0),\n          left: this.dims.rootX,\n          height: this.dims.height,\n          width: this.isAuto ? undefined : this.dims.width,\n          caretColor: this.isText ? style.color || 'black' : 'grey',\n          color: this.isText ? style.color || 'black' : '#757575',\n          fontSize: style.fontSize ? parseInt(style.fontSize, 10) : 14,\n          lineHeight: this.getStringStyle('lineHeight') || 'normal',\n          letterSpacing: this.getStringStyle('letterSpacing'),\n          WebkitFontSmoothing: 'antialiased',\n        }}\n      >\n        <Editor\n          ref={(c: any) => {\n            this.editorRef = c;\n          }}\n          editorState={this.state.editorState}\n          onChange={this.onChange}\n          keyBindingFn={this.handleKeyBinding}\n          blockStyleFn={this.myBlockStyleFn}\n          handleReturn={(e: any, editorState: EditorState) =>\n            this.isNumpadEnter(e) ? 'handled' : 'not-handled'\n          }\n          onBlur={this.onBlur}\n          onFocus={this.onFocus}\n          onTab={this.handleTab}\n        />\n      </div>\n    );\n  }\n}\n","import * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Canvas, IPlugin, TextEditorEvent, Layer } from '../..';\nimport { IDimensionWithRoot, IContext } from 'interfaces';\nimport TextEditorRenderer from './TextEditorRenderer';\n\nexport default class TextEditorPlugin implements IPlugin {\n  name = 'TextEditorPlugin';\n  canvas!: Canvas;\n  dispose: any;\n  wrapperLayer: any;\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n  mountTextEditor(context: IContext, layer: Layer) {\n    if (layer && (layer.type == 'text' || layer.type == 'textInput')) {\n      // layer.setStyle('display', 'none');\n      layer.setStyle('visibility', 'hidden');\n      const dims: IDimensionWithRoot = this.canvas.getBoundingClientRect();\n      this.wrapperLayer.style.display = '';\n      this.wrapperLayer.style.top = dims.rootY + 'px';\n      this.wrapperLayer.style.left = dims.rootX + 'px';\n      this.wrapperLayer.style.height = dims.height + 'px';\n      this.wrapperLayer.style.width = dims.width + 'px';\n      ReactDOM.render(\n        <TextEditorRenderer\n          layer={layer}\n          onEvent={(event: TextEditorEvent) => {\n            if (event.name === 'onEditorChange' && event.target) {\n              event.target.dispatchEvent('setText', event);\n            } else if (event.name === 'onEditorBlur' && event.target) {\n              this.wrapperLayer.style.display = 'none';\n              // event.target.setStyle('display', '');\n              event.target.removeStyle('visibility');\n              event.target.dispatchEvent('setText', event);\n            }\n          }}\n        />,\n        this.wrapperLayer\n      );\n    }\n  }\n  unmountTextEditor(context: IContext) {\n    ReactDOM.unmountComponentAtNode(this.wrapperLayer);\n  }\n  activate() {\n    this.wrapperLayer = document.createElement('div');\n    this.dispose = this.canvas.addDomToWorld(this.wrapperLayer);\n    this.wrapperLayer.style.position = 'absolute';\n    this.wrapperLayer.style.top = '0';\n    this.wrapperLayer.style.left = '0';\n    this.wrapperLayer.style.height = '0';\n    this.wrapperLayer.style.width = '0';\n    this.wrapperLayer.style.display = 'none';\n    this.canvas.addFunction(\n      'TextEditorPlugin.mountEditor',\n      this.mountTextEditor.bind(this)\n    );\n    this.canvas.addFunction(\n      'TextEditorPlugin.unmountEditor',\n      this.unmountTextEditor.bind(this)\n    );\n  }\n\n  deactivate() {\n    this.canvas.removeFunction('TextEditorPlugin.mountEditor');\n    this.canvas.removeFunction('TextEditorPlugin.unmountEditor');\n    this.dispose();\n  }\n}\n","import * as React from 'react';\n//@ts-ignore\nimport paper from 'paper';\nimport {\n  getPaperPathFromPoints,\n  convertPaperPointToBxObj,\n} from '@builderx-core/conversions';\nimport { PathEvent, MouseEvent } from '../../';\nimport { get } from 'lodash';\n\ntype PathEditorProps = {\n  onEvent: (event: any) => void;\n  pathProps?: any;\n  newPath?: boolean;\n  bounds: any;\n  dimensions: any;\n  canvas: any;\n  layer: any;\n};\n\nexport default class PathEditor extends React.PureComponent<\n  PathEditorProps,\n  any\n> {\n  paper: any = paper;\n  path!: paper.Path | null;\n  segment!: paper.Segment | null | any;\n  tool!: paper.Tool | null;\n  handle!: string | null;\n  xFactor: number = 1;\n  yFactor: number = 1;\n  oldBounds: any;\n  isFirstClick: boolean = true;\n  onUpdate = (keys: any) => {\n    this.forceUpdate();\n  };\n  componentDidMount() {\n    const canvas = document.getElementById('path-editor-canvas');\n    if (!canvas) {\n      return;\n    }\n    this.props.canvas.on('zoom', this.onUpdate);\n    this.paper.setup(canvas as HTMLCanvasElement);\n    this.init();\n    let tool = new paper.Tool();\n    tool.onMouseDrag = this.onMouseDrag;\n    tool.onMouseDown = this.onMouseDown;\n    tool.onMouseUp = this.onMouseUp;\n    tool.onMouseMove = this.onMouseMove;\n    this.tool = tool;\n    this.paper.settings.handleSize = 7 / this.props.canvas.getZoom();\n    this.ready();\n  }\n\n  ready() {\n    let pointMode = '';\n    if (this.segment) {\n      if (this.segment.handleIn.isZero() || this.segment.handleOut.isZero()) {\n        pointMode = 'straight';\n      } else {\n        pointMode = 'disconnected';\n      }\n    }\n    const event = new PathEvent('pathEditorOnReady', this.props.layer, {\n      actions: {\n        deleteSelectedPoint: this.deleteSelectedPoint,\n        straightenSelectedPoint: this.straightenSelectedPoint,\n        disconnectSelectedPoint: this.disconnectSelectedPoint,\n        finishEditing: this.finishEditing,\n        closePath: this.closePath,\n      },\n      pointMode,\n    });\n    this.props.onEvent(event);\n  }\n\n  componentDidUpdate(prevProps: PathEditorProps) {\n    this.paper.settings.handleSize = 7 / this.props.canvas.getZoom();\n    this.init();\n  }\n\n  componentWillUnmount() {\n    if (this.tool) {\n      this.tool.remove();\n    }\n    this.pathEditorOnEnd(true);\n    this.paper.project.clear();\n    this.paper.project.remove();\n  }\n\n  init() {\n    let { layer, dimensions, newPath } = this.props;\n    let path: paper.Path | any;\n    if (newPath) {\n      path = new paper.Path();\n      this.segment = path.add(new paper.Point(0, 0));\n      path.selectedColor = '#A3A3A3';\n      path.strokeColor = '#A3A3A3';\n      path.strokeWidth = 1 / this.props.canvas.getZoom();\n      this.paper.project.clear();\n      let paperLayer = new paper.Layer([path]);\n      this.paper.project.addLayer(paperLayer);\n    } else {\n      if (this.path) {\n        this.path.remove();\n      }\n      this.isFirstClick = false;\n      let pathProps = layer.props.getAll();\n      let points = pathProps.points;\n      let isClosed = pathProps.isClosed;\n      let pathJSON = getPaperPathFromPoints(points, isClosed);\n      path = pathJSON;\n      this.xFactor = dimensions.width / path.bounds.width;\n      this.yFactor = dimensions.height / path.bounds.height;\n      this.oldBounds = path.bounds;\n      path.applyMatrix = true;\n      path.bounds.x = 0;\n      path.bounds.y = 0;\n      path.translate(new paper.Point(dimensions.rootX, dimensions.rootY));\n      path.scale(this.xFactor, this.yFactor, path.bounds.topLeft);\n      const rotation = this.getRotation();\n      if (rotation) {\n        path.rotate(rotation);\n      }\n      path.selectedColor = '#A3A3A3';\n      path.strokeColor = '#A3A3A3';\n      path.fillColor = pathProps.fill;\n      this.paper.project.clear();\n      let paperLayer = new paper.Layer([path]);\n      this.paper.project.addLayer(paperLayer);\n    }\n    path.selected = true;\n    //@ts-ignore\n    this.paper.view.draw();\n    this.paper.view.update();\n    this.path = path;\n  }\n\n  getRotation = () => {\n    // TODO: handle rotation here\n    // const rotation = get(\n    //   this.props.layer,\n    //   'domainCompiledRefs[0].renderCompiledRef.rotation'\n    // );\n    return 0;\n  };\n\n  finishEditing = () => {\n    if (this.segment) {\n      this.segment.remove();\n      this.segment = null;\n    }\n  };\n\n  closePath = () => {\n    this.finishEditing();\n    if (this.path) {\n      this.path.closePath();\n    }\n  };\n\n  deleteSelectedPoint = () => {\n    if (this.segment) {\n      this.segment.remove();\n      this.ready();\n    }\n  };\n\n  straightenSelectedPoint = () => {\n    if (this.segment) {\n      this.segment.clearHandles();\n      this.ready();\n    }\n  };\n\n  disconnectSelectedPoint = () => {\n    if (this.segment) {\n      if (this.segment.handleIn.isZero()) {\n        this.segment.smooth();\n      }\n      if (this.segment.handleOut.isZero()) {\n        this.segment.smooth();\n      }\n      this.ready();\n    }\n  };\n\n  emitUpdatedJSON = () => {\n    if (this.path) {\n      if (this.props.newPath) {\n        let tempPath = this.path.clone({ insert: false, deep: true });\n        tempPath.translate(\n          new paper.Point(-this.path.bounds.x, -this.path.bounds.y)\n        );\n\n        let convertedJSON = convertPaperPointToBxObj(tempPath);\n        const emitEvent = new PathEvent(\n          'pathEditorOnChange',\n          this.props.layer,\n          {\n            pathProps: convertedJSON,\n            bounds: this.path.bounds,\n          }\n        );\n        this.props.onEvent(emitEvent);\n      } else {\n        let tempPath = this.path.clone({ insert: false, deep: true });\n        tempPath.translate(\n          new paper.Point(-this.props.dimensions.x, -this.props.dimensions.y)\n        );\n        let tempPath2 = this.path.clone({ insert: false, deep: true });\n\n        const rotation = this.getRotation();\n        if (rotation) {\n          tempPath.rotate(-rotation);\n          tempPath2.rotate(-rotation);\n        }\n        tempPath.bounds = this.oldBounds;\n        let convertedJSON = convertPaperPointToBxObj(tempPath);\n        const emitEvent = new PathEvent(\n          'pathEditorOnChange',\n          this.props.layer,\n          {\n            pathProps: convertedJSON,\n            bounds: tempPath2.bounds,\n          }\n        );\n        this.props.onEvent(emitEvent);\n      }\n    }\n  };\n\n  render() {\n    return (\n      <canvas\n        width={this.props.bounds.width}\n        height={this.props.bounds.height}\n        style={{\n          cursor: 'crosshair',\n          position: 'absolute',\n          pointerEvents: 'auto',\n          // border: '2px solid red',\n        }}\n        id=\"path-editor-canvas\"\n      />\n    );\n  }\n\n  private onMouseUp = (event: paper.ToolEvent) => {\n    let { point } = event;\n    let canvasEvent = new MouseEvent(\n      'PaperEvent',\n      this.props.canvas,\n      (event as any).event\n    );\n    point.x = canvasEvent.worldX;\n    point.y = canvasEvent.worldY;\n    if (this.props.newPath && this.path) {\n      if (this.segment) {\n        this.segment.selected = false;\n      }\n      const hitResult = this.paper.project.hitTest(point, {\n        segments: true,\n        tolerance: 5,\n      });\n      if (\n        (hitResult &&\n          hitResult.segment &&\n          hitResult.segment.index === 0 &&\n          hitResult.segment.next) ||\n        get(event, 'event.detail') === 2\n      ) {\n        this.closePath();\n        this.emitUpdatedJSON();\n      } else {\n        this.segment = this.path.add(point);\n        this.segment.selected = true;\n      }\n    }\n    this.handle = null;\n  };\n  private onMouseDrag = (event: paper.ToolEvent) => {\n    let { point, downPoint } = event;\n    if (downPoint) {\n      let canvasEvent = new MouseEvent(\n        'PaperEvent',\n        this.props.canvas,\n        (event as any).event\n      );\n      point.x = canvasEvent.worldX;\n      point.y = canvasEvent.worldY;\n      if (this.props.newPath && this.segment) {\n        this.segment.handleIn = downPoint.subtract(point);\n        this.segment.handleOut = point.subtract(downPoint);\n      } else {\n        if (this.segment) {\n          switch (this.handle) {\n            case 'segment':\n              this.segment.point = point;\n              this.emitUpdatedJSON();\n              break;\n            case 'handle-in':\n              this.segment.handleIn = point.subtract(this.segment.point);\n              this.emitUpdatedJSON();\n              break;\n            case 'handle-out':\n              this.segment.handleOut = point.subtract(this.segment.point);\n              this.emitUpdatedJSON();\n              break;\n            default:\n              break;\n          }\n        }\n      }\n    }\n  };\n  private pathEditorOnEnd = (isLastUpdate: boolean = false) => {\n    if (!isLastUpdate) {\n      this.emitUpdatedJSON();\n    }\n    const emitEvent = new PathEvent('pathEditorOnEnd', this.props.layer);\n    this.props.onEvent(emitEvent);\n  };\n  private onMouseDown = (event: paper.ToolEvent) => {\n    if (this.isFirstClick) {\n      const emitEvent = new MouseEvent(\n        'pathEditor.selectParent',\n        this.props.canvas,\n        (event as any).event\n      );\n      this.props.onEvent(emitEvent);\n      this.isFirstClick = false;\n    }\n    if (this.path) {\n      let downPoint = event.downPoint;\n      let canvasEvent = new MouseEvent(\n        'PaperEvent',\n        this.props.canvas,\n        (event as any).event\n      );\n      downPoint.x = canvasEvent.worldX;\n      downPoint.y = canvasEvent.worldY;\n      if (!this.props.newPath) {\n        const hitResult = this.paper.project.hitTest(downPoint, {\n          stroke: true,\n          segments: true,\n          handles: true,\n          tolerance: 5,\n        });\n        if (this.segment) {\n          this.segment.selected = false;\n        }\n        if (hitResult) {\n          this.handle = hitResult.type;\n          switch (hitResult.type) {\n            case 'stroke':\n              if (hitResult.location) {\n                const { location } = hitResult;\n                const newCurve = location.curve.divideAt(location);\n                if (newCurve) {\n                  this.segment = newCurve.segment1;\n                  this.segment!.selected = true;\n                  this.handle = 'segment';\n                }\n              }\n              break;\n            case 'segment':\n            case 'handle-in':\n            case 'handle-out':\n              this.segment = hitResult.segment;\n              this.segment.selected = true;\n              break;\n            default:\n              break;\n          }\n          this.ready();\n        } else {\n          if (!this.path.contains(downPoint)) {\n            this.pathEditorOnEnd();\n          }\n        }\n      }\n    }\n  };\n  private onMouseMove = (event: paper.ToolEvent) => {\n    let { newPath } = this.props;\n    let { point } = event;\n    let canvasEvent = new MouseEvent(\n      'PaperEvent',\n      this.props.canvas,\n      (event as any).event\n    );\n    point.x = canvasEvent.worldX;\n    point.y = canvasEvent.worldY;\n    if (newPath && this.segment) {\n      this.segment.point.set(point);\n    }\n  };\n}\n","import * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Canvas, IPlugin, PathEvent } from '../..';\nimport { IDimensionWithRoot } from 'interfaces';\nimport PathEditorRenderer from './PathEditorRenderer';\n\nexport default class PathEditorPlugin implements IPlugin {\n  name = 'PathEditorPlugin';\n  nameSpace: string = 'PathEditor';\n  canvas!: Canvas;\n  dispose: any;\n  wrapperLayer: any;\n  selectedTool: string = 'pen';\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n\n  handlePathEditorEvents = (event: any) => {\n    const { payload, target, name } = event;\n    switch (name) {\n      case 'pathEditorOnReady':\n        const {\n          deleteSelectedPoint,\n          disconnectSelectedPoint,\n          straightenSelectedPoint,\n          finishEditing,\n          closePath,\n        } = payload.actions;\n        this.canvas.addFunction(\n          `${this.nameSpace}.deleteSelectedPoint`,\n          deleteSelectedPoint\n        );\n        this.canvas.addFunction(\n          `${this.nameSpace}.disconnectSelectedPoint`,\n          disconnectSelectedPoint\n        );\n        this.canvas.addFunction(\n          `${this.nameSpace}.straightenSelectedPoint`,\n          straightenSelectedPoint\n        );\n        this.canvas.addFunction(\n          `${this.nameSpace}.finishEditing`,\n          finishEditing\n        );\n        this.canvas.addFunction(`${this.nameSpace}.closePath`, closePath);\n        break;\n\n      case 'pathEditorOnChange':\n        const { pathProps, bounds } = payload;\n        let viewBox = `0 0 ${bounds.width} ${bounds.height}`;\n        let style = {\n          left: bounds.x,\n          top: bounds.y,\n          width: bounds.width,\n          height: bounds.height,\n          position: 'absolute',\n        };\n        if (this.selectedTool === 'path' && target) {\n          target.dispatchEvent(\n            `${this.nameSpace}.onEdit`,\n            new PathEvent(`${this.nameSpace}.onEdit`, target, {\n              viewBox,\n              points: pathProps.points,\n              style,\n              isClosed: pathProps.closed,\n            })\n          );\n        } else if (this.selectedTool === 'pen') {\n          this.canvas.dispatchEvent(\n            `${this.nameSpace}.addNew`,\n            new PathEvent(`${this.nameSpace}.addNew`, this.canvas, {\n              viewBox,\n              points: pathProps.points,\n              style,\n              isClosed: pathProps.closed,\n            })\n          );\n          this.hide();\n        }\n        break;\n      case 'pathEditorOnEnd':\n        this.hide();\n        target.setStyle('display', '');\n        this.canvas.dispatchEvent(\n          `${this.nameSpace}.isClosed`,\n          new PathEvent(`${this.nameSpace}.isClosed`, this.canvas)\n        );\n        break;\n      case 'pathEditor.selectParent':\n        this.canvas.dispatchEvent(`${this.nameSpace}.selectParent`, event);\n        break;\n      default:\n        break;\n    }\n  };\n\n  hide = () => {\n    ReactDOM.unmountComponentAtNode(this.wrapperLayer);\n    this.wrapperLayer.style.display = 'none';\n    this.canvas.removeFunction(`${this.nameSpace}.deleteSelectedPoint`);\n    this.canvas.removeFunction(`${this.nameSpace}.disconnectSelectedPoint`);\n    this.canvas.removeFunction(`${this.nameSpace}.straightenSelectedPoint`);\n    this.canvas.removeFunction(`${this.nameSpace}.finishEditing`);\n    this.canvas.removeFunction(`${this.nameSpace}.closePath`);\n  };\n  getScrollShift = () => {\n    const canvasScroll = this.canvas.getScroll();\n    const zoom = this.canvas.getZoom();\n    const viewPortLeftPos: number =\n      canvasScroll.x *\n      (this.canvas.layout.get('width') * zoom -\n        this.canvas.getViewport().width);\n    const viewPortTopPos: number =\n      canvasScroll.y *\n      (this.canvas.layout.get('height') * zoom -\n        this.canvas.getViewport().height);\n    return { x: viewPortLeftPos, y: viewPortTopPos };\n  };\n  handleEvent = (data: PathEvent) => {\n    this.selectedTool = data.payload.selectedTool;\n    let dims: IDimensionWithRoot;\n    const viewPort = this.canvas.getViewport();\n    const { x, y } = this.getScrollShift();\n    const zoom = this.canvas.getZoom();\n    // let bounds = {\n    //   x: x / zoom,\n    //   y: y / zoom,\n    //   rootX: x / zoom,\n    //   rootY: y / zoom,\n    //   height: viewPort.height / zoom,\n    //   width: viewPort.width / zoom,\n    // };\n    let bounds = this.canvas.getBoundingClientRect();\n    if (this.selectedTool === 'path') {\n      data.target.setStyle('display', 'none');\n      dims = data.target.getBoundingClientRect();\n    } else {\n      dims = bounds;\n    }\n    this.wrapperLayer.style.display = '';\n    // this.wrapperLayer.style.top = dims.rootY + 'px';\n    // this.wrapperLayer.style.left = dims.rootX + 'px';\n    this.wrapperLayer.style.height = dims.height + 'px';\n    this.wrapperLayer.style.width = dims.width + 'px';\n    // this.wrapperLayer.style.border = '2px solid green';\n    ReactDOM.render(\n      <PathEditorRenderer\n        onEvent={this.handlePathEditorEvents}\n        layer={this.selectedTool === 'pen' ? this.canvas : data.target}\n        newPath={this.selectedTool === 'pen'}\n        bounds={{\n          left: bounds.x,\n          top: bounds.y,\n          width: bounds.width / this.canvas.getZoom(),\n          height: bounds.height / this.canvas.getZoom(),\n        }}\n        canvas={this.canvas}\n        dimensions={dims}\n      />,\n      this.wrapperLayer\n    );\n  };\n  activate() {\n    this.wrapperLayer = document.createElement('div');\n    this.dispose = this.canvas.addDomToWorld(this.wrapperLayer);\n    this.wrapperLayer.style.position = 'absolute';\n    this.wrapperLayer.style.top = '0';\n    this.wrapperLayer.style.left = '0';\n    this.wrapperLayer.style.height = '0';\n    this.wrapperLayer.style.width = '0';\n    this.wrapperLayer.style.display = 'none';\n    this.canvas.addFunction(\n      `${this.nameSpace}.open`,\n      (context: any, data: PathEvent) => {\n        this.handleEvent(data);\n      }\n    );\n    this.canvas.addFunction(\n      `${this.nameSpace}.mount`,\n      this.mountEditor.bind(this)\n    );\n    this.canvas.addFunction(`${this.nameSpace}.unmount`, this.hide.bind(this));\n  }\n  mountEditor(context: any, targetLayer: any) {\n    this.handleEvent(\n      new PathEvent('PathEditor.open', targetLayer, { selectedTool: 'path' })\n    );\n    this.canvas.dispatchEvent(\n      `${this.nameSpace}.isOpened`,\n      new PathEvent(`${this.nameSpace}.isOpened`, this.canvas)\n    );\n  }\n  deactivate() {\n    this.canvas.removeFunction(`${this.nameSpace}.open`);\n    this.canvas.removeFunction(`${this.nameSpace}.mount`);\n    this.canvas.removeFunction(`${this.nameSpace}.unmount`);\n    this.dispose();\n  }\n}\n","import * as React from 'react';\nimport { Layer, Gradient, Canvas } from '../../';\nimport { StopPoints } from '../../models/Gradient';\nimport LineSegmentSliderInput, { Stop } from 'line-segment-slider-input';\nimport {\n  IDimensionWithRoot,\n  IDimensionWithRotation,\n  IPosition,\n} from 'interfaces';\n\ntype propType = {\n  layer: Layer;\n  dims: IDimensionWithRoot & IDimensionWithRotation;\n  gradient: Gradient;\n  canvas: Canvas;\n  zoom: number;\n  scroll: IPosition;\n  onChange: (\n    gradient: LineSegmentGradient,\n    type: '' | 'Skip' | 'Forget'\n  ) => void;\n  onClickOutside: (e: any) => void;\n  onWrapperMouseDown: (e: any) => void;\n  onWrapperContexMenu: (e: any) => void;\n  onWrapperDoubleClick: (e: any) => void;\n  onWrapperMouseOut: (e: any) => void;\n  onWrapperDrop: (e: any) => void;\n  onDragOver: (e: any) => void;\n  onWrapperMouseMove: (e: any) => void;\n  onWrapperMouseUp: (e: any) => void;\n};\n\nexport type LineSegmentGradient = {\n  from: number[];\n  to: number[];\n  stops: Stop[];\n  activeIndex: number;\n  gradientType: 'LinearGradient' | 'RadialGradient' | 'AngularGradient';\n};\n\nexport const getLineSegmentObject = (gradient: Gradient) => {\n  let stops: Array<Stop> = [];\n  gradient.stops.map(stop => {\n    stops.push({\n      position: stop.offset,\n      color: stop.stopColor,\n    });\n  });\n  return {\n    from: [gradient.from.x, gradient.from.y],\n    to: [gradient.to.x, gradient.to.y],\n    stops,\n    activeIndex: gradient.activeIndex,\n    gradientType: gradient.gradientType,\n  };\n};\n\nexport const getGradientFromLineSegmentObject = (\n  gradient: LineSegmentGradient\n) => {\n  let stops: Array<StopPoints> = [];\n  gradient.stops.map((stop: Stop) => {\n    stops.push({\n      offset: stop.position,\n      stopColor: stop.color,\n    });\n  });\n  return {\n    from: { x: gradient.from[0], y: gradient.from[1] },\n    to: { x: gradient.to[0], y: gradient.to[1] },\n    stops,\n    activeIndex: gradient.activeIndex,\n    gradientType: gradient.gradientType,\n  };\n};\n\nexport default class GradientEditorRenderer extends React.Component<\n  propType,\n  any\n> {\n  constructor(props: propType) {\n    super(props);\n    this.state = {\n      activeIndex: props.gradient.activeIndex,\n      ...getLineSegmentObject(props.gradient),\n    };\n  }\n  componentDidMount() {\n    const { canvas } = this.props;\n    canvas.addFunction(\n      'GradientEditor.changeStopColor',\n      (context: any, payload: any) => {\n        let newStops: Stop[] = this.state.stops;\n        newStops[this.state.activeIndex].color = payload.color;\n        this.setState({ stops: newStops });\n        this.props.onChange({ ...this.state } as LineSegmentGradient, 'Skip');\n      }\n    );\n    canvas.addFunction(\n      'GradientEditor.change',\n      (context: any, gradient: Gradient) => {\n        if (gradient) {\n          const lineSegmentObj = getLineSegmentObject(gradient);\n          this.setState({\n            ...lineSegmentObj,\n          });\n        }\n      }\n    );\n  }\n  handleMove = (type: string, handle: number[] | Stop[]) => {\n    if (type === 'from') {\n      this.props.onChange(\n        {\n          ...this.state,\n          from: handle,\n        } as LineSegmentGradient,\n        'Skip'\n      );\n      this.setState({ from: handle });\n    } else if (type === 'to') {\n      this.props.onChange(\n        {\n          ...this.state,\n          to: handle,\n        } as LineSegmentGradient,\n        'Skip'\n      );\n      this.setState({ to: handle });\n    } else {\n      this.props.onChange(\n        {\n          ...this.state,\n          stops: handle,\n        } as LineSegmentGradient,\n        'Skip'\n      );\n      this.setState({ stops: handle });\n    }\n    return null;\n  };\n  removeHandle = () => {\n    if (this.state.activeIndex) {\n      let stops = this.state.stops;\n      if (\n        !(\n          this.state.activeIndex === 0 ||\n          this.state.activeIndex === stops.length - 1\n        )\n      ) {\n        stops.splice(this.state.activeIndex, 1);\n      }\n\n      this.setState({ stops });\n      this.props.onChange({ ...this.state } as LineSegmentGradient, '');\n    }\n  };\n\n  changeIndex = (activeIndex: number) => {\n    this.setState({ activeIndex });\n    this.props.onChange(\n      { ...this.state, activeIndex } as LineSegmentGradient,\n      'Skip'\n    );\n  };\n  handleDragStart = () => {\n    this.props.onChange({ ...this.state } as LineSegmentGradient, 'Forget');\n  };\n  handleDragEnd = () => {\n    this.props.onChange({ ...this.state } as LineSegmentGradient, '');\n  };\n  render() {\n    const { props, state } = this;\n    const { dims, zoom, scroll } = props;\n    return (\n      <LineSegmentSliderInput\n        //@ts-ignore\n        x={dims.rootX}\n        y={dims.rootY}\n        width={dims.width}\n        height={dims.height}\n        from={state.from}\n        to={state.to}\n        stops={state.stops}\n        index={state.activeIndex}\n        zoom={zoom}\n        rotation={dims.rotation}\n        scroll={scroll}\n        changeIndex={this.changeIndex}\n        handleMove={this.handleMove}\n        removeHandle={this.removeHandle}\n        onClickOutside={this.props.onClickOutside}\n        onWrapperMouseDown={this.props.onWrapperMouseDown}\n        onWrapperContexMenu={this.props.onWrapperContexMenu}\n        onWrapperDoubleClick={this.props.onWrapperDoubleClick}\n        onWrapperMouseOut={this.props.onWrapperMouseOut}\n        onWrapperDrop={this.props.onWrapperDrop}\n        onDragOver={this.props.onDragOver}\n        onWrapperMouseMove={this.props.onWrapperMouseMove}\n        onWrapperMouseUp={this.props.onWrapperMouseUp}\n        onDragStart={this.handleDragStart}\n        onDragEnd={this.handleDragEnd}\n      />\n    );\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\n\ntype CommandParams = {\n  [key: string]: any;\n};\n\nexport default class CommandEvent extends Event {\n  commandParams!: CommandParams;\n  type: '' | 'Skip' | 'Forget';\n  constructor(\n    name: string,\n    target: Layer,\n    commandParams: CommandParams,\n    currentTarget?: Layer,\n    type?: '' | 'Skip' | 'Forget'\n  ) {\n    super(name, target, currentTarget);\n    this.commandParams = commandParams;\n    this.type = type || '';\n  }\n}\n","import * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport {\n  Canvas,\n  IPlugin,\n  Layer,\n  Gradient,\n  MouseEvent as DesignerMouseEvent,\n} from '../..';\nimport { IDimensionWithRoot, IDimensionWithRotation } from 'interfaces';\nimport GradientEditorRenderer, {\n  getGradientFromLineSegmentObject,\n  LineSegmentGradient,\n} from './EditorRenderer';\nimport CommandEvent from '../../events/CommandEvent';\nexport default class GradientEditorPlugin implements IPlugin {\n  name = 'GradientEditorPlugin';\n  nameSpace = 'GradientEditor';\n  gradient?: Gradient;\n  activeIndex?: number;\n  initialShift?: { x: number; y: number };\n  canvas!: Canvas;\n  dispose: any;\n  isOpened: boolean = false;\n  wrapperLayer?: any;\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n  getScrollShift = () => {\n    const canvasScroll = this.canvas.getScroll();\n    const zoom = this.canvas.getZoom();\n    const viewPortLeftPos: number =\n      canvasScroll.x *\n      (this.canvas.layout.get('width') * zoom -\n        this.canvas.getViewport().width);\n    const viewPortTopPos: number =\n      canvasScroll.y *\n      (this.canvas.layout.get('height') * zoom -\n        this.canvas.getViewport().height);\n    return { x: viewPortLeftPos, y: viewPortTopPos };\n  };\n  render = (layer: Layer) => {\n    this.gradient = layer.style.get('gradient');\n    if (!this.gradient) {\n      this.gradient = new Gradient(\n        'LinearGradient',\n        { x: 0.1, y: 0.1 },\n        { x: 0.9, y: 0.9 },\n        [\n          { stopColor: '#E70B0B', offset: 0 },\n          { stopColor: '#EEEEEE', offset: 1 },\n        ],\n        1\n      );\n      this.canvas.dispatchEvent(\n        'setStyleAttribute',\n        new CommandEvent('setStyleAttribute', this.canvas, {\n          layer,\n          key: 'gradient',\n          value: this.gradient.toJS(),\n          stylePropName: 'style',\n        })\n      );\n    }\n    const dims: IDimensionWithRoot &\n      IDimensionWithRotation = layer.getBoundingClientRect();\n    if (!this.wrapperLayer) {\n      return;\n    }\n    this.isOpened = true;\n    this.wrapperLayer.style.display = '';\n    let scroll = this.getScrollShift();\n    if (this.initialShift) {\n      scroll = {\n        x: scroll.x - this.initialShift.x,\n        y: scroll.y - this.initialShift.y,\n      };\n    }\n    ReactDOM.render(\n      <GradientEditorRenderer\n        layer={layer}\n        dims={dims}\n        zoom={this.canvas.getZoom()}\n        scroll={scroll}\n        canvas={this.canvas}\n        gradient={this.gradient}\n        onChange={(\n          gradient: LineSegmentGradient,\n          type: '' | 'Skip' | 'Forget'\n        ) => {\n          const gradientProps = getGradientFromLineSegmentObject(gradient);\n          this.gradient = new Gradient(\n            gradient ? gradient.gradientType : 'LinearGradient',\n            gradientProps.from,\n            gradientProps.to,\n            gradientProps.stops,\n            gradientProps.activeIndex\n          );\n          this.canvas.dispatchEvent(\n            'setStyleAttribute',\n            new CommandEvent(\n              'setStyleAttribute',\n              this.canvas,\n              {\n                layer,\n                key: 'gradient',\n                value: this.gradient.toJS(),\n                stylePropName: 'style',\n              },\n              undefined,\n              type\n            )\n          );\n        }}\n        onClickOutside={(e: any) => {\n          this.closeEditor();\n          this.canvas.dispatchEventOnHitLayer(\n            e.type,\n            new DesignerMouseEvent(e.type, this.canvas, e, this.canvas)\n          );\n        }}\n        onWrapperMouseDown={(e: any) => {\n          this.canvas.dispatchEventOnHitLayer(\n            e.type,\n            new DesignerMouseEvent(e.type, this.canvas, e, this.canvas)\n          );\n        }}\n        onWrapperContexMenu={(e: any) => {\n          this.canvas.dispatchEventOnHitLayer(\n            e.type,\n            new DesignerMouseEvent(e.type, this.canvas, e, this.canvas)\n          );\n        }}\n        onWrapperDoubleClick={(e: any) => {\n          this.canvas.dispatchEventOnHitLayer(\n            e.type,\n            new DesignerMouseEvent(e.type, this.canvas, e, this.canvas)\n          );\n        }}\n        onWrapperMouseOut={(e: any) => {\n          this.canvas.dispatchEventOnHitLayer(\n            e.type,\n            new DesignerMouseEvent(e.type, this.canvas, e, this.canvas)\n          );\n        }}\n        onWrapperDrop={(e: any) => {\n          this.canvas.dispatchEventOnHitLayer(\n            e.type,\n            new DesignerMouseEvent(e.type, this.canvas, e, this.canvas)\n          );\n        }}\n        onDragOver={(e: any) => {\n          this.canvas.dispatchEventOnHitLayer(\n            e.type,\n            new DesignerMouseEvent(e.type, this.canvas, e, this.canvas)\n          );\n        }}\n        onWrapperMouseMove={(e: any) => {\n          this.canvas.dispatchEventOnHitLayer(\n            e.type,\n            new DesignerMouseEvent(e.type, this.canvas, e, this.canvas)\n          );\n        }}\n        onWrapperMouseUp={(e: any) => {\n          this.canvas.dispatchEventOnHitLayer(\n            e.type,\n            new DesignerMouseEvent(e.type, this.canvas, e, this.canvas)\n          );\n        }}\n      />,\n      this.wrapperLayer\n    );\n  };\n  rerender = () => {\n    const layer = this.canvas.selectedLayers[0];\n    if (layer && this.isOpened) {\n      this.render(layer);\n    }\n  };\n  closeEditor = () => {\n    if (this.isOpened) {\n      ReactDOM.unmountComponentAtNode(this.wrapperLayer);\n      this.isOpened = false;\n      this.wrapperLayer.style.display = 'none';\n      this.canvas.off('zoom', this.rerender);\n      this.canvas.off('scroll', this.rerender);\n      this.canvas.removeFunction(`${this.nameSpace}.change`);\n      this.canvas.removeFunction(`${this.nameSpace}.changeStopColor`);\n    }\n  };\n  activate() {\n    this.wrapperLayer = document.createElement('div');\n    this.dispose = this.canvas.addDomToWorld(this.wrapperLayer);\n    this.wrapperLayer.style.position = 'absolute';\n    this.wrapperLayer.style.top = '0';\n    this.wrapperLayer.style.left = '0';\n    this.wrapperLayer.style.right = '0';\n    this.wrapperLayer.style.bottom = '0';\n    this.wrapperLayer.style.display = 'none';\n    this.wrapperLayer.style.zIndex = 101;\n    this.canvas.addEventListener(`${this.nameSpace}.open`, (data: any) => {\n      if (!this.isOpened) {\n        const layer = this.canvas.selectedLayers[0];\n        this.initialShift = this.getScrollShift();\n        if (layer) {\n          this.render(layer);\n        }\n        this.canvas.on('zoom', this.rerender);\n        this.canvas.on('scroll', this.rerender);\n      }\n    });\n    this.canvas.addFunction(`${this.nameSpace}.isOpen`, (context: any) => {\n      return this.isOpened;\n    });\n    this.canvas.addEventListener(`${this.nameSpace}.close`, this.closeEditor);\n  }\n  deactivate() {\n    this.canvas.removeFunction(`${this.nameSpace}.isOpen`);\n    this.canvas.removeEventListener(\n      `${this.nameSpace}.close`,\n      this.closeEditor\n    );\n    this.dispose();\n  }\n}\n","import { Canvas, IPlugin } from '../../';\nimport { IDimensionWithRotation, IPosition } from 'interfaces';\nimport ModelUtils from './../../models/utils';\nimport NativeHtmlDragEvent from './NativeHtmlDragEvent';\nexport default class NativeHtmlDrag implements IPlugin {\n  name = 'NativeHtmlDrag';\n  namespace = 'NativeHtmlDrag';\n  canvas!: Canvas;\n  mouseDown: boolean = false;\n  dragStarted: boolean = false;\n  dragDom: any;\n  boundMouseMove: any;\n  boundMouseUp: any;\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  onMouseMove = (dragDom: any, e: any) => {\n    if (this.mouseDown && !this.dragStarted) {\n      this.dragStarted = true;\n      var event = new MouseEvent('htmlDragStart', e);\n      dragDom.dispatchEvent(event);\n    } else if (this.dragStarted) {\n      var event = new MouseEvent('htmlDrag', e);\n      dragDom.dispatchEvent(event);\n    }\n  };\n\n  disableSelect = (event: Event) => {\n    event.preventDefault();\n  };\n  onMouseUp = (dragDom: any, e: any) => {\n    e.preventDefault();\n    if (this.dragStarted) {\n      var event = new MouseEvent('htmlDragEnd', e);\n      dragDom.dispatchEvent(event);\n    }\n\n    this.mouseDown = false;\n    this.dragStarted = false;\n    dragDom.ownerDocument.removeEventListener('mousemove', this.boundMouseMove);\n    dragDom.ownerDocument.removeEventListener('mouseup', this.boundMouseUp);\n    dragDom.ownerDocument.removeEventListener('contextmenu', this.boundMouseUp);\n    window.removeEventListener('selectstart', this.disableSelect);\n  };\n  handleHtmlDrag(context: any, dragDom: any) {\n    this.dragDom = dragDom;\n    dragDom.addEventListener('mousedown', (event: any) => {\n      window.addEventListener('selectstart', this.disableSelect);\n\n      // event.preventDefault();\n      if (event.button !== 2 && event.which !== 3) {\n        // Ignore right click mousedown\n        this.mouseDown = true;\n        this.dragStarted = false;\n\n        if (dragDom && dragDom.ownerDocument) {\n          this.boundMouseMove = this.onMouseMove.bind(this, dragDom);\n          this.boundMouseUp = this.onMouseUp.bind(this, dragDom);\n          dragDom.ownerDocument.addEventListener(\n            'mousemove',\n            this.boundMouseMove\n          );\n          dragDom.ownerDocument.addEventListener('mouseup', this.boundMouseUp);\n          dragDom.ownerDocument.addEventListener(\n            'contextmenu',\n            this.boundMouseUp\n          );\n        }\n      }\n    });\n\n    // dragDom.addEventListener('mousemove', (e: any) => {\n    //   if (this.mouseDown && !this.dragStarted) {\n    //     this.dragStarted = true;\n    //     var event = new MouseEvent('htmlDragStart', e);\n    //     dragDom.dispatchEvent(event);\n    //   } else if (this.dragStarted) {\n    //     var event = new MouseEvent('htmlDrag', e);\n    //     dragDom.dispatchEvent(event);\n    //   }\n    // });\n\n    // dragDom.addEventListener('mouseup', (e: any) => {\n    //   e.preventDefault();\n    //   if (this.dragStarted) {\n    //     var event = new MouseEvent('htmlDragEnd', e);\n    //     dragDom.dispatchEvent(event);\n    //   }\n\n    //   this.mouseDown = false;\n    //   this.dragStarted = false;\n    // });\n  }\n\n  activate() {\n    this.canvas.addFunction(`handleHtmlDrag`, this.handleHtmlDrag.bind(this));\n  }\n\n  deactivate() {\n    //\n    this.canvas.removeFunction(`handleHtmlDrag`);\n  }\n}\n","import { Canvas, IPlugin, Layer, IContext } from '../..';\nconst path = require('path');\nexport default class StageDesignerDeviceData implements IPlugin {\n  name = 'StageDesignerDeviceData';\n  canvas!: Canvas;\n  dataMap = new Map<Layer, any>();\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n  activate() {\n    this.canvas.addFunction('getDeviceData', this.getDeviceData);\n  }\n\n  getDeviceData = (context: IContext) => {\n    const layer = context.layer;\n\n    return this.getDeviceDataOnLayer(layer);\n  };\n\n  getDeviceDataOnLayer = (layer: Layer): any => {\n    const deviceData = layer.executeFunction('getData', 'deviceData');\n    if (deviceData) {\n      return deviceData;\n    } else if (layer.parent) {\n      return this.getDeviceDataOnLayer(layer.parent);\n    }\n\n    return null;\n  };\n\n  deactivate() {\n    this.canvas.removeFunction('getDeviceData');\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\n\nexport default class PathEvent extends Event {\n  payload: any;\n  constructor(\n    name: string,\n    target: Layer,\n    payload?: any,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.payload = payload;\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\n\nexport default class ArtboardEvent extends Event {\n  artboard: Layer;\n  constructor(\n    name: string,\n    target: Layer,\n    artboard: Layer,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.artboard = artboard;\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\nexport default class TextEditorEvent extends Event {\n  payload: any;\n  isFinal: boolean;\n  constructor(\n    name: string,\n    target: Layer,\n    payload?: any,\n    isFinal?: boolean,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.payload = payload;\n    this.isFinal = isFinal || false;\n  }\n}\n","import { Layer } from '../../models/Layer';\nimport DesignerMouseEvent from '../../events/MouseEvent';\nexport default class LayerDragEvent extends DesignerMouseEvent {\n  layout: any;\n  meta: any;\n  snapPoints: any;\n  constructor(\n    name: string,\n    target: Layer,\n    originalEvent: any,\n    payload: {\n      layerWorldX: number;\n      layerWorldY: number;\n      meta?: any;\n      snapPoints?: any;\n    },\n    currentTarget?: Layer\n  ) {\n    super(name, target, originalEvent, currentTarget);\n    let dims = target.getBoundingClientRect();\n    let newDims = target.convertLayerDimensions({\n      x: payload.layerWorldX,\n      y: payload.layerWorldY,\n      width: dims.width,\n      height: dims.height,\n      rotation: dims.rotation,\n    });\n    this.layout = newDims;\n    this.meta = payload.meta;\n    this.snapPoints = payload.snapPoints;\n  }\n}\n","import { IPlugin } from 'interfaces/IPlugin';\nimport { Canvas } from 'models/Canvas';\nimport ISnapPoints from './interfaces/ISnapPoints';\n// import getSnapPoints from './getSnapPoints';\nimport LayerDragEvent from './LayerDragEvent';\nimport ISnapXPoint from './interfaces/ISnapXPoint';\nimport ISnapYPoint from './interfaces/ISnapYPoint';\nimport Config from './interfaces/Config';\nimport { IDimensionWithRoot, IDimension, IContext } from 'interfaces';\nimport ModelUtils from '../../models/utils';\n\nexport default class LayerDrag implements IPlugin {\n  name = 'LayerDrag';\n  nameSpace: string = 'LayerDrag';\n  canvas!: Canvas;\n  dispose: any;\n  targetLayer: any;\n  dragStarted = false;\n  boundingBox: any;\n  boundingBoxWRTWorld: any;\n  startX: any = 0;\n  startY: any = 0;\n  startLayoutX: any = 0;\n  startLayoutY: any = 0;\n  startAbsoluteX: any = 0;\n  startAbsoluteY: any = 0;\n  totalDx: any = 0;\n  totalDy: any = 0;\n  snapPoints: any;\n\n  isAltPressed: boolean = false;\n  isShiftPressed: boolean = false;\n  shiftDirection: string = '';\n\n  oldDelta: any;\n  dragEventData: any;\n  applyDimensions(eventType: string, showLog: boolean = false) {\n    const data = this.dragEventData;\n    // if (showLog)\n    // console.log(this.totalDx, this.totalDy, 'database me chal raha hai');\n    const worldDx = isNaN(data.worldDx) ? 0 : data.worldDx;\n    const worldDy = isNaN(data.worldDy) ? 0 : data.worldDy;\n    // this.totalDx += worldDx;\n    // this.totalDy += worldDy;\n\n    // const deltaX  = worldDx;\n    // const deltaY += worldDy;\n\n    this.totalDx += worldDx;\n    this.totalDy += worldDy;\n\n    let currentDeltaX = this.totalDx;\n    let currentDeltaY = this.totalDy;\n\n    if (!this.targetLayer.parent) {\n      return;\n    }\n\n    const parentAbsoluteRotation = this.targetLayer\n      ? this.targetLayer.parent.getAbsoluteRotation()\n      : 0;\n\n    let rotateDelta = ModelUtils.rotatePoint(\n      [currentDeltaX, currentDeltaY],\n      360 - parentAbsoluteRotation,\n      [0, 0]\n    );\n\n    const snappedData = this.canvas.executeFunction(\n      'snapToPoints',\n      this.snapPoints,\n      [this.startX, this.startY],\n      [rotateDelta[0], rotateDelta[1]],\n      {\n        ...this.boundingBox,\n      },\n      [currentDeltaX, currentDeltaY],\n      [this.startAbsoluteX, this.startAbsoluteY],\n      parentAbsoluteRotation,\n      this.boundingBoxWRTWorld\n    );\n\n    this.boundingBox = {\n      ...this.boundingBox,\n      x: this.boundingBox.x + snappedData.delta.x,\n      y: snappedData.y + snappedData.delta.y,\n    };\n\n    let delta = snappedData.delta;\n\n    if (!this.isShiftPressed) {\n      this.shiftDirection = '';\n    }\n\n    let payload = {\n      layerWorldX: this.startLayoutX + delta.x,\n      layerWorldY: this.startLayoutY + delta.y,\n      meta: snappedData.meta,\n    };\n\n    if (this.isShiftPressed) {\n      if (!this.shiftDirection) {\n        if (Math.abs(data.worldDx) !== Math.abs(data.worldDy)) {\n          if (Math.abs(data.worldDx) > Math.abs(data.worldDy)) {\n            this.shiftDirection = 'horizontal';\n          } else {\n            this.shiftDirection = 'vertical';\n          }\n        }\n      }\n      if (this.shiftDirection) {\n        if (this.shiftDirection === 'horizontal') {\n          payload.layerWorldY = this.targetLayer.getBoundingClientRect().y;\n        } else {\n          payload.layerWorldX = this.targetLayer.getBoundingClientRect().x;\n        }\n      }\n    }\n\n    // this.oldDelta = {\n    //   x: delta.x,\n    //   y: delta.y,\n    // };\n\n    let layerDragEvent = new LayerDragEvent(\n      eventType,\n      this.targetLayer,\n      data.originalEvent,\n      payload\n    );\n    this.targetLayer.dispatchEvent(eventType, layerDragEvent, data);\n\n    // this.setNewLayout(\n    //   this.selectedLayers,\n    //   this.boundingBox,\n    //   data.session,\n    //   data.targetHandle,\n    //   eventType,\n    //   data,\n    //   delta\n    //   // { x: rotateDelta[0], y: rotateDelta[1] }\n    // );\n  }\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n\n  activate() {\n    let snapPoints: ISnapPoints;\n\n    let totalDx: number = 0;\n    let totalDy: number = 0;\n\n    let startX: number = 0;\n    let startY: number = 0;\n\n    let startRootX: number = 0;\n    let startRootY: number = 0;\n\n    this.canvas.addFunction(`${this.nameSpace}.isDragging`, () => {\n      return this.dragStarted;\n    });\n\n    this.canvas.addEventListener('dragStart', (event: any) => {\n      return this.canvas.executeMiddleware(\n        'LayerDrag.dragStart',\n        event,\n        async (event: any) => {\n          this.dragStarted = true;\n          this.targetLayer = event.target;\n\n          if (this.targetLayer) {\n            //\n\n            this.targetLayer.setDragging(true);\n            this.boundingBox = this.canvas.getContainerBoundingBoxWRTParent([\n              this.targetLayer,\n            ]);\n\n            this.boundingBoxWRTWorld = this.canvas.getContainerBoundingBox([\n              this.targetLayer,\n            ]);\n\n            const parentLayer = this.targetLayer.parent;\n\n            if (!parentLayer) {\n              return;\n            }\n\n            this.startX = this.boundingBox.x;\n            this.startY = this.boundingBox.y;\n\n            this.startAbsoluteX =\n              this.boundingBoxWRTWorld.x -\n              this.canvas.getContainerBoundingBox([parentLayer]).x;\n\n            this.startAbsoluteY =\n              this.boundingBoxWRTWorld.y -\n              this.canvas.getContainerBoundingBox([parentLayer]).y;\n\n            this.snapPoints = this.canvas.executeFunction(\n              'getSnapPoints',\n              [this.targetLayer],\n              parentLayer\n            );\n\n            //\n            let layoutData: IDimensionWithRoot = this.targetLayer.getBoundingClientRect();\n            this.startLayoutX = layoutData.x;\n            this.startLayoutY = layoutData.y;\n\n            let payload = {\n              layerWorldX: layoutData.x,\n              layerWorldY: layoutData.y,\n              snapPoints: this.snapPoints,\n            };\n\n            let layerDragEvent = new LayerDragEvent(\n              'layerDragStart',\n              this.targetLayer,\n              event.originalEvent,\n              payload\n            );\n\n            // TODO: data to be removed later\n            this.targetLayer.dispatchEvent(\n              'layerDragStart',\n              layerDragEvent,\n              event\n            );\n          }\n        }\n      );\n    });\n\n    this.canvas.addEventListener('drag', (data: any) =>\n      this.canvas.executeMiddleware('LayerDrag.drag', data, (data: any) => {\n        if (this.dragStarted) {\n          if (!this.targetLayer) {\n            return;\n          }\n          this.dragEventData = data;\n          this.applyDimensions('layerDrag');\n          // let layoutData = this.targetLayer\n          //   ? this.canvas.getBoundingBoxWRTParent([this.targetLayer], true)\n          //   : null;\n\n          // // let dims = this.canvas.getBoundingBoxWRTParent([data.target], true); //.getBoundingClientRect();\n\n          // totalDx += data.worldDx;\n          // totalDy += data.worldDy;\n\n          // let left = startX + totalDx;\n          // let top = startY + totalDy;\n\n          // const absoluteRotation = this.targetLayer.parent.getAbsoluteRotation();\n          // let rotateDelta = ModelUtils.rotatePoint(\n          //   [totalDx, totalDy],\n          //   360 - absoluteRotation,\n          //   [0, 0]\n          // );\n          // const newDx = rotateDelta[0];\n          // const newDy = rotateDelta[1];\n\n          // let newSnapPoints = this.getSnapPointCoordinates(\n          //   snapPoints,\n          //   top,\n          //   left,\n          //   startX,\n          //   startY,\n          //   newDx,\n          //   newDy,\n          //   layoutData\n          // );\n\n          // left = newSnapPoints.left;\n          // top = newSnapPoints.top;\n\n          // let payload = { layerWorldX: left, layerWorldY: top };\n          // let layerDragEvent = new LayerDragEvent(\n          //   'layerDrag',\n          //   this.targetLayer,\n          //   data.originalEvent,\n          //   payload\n          // );\n          // this.targetLayer.dispatchEvent('layerDrag', layerDragEvent, data);\n        }\n      })\n    );\n\n    this.canvas.addEventListener('dragEnd', (data: LayerDragEvent) =>\n      this.canvas.executeMiddleware(\n        'LayerDrag.dragEnd',\n        data,\n        (data: LayerDragEvent) => {\n          if (this.dragStarted) {\n            if (!this.targetLayer) {\n              return;\n            }\n            this.targetLayer.setDragging(false);\n            this.dragEventData = data;\n            this.applyDimensions('layerDragEnd');\n            this.shiftDirection = '';\n\n            this.totalDx = 0;\n            this.totalDy = 0;\n            this.startX = 0;\n            this.startY = 0;\n            this.startAbsoluteX = 0;\n            this.startAbsoluteY = 0;\n            this.dragStarted = false;\n            this.dragEventData = undefined;\n          }\n        }\n      )\n    );\n\n    this.canvas.addEventListener('blur', () => {\n      if (this.isAltPressed) this.isAltPressed = false;\n      if (this.isShiftPressed) this.isShiftPressed = false;\n    });\n    this.canvas.addEventListener('keyUp', (data: any) => {\n      let event = data.originalEvent ? data.originalEvent : data;\n      if (event.keyCode === 16) {\n        this.isShiftPressed = false;\n      }\n      if (event.keyCode === 18) {\n        this.isAltPressed = false;\n      }\n\n      if (this.dragEventData) {\n        this.applyDimensions('layerDrag', true);\n      }\n    });\n    this.canvas.addEventListener('keyDown', (data: any) => {\n      let event = data.originalEvent ? data.originalEvent : data;\n      if (event.keyCode === 16) {\n        this.isShiftPressed = true;\n      }\n      if (event.keyCode === 18) {\n        this.isAltPressed = true;\n      }\n\n      if (this.dragEventData) {\n        this.applyDimensions('layerDrag');\n      }\n    });\n  }\n\n  deactivate() {\n    this.dispose();\n  }\n}\n","import { IPlugin, IContext, Canvas } from '../../';\nimport GridDimension from './interfaces/GridDimension';\nimport GridData from './interfaces/GridData';\nimport { Layer } from '../../models/Layer';\nimport SetLayoutEvent from '../../events/SetLayoutEvent';\n\nexport default class GridRenderer implements IPlugin {\n  name = 'GridRenderer';\n  canvas!: Canvas;\n  dispose: any;\n  gridLayers: Map<Layer, GridData> = new Map<Layer, GridData>();\n  gridWrapper: any;\n  gridLayersRef: Map<Layer, Map<string, any>> = new Map<\n    Layer,\n    Map<string, any>\n  >();\n\n  gridOffset: {\n    x: number;\n    y: number;\n  } = {\n    x: 0,\n    y: 0,\n  };\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    let canvasDims = this.canvas.getBoundingClientRect();\n    this.gridWrapper = document.createElement('div');\n    this.dispose = this.canvas.addDomToWorld(this.gridWrapper, true);\n    this.gridWrapper.style.pointerEvents = 'none';\n    this.gridWrapper.style.position = 'absolute';\n    this.gridWrapper.style.height = canvasDims.height + 'px';\n    this.gridWrapper.style.width = canvasDims.width + 'px';\n\n    this.canvas.addFunction('showGrid', this.showGrid);\n    this.canvas.addFunction('hideGrid', this.hideGrid);\n    this.canvas.addFunction('getGridSize', this.getGridSize);\n    this.canvas.addFunction('setGridSize', this.setGridSize);\n    this.canvas.addFunction('setGridOffset', this.setGridOffset);\n    this.canvas.addFunction('getGridOffset', this.getGridOffset);\n\n    this.canvas.addEventListener('setLayout', (data: SetLayoutEvent) => {\n      if (data.target.type === 'canvas') {\n        let newDims = data.target.getBoundingClientRect();\n        this.gridWrapper.style.height = newDims.height;\n        this.gridWrapper.style.width = newDims.width;\n        this.gridLayers.forEach((gridData, layer) => {\n          this.refreshGrid(layer);\n        });\n      }\n      if (this.gridLayers.has(data.target)) {\n        let gridData = this.gridLayers.get(data.target);\n        if (gridData) {\n          let dims = gridData.dimensions;\n          data.target.executeFunction('showGrid', dims);\n        }\n      }\n    });\n\n    this.canvas.on('zoom', () => {\n      this.adjustStroke();\n    });\n  }\n  deactivate() {\n    this.canvas.removeFunction('showGrid');\n    this.canvas.removeFunction('hideGrid');\n    this.canvas.removeFunction('getGridSize');\n    this.canvas.removeFunction('setGridSize');\n    this.canvas.removeFunction('setGridOffset');\n    this.canvas.removeFunction('getGridOffset');\n    this.dispose();\n  }\n  refreshGrid = (layer: Layer) => {\n    let gridData = this.gridLayers.get(layer);\n    if (layer.type !== 'canvas') {\n      if (gridData) {\n        this.createGrid(layer, gridData.dimensions);\n      } else {\n        this.createGrid(layer, {\n          x: 0,\n          y: 0,\n        });\n      }\n    }\n  };\n\n  getGridSize = (context: IContext) => {\n    let layer = context.layer;\n    let data = this.gridLayers.get(layer);\n    if (data) {\n      return data.dimensions;\n    }\n    return null;\n  };\n\n  setGridSize = (context: IContext, gridSize: any) => {\n    let layer = context.layer;\n    if (this.gridLayers.has(layer)) {\n      this.gridLayers.delete(layer);\n    }\n\n    this.gridLayers.set(layer, {\n      dimensions: gridSize,\n    });\n  };\n\n  hideGrid = (context: IContext) => {\n    let layer = context.layer;\n    if (this.gridLayers.has(layer)) {\n      this.gridLayers.delete(layer);\n      if (this.gridLayersRef.get(layer)) {\n        let gridElementMap = this.gridLayersRef.get(layer);\n        if (gridElementMap) {\n          let wrapperElement = gridElementMap.get('wrapper');\n          this.gridWrapper.removeChild(wrapperElement);\n        }\n        this.gridLayersRef.delete(layer);\n      }\n    }\n    this.gridLayers.forEach((gridData, layer) => {\n      this.refreshGrid(layer);\n    });\n  };\n\n  showGrid = (context: IContext, dims: GridDimension) => {\n    this.setGridSize(context, dims);\n    this.gridLayers.forEach((gridData, layer) => {\n      this.refreshGrid(layer);\n    });\n  };\n\n  setGridOffset = (context: IContext, offset: any) => {\n    this.gridOffset = offset;\n  };\n\n  getGridOffset = (context: IContext, dims: GridDimension) => {\n    return this.gridOffset;\n  };\n  adjustStroke = () => {\n    this.gridLayers.forEach((gridData, layer) => {\n      let gridElementMap = this.gridLayersRef.get(layer);\n      if (gridElementMap) {\n        let pathElement = gridElementMap.get('path');\n        if (pathElement) {\n          pathElement.setAttributeNS(\n            null,\n            'stroke-width',\n            `${1 / this.canvas.getZoom()}px`\n          );\n        }\n      }\n    });\n  };\n  createGrid = (layer: Layer, gridDims: GridDimension): void => {\n    const dims = layer.getBoundingClientRect();\n    let gridElementMap = this.gridLayersRef.get(layer);\n    if (gridElementMap) {\n      let wrapperElement = gridElementMap.get('wrapper');\n      if (!wrapperElement) {\n        wrapperElement = document.createElement('div');\n        wrapperElement.style.pointerEvents = 'none';\n        wrapperElement.style.position = 'absolute';\n        this.gridWrapper.appendChild(wrapperElement);\n        gridElementMap.set('wrapper', wrapperElement);\n      }\n      wrapperElement.style.left = dims.rootX + 'px';\n      wrapperElement.style.top = dims.rootY + 'px';\n      wrapperElement.style.height = dims.height + 'px';\n      wrapperElement.style.width = dims.width + 'px';\n      const svgns = 'http://www.w3.org/2000/svg';\n      let svgElement = gridElementMap.get('svg');\n      if (!svgElement) {\n        svgElement = document.createElementNS(svgns, 'svg');\n        svgElement.setAttributeNS(null, 'height', '100%');\n        svgElement.setAttributeNS(null, 'width', '100%');\n        wrapperElement.appendChild(svgElement);\n        gridElementMap.set('svg', svgElement);\n      }\n      let defsElement = gridElementMap.get('defs');\n      if (!defsElement) {\n        defsElement = document.createElementNS(svgns, 'defs');\n        svgElement.appendChild(defsElement);\n        gridElementMap.set('defs', defsElement);\n      }\n      let patternElement = gridElementMap.get('pattern');\n      if (!patternElement) {\n        patternElement = document.createElementNS(svgns, 'pattern');\n        defsElement.appendChild(patternElement);\n        patternElement.setAttributeNS(null, 'id', 'grid-pattern');\n        patternElement.setAttributeNS(null, 'patternUnits', 'userSpaceOnUse');\n        gridElementMap.set('pattern', patternElement);\n      }\n      patternElement.setAttributeNS(null, 'width', gridDims.x + 'px');\n      patternElement.setAttributeNS(null, 'height', gridDims.y + 'px');\n      let pathElement = gridElementMap.get('path');\n      if (!pathElement) {\n        pathElement = document.createElementNS(svgns, 'path');\n        patternElement.appendChild(pathElement);\n        pathElement.setAttributeNS(null, 'fill', 'none');\n        pathElement.setAttributeNS(null, 'stroke', '#DBDBDB');\n        gridElementMap.set('path', pathElement);\n      }\n      pathElement.setAttributeNS(\n        null,\n        'd',\n        `M ${gridDims.x} 0 L 0 0 0 ${gridDims.y}`\n      );\n      pathElement.setAttributeNS(\n        null,\n        'stroke-width',\n        `${1 / this.canvas.getZoom()}px`\n      );\n      let rectElement = gridElementMap.get('rect');\n      if (!rectElement) {\n        rectElement = document.createElementNS(svgns, 'rect');\n        svgElement.appendChild(rectElement);\n        rectElement.setAttributeNS(null, 'height', '100%');\n        rectElement.setAttributeNS(null, 'width', '100%');\n        rectElement.setAttributeNS(null, 'fill', `url(#grid-pattern)`);\n        gridElementMap.set('rect', rectElement);\n      }\n    } else {\n      this.gridLayersRef.set(layer, new Map<string, any>());\n      this.createGrid(layer, gridDims);\n    }\n  };\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\nexport default class SelectLayers extends Event {\n  layers: Array<Layer>;\n\n  constructor(\n    name: string,\n    target: Layer,\n    layers: Array<Layer>,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.layers = layers;\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { Event } from './index';\n\nexport default class ResetResizerEvent extends Event {\n  originalEvent: any;\n  constructor(name: string, target: Layer, event: any, currentTarget?: Layer) {\n    super(name, target, currentTarget);\n    this.originalEvent = event;\n  }\n}\n","import {\n  Canvas,\n  IPlugin,\n  Layer,\n  IContext,\n  MouseEvent as DesignerMouseEvent,\n  Event as DesignerEvent,\n  ArtboardEvent,\n  stopRerender,\n  startRerender,\n} from '../..';\nimport { union } from 'lodash';\nimport {\n  forEach,\n  isEmpty,\n  indexOf,\n  findLast,\n  intersection,\n  filter,\n} from 'lodash';\nimport SelectLayers from '../../events/SelectLayers';\nimport ResetResizerEvent from '../../events/ResetResizerEvent';\nimport CommandEvent from '../../events/CommandEvent';\nimport { generateRandomString } from '../../models/utils';\n\nexport default class StageDesigner implements IPlugin {\n  name = 'StageDesigner';\n  canvas!: Canvas;\n  artboards = new Map<string, Layer>();\n  selectedArtboard?: Layer;\n  topLayerSelectionMode: boolean = false;\n  previousMovedLayers: Array<Layer> = [];\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n  activate() {\n    this.canvas.addFunction('addArtboard', this.addArtboard.bind(this));\n    this.canvas.addFunction('removeArtboard', this.removeArtboard.bind(this));\n    this.canvas.addFunction('selectArtboard', this.selectArtboard.bind(this));\n    this.canvas.addFunction(\n      'getSelectedArtboard',\n      this.getSelectedArtboard.bind(this)\n    );\n    this.canvas.addFunction('getArtboard', this.getArtboard.bind(this));\n    this.canvas.addFunction('focusArtboard', this.focusArtboard.bind(this));\n    this.canvas.addFunction('getAllArtboards', this.getAllArtboards.bind(this));\n    this.canvas.addFunction('getArtboardById', this.getArtboardById.bind(this));\n    this.canvas.addFunction(\n      'getSelectedArtboardId',\n      this.getSelectedArtboardId.bind(this)\n    );\n\n    this.canvas.addFunction(\n      'getNewArtboardPosition',\n      this.getNewArtboardPosition.bind(this)\n    );\n    this.canvas.addFunction('getHitArtboard', this.getHitArtboard.bind(this));\n\n    this.canvas.on('selectedLayers', () => {\n      if (\n        this.canvas.selectedLayers[0] &&\n        this.canvas.selectedLayers[0].parent &&\n        this.canvas.selectedLayers[0].parent.parent &&\n        this.canvas.selectedLayers[0].parent.parent.type === 'canvas' &&\n        this.canvas.selectedLayers[0].type !== 'scrollView'\n      ) {\n        // TODO: heavy jugaad\n        // if root layer is selected, select artboard instead\n        stopRerender();\n        const artboardLayer = this.canvas.selectedLayers[0].parent;\n        this.canvas.selectLayers(artboardLayer);\n\n        if (artboardLayer.children[0].children.length === 0) {\n          artboardLayer.executeFunction('LayerResizer.showLayer');\n        } else {\n          artboardLayer.executeFunction('LayerResizer.hideLayer');\n        }\n\n        startRerender();\n      }\n    });\n\n    // Filter layers in hitRect other that direct children of root layer in selected artboard\n    this.canvas.addMiddleware(\n      'MouseRect.getHitRectResult',\n      (next, hitRectResult: Array<Layer>) => {\n        const selectedArtboard = this.canvas.executeFunction(\n          'getSelectedArtboard'\n        );\n        // console.log(hitRectResult, 'Layer.getHitRectResult original *(*(*(');\n        if (selectedArtboard) {\n          let selectedArtboardLayers: Array<Layer> = [];\n          let lowestIndexArtboardLayers: Array<Layer> = [];\n          const allArtboards = Array.from(this.artboards.values());\n          let lowestIndex = allArtboards.length - 1;\n\n          const ignoredHitRectLayers: Array<Layer> = [];\n          hitRectResult.forEach(layer => {\n            if (\n              layer.parent &&\n              layer.parent.style.get('pointerEvents') === 'none'\n            ) {\n              ignoredHitRectLayers.push(layer.parent);\n            }\n          });\n\n          const hitRectResultWithIgnored = union(\n            hitRectResult,\n            ignoredHitRectLayers\n          );\n\n          hitRectResultWithIgnored.forEach((layer: Layer): any => {\n            if (layer.type === 'canvas') return;\n            const currentLayerArtboard = layer.executeFunction('getArtboard');\n\n            if (!currentLayerArtboard) {\n              return;\n            }\n\n            let modLayers; // Layers to consider for comparing. Should be a direct child of root layer\n            // or should be a child of ignored layer which is a direct child of root layer\n            if (\n              currentLayerArtboard.children[0] &&\n              currentLayerArtboard.children[0].children.includes(layer)\n            ) {\n              if (layer.style.get('pointerEvents') !== 'none') {\n                modLayers = [layer];\n              } else {\n                // if ignored layer, then consider its children and add to modLayers\n                modLayers = intersection(hitRectResult, layer.children);\n              }\n            }\n\n            if (modLayers) {\n              if (\n                // Layer belongs to selectedArtboard\n                currentLayerArtboard === selectedArtboard\n              ) {\n                selectedArtboardLayers = union(\n                  selectedArtboardLayers,\n                  modLayers\n                );\n              }\n              // Check if layer belongs to lowestIndexArtboard\n              else {\n                const index = indexOf(allArtboards, currentLayerArtboard);\n                if (index < lowestIndex) {\n                  // If index is lesser than previous, createNewArray and change index\n                  lowestIndexArtboardLayers = [];\n\n                  lowestIndexArtboardLayers = union(\n                    lowestIndexArtboardLayers,\n                    modLayers\n                  );\n                  lowestIndex = index;\n                } else if (index === lowestIndex) {\n                  lowestIndexArtboardLayers = union(\n                    lowestIndexArtboardLayers,\n                    modLayers\n                  );\n                }\n              }\n            }\n          });\n          if (selectedArtboardLayers.length) {\n            return next(selectedArtboardLayers);\n          } else {\n            return next(lowestIndexArtboardLayers);\n          }\n        } else {\n          return next(hitRectResult);\n        }\n      }\n    );\n\n    // Modify event.target in Canvas.dispatchEventOnHitLayer according to selected layer,\n    this.canvas.addMiddleware(\n      'Canvas.dispatchEventOnHitLayer',\n      (next, event) => {\n        if (event.name === 'click') {\n          this.modifyEventForSelectableLayers(event);\n          return next(event);\n        } else if (event.name === 'mousemove') {\n          this.modifyEventForSelectableLayers(event);\n          return next(event);\n        }\n\n        return next(event);\n      }\n    );\n\n    this.canvas.addMiddleware('LayerDrag.dragStart', (next, event) => {\n      const target = event.target;\n      if (\n        target.type === 'canvas' ||\n        // (target.parent && target.parent.type === 'canvas') ||\n        (target.parent.parent && target.parent.parent.type === 'canvas') ||\n        this.canvas.moveWithGrabHandle\n      ) {\n        return;\n      }\n      // const allRootLayers: Array<Layer> = [];\n\n      //   const artboardArray = Array.from(this.artboards.values());\n\n      //   artboardArray.forEach((artboard: Layer) => {\n      //     const rootLayer = artboard.children[0];\n\n      //     if (rootLayer) {\n      //       allRootLayers.push(rootLayer);\n      //     }\n      //   });\n\n      //   if (allRootLayers.includes(hitLayer)) {\n      //     next(event);\n      //   }\n\n      this.modifyEventForSelectableLayers(event, true);\n\n      return next(event);\n    });\n    // this.canvas.on('selectedLayers', () => {\n    //   if (this.canvas.selectedLayers[0]) {\n    //     const artboard = this.canvas.selectedLayers[0].executeFunction(\n    //       'getArtboard'\n    //     );\n    //     if (this.selectedArtboard !== artboard) {\n    //       this.canvas.dispatchEvent(\n    //         'selectArtboard',\n    //         new Event('selectArtboard', artboard)\n    //       );\n    //       this.selectArtboard(\n    //         { canvas: this.canvas, layer: this.canvas },\n    //         artboard\n    //       );\n    //     }\n    //   }\n    // });\n\n    this.canvas.addEventListener('dblclick', (e: DesignerMouseEvent) => {\n      let parentLayer = e.target.parent;\n      const hitLayers = e.target.getHitResult(e.worldX, e.worldY);\n\n      let currentLayer: Layer | null = e.target;\n      while (\n        currentLayer &&\n        currentLayer.type !== 'canvas' &&\n        !this.canvas.selectedLayers.includes(currentLayer)\n      ) {\n        if (this.canvas.selectedLayers.includes(currentLayer.parent as Layer)) {\n          const filteredLayer = filterIgnoredLayers(currentLayer, hitLayers);\n\n          if (filteredLayer) {\n            this.canvas.dispatchEvent(\n              'selectLayers',\n              new SelectLayers('selectLayers', this.canvas, [filteredLayer])\n            );\n          }\n          break;\n        }\n        currentLayer = currentLayer.parent;\n      }\n    });\n\n    this.canvas.addMiddleware('MouseRect.dragStart', (next, event) => {\n      if (this.canvas.moveWithGrabHandle) {\n        return;\n      }\n      const hitLayer = this.canvas.getHitLayer(event.worldX, event.worldY);\n      if (\n        hitLayer &&\n        (hitLayer.locked ||\n          (hitLayer.type === 'canvas' &&\n            event.target &&\n            event.target.type === 'canvas'))\n      ) {\n        next(event);\n      } else {\n        const allRootLayers: Array<Layer> = [];\n\n        const artboardArray = Array.from(this.artboards.values());\n\n        artboardArray.forEach((artboard: Layer) => {\n          const rootLayer = artboard.children[0];\n\n          if (rootLayer) {\n            allRootLayers.push(rootLayer);\n          }\n        });\n\n        if (allRootLayers.includes(hitLayer)) {\n          next(event);\n        }\n      }\n    });\n\n    this.canvas.addMiddleware('LayerResizer.dragStart', (next, event) => {\n      if (this.canvas.moveWithGrabHandle) {\n        return;\n      } else {\n        next(event);\n      }\n    });\n    this.canvas.addMiddleware('LayerResizer.drag', (next, event) => {\n      if (this.canvas.moveWithGrabHandle) {\n        return;\n      } else {\n        next(event);\n      }\n    });\n    this.canvas.addMiddleware('LayerResizer.dragEnd', (next, event) => {\n      if (this.canvas.moveWithGrabHandle) {\n        return;\n      } else {\n        next(event);\n      }\n    });\n    // this.canvas.addEventListener('layerDrag', this.handleMoveLayerArtboard);\n    // this.canvas.addEventListener(\n    //   'LayerResizer.drag',\n    //   this.handleMoveLayerArtboard\n    // );\n    this.canvas.addEventListener('keyUp', (data: any) => {\n      let event = data.originalEvent ? data.originalEvent : data;\n      if (event.keyCode === 91) {\n        this.setTopLayerSelectionMode(false);\n      }\n    });\n    this.canvas.addEventListener('keyDown', (data: any) => {\n      let event = data.originalEvent ? data.originalEvent : data;\n      if (event.keyCode === 91) {\n        this.setTopLayerSelectionMode(true);\n      }\n    });\n    this.canvas.addMiddleware(\n      `LayerResizer.getHandles`,\n      (next: any, layers: Array<Layer>) => {\n        if (layers?.[0]?.parent?.type === 'canvas') {\n          // if layer is an artboard\n          const handles = next(layers);\n\n          const handlesWithoutRotation = filter(handles, h => h !== 'ROTATE');\n          return handlesWithoutRotation;\n        } else {\n          return next(layers);\n        }\n      }\n    );\n\n    // this.canvas.addEventListener('drag', (e: DesignerMouseEvent) => {\n    //   this.setScroll(\n    //     { canvas: this.canvas, layer: this.canvas },\n    //     {\n    //       x:\n    //         (this.canvas.layout.get('width') - e.worldX) /\n    //         this.canvas.layout.get('width'),\n    //       y:\n    //         (this.canvas.layout.get('height') - e.worldY) /\n    //         this.canvas.layout.get('height'),\n    //     }\n    //   );\n    // });\n\n    this.canvas.addEventListener('keyDown', (event: any) => {\n      event = event.originalEvent ? event.originalEvent : event;\n      if (event.keyCode === 32) {\n        this.canvas.enableMoveWithGrabHandle();\n      }\n    });\n\n    this.canvas.addEventListener('keyUp', (event: any) => {\n      event = event.originalEvent ? event.originalEvent : event;\n      if (event.keyCode === 32) {\n        this.canvas.disableMoveWithGrabHandle();\n      }\n    });\n  }\n\n  getNewRootLayer = (targetDims: any, currentArtboard: any) => {\n    const { rootX, rootY, width, height } = targetDims;\n\n    const layersHit = this.canvas.getHitRectResult(rootX, rootY, width, height);\n    const currentRootLayer = currentArtboard.children[0];\n\n    const newRootLayersHit: Array<Layer> = filter(layersHit, (layer: Layer) => {\n      if (\n        layer !== currentRootLayer &&\n        layer.parent &&\n        layer.parent.parent &&\n        layer.parent.parent.type === 'canvas'\n      ) {\n        return true;\n      }\n      return false;\n    });\n    let newRootLayer: Layer | undefined;\n    newRootLayersHit.forEach((layer: any) => {\n      const dims = layer.getBoundingClientRect();\n      const x_overlap = Math.max(\n        0,\n        Math.min(dims.rootX + dims.width, targetDims.rootX + targetDims.width) -\n          Math.max(dims.rootX, targetDims.rootX)\n      );\n      const y_overlap = Math.max(\n        0,\n        Math.min(\n          dims.rootY + dims.height,\n          targetDims.rootY + targetDims.height\n        ) - Math.max(dims.rootY, targetDims.rootY)\n      );\n      const overlapArea = x_overlap * y_overlap;\n      newRootLayer =\n        overlapArea > (targetDims.width * targetDims.height) / 2\n          ? layer\n          : undefined;\n    });\n    return newRootLayer;\n  };\n\n  handleMoveLayerArtboard = (event: any) => {\n    if (indexOf(this.previousMovedLayers, event.target) !== -1) {\n      return;\n    }\n    this.canvas.executeFunction('Hover.hideAllHoverBoxes');\n    const layerDims = event.target.getBoundingClientRect();\n    const currentArtboard = event.target.executeFunction('getArtboard');\n    const currentSelectedLayers: Array<Layer> = filter(\n      this.canvas.selectedLayers,\n      (layer: Layer) => {\n        if (layer.parent && layer.parent.type === 'canvas') {\n          return false;\n        }\n        return true;\n      }\n    );\n    let hitRectParams = {};\n    if (currentSelectedLayers.length > 1) {\n      const boundingBox = this.canvas.getBoundingBox(currentSelectedLayers);\n      hitRectParams = {\n        rootX: boundingBox.x,\n        rootY: boundingBox.y,\n        width: boundingBox.width,\n        height: boundingBox.height,\n      };\n    } else {\n      hitRectParams = {\n        rootX: layerDims.rootX,\n        rootY: layerDims.rootY,\n        width: layerDims.width,\n        height: layerDims.height,\n      };\n    }\n    const newRootLayer: Layer | undefined = this.getNewRootLayer(\n      hitRectParams,\n      currentArtboard\n    );\n\n    if (newRootLayer) {\n      if (\n        currentSelectedLayers.length > 0 &&\n        currentSelectedLayers.includes(event.target)\n      ) {\n        let newToSelectLayers: Array<Layer> = [];\n        currentSelectedLayers.forEach((layer: Layer) => {\n          this.previousMovedLayers.push(layer);\n          const newLayer: Layer | undefined = this.moveLayer(\n            layer,\n            newRootLayer\n          );\n          if (newLayer) {\n            newToSelectLayers.push(newLayer);\n          }\n        });\n\n        this.canvas.selectLayers(newToSelectLayers);\n        this.canvas.dispatchEvent(\n          'resetResizer',\n          new ResetResizerEvent(\n            'resetResizer',\n            this.canvas,\n            event.originalEvent\n          )\n        );\n      } else {\n        // Synthetic Mouse Up event\n        const mouseUpEvent = new DesignerMouseEvent(\n          'mouseup',\n          this.canvas,\n          event.originalEvent,\n          this.canvas\n        );\n        this.canvas.dispatchEventOnHitLayer('mouseup', mouseUpEvent);\n\n        this.moveLayer(event.target, newRootLayer);\n\n        // Synthetic mouseDown event for LayerDrag\n        const mouseDownEvent = new DesignerMouseEvent(\n          'mousedown',\n          this.canvas,\n          event.originalEvent,\n          this.canvas\n        );\n        this.canvas.dispatchEventOnHitLayer('mousedown', mouseDownEvent);\n      }\n    }\n    this.canvas.executeFunction('Hover.showAllHoverBoxes');\n  };\n\n  moveLayer = (layer: Layer, newRootLayer: Layer) => {\n    const fromIndex = indexOf(layer.parent?.children, layer);\n    const toIndex = newRootLayer.children.length;\n    this.canvas.dispatchEvent(\n      'moveLayer',\n      new CommandEvent('moveLayer', this.canvas, {\n        fromParent: layer.parent,\n        toParent: newRootLayer,\n        fromIndex: fromIndex,\n        toIndex: toIndex,\n      })\n    );\n    const newLayer: Layer = newRootLayer.children[toIndex];\n    const dims = layer.getBoundingClientRect();\n    const newRootLayerDims = newRootLayer.getBoundingClientRect();\n    const newLayerDims = {\n      ...layer.getBoundingClientRect(),\n      x: dims.rootX - newRootLayerDims.rootX,\n      y: dims.rootY - newRootLayerDims.rootY,\n    };\n    if (newLayer) {\n      forEach(newLayer.convertLayerDimensions(newLayerDims), (value, key) => {\n        this.canvas.dispatchEvent(\n          'setStyleAttribute',\n          new CommandEvent('setStyleAttribute', this.canvas, {\n            layer: newLayer,\n            key,\n            value,\n            stylePropName: 'style',\n          })\n        );\n      });\n    }\n    return newLayer;\n  };\n\n  addArtboard(context: IContext, filePath: string): Layer {\n    const position = this.getNewArtboardPosition();\n    const artboard = this.canvas.createLayer();\n    this.canvas.addChild(artboard);\n    artboard.setLayout({\n      top: position.artTop,\n      left: position.artLeft,\n      height: 600,\n      width: 300,\n      position: 'absolute',\n    });\n    artboard.setStyle('backgroundColor', 'white');\n    artboard.setProp('id', generateRandomString(20));\n    this.artboards.set(filePath, artboard);\n    artboard.on('layout', () => {\n      this.canvas.dispatchEvent(\n        'artboardLayoutChanges',\n        new DesignerEvent('artboardLayoutChanges', this.canvas, this.canvas)\n      );\n    });\n    artboard.on('updateDom', () => {\n      this.canvas.dispatchEvent(\n        'artboardLayoutChanges',\n        new DesignerEvent('artboardLayoutChanges', this.canvas, this.canvas)\n      );\n    });\n\n    this.canvas.dispatchEvent(\n      'artboardLayoutChanges',\n      new DesignerEvent('artboardLayoutChanges', this.canvas, this.canvas)\n    );\n\n    return artboard;\n  }\n\n  removeArtboard(context: IContext, filePath: string) {\n    const artboard = this.artboards.get(filePath);\n    if (artboard) {\n      this.artboards.delete(filePath);\n      this.canvas.removeChild(artboard);\n    }\n\n    this.canvas.dispatchEvent(\n      'artboardLayoutChanges',\n      new DesignerEvent('artboardLayoutChanges', this.canvas, this.canvas)\n    );\n  }\n\n  selectArtboard(context: IContext, artboard: Layer) {\n    this.selectedArtboard = artboard;\n\n    if (this.selectedArtboard) {\n      const artboardDims = this.selectedArtboard.getBoundingClientRect();\n\n      // set grid configuration\n      this.canvas.executeFunction('setGridOffset', {\n        x: artboardDims.rootX,\n        y: artboardDims.rootY,\n      });\n      this.canvas.executeFunction(\n        'setGridSize',\n        this.selectedArtboard.executeFunction('getGridSize')\n      );\n    }\n\n    this.canvas.dispatchEvent(\n      'artboardSelected',\n      new ArtboardEvent('artboardSelected', this.canvas, artboard, this.canvas)\n    );\n  }\n\n  focusArtboard(context: IContext) {\n    const canvasDims = this.canvas.getBoundingClientRect();\n    const artboardDims = context.layer.getBoundingClientRect();\n\n    const scrollDims = {\n      x: (artboardDims.x + artboardDims.width / 2) / canvasDims.width,\n      y: (artboardDims.y + artboardDims.height / 2) / canvasDims.height,\n    };\n\n    this.canvas.executeFunction('setScroll', scrollDims);\n  }\n\n  getHitArtboard(context: IContext, x: number, y: number) {\n    let hitLayers = this.canvas.getHitResult(x, y);\n    const artboardArray = Array.from(this.artboards.values());\n    let artboards: Array<Layer> = [];\n\n    forEach(hitLayers.reverse(), layer => {\n      if (artboardArray.includes(layer)) {\n        artboards.push(layer);\n      }\n    });\n\n    if (isEmpty(artboards)) {\n      return null;\n    }\n\n    return artboards[artboards.length - 1];\n  }\n\n  getSelectedArtboard(context: IContext, filePath: string) {\n    return this.selectedArtboard;\n  }\n  getSelectedArtboardId(context: IContext) {\n    return this.selectedArtboard\n      ? this.selectedArtboard.props.get('id')\n      : undefined;\n  }\n  getAllArtboards(context: IContext) {\n    return this.artboards;\n  }\n\n  getArtboardById(context: IContext, path: string) {\n    return this.artboards.get(path);\n  }\n\n  getArtboard(context: IContext) {\n    let layer = context.layer;\n    if (layer.type !== 'canvas') {\n      const artboardArray = Array.from(this.artboards.values());\n      while (!artboardArray.includes(layer) && layer.parent) {\n        layer = layer.parent;\n      }\n      if (artboardArray.includes(layer)) {\n        return layer;\n      } else {\n        return null;\n      }\n    } else {\n      throw new Error('getArtboard should be called on layer only');\n    }\n  }\n\n  getNewArtboardPosition = () => {\n    let left = Number.MIN_VALUE;\n    let artLeft = Number.MIN_VALUE;\n    let artTop = Number.MIN_VALUE;\n    let top = Number.MIN_VALUE;\n    const zoom = 1; // TODO: get actual zoom later\n\n    if (this.artboards.size === 0) {\n      return { left: 300, top: 50, artTop: 50, artLeft: 300 };\n    }\n    this.artboards.forEach((artboard: Layer) => {\n      const artboardClientRect = artboard.getBoundingClientRect();\n      const artMaxX = artboardClientRect.x + artboardClientRect.width;\n      const artMidY = artboardClientRect.y + artboardClientRect.height / 2;\n      if (left < artMaxX) {\n        left = artMaxX;\n        top = artMidY;\n        artTop = artboardClientRect.y;\n      }\n    });\n    artLeft = left + 50;\n    left = left * zoom + 50;\n    top = top * zoom - 40;\n    return { left, top, artTop, artLeft };\n  };\n\n  modifyEventForSelectableLayers(event: any, forLayerDrag: boolean = false) {\n    // Traverse up the chain to all the parents and modify e.target as soon as you find a layer that matches one of the following conditions\n    // - It is a sibling of selected layers,\n    // - It is one of the direct ancestors of the selected layer upto the root layer, siblings of those parents, or a direct children of root layer of any artboard\n\n    // console.log(\n    //   event.target,\n    //   'Canvas.dispatchEventOnHitLayer click original *(*(*('\n    // );\n\n    if (event.target && event.target.type === 'canvas') {\n      // event.target = null;\n      return;\n    }\n\n    const hitLayers = (event.target as Layer).getHitResult(\n      event.worldX,\n      event.worldY\n    );\n\n    const selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n    let currentRootLayer: Layer | undefined;\n    if (selectedArtboard) {\n      currentRootLayer = selectedArtboard.children[0];\n    }\n\n    let allRootLayerChildren: Array<Layer> = [];\n    const allRootLayers: Array<Layer> = [];\n\n    const artboardArray = Array.from(this.artboards.values());\n\n    artboardArray.forEach((artboard: Layer) => {\n      const rootLayer = artboard.children[0];\n\n      if (rootLayer) {\n        allRootLayerChildren = allRootLayerChildren.concat(rootLayer.children);\n        // allRootLayerChildren.push(rootLayer);\n        allRootLayers.push(rootLayer);\n      }\n    });\n\n    // Because artboard should be draggable (when dragging its label) but not clickable or hoverable\n    if (artboardArray.includes(event.target) && forLayerDrag) {\n      return;\n    }\n\n    let currentLayer: Layer | null = event.target;\n    while (\n      currentLayer &&\n      currentLayer.type !== 'canvas'\n      // !this.canvas.selectedLayers.includes(currentLayer)\n    ) {\n      if (this.topLayerSelectionMode) {\n        // Don't modify target, select top layer\n        break;\n      }\n\n      // If currentLayer is a sibling of selected Layer\n      if (\n        this.canvas.selectedLayers.length > 0 &&\n        this.canvas.selectedLayers[0].parent &&\n        this.canvas.selectedLayers[0].parent.children.includes(\n          currentLayer as Layer\n        )\n      ) {\n        const filteredLayer = filterIgnoredLayers(currentLayer, hitLayers);\n        if (filteredLayer) {\n          event.target = filteredLayer;\n        }\n        // console.log(currentLayer, 'is being hovered *(*(*(*');\n        break;\n      }\n\n      if (allRootLayerChildren.includes(currentLayer)) {\n        const filteredLayer = filterIgnoredLayers(currentLayer, hitLayers);\n        if (filteredLayer) {\n          event.target = filteredLayer;\n        }\n        break;\n      }\n\n      if (allRootLayers.includes(currentLayer)) {\n        const filteredLayer = filterIgnoredLayers(currentLayer, hitLayers);\n        if (filteredLayer) {\n          event.target = filteredLayer;\n        }\n        break;\n      }\n\n      const ancestorsList = [];\n\n      let parent: Layer | null = this.canvas.selectedLayers[0];\n      while (\n        currentRootLayer &&\n        parent &&\n        !currentRootLayer.children.includes(parent) &&\n        parent.parent\n      ) {\n        parent = parent.parent;\n        ancestorsList.push(parent);\n      }\n\n      let ancestorSiblingsList: Layer[] = [];\n      ancestorsList.forEach((ancestor: Layer) => {\n        if (ancestor.parent) {\n          ancestorSiblingsList = ancestorSiblingsList.concat(\n            ancestor.parent.children\n          );\n        }\n      });\n\n      if (union(ancestorsList, ancestorSiblingsList).includes(currentLayer)) {\n        const filteredLayer = filterIgnoredLayers(currentLayer, hitLayers);\n        if (filteredLayer) {\n          event.target = filteredLayer;\n        }\n        break;\n      }\n\n      currentLayer = currentLayer.parent;\n      // while (currentLayer && !hitLayers.includes(currentLayer?.parent)) {\n      //   currentLayer = currentLayer.parent;\n      // }\n\n      event.target = null;\n    }\n  }\n\n  setTopLayerSelectionMode(value: boolean) {\n    this.topLayerSelectionMode = value;\n  }\n\n  deactivate() {\n    this.canvas.removeFunction('addArtboard');\n    this.canvas.removeFunction('removeArtboard');\n    this.canvas.removeFunction('getArtboardById');\n    this.canvas.removeFunction('getNewArtboardPosition');\n    this.canvas.removeFunction('getSelectedArtboardId');\n  }\n}\n\nfunction filterIgnoredLayers(currentLayer: Layer, hitLayers: Array<Layer>) {\n  if (hitLayers.includes(currentLayer)) {\n    return currentLayer;\n  } else if (currentLayer.style.get('pointerEvents') === 'none') {\n    const topChildInHitLayers = findLast(currentLayer.children, child => {\n      if (hitLayers.includes(child)) {\n        return true;\n      }\n      return false;\n    });\n\n    if (topChildInHitLayers) {\n      return topChildInHitLayers;\n    }\n  }\n  return;\n}\n","import { Canvas, IPlugin, IContext } from '../..';\n\nexport default class LayerMouseCursorPlugin implements IPlugin {\n  name = 'LayerMouseCursorPlugin';\n  canvas!: Canvas;\n  dispose: any;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n\n  activate() {\n    this.canvas.addFunction(\n      'setMouseCursor',\n      (context: IContext, cursor: string) => {\n        context.layer.addEventListener('mouseEnter', (data: any) => {\n          this.canvas.setMouseCursor(cursor);\n        });\n        context.layer.addEventListener('mouseLeave', (data: any) => {\n          this.canvas.setMouseCursor('default');\n        });\n      }\n    );\n  }\n\n  deactivate() {\n    this.canvas.removeFunction('setMouseCursor');\n    this.dispose();\n  }\n}\n","import { Canvas, IPlugin, Layer, IContext } from '../..';\nconst path = require('path');\nexport default class DataStore implements IPlugin {\n  name = 'DataStore';\n  canvas!: Canvas;\n  dataMap = new Map<Layer, any>();\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n  activate() {\n    this.canvas.addFunction('setData', this.setData.bind(this));\n    this.canvas.addFunction('getData', this.getData.bind(this));\n    this.canvas.addFunction('removeData', this.removeData.bind(this));\n  }\n\n  setData(context: IContext, key: any, value: any) {\n    //\n    const layer = context.layer;\n    let layerData = this.dataMap.get(layer);\n\n    if (layerData) {\n      layerData = { ...layerData, [key]: value };\n    } else {\n      layerData = {\n        [key]: value,\n      };\n    }\n    // console.log(layerData, layer, 'layer data here');\n\n    this.dataMap.set(layer, layerData);\n  }\n\n  getData(context: IContext, key?: any) {\n    const layer = context.layer;\n    let layerData = this.dataMap.get(layer);\n    if (layerData) {\n      if (key) {\n        return layerData[key];\n      } else {\n        return layerData;\n      }\n    }\n  }\n\n  removeData(context: IContext, key?: any) {\n    const layer = context.layer;\n    let layerData = this.dataMap.get(layer);\n    if (key) {\n      delete layerData[key];\n    } else {\n      this.dataMap.delete(layer);\n    }\n  }\n\n  deactivate() {\n    this.canvas.removeFunction('setData');\n    this.canvas.removeFunction('getData');\n    this.canvas.removeFunction('removeData');\n  }\n}\n","import { Canvas, IPlugin, IPosition, IContext } from '../..';\n\nexport default class TooltipPlugin implements IPlugin {\n  name = 'Tooltip';\n  canvas!: Canvas;\n  dispose: any;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n\n  activate() {\n    const containerDiv = document.createElement('div');\n    containerDiv.style.position = 'absolute';\n    this.dispose = this.canvas.addDomToViewport(containerDiv);\n    containerDiv.style.pointerEvents = 'none';\n    containerDiv.style.padding = '.25em .4em';\n    containerDiv.style.fontWeight = '700px';\n    containerDiv.style.textAlign = 'center';\n    containerDiv.style.flexDirection = 'row';\n    containerDiv.style.alignItems = 'center';\n    containerDiv.style.justifyContent = 'center';\n    containerDiv.style.display = 'none';\n    containerDiv.style.whiteSpace = 'nowrap';\n    containerDiv.style.verticalAlign = 'middle';\n    containerDiv.style.borderRadius = '2px';\n    containerDiv.style.position = 'absolute';\n    containerDiv.style.color = 'white';\n    containerDiv.style.fontSize = '10px';\n    containerDiv.style.background = '#1FB2CC';\n    containerDiv.style.fontFamily =\n      'Roboto, -apple-system, BlinkMacSystemFont, sans-serif';\n\n    this.canvas.addFunction(\n      `${this.name}.show`,\n      (context: IContext, coords: IPosition, text: string) => {\n        containerDiv.style.left = `${coords.x}px`;\n        containerDiv.style.top = `${coords.y}px`;\n        containerDiv.style.display = 'flex';\n        if (containerDiv.childNodes.length) {\n          containerDiv.childNodes[0].nodeValue = text;\n        } else {\n          containerDiv.appendChild(document.createTextNode(text));\n        }\n      }\n    );\n\n    this.canvas.addFunction(`${this.name}.hide`, (context: IContext) => {\n      containerDiv.style.display = 'none';\n    });\n\n    this.canvas.addFunction(\n      `${this.name}.setPosition`,\n      (context: IContext, coords: IPosition) => {\n        containerDiv.style.left = `${coords.x}px`;\n        containerDiv.style.top = `${coords.y}px`;\n      }\n    );\n\n    this.canvas.addFunction(\n      `${this.name}.setText`,\n      (context: IContext, text: string) => {\n        if (containerDiv.childNodes.length) {\n          containerDiv.childNodes[0].nodeValue = text;\n        } else {\n          containerDiv.appendChild(document.createTextNode(text));\n        }\n      }\n    );\n  }\n\n  deactivate() {\n    this.canvas.removeFunction(`${this.name}.show`);\n    this.canvas.removeFunction(`${this.name}.hide`);\n    this.canvas.removeFunction(`${this.name}.setPosition`);\n    this.canvas.removeFunction(`${this.name}.setText`);\n    this.dispose();\n  }\n}\n","import { Canvas, IPlugin, Layer } from '../..';\nimport CommandEvent from '../../events/CommandEvent';\nexport default class OpacityShortcutPlugin implements IPlugin {\n  name = 'OpacityShortcut';\n  canvas!: Canvas;\n  dispose: any;\n  previousEvent: any;\n  opacity: number = 100;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n\n  activate() {\n    this.canvas.addEventListener('keyDown', this.handleKeyPress);\n  }\n\n  handleKeyPress = (event: any) => {\n    const originalEvent = event.originalEvent;\n    const keycode = originalEvent.keyCode || originalEvent.which;\n    let newOpacity = this.opacity;\n    const isModifierKeyPressed =\n      originalEvent.altKey ||\n      originalEvent.ctrlKey ||\n      originalEvent.metaKey ||\n      originalEvent.shiftKey;\n    if (\n      !isModifierKeyPressed &&\n      this.canvas.selectedLayers.length > 0 &&\n      keycode >= 48 &&\n      keycode <= 57\n    ) {\n      if (\n        this.previousEvent &&\n        originalEvent.timeStamp - this.previousEvent.timeStamp < 1000\n      ) {\n        newOpacity = this.opacity * 10 + parseInt(originalEvent.key);\n        if (newOpacity > 100) {\n          const opacityInString = newOpacity.toString();\n          newOpacity = parseInt(\n            opacityInString.slice(\n              opacityInString.length - 2,\n              opacityInString.length\n            )\n          );\n        }\n        this.opacity = newOpacity;\n      } else {\n        newOpacity = parseInt(originalEvent.key) * 10;\n        this.opacity = parseInt(originalEvent.key);\n      }\n      this.previousEvent = originalEvent;\n\n      this.canvas.selectedLayers.map((selectedLayer: Layer) => {\n        const commandParams = {\n          layer: selectedLayer,\n          key: 'opacity',\n          value: newOpacity / 100,\n          stylePropName: 'style',\n        };\n        this.canvas.dispatchEvent(\n          'setStyleAttribute',\n          new CommandEvent('setStyleAttribute', this.canvas, commandParams)\n        );\n      });\n    }\n  };\n\n  deactivate() {\n    this.dispose();\n  }\n}\n","import { Event, Layer } from '../..';\n\nexport class FontResizerEvent extends Event {\n  fontSize!: number;\n  y!: number;\n  x!: number;\n  constructor(\n    name: string,\n    target: Layer,\n    payload: {\n      fontSize?: number;\n      x?: number;\n      y?: number;\n    },\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    const { x, y, fontSize } = payload;\n    if (fontSize) this.fontSize = fontSize;\n    if (y) this.y = y;\n    if (x) this.x = x;\n  }\n}\n","import { Canvas, Layer, IPlugin } from '../..';\nimport { FontResizerEvent } from './FontResizerEvent';\nimport { IDimensionWithRoot } from 'interfaces';\n\nexport default class FontResizerPlugin implements IPlugin {\n  name = 'FontResizerPlugin';\n  namespace = 'FontResizer';\n  canvas!: Canvas;\n  disabled: boolean = false;\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addMiddleware(\n      `LayerResizer.handleDragStart`,\n      this.handleDragStart\n    );\n    this.canvas.addMiddleware(`LayerResizer.handleDrag`, this.handleDrag);\n    this.canvas.addMiddleware(`LayerResizer.handleDragEnd`, this.handleDragEnd);\n    this.canvas.addMiddleware(`LayerResizer.getHandles`, this.getHandles);\n    this.canvas.addFunction(\n      `${this.namespace}.disable`,\n      this.disableDrag.bind(this)\n    );\n  }\n  disableDrag() {\n    this.disabled = true;\n  }\n  isInsideCenterBox(\n    layerDims: IDimensionWithRoot,\n    parentDims: IDimensionWithRoot\n  ): boolean {\n    const parentBoundaries = {\n      left: parentDims.rootX + parentDims.width / 5,\n      right: parentDims.rootX + (parentDims.width * 4) / 5,\n      top: parentDims.rootY + parentDims.height / 10,\n      bottom: parentDims.rootY + (parentDims.height * 9) / 10,\n    };\n    const layerCenterY = layerDims.rootY + layerDims.height / 2;\n    const layerCenterX = layerDims.rootX + layerDims.width / 2;\n    return (\n      layerCenterX > parentBoundaries.left &&\n      layerCenterX < parentBoundaries.right &&\n      layerCenterY > parentBoundaries.top &&\n      layerCenterY < parentBoundaries.bottom\n    );\n  }\n  getHandles = (next: any, layers: Array<Layer>) => {\n    if (\n      layers.length === 1 &&\n      layers[0].type === 'text' &&\n      !layers[0].layout.get('height') &&\n      !layers[0].layout.get('width')\n    ) {\n      const textLayer = layers[0];\n      const parentDims = textLayer.parent?.getBoundingClientRect();\n      const textLayerDims = textLayer.getBoundingClientRect();\n      let newHandle = '';\n\n      if (parentDims) {\n        let parentCenterY = parentDims.rootY + parentDims.height / 2;\n        let parentCenterX = parentDims.rootX + parentDims.width / 2;\n\n        let textLayerCenterY = textLayerDims.rootY + textLayerDims.height / 2;\n        let textLayerCenterX = textLayerDims.rootX + textLayerDims.width / 2;\n        if (textLayerCenterY < parentCenterY) {\n          newHandle = 'B';\n        } else if (textLayerCenterY > parentCenterY) {\n          newHandle += 'T';\n        } else {\n          newHandle += '';\n        }\n\n        if (textLayerCenterX < parentCenterX) {\n          newHandle += 'R';\n        } else if (textLayerCenterX > parentCenterX) {\n          newHandle += 'L';\n        } else {\n          newHandle += '';\n        }\n\n        if (\n          textLayer.parent &&\n          this.isInsideCenterBox(textLayerDims, parentDims)\n        ) {\n          newHandle = 'B';\n        }\n        return [newHandle, 'ROTATE'];\n      }\n    } else {\n      return next(layers);\n    }\n  };\n  handleDragStart = (next: any, data: any) => {\n    const event = data.data;\n    const selectedLayer = data.selectedLayer;\n    if (\n      (event.targetHandle && event.targetHandle.includes('ROTATE')) ||\n      this.disabled\n    ) {\n      return next(data);\n    }\n    if (\n      selectedLayer &&\n      selectedLayer.type === 'text' &&\n      !selectedLayer.layout.get('height') &&\n      !selectedLayer.layout.get('width')\n    ) {\n      this.canvas.executeFunction('Tooltip.hide');\n      selectedLayer.executeFunction(\n        'setData',\n        'fontSize',\n        selectedLayer.layout.get('fontSize') || 14\n      );\n      selectedLayer.executeFunction(\n        'setData',\n        'initialDimensions',\n        selectedLayer.getBoundingClientRect()\n      );\n      this.canvas.executeFunction('LayerResizer.stopHandleRerender');\n      this.canvas.dispatchEvent(\n        `${this.namespace}.dragStart`,\n        new FontResizerEvent(`${this.namespace}.dragStart`, selectedLayer, {})\n      );\n    } else {\n      return next(data);\n    }\n  };\n\n  handleDrag = (next: any, data: any) => {\n    const event = data.data;\n    const selectedLayer = data.selectedLayer;\n\n    if (\n      (event.targetHandle && event.targetHandle.includes('ROTATE')) ||\n      this.disabled\n    ) {\n      return next(data);\n    }\n    if (\n      selectedLayer &&\n      selectedLayer.type === 'text' &&\n      !selectedLayer.layout.get('height') &&\n      !selectedLayer.layout.get('width')\n    ) {\n      const { session, targetHandle } = event;\n\n      let deltaInput = {\n        x: session.current.x - session.start.x,\n        y: session.current.y - session.start.y,\n      };\n\n      const currentFontSize = selectedLayer.executeFunction(\n        'getData',\n        'fontSize'\n      );\n      const initialDims = selectedLayer.executeFunction(\n        'getData',\n        'initialDimensions'\n      );\n\n      const ratioX = deltaInput.x / initialDims.width;\n      const ratioY = deltaInput.y / initialDims.height;\n      let newFontSize = currentFontSize;\n      let newLeft = initialDims.x;\n      let newTop = initialDims.y;\n\n      if (targetHandle === 'B') {\n        newFontSize += currentFontSize * ratioY;\n      } else if (targetHandle === 'T') {\n        newFontSize += -currentFontSize * ratioY;\n      } else {\n        if (targetHandle.indexOf('L') === -1) {\n          newFontSize += currentFontSize * ratioX;\n        } else {\n          newFontSize += -currentFontSize * ratioX;\n        }\n      }\n      if (newFontSize <= 0) {\n        newFontSize *= -1;\n      }\n      this.canvas.dispatchEvent(\n        `${this.namespace}.setFontSize`,\n        new FontResizerEvent(`${this.namespace}.setFontSize`, selectedLayer, {\n          fontSize: Math.round(newFontSize),\n        })\n      );\n      const currentDims = selectedLayer.getBoundingClientRect();\n      const widthChanged = currentDims.width - initialDims.width;\n      const heightChanged = currentDims.height - initialDims.height;\n      if (targetHandle === 'L' || targetHandle === 'R') {\n        newTop = newTop - heightChanged / 2;\n      } else if (!(targetHandle.indexOf('B') !== -1)) {\n        newTop = newTop - heightChanged;\n      }\n      if (!(targetHandle.indexOf('L') === -1)) {\n        newLeft = newLeft - widthChanged;\n      } else if (targetHandle === 'T' || targetHandle === 'B') {\n        newLeft = newLeft - widthChanged / 2;\n      }\n      const positionChanged =\n        initialDims.y !== newTop || initialDims.x !== newLeft;\n      if (positionChanged) {\n        this.canvas.dispatchEvent(\n          `${this.namespace}.setPosition`,\n          new FontResizerEvent(`${this.namespace}.setPosition`, selectedLayer, {\n            y: newTop,\n            x: newLeft,\n          })\n        );\n      }\n      this.canvas.executeFunction(\n        'Tooltip.show',\n        {\n          x: event.viewportX + 20,\n          y: event.viewportY + 20,\n        },\n        `${Math.round(newFontSize)}`\n      );\n    } else {\n      return next(data);\n    }\n  };\n\n  handleDragEnd = (next: any, data: any) => {\n    const event = data.data;\n    const selectedLayer = data.selectedLayer;\n    if (\n      (event.targetHandle && event.targetHandle.includes('ROTATE')) ||\n      this.disabled\n    ) {\n      return next(data);\n    }\n    if (\n      selectedLayer &&\n      selectedLayer.type === 'text' &&\n      !selectedLayer.layout.get('height') &&\n      !selectedLayer.layout.get('width')\n    ) {\n      this.canvas.executeFunction('Tooltip.hide');\n      selectedLayer.executeFunction(\n        'setData',\n        'fontSize',\n        selectedLayer.layout.get('fontSize') || 14\n      );\n      selectedLayer.executeFunction(\n        'setData',\n        'initialDimensions',\n        selectedLayer.getBoundingClientRect()\n      );\n      this.canvas.executeFunction('LayerResizer.startHandleRerender');\n      this.canvas.dispatchEvent(\n        `${this.namespace}.dragEnd`,\n        new FontResizerEvent(`${this.namespace}.dragEnd`, selectedLayer, {})\n      );\n    } else {\n      return next(data);\n    }\n  };\n\n  deactivate() {}\n}\n","import { Canvas, Layer, IPlugin } from '../..';\nimport { forEach, indexOf, sortBy, cloneDeep, isNil, get } from 'lodash';\nimport { IDimensionWithRotation } from 'interfaces';\nimport DesignerMouseEvent from '../../events/MouseEvent';\nimport { Event } from '../../events';\nimport CommandEvent from '../../events/CommandEvent';\n\nconst transitionStyle = document.createElement('style');\ntransitionStyle.innerHTML = `\n #transition {\n   transition: top 0.2s ease-in 0s, left 0.2s ease-in 0s, right 0.2s ease-in 0s,\n     bottom 0.2s ease-in 0s;\n }`;\n\nexport default class FlexDragPlugin implements IPlugin {\n  name = 'FlexDragPlugin';\n  namespace = 'FlexDrag';\n  canvas!: Canvas;\n  disabled: boolean = false;\n  layerOpacities: Map<Layer, number> = new Map<Layer, number>();\n  previousTriggerPoint: number | null = null;\n  nextTriggerPoint: number | null = null;\n  targetInitialDims!: IDimensionWithRotation;\n  target: Array<Layer> | Layer = [];\n  flexDirection!: string;\n  flexLayers: Array<Layer | undefined> = [];\n  totalDx: number = 0;\n  totalDy: number = 0;\n  newTargetIndex: number | undefined;\n  initialSnapshotData: Map<Layer, any> = new Map();\n  beforeDragSnapshotData: Map<Layer, any> = new Map();\n  currentSnapshotData: Map<Layer, any> = new Map();\n  ghostLayer!: Layer;\n  targetGhostLayer!: Layer;\n  isFlex: boolean = false;\n  layersHeightWidth: Map<Layer, { height: any; width: any }> = new Map();\n  initialParentData: { layer: Layer; dims: any } | undefined;\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addMiddleware(`LayerDrag.dragStart`, this.layerDragStart);\n    this.canvas.addMiddleware(`LayerDrag.drag`, this.layerDrag);\n    this.canvas.addMiddleware(`LayerDrag.dragEnd`, this.layerDragEnd);\n\n    this.canvas.addMiddleware(`LayerResizer.dragStart`, this.layerDragStart);\n    this.canvas.addMiddleware(`LayerResizer.drag`, this.layerResizerDrag);\n    this.canvas.addMiddleware(`LayerResizer.dragEnd`, this.layerResizerDragEnd);\n    this.canvas.addFunction(`${this.namespace}.disable`, () => {\n      this.disabled = true;\n    });\n  }\n  saveLayersHeightWidth = (layer: Layer) => {\n    if (!this.layersHeightWidth.get(layer)) {\n      this.layersHeightWidth.set(layer, {\n        height: layer.layout.get('height'),\n        width: layer.layout.get('width'),\n      });\n    }\n  };\n  clearFlexLayersHeightWidth = () => {\n    this.layersHeightWidth.clear();\n  };\n  saveSiblingOpacity = (parentLayer: Layer) => {\n    forEach(parentLayer.children, (layer: Layer) => {\n      if (layer.isFlexChild()) {\n        let opacity = !isNil(layer.style.get('opacity'))\n          ? layer.style.get('opacity')\n          : 1;\n        this.layerOpacities.set(layer, opacity);\n        layer.setStyle('opacity', 0.3);\n      }\n    });\n  };\n  revertSiblingOpacity = () => {\n    this.layerOpacities.forEach((opacity: any, layer: Layer) => {\n      layer.setStyle('opacity', this.layerOpacities.get(layer));\n    });\n    this.layerOpacities.clear();\n  };\n  layerResizerDrag = (next: any, event: any) => {\n    if (this.disabled) return;\n    if (event.selectedLayers.length === 0) {\n      return;\n    }\n    if (!this.isFlex) {\n      return next(event);\n    } else {\n    }\n  };\n  layerResizerDragEnd = (next: any, event: any) => {\n    if (this.disabled) return;\n    if (event.selectedLayers.length === 0) {\n      return;\n    }\n    this.revertParentDims();\n    this.canvas.dispatchEvent(\n      `${this.namespace}.dragEnd`,\n      new Event(`${this.namespace}.dragEnd`, this.canvas)\n    );\n    if (!this.isFlex) {\n      return next(event);\n    }\n  };\n  revertParentDims = () => {\n    if (this.initialParentData) {\n      const layer = this.initialParentData.layer;\n      const dims = this.initialParentData.dims;\n      if (layer.isAutoHeight() || layer.isAutoWidth()) {\n        layer.removeLayout(['position', 'top', 'left', 'right', 'bottom']);\n        if (!dims.hasOwnProperty('height')) {\n          layer.removeLayout('height');\n        }\n        if (!dims.hasOwnProperty('width')) {\n          layer.removeLayout('width');\n        }\n        layer.setLayout(dims);\n        this.initialParentData = undefined;\n      }\n    }\n  };\n  changeParentDims = (layer: Layer) => {\n    if (\n      !this.initialParentData &&\n      (layer.isAutoHeight() || layer.isAutoWidth())\n    ) {\n      this.initialParentData = { layer, dims: layer.layout.getAll() };\n      const dims = this.getMarginAdjustedBounds(layer);\n      layer.setLayout({\n        position: 'absolute',\n        left: dims.x,\n        top: dims.y,\n        width: dims.width,\n        height: dims.height,\n      });\n    }\n  };\n  /*\n    ---> This is used to differentiate between both in the code wherever required:\n    - Event from layerResizer is of type {data:Event,selectedLayers:current selected layers}\n    - Event from layer drag is directly Event\n    ---> On each drag start a ghost layer is created and everything else is handeled on that\n         ghost layer only.\n  */\n\n  setFlexLayers = () => {\n    let parent;\n    if (this.target instanceof Layer) {\n      parent = this.target.parent;\n    } else {\n      parent = this.target[0].parent;\n    }\n    if (parent) {\n      this.flexLayers = [];\n      forEach(parent.children, (layer: Layer) => {\n        document.body.appendChild(transitionStyle);\n        if (layer.isFlexChild()) {\n          layer.setProp('id', 'transition');\n          this.saveLayersHeightWidth(layer);\n          this.flexLayers.push(layer);\n        } else {\n          this.flexLayers.push(undefined);\n        }\n      });\n    }\n  };\n\n  createGhostLayer = (layout: any, parent: Layer) => {\n    const dims = {\n      width: layout.width,\n      height: layout.height,\n      left: layout.x,\n      top: layout.y,\n      position: 'absolute',\n    };\n    if (this.target instanceof Layer) {\n      this.ghostLayer = this.canvas.createLayer();\n      parent.addChild(this.ghostLayer);\n      this.ghostLayer.setLayout(dims);\n      this.ghostLayer.executeFunction('Hover.hideLayer');\n      this.target.setStyle('opacity', this.layerOpacities.get(this.target));\n      const layerStyles = { ...this.target.style.getAll() };\n      this.ghostLayer.setStyle({ ...layerStyles, opacity: 0 });\n    } else {\n      const wrapperLayer = this.canvas.createLayer();\n      parent.addChild(wrapperLayer);\n      wrapperLayer.setLayout(dims);\n      wrapperLayer.executeFunction('Hover.hideLayer');\n      this.target.forEach((layer: Layer) => {\n        const copyLayer = this.canvas.createLayer();\n        wrapperLayer.addChild(copyLayer);\n        const layerDims = this.getMarginAdjustedBounds(layer);\n        const layerStyles = { ...layer.style.getAll() };\n        layer.setStyle('opacity', this.layerOpacities.get(layer));\n        const wrapperLayerDims = this.getMarginAdjustedBounds(wrapperLayer);\n        copyLayer.setLayout({\n          left: layerDims.x - wrapperLayerDims.x,\n          top: layerDims.y - wrapperLayerDims.y,\n          width: layerDims.width,\n          height: layerDims.height,\n          position: 'absolute',\n        });\n        copyLayer.setStyle({ ...layerStyles, opacity: 0 });\n      });\n      this.ghostLayer = wrapperLayer;\n    }\n  };\n\n  startGhostDragging = (event: any) => {\n    document.addEventListener('mousemove', this.ghostMove);\n    document.addEventListener('mouseup', this.ghostMouseUp);\n    document.addEventListener('contextmenu', this.ghostMouseUp);\n    this.canvas.setDragging(true);\n    const mouseDownEvent = new DesignerMouseEvent(\n      'mousedown',\n      this.canvas,\n      event.originalEvent,\n      this.canvas\n    );\n    this.canvas.dispatchEventOnHitLayer('mousedown', mouseDownEvent);\n  };\n  ghostMove = (e: any) => {\n    this.canvas.handleNativeEvent(e);\n  };\n  ghostMouseUp = (e: any) => {\n    document.removeEventListener('mousemove', this.ghostMove);\n    document.removeEventListener('mouseup', this.ghostMouseUp);\n    document.removeEventListener('contextmenu', this.ghostMouseUp);\n    this.canvas.handleNativeEvent(e);\n    this.canvas.setDragging(false);\n  };\n  getMarginAdjustedBounds = (layer: Layer) => {\n    let initialBounds = layer.getBoundingClientRect();\n    return {\n      ...initialBounds,\n      x: initialBounds.x - layer.getMarginLeft(),\n      y: initialBounds.y - layer.getMarginTop(),\n    };\n  };\n  endFlexLayerDragging = (event: any) => {\n    const mouseUpEvent = new DesignerMouseEvent(\n      'mouseup',\n      this.canvas,\n      event.originalEvent,\n      this.canvas\n    );\n    this.canvas.dispatchEventOnHitLayer('mouseup', mouseUpEvent);\n  };\n\n  recordCurrentSnapshot = (parent: Layer) => {\n    this.currentSnapshotData.clear();\n    parent.children.forEach((child: Layer, index: number) => {\n      if (child !== this.ghostLayer)\n        this.currentSnapshotData.set(child, {\n          index,\n          dims: cloneDeep(this.getMarginAdjustedBounds(child)),\n        });\n    });\n  };\n\n  changeToAbsolute = (parent: Layer) => {\n    parent.children.forEach((sibling: Layer) => {\n      if (sibling !== this.ghostLayer) {\n        const siblingDims = this.getMarginAdjustedBounds(sibling);\n        sibling.setLayout({\n          position: 'absolute',\n          left: siblingDims.x,\n          top: siblingDims.y,\n          width: siblingDims.width,\n          height: siblingDims.height,\n        });\n      }\n    });\n  };\n\n  revertBackToSnapshot = (parent: Layer, snapshotData: Map<Layer, any>) => {\n    snapshotData.forEach((value: any, layer: Layer) => {\n      if (layer.getIndexInParent() !== value.index)\n        layer.move(parent, value.index);\n      if (this.flexLayers.includes(layer)) {\n        layer.removeLayout(['position', 'top', 'left', 'right', 'bottom']);\n      }\n      const originalHW = this.layersHeightWidth.get(layer);\n      if (this.flexLayers.includes(layer) && originalHW) {\n        if (!originalHW.height && !isNil(layer.layout.get('height')))\n          layer.removeLayout('height');\n        if (!originalHW.width && !isNil(layer.layout.get('width')))\n          layer.removeLayout('width');\n      }\n    });\n  };\n\n  findAbsolutePreviousLayer = (index: number) => {\n    let previousLayer = undefined;\n    let prevLayerIndex = index - 1;\n    while (isNil(previousLayer) && prevLayerIndex >= 0) {\n      if (this.flexLayers[prevLayerIndex]) {\n        previousLayer = this.flexLayers[prevLayerIndex];\n      }\n      prevLayerIndex--;\n    }\n    return previousLayer;\n  };\n  findPreviousLayer = (index: number) => {\n    if (this.flexDirection && this.flexDirection.includes('reverse')) {\n      return this.findAbsoluteNextLayer(index);\n    }\n    return this.findAbsolutePreviousLayer(index);\n  };\n  findAbsoluteNextLayer = (index: any) => {\n    let nextLayer = undefined;\n    let nextLayerIndex = index + 1;\n    while (isNil(nextLayer) && nextLayerIndex < this.flexLayers.length) {\n      if (this.flexLayers[nextLayerIndex]) {\n        nextLayer = this.flexLayers[nextLayerIndex];\n      }\n      nextLayerIndex++;\n    }\n    return nextLayer;\n  };\n  findNextLayer = (index: number) => {\n    if (this.flexDirection && this.flexDirection.includes('reverse')) {\n      return this.findAbsolutePreviousLayer(index);\n    }\n    return this.findAbsoluteNextLayer(index);\n  };\n\n  setTriggerPoints = () => {\n    this.previousTriggerPoint = null;\n    this.nextTriggerPoint = null;\n    if (this.target instanceof Layer) {\n      const targetIndexInParent = indexOf(this.flexLayers, this.target);\n      if (targetIndexInParent !== -1) {\n        let previousLayer = this.findPreviousLayer(targetIndexInParent);\n        let nextLayer = this.findNextLayer(targetIndexInParent);\n        const currentTargetDims = this.getMarginAdjustedBounds(this.target);\n        if (previousLayer) {\n          const previousLayerDims = this.getMarginAdjustedBounds(previousLayer);\n          this.previousTriggerPoint = this.calculateTriggerPoint(\n            previousLayerDims,\n            currentTargetDims\n          );\n        }\n\n        if (nextLayer) {\n          const nextLayerDims = this.getMarginAdjustedBounds(nextLayer);\n          this.nextTriggerPoint = this.calculateTriggerPoint(\n            currentTargetDims,\n            nextLayerDims\n          );\n        }\n      }\n    } else {\n      const sortedSelectedLayers = sortBy(this.target, (layer: Layer) =>\n        layer.getIndexInParent()\n      );\n\n      const firstSelectedLayerIndex = indexOf(\n        this.flexLayers,\n        sortedSelectedLayers[0]\n      );\n      const lastSelectedLayerIndex = indexOf(\n        this.flexLayers,\n        sortedSelectedLayers[sortedSelectedLayers.length - 1]\n      );\n\n      if (firstSelectedLayerIndex !== -1 && lastSelectedLayerIndex !== -1) {\n        const previousLayer = this.findPreviousLayer(firstSelectedLayerIndex);\n        const nextLayer = this.findNextLayer(lastSelectedLayerIndex);\n\n        const boundingBoxDims = this.canvas.getBoundingBox(\n          sortedSelectedLayers\n        );\n        const parentDims =\n          sortedSelectedLayers.length && sortedSelectedLayers[0].parent\n            ? this.getMarginAdjustedBounds(sortedSelectedLayers[0].parent)\n            : undefined;\n\n        if (parentDims) {\n          const boundingBoxDimsWRTParent = {\n            ...boundingBoxDims,\n            x: boundingBoxDims.x - parentDims.rootX,\n            y: boundingBoxDims.y - parentDims.rootY,\n          };\n          if (previousLayer) {\n            const previousLayerDims = this.getMarginAdjustedBounds(\n              previousLayer\n            );\n            this.previousTriggerPoint = this.calculateTriggerPoint(\n              previousLayerDims,\n              boundingBoxDimsWRTParent\n            );\n          }\n\n          if (nextLayer) {\n            const nextLayerDims = this.getMarginAdjustedBounds(nextLayer);\n            this.nextTriggerPoint = this.calculateTriggerPoint(\n              boundingBoxDimsWRTParent,\n              nextLayerDims\n            );\n          }\n        }\n      }\n    }\n  };\n\n  calculateTriggerPoint = (\n    previousLayerDims: IDimensionWithRotation,\n    nextLayerDims: IDimensionWithRotation\n  ) => {\n    if (this.flexDirection === 'row' || this.flexDirection === 'row-reverse') {\n      return (previousLayerDims.x + nextLayerDims.x + nextLayerDims.width) / 2;\n    } else {\n      return (nextLayerDims.y + nextLayerDims.height + previousLayerDims.y) / 2;\n    }\n  };\n\n  handleSwapWRTNewPosition = (oldCenter: number, newCenter: number) => {\n    const crossedPreviousTriggerPoint =\n      this.previousTriggerPoint &&\n      oldCenter > this.previousTriggerPoint &&\n      newCenter < this.previousTriggerPoint;\n\n    const crossedNextTriggerPoint =\n      this.nextTriggerPoint &&\n      oldCenter < this.nextTriggerPoint &&\n      newCenter > this.nextTriggerPoint;\n    let targetLayerIndex;\n    let newIndex;\n    let toMoveLayer;\n    if (this.target instanceof Layer) {\n      targetLayerIndex = indexOf(this.flexLayers, this.target);\n      newIndex = targetLayerIndex;\n      toMoveLayer = crossedPreviousTriggerPoint\n        ? this.findPreviousLayer(targetLayerIndex)\n        : crossedNextTriggerPoint\n        ? this.findNextLayer(targetLayerIndex)\n        : null;\n      if (toMoveLayer)\n        this.newTargetIndex = indexOf(this.flexLayers, toMoveLayer);\n    } else {\n      const sortedSelectedLayers = sortBy(this.target, (layer: Layer) =>\n        layer.getIndexInParent()\n      );\n\n      const firstSelectedLayerIndex = indexOf(\n        this.flexLayers,\n        sortedSelectedLayers[0]\n      );\n      const lastSelectedLayerIndex = indexOf(\n        this.flexLayers,\n        sortedSelectedLayers[sortedSelectedLayers.length - 1]\n      );\n      if (crossedPreviousTriggerPoint) {\n        newIndex = lastSelectedLayerIndex;\n        toMoveLayer = this.findPreviousLayer(firstSelectedLayerIndex);\n        if (toMoveLayer)\n          this.newTargetIndex = indexOf(this.flexLayers, toMoveLayer);\n      } else if (crossedNextTriggerPoint) {\n        newIndex = firstSelectedLayerIndex;\n        toMoveLayer = this.findNextLayer(lastSelectedLayerIndex);\n        if (toMoveLayer)\n          this.newTargetIndex = indexOf(this.flexLayers, toMoveLayer);\n      }\n    }\n    if (!isNil(newIndex) && newIndex >= 0 && toMoveLayer) {\n      this.internalMove(toMoveLayer, newIndex);\n    }\n  };\n\n  internalMove = (targetLayer: Layer, newIndex: number) => {\n    let parent = targetLayer.parent;\n    if (parent) {\n      this.revertBackToSnapshot(parent, this.currentSnapshotData);\n      targetLayer.move(parent, newIndex);\n      const newPositionData: Map<Layer, any> = new Map();\n      parent.children.forEach((child: Layer) => {\n        if (child !== this.ghostLayer) {\n          newPositionData.set(child, this.getMarginAdjustedBounds(child));\n        }\n      });\n      this.recordCurrentSnapshot(parent);\n      this.setFlexLayers();\n      this.setTriggerPoints();\n      this.revertBackToSnapshot(parent, this.beforeDragSnapshotData);\n      this.changeToAbsolute(parent);\n      parent.children.forEach((child: Layer) => {\n        const newChildLayout = newPositionData.get(child);\n        if (child !== this.ghostLayer && newChildLayout) {\n          child.setLayout({\n            left: newChildLayout.x,\n            top: newChildLayout.y,\n          });\n        }\n      });\n    }\n  };\n  layerDragStart = (next: any, event: any) => {\n    if (this.disabled) return;\n    this.totalDx = 0;\n    this.totalDy = 0;\n    this.canvas.dispatchEvent(\n      `${this.namespace}.dragStart`,\n      new Event(`${this.namespace}.dragStart`, this.canvas)\n    );\n    if (event.selectedLayers) {\n      const isFlex = event.selectedLayers.every((layer: Layer) =>\n        layer.isFlexChild()\n      );\n      this.isFlex = isFlex;\n      if (!isFlex) {\n        return next(event);\n      }\n      this.target = event.selectedLayers;\n\n      const parent: Layer = get(event.selectedLayers, '[0].parent');\n      const boundingBoxDims = this.canvas.getBoundingBox(event.selectedLayers);\n      if (parent) {\n        const parentDims = this.getMarginAdjustedBounds(parent);\n        this.saveSiblingOpacity(parent);\n        const boundingBoxDimsWRTParent = {\n          ...boundingBoxDims,\n          x: boundingBoxDims.x - parentDims.rootX,\n          y: boundingBoxDims.y - parentDims.rootY,\n        };\n        this.targetInitialDims = boundingBoxDimsWRTParent;\n        this.flexDirection = parent.layout.get('flexDirection');\n        this.setFlexLayers();\n        this.recordCurrentSnapshot(parent);\n        this.initialSnapshotData = new Map(this.currentSnapshotData);\n        this.beforeDragSnapshotData = new Map(this.currentSnapshotData);\n        this.endFlexLayerDragging(event.data);\n        this.createGhostLayer(this.targetInitialDims, parent);\n        this.startGhostDragging(event.data);\n        this.changeParentDims(parent);\n        this.changeToAbsolute(parent);\n        this.setTriggerPoints();\n      }\n    } else {\n      if (!event || !(event && event.target)) {\n        return next(event);\n      }\n      const isFlex = event.target ? event.target.isFlexChild() : false;\n      this.isFlex = isFlex;\n      if (event.target === this.ghostLayer) {\n        this.targetGhostLayer = event.target;\n      }\n      if (!isFlex) {\n        return next(event);\n      }\n      this.target = event.target;\n      this.targetInitialDims = this.getMarginAdjustedBounds(event.target);\n      const parent: Layer = event.target.parent;\n      if (parent) {\n        this.saveSiblingOpacity(parent);\n        this.flexDirection = parent.layout.get('flexDirection');\n        this.setFlexLayers();\n        this.recordCurrentSnapshot(parent);\n        this.initialSnapshotData = new Map(this.currentSnapshotData);\n        this.beforeDragSnapshotData = new Map(this.currentSnapshotData);\n        this.endFlexLayerDragging(event);\n        this.createGhostLayer(this.targetInitialDims, parent);\n        this.startGhostDragging(event);\n        this.changeParentDims(parent);\n        this.changeToAbsolute(parent);\n        this.setTriggerPoints();\n      }\n    }\n  };\n\n  layerDrag = (next: any, event: any) => {\n    if (this.disabled) return;\n    // if (!this.isFlex) {\n    //   return next(event);\n    // }\n    this.canvas.dispatchEvent(\n      `${this.namespace}.drag`,\n      new Event(`${this.namespace}.drag`, this.canvas)\n    );\n    if (this.targetGhostLayer) {\n      this.canvas.selectLayers([]);\n      this.totalDx += event.worldDx;\n      this.totalDy += event.worldDy;\n\n      let targetNewDims;\n      if (this.target instanceof Layer) {\n        targetNewDims = this.getMarginAdjustedBounds(this.target);\n      } else {\n        const boundingBoxDims = this.canvas.getBoundingBox(this.target);\n        const parentDims = this.target[0].parent\n          ? this.getMarginAdjustedBounds(this.target[0].parent)\n          : undefined;\n        if (parentDims) {\n          targetNewDims = {\n            ...boundingBoxDims,\n            x: boundingBoxDims.x - parentDims.rootX,\n            y: boundingBoxDims.y - parentDims.rootY,\n          };\n        } else {\n          targetNewDims = boundingBoxDims;\n        }\n      }\n\n      const newLeft = this.targetInitialDims.x + this.totalDx;\n      const newTop = this.targetInitialDims.y + this.totalDy;\n      this.ghostLayer.setLayout({ left: newLeft, top: newTop });\n\n      let oldCenterTargetLayer = null;\n      let newCenterTargetLayer = null;\n      if (\n        this.flexDirection === 'row' ||\n        this.flexDirection === 'row-reverse'\n      ) {\n        oldCenterTargetLayer = targetNewDims.x + targetNewDims.width / 2;\n        newCenterTargetLayer = newLeft + this.targetInitialDims.width / 2;\n      } else {\n        oldCenterTargetLayer = targetNewDims.y + targetNewDims.height / 2;\n        newCenterTargetLayer = newTop + this.targetInitialDims.height / 2;\n      }\n      this.handleSwapWRTNewPosition(oldCenterTargetLayer, newCenterTargetLayer);\n    } else {\n      next(event);\n    }\n  };\n  layerDragEnd = (next: any, event: any) => {\n    if (this.disabled) return;\n    if (this.targetGhostLayer) {\n      this.isFlex = false;\n      const parent = this.targetGhostLayer.parent;\n      this.revertSiblingOpacity();\n      if (parent) {\n        while (this.ghostLayer.children.length !== 0) {\n          this.ghostLayer.removeChild(this.ghostLayer.children[0]);\n        }\n        parent.removeChild(this.ghostLayer);\n        delete this.ghostLayer;\n        this.revertBackToSnapshot(parent, this.beforeDragSnapshotData);\n      }\n      document.body.removeChild(transitionStyle);\n      delete this.targetGhostLayer;\n      if (this.target instanceof Layer) {\n        if (\n          !isNil(this.newTargetIndex) &&\n          this.target.getIndexInParent() !== this.newTargetIndex\n        ) {\n          this.canvas.dispatchEvent(\n            'moveLayer',\n            new CommandEvent('moveLayer', this.canvas, {\n              fromParent: this.target.parent,\n              toParent: this.target.parent,\n              fromIndex: this.target.getIndexInParent(),\n              toIndex: this.newTargetIndex,\n            })\n          );\n        }\n        this.target.parent?.children.forEach((sibling: Layer) => {\n          sibling.setProp('id', undefined);\n        });\n      } else {\n        let sortedSelectedLayers = sortBy(this.target, (layer: Layer) =>\n          layer.getIndexInParent()\n        );\n\n        if (\n          !isNil(this.newTargetIndex) &&\n          sortedSelectedLayers[0].getIndexInParent() > this.newTargetIndex\n        ) {\n          sortedSelectedLayers = sortedSelectedLayers.reverse();\n        }\n        let newToSelectLayers: Array<Layer> = [];\n        if (\n          !isNil(this.newTargetIndex) &&\n          sortedSelectedLayers[0].getIndexInParent() !== this.newTargetIndex\n        ) {\n          sortedSelectedLayers.forEach((layer: Layer) => {\n            const parent = layer.parent;\n            this.canvas.dispatchEvent(\n              'moveLayer',\n              new CommandEvent('moveLayer', this.canvas, {\n                fromParent: parent,\n                toParent: parent,\n                fromIndex: layer.getIndexInParent(),\n                toIndex: this.newTargetIndex,\n              })\n            );\n            if (parent && !isNil(this.newTargetIndex))\n              newToSelectLayers.push(parent.children[this.newTargetIndex]);\n          });\n        }\n\n        if (newToSelectLayers.length)\n          this.canvas.selectLayers(newToSelectLayers);\n        else this.canvas.selectLayers(this.target);\n\n        this.target[0].parent?.children.forEach((sibling: Layer) => {\n          sibling.setProp('id', undefined);\n        });\n      }\n      this.clearFlexLayersHeightWidth();\n      this.revertParentDims();\n      delete this.newTargetIndex;\n      this.canvas.dispatchEvent(\n        `${this.namespace}.dragEnd`,\n        new Event(`${this.namespace}.dragEnd`, this.canvas)\n      );\n    } else {\n      return next(event);\n    }\n  };\n\n  deactivate() {}\n}\n","import * as React from 'react';\nexport default class Ruler extends React.PureComponent<any, any> {\n  domWidth: any;\n  domHeight: any;\n  height: any;\n  width: any;\n  ruler: any;\n  ctx: any;\n  lock: any;\n  vertical: any;\n  onLineChange: any;\n  fontScale: any;\n  bgColor: any;\n  fgColor: any;\n  fontColor: any;\n  lineColor: any;\n  shadowColor: any;\n  horLineValue: any;\n  verLineValue: any;\n  startX: any;\n  startY: any;\n  perWidth: any;\n  ratio: any;\n  shadow: any;\n  componentDidMount() {\n    this.handleResize(true);\n    window.addEventListener('resize', this.handleResize);\n  }\n  componentDidUpdate() {\n    this.handleResize(true);\n  }\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.handleResize);\n  }\n  handleResize = (render: any) => {\n    const height = this.props.height;\n    const width = this.props.width;\n    this.domWidth = width;\n    this.domHeight = height;\n    this.width = width * this.props.ratio;\n    this.height = height * this.props.ratio;\n    this.ruler.width = this.width;\n    this.ruler.height = this.height;\n\n    const ctx = this.ruler.getContext('2d');\n    ctx.font = `${12 *\n      this.props.ratio}px Roboto, -apple-system, \".SFNSText-Regular\",\n      \"SF UI Text\", \"Helvetica Neue\", Arial, \"PingFang SC\",\n      \"Hiragino Sans GB\", \"Microsoft YaHei\", \"WenQuanYi Zen Hei\", sans-serif`;\n\n    ctx.lineWidth = this.props.ratio;\n    ctx.strokeStyle = '#6F727D';\n    ctx.textBaseline = 'middle';\n    this.ctx = ctx;\n\n    const { start } = this.props;\n    if (render) {\n      this.drawRuler(start, ctx);\n    }\n  };\n  drawRuler(start: any, select: any) {\n    // console.log('*** drawRuler');\n  }\n  render() {\n    return (\n      <canvas\n        style={{ pointerEvents: 'none' }}\n        className=\"ruler\"\n        ref={ref => (this.ruler = ref)}\n      />\n    );\n  }\n}\n","import Ruler from './Ruler';\n\nexport default class HorizontalRuler extends Ruler {\n  drawRuler(start: any, ctx: any) {\n    let {\n      fontColor,\n      bgColor,\n      fontScale,\n      width,\n      height,\n      ratio,\n      perWidth,\n      scale,\n      zoom,\n    } = this.props;\n    ctx.fillStyle = bgColor;\n    ctx.fillRect(0, 0, width, height);\n    ctx.translate(-start * ratio, 0);\n    ctx.beginPath();\n    ctx.fillStyle = fontColor;\n\n    const startX = start - (start % perWidth);\n    for (let i = startX; i < startX + width / ratio; i += perWidth) {\n      let tempX = ((i >> 0) + 0.5) * ratio;\n      ctx.lineWidth = 0.5;\n      ctx.moveTo(tempX, height);\n      let text: any = i / zoom;\n      text = Math.round(text / scale) * scale;\n\n      if (text % (scale * 10) === 0) {\n        ctx.save();\n        ctx.translate((i + 2) * ratio, 0);\n        ctx.scale(fontScale, fontScale);\n        ctx.fillText(text, 2 * ratio, height / 2);\n        ctx.restore();\n        ctx.lineTo(tempX, 0);\n      } else if (text % (scale * 5) === 0) {\n        ctx.lineTo(tempX, height / 2);\n      } else {\n        ctx.lineTo(tempX, (height * 2) / 3);\n      }\n      ctx.stroke();\n    }\n    ctx.closePath();\n    ctx.translate(start * ratio, 0);\n  }\n}\n","import Ruler from './Ruler';\n\nexport default class VerticalRuler extends Ruler {\n  constructor(props: any) {\n    super(props);\n    this.vertical = true;\n  }\n  drawRuler(start: any, ctx: any) {\n    const {\n      fontColor,\n      bgColor,\n      fontScale,\n      width,\n      height,\n      ratio,\n      perWidth,\n      scale,\n      zoom,\n    } = this.props;\n\n    ctx.fillStyle = bgColor;\n    ctx.fillRect(0, 0, width, height);\n    ctx.translate(0, -start * ratio);\n    ctx.beginPath();\n    ctx.fillStyle = fontColor;\n    const perHeight = perWidth;\n    const startY = start - (start % perHeight);\n    for (let i = startY; i < startY + height / ratio; i += perHeight) {\n      let tempY = ((i >> 0) + 0.5) * ratio;\n      let text: any = i / zoom;\n      text = Math.round(text / scale) * scale;\n      ctx.moveTo(width, tempY);\n      if (text % (scale * 10) === 0) {\n        ctx.save();\n        ctx.translate(width, (i - 2) * ratio);\n        ctx.rotate(-Math.PI / 2);\n        ctx.scale(fontScale, fontScale);\n        ctx.fillText(text, 2 * ratio, (-width / 3) * 2);\n        ctx.restore();\n        ctx.lineTo(0, tempY);\n      } else if (text % (scale * 5) === 0) {\n        ctx.lineTo(width / 2, tempY);\n      } else {\n        ctx.lineTo((width * 2) / 3, tempY);\n      }\n      ctx.stroke();\n    }\n    ctx.closePath();\n    ctx.translate(0, start * ratio);\n  }\n}\n","import * as React from 'react';\nimport HorizontalRuler from './components/HorizontalRuler';\nimport VerticalRuler from './components/VerticalRuler';\nimport { Canvas } from '../..';\nimport { isEmpty } from 'lodash';\n\nexport default class RulerScaleWrapper extends React.PureComponent<any, any> {\n  // TODO: move it to somewhere else\n  getPixelRatio() {\n    var context: any = document.createElement('canvas').getContext('2d');\n    var backingStore = 1;\n\n    if (context) {\n      backingStore =\n        context.backingStorePixelRatio ||\n        context.webkitBackingStorePixelRatio ||\n        context.mozBackingStorePixelRatio ||\n        context.msBackingStorePixelRatio ||\n        context.oBackingStorePixelRatio ||\n        context.backingStorePixelRatio ||\n        1;\n    }\n    return (window.devicePixelRatio || 1) / backingStore;\n  }\n  render() {\n    const { horLineArr, verLineArr, shadow } = this.props;\n    const canvas: Canvas = this.props.canvas;\n    const { x, y, width, height } = shadow;\n    const props = {\n      perWidth: this.props.perWidth,\n      scale: this.props.scale,\n      zoom: this.props.zoom,\n      fontScale: 0.83,\n      ratio: 1,\n      bgColor: this.props.bgColor,\n      fgColor: this.props.fgColor,\n      fontColor: this.props.fontColor,\n      shadowColor: this.props.shadowColor,\n    };\n    return (\n      <div>\n        <div\n          className=\"hor-ruler\"\n          onContextMenu={this.props.onContextMenu}\n          style={{ cursor: 'row-resize', pointerEvents: 'auto' }}\n          draggable\n          onDragStart={this.props.onDragStartHorizontal}\n          onDrag={this.props.onDragHorizontal}\n          onDragEnd={this.props.onDragEndHorizontal}\n        >\n          <HorizontalRuler\n            start={-this.props.initialPoint.x}\n            lines={horLineArr}\n            select={{ x, width }}\n            height={20}\n            width={canvas.getViewport().width}\n            {...props}\n          />\n        </div>\n        <div\n          className=\"ver-ruler\"\n          style={{\n            position: 'absolute',\n            marginTop: -24,\n            cursor: 'col-resize',\n            pointerEvents: 'auto',\n          }}\n          draggable\n          onDragStart={this.props.onDragStartVertical}\n          onDrag={this.props.onDragVertical}\n          onDragEnd={this.props.onDragEndVertical}\n          onContextMenu={this.props.onContextMenu}\n        >\n          <VerticalRuler\n            start={-this.props.initialPoint.y}\n            lines={verLineArr}\n            select={{ y, height }}\n            height={canvas.getViewport().height}\n            width={20}\n            {...props}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n","import * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Canvas, IPlugin } from '../..';\nimport RulerScaleWrapper from './RulerScaleWrapper';\n\nexport default class RulerScalePlugin implements IPlugin {\n  name = 'RulerScalePlugin';\n  canvas!: Canvas;\n  dispose: any;\n  show!: boolean;\n  wrapperLayer: any;\n  selectedLineIndex: any;\n  ghostImageDOM?: any;\n  initialPoint: { x: number; y: number } = { x: 0, y: 0 };\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n    this.show = true;\n  }\n  showRulers() {\n    this.show = true;\n    this.renderScale();\n    this.wrapperLayer.style.display = '';\n  }\n  hideRulers() {\n    this.show = false;\n    this.wrapperLayer.style.display = 'none';\n    ReactDOM.unmountComponentAtNode(this.wrapperLayer);\n  }\n  setInitialPoint(context: any, point: { x: number; y: number }) {\n    this.initialPoint = point;\n    if (this.show) {\n      this.renderScale();\n    }\n  }\n  handleGhostImage(e: any) {\n    var crt = e.target.cloneNode(true);\n    crt.style.backgroundColor = 'red';\n    crt.style.opacity = 0;\n    crt.style.pointerEvents = 'none';\n    document.body.appendChild(crt);\n    this.ghostImageDOM = crt;\n    e.dataTransfer.setDragImage(crt, 0, 0);\n  }\n\n  disposeGhostImage() {\n    if (this.ghostImageDOM) this.ghostImageDOM.remove();\n  }\n  calculateScaleFromZoom(zoom: number) {\n    let scale = 1;\n    if (zoom <= 0.01) {\n      scale = 1000;\n    } else if (zoom <= 0.03) {\n      scale = 500;\n    } else if (zoom <= 0.06) {\n      scale = 200;\n    } else if (zoom <= 0.12) {\n      scale = 100;\n    } else if (zoom <= 0.25) {\n      scale = 50;\n    } else if (zoom > 0.25 && zoom <= 0.5) {\n      scale = 20;\n    } else if (zoom > 0.5 && zoom <= 1) {\n      scale = 10;\n    } else if (zoom > 1 && zoom <= 2) {\n      scale = 5;\n    } else if (zoom > 2 && zoom <= 4) {\n      scale = 2;\n    }\n    return scale;\n  }\n  onDragStartHorizontal = (e: any) => {\n    this.handleGhostImage(e);\n    const dims = {\n      x: 0,\n      y: 19,\n      height: 1,\n      width: 1000,\n      rotation: 0,\n    };\n    this.canvas.executeFunction('HtmlDragToWorld.dragStart', e, dims);\n    this.selectedLineIndex = this.canvas.executeFunction(\n      'RulerLines.addLine',\n      'x',\n      19\n    );\n  };\n  onDragEndHorizontal = (e: any) => {\n    this.disposeGhostImage();\n    e.preventDefault();\n    let dragVal = this.canvas.executeFunction('HtmlDragToWorld.dragEnd', e);\n    this.canvas.executeFunction(\n      'RulerLines.setPosition',\n      dragVal.session.current.y,\n      this.selectedLineIndex\n    );\n    this.selectedLineIndex = undefined;\n  };\n  onDragHorizontal = (e: any) => {\n    if (e.pageX && e.pageY) {\n      let dragVal = this.canvas.executeFunction('HtmlDragToWorld.drag', e);\n      if (\n        dragVal.session.current.deltaX !== 0 ||\n        dragVal.session.current.deltaY !== 0\n      ) {\n        if (dragVal.session.current.y > 18) {\n          this.canvas.executeFunction(\n            'RulerLines.setPosition',\n            dragVal.session.current.y,\n            this.selectedLineIndex\n          );\n        }\n      }\n    }\n  };\n  onDragStartVertical = (e: any) => {\n    this.handleGhostImage(e);\n    const dims = {\n      x: 19,\n      y: 0,\n      height: 1000,\n      width: 1,\n      rotation: 0,\n    };\n    this.canvas.executeFunction('HtmlDragToWorld.dragStart', e, dims);\n    this.selectedLineIndex = this.canvas.executeFunction(\n      'RulerLines.addLine',\n      'y',\n      19\n    );\n  };\n  onDragEndVertical = (e: any) => {\n    this.disposeGhostImage();\n    e.preventDefault();\n    let dragVal = this.canvas.executeFunction('HtmlDragToWorld.dragEnd', e);\n    this.canvas.executeFunction(\n      'RulerLines.setPosition',\n      dragVal.session.current.x,\n      this.selectedLineIndex\n    );\n    this.selectedLineIndex = undefined;\n  };\n  onDragVertical = (e: any) => {\n    if (e.pageX && e.pageY) {\n      let dragVal = this.canvas.executeFunction('HtmlDragToWorld.drag', e);\n      if (\n        dragVal.session.current.deltaX !== 0 ||\n        dragVal.session.current.deltaY !== 0\n      ) {\n        if (dragVal.session.current.x > 18) {\n          this.canvas.executeFunction(\n            'RulerLines.setPosition',\n            dragVal.session.current.x,\n            this.selectedLineIndex\n          );\n        }\n      }\n    }\n  };\n  renderScale() {\n    let zoom: any = this.canvas.getZoom();\n    let scale = this.calculateScaleFromZoom(zoom);\n    let perWidth = scale * zoom;\n    ReactDOM.render(\n      <RulerScaleWrapper\n        canvas={this.canvas}\n        initialPoint={this.initialPoint}\n        thick={0.5}\n        perWidth={perWidth}\n        zoom={zoom}\n        scale={scale}\n        horLineArr={[1, 1]}\n        verLineArr={[1, 1]}\n        bgColor={'#252a31'}\n        fgColor={'#6F727D'}\n        fontColor={'#6F727D'}\n        lineColor={'#FF0000'}\n        shadowColor={'#6F727D'}\n        horLineValue={[100, 200]}\n        verLineValue={[100, 200]}\n        shadow={{\n          x: 200,\n          y: 100,\n          width: 100,\n          height: 400,\n        }}\n        onDragStartHorizontal={this.onDragStartHorizontal}\n        onDragEndHorizontal={this.onDragEndHorizontal}\n        onDragHorizontal={this.onDragHorizontal}\n        onDragStartVertical={this.onDragStartVertical}\n        onDragEndVertical={this.onDragEndVertical}\n        onDragVertical={this.onDragVertical}\n        // onContextMenu={this.props.onContextMenu}\n      />,\n      this.wrapperLayer\n    );\n  }\n  activate() {\n    if (this.show) {\n      this.wrapperLayer = document.createElement('div');\n      this.dispose = this.canvas.addDomToViewport(this.wrapperLayer);\n      this.wrapperLayer.style.position = 'absolute';\n      this.wrapperLayer.style.top = '0px';\n      this.wrapperLayer.style.left = '0px';\n      this.wrapperLayer.style.bottom = '0px';\n      this.wrapperLayer.style.right = '0px';\n      this.wrapperLayer.style.display = this.show ? '' : 'none';\n      this.wrapperLayer.id = 'ruler-wrapper';\n      this.wrapperLayer.style.zIndex = '1';\n      this.wrapperLayer.style.pointerEvents = 'none';\n      if (this.show) {\n        this.renderScale();\n      }\n      this.canvas.on('zoom', () => {\n        if (this.show) {\n          this.renderScale();\n        }\n      });\n    }\n    this.canvas.addFunction(\n      'RulerScale.setInitialPoint',\n      this.setInitialPoint.bind(this)\n    );\n    this.canvas.addFunction('RulerScale.show', this.showRulers.bind(this));\n    this.canvas.addFunction('RulerScale.hide', this.hideRulers.bind(this));\n  }\n\n  deactivate() {\n    this.dispose();\n    this.canvas.removeFunction('RulerScale.setInitialPoint');\n    this.canvas.removeFunction('RulerScale.show');\n    this.canvas.removeFunction('RulerScale.hide');\n  }\n}\n","import { Layer, Event } from '../../..';\n\nexport default class RulerLinesAddEvent extends Event {\n  axis: 'x' | 'y';\n  axisCoordinate: number;\n  constructor(\n    name: string,\n    target: Layer,\n    axis: 'x' | 'y',\n    axisCoordinate: number,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.axisCoordinate = axisCoordinate;\n    this.axis = axis;\n  }\n}\n","import { Layer, Event } from '../../..';\n\nexport default class RulerLinesSetPositionEvent extends Event {\n  axis: 'x' | 'y';\n  axisCoordinate: number;\n  index?: number;\n  constructor(\n    name: string,\n    target: Layer,\n    axis: 'x' | 'y',\n    axisCoordinate: number,\n    index?: number,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.axisCoordinate = axisCoordinate;\n    this.axis = axis;\n    this.index = index;\n  }\n}\n","import { Layer, Event } from '../../..';\n\nexport default class RulerLinesRemoveEvent extends Event {\n  index: number;\n  constructor(\n    name: string,\n    target: Layer,\n    index: number,\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.index = index;\n  }\n}\n","import { Canvas, IPlugin, IContext } from '../..';\nimport { LineDrawerDragEvent } from '../LineDrawer/events';\nimport { isNil, findIndex } from 'lodash';\nimport RulerLinesAddEvent from './events/RulerLinesAddEvent';\nimport RulerLinesSetPositionEvent from './events/RulerLinesSetPositionEvent';\nimport RulerLinesRemoveEvent from './events/RulerLinesRemoveEvent';\nimport IRulerLine from './interfaces/IRulerLine';\n\nexport default class RulerLinesPlugin implements IPlugin {\n  name = 'RulerLinesPlugin';\n  canvas!: Canvas;\n  lines: Array<IRulerLine> = [];\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.lines = [];\n  }\n\n  addLine = (\n    context: IContext,\n    axis: 'x' | 'y',\n    axisCoordinate: number,\n    noEmit: boolean = false\n  ) => {\n    const lineWrapper = this.canvas.executeFunction(\n      'drawLine',\n      axis,\n      axisCoordinate,\n      'rulerHorizontalLine',\n      0,\n      null,\n      true\n    );\n    this.lines.push({ axis, axisCoordinate, dom: lineWrapper });\n    if (!noEmit)\n      this.canvas.dispatchEvent(\n        'RulerLines.add',\n        new RulerLinesAddEvent(\n          'RulerLines.add',\n          lineWrapper,\n          axis,\n          axisCoordinate\n        )\n      );\n    this.canvas.addEventListener(\n      'LineDrawer.dragStart',\n      (data: LineDrawerDragEvent) => {\n        const deltaInput = {\n          x: data.session.current.x,\n          y: data.session.current.y,\n        };\n        const target = data.originalEvent.originalEvent.target;\n        const index = findIndex(this.lines, function(o) {\n          return o.dom == target;\n        });\n        this.setPosition(\n          { layer: target, canvas: this.canvas },\n          data.axis == 'y' ? deltaInput.x : deltaInput.y,\n          index\n        );\n      }\n    );\n    this.canvas.addEventListener(\n      'LineDrawer.onDrag',\n      (data: LineDrawerDragEvent) => {\n        const deltaInput = {\n          x: data.session.current.x,\n          y: data.session.current.y,\n        };\n        const target = data.originalEvent.originalEvent.target;\n        const index = findIndex(this.lines, function(o) {\n          return o.dom == target;\n        });\n        this.setPosition(\n          { layer: target, canvas: this.canvas },\n          data.axis == 'y' ? deltaInput.x : deltaInput.y,\n          index\n        );\n      }\n    );\n    this.canvas.addEventListener(\n      'LineDrawer.dragEnd',\n      (data: LineDrawerDragEvent) => {\n        const deltaInput = {\n          x: data.session.current.x,\n          y: data.session.current.y,\n        };\n        const target = data.originalEvent.originalEvent.target;\n        const index = findIndex(this.lines, function(o) {\n          return o.dom == target;\n        });\n        this.setPosition(\n          { layer: target, canvas: this.canvas },\n          data.axis == 'y' ? deltaInput.x : deltaInput.y,\n          index,\n          true\n        );\n      }\n    );\n    return this.lines.length - 1;\n  };\n\n  removeLine = (context: IContext, index: number) => {\n    const { dom } = this.lines[index];\n    if (dom && dom.parentNode) {\n      dom.parentNode.removeChild(dom);\n      this.canvas.removeDomFromWorld(dom);\n      this.lines.splice(index, 1);\n      this.canvas.dispatchEvent(\n        'RulerLines.remove',\n        new RulerLinesRemoveEvent('RulerLines.remove', this.canvas, index)\n      );\n    }\n  };\n\n  setPosition = (\n    context: IContext,\n    axisCoordinate: number,\n    index?: number,\n    dragEnd?: boolean\n  ) => {\n    let indexOfLayer;\n    if (isNil(index)) {\n      indexOfLayer = this.lines.length - 1;\n    } else {\n      indexOfLayer = index;\n    }\n    const line = this.lines[indexOfLayer];\n    if (line) {\n      const { dom, axis } = line;\n      if (axis == 'y') {\n        dom.style.left = axisCoordinate + 'px';\n      } else {\n        dom.style.top = axisCoordinate + 'px';\n      }\n      this.lines[indexOfLayer] = { axis, axisCoordinate, dom };\n      this.canvas.dispatchEvent(\n        'RulerLines.setPosition',\n        new RulerLinesSetPositionEvent(\n          'RulerLines.setPosition',\n          this.canvas,\n          axis,\n          axisCoordinate,\n          indexOfLayer\n        )\n      );\n\n      if (dragEnd) {\n        let axisPoint = {\n          x: axis == 'y' ? axisCoordinate : 0,\n          y: axis == 'x' ? axisCoordinate : 0,\n        };\n        let viewportPoint = this.canvas.convertPoint(\n          axisPoint,\n          'world',\n          'viewport'\n        );\n        let viewportAxisCoordinate =\n          axis === 'y' ? viewportPoint.x : viewportPoint.y;\n        if (viewportAxisCoordinate < 18) {\n          this.removeLine(\n            { layer: this.canvas, canvas: this.canvas },\n            indexOfLayer\n          );\n        }\n      }\n    }\n  };\n\n  removeAll = (context: IContext) => {\n    this.lines.forEach((line: any) => {\n      const dom = line.dom;\n      if (dom) {\n        dom.remove();\n        this.canvas.removeDomFromWorld(dom);\n      }\n    });\n    this.lines = [];\n  };\n\n  addAll = (\n    context: IContext,\n    data: [{ axis: 'x' | 'y'; axisCoordinate: number }],\n    emit: boolean = true\n  ) => {\n    data.forEach((line: { axis: 'x' | 'y'; axisCoordinate: number }) => {\n      this.addLine(\n        { layer: this.canvas, canvas: this.canvas },\n        line.axis,\n        line.axisCoordinate,\n        emit\n      );\n    });\n  };\n\n  show = (context: IContext) => {\n    this.lines.forEach((line: any) => {\n      const dom = line.dom;\n      if (dom) {\n        dom.style.display = '';\n      }\n    });\n  };\n\n  hide = (context: IContext) => {\n    this.lines.forEach((line: any) => {\n      const dom = line.dom;\n      if (dom) {\n        dom.style.display = 'none';\n      }\n    });\n  };\n\n  getLineCoordinates = (context: IContext) => {\n    let coordinates: { x: Array<number>; y: Array<number> } = {\n      x: [],\n      y: [],\n    };\n\n    if (this.lines && this.lines.length > 0) {\n      if (this.lines[0].dom.style.display !== 'none') {\n        for (let line of this.lines) {\n          if (line.axis === 'x') {\n            coordinates.x.push(line.axisCoordinate);\n          } else {\n            coordinates.y.push(line.axisCoordinate);\n          }\n        }\n      }\n    }\n\n    return coordinates;\n  };\n\n  activate() {\n    this.canvas.addFunction('RulerLines.addLine', this.addLine);\n    this.canvas.addFunction('RulerLines.removeLine', this.removeLine);\n    this.canvas.addFunction('RulerLines.setPosition', this.setPosition);\n    this.canvas.addFunction('RulerLines.removeAll', this.removeAll);\n    this.canvas.addFunction('RulerLines.addAll', this.addAll);\n    this.canvas.addFunction('RulerLines.show', this.show);\n    this.canvas.addFunction('RulerLines.hide', this.hide);\n    this.canvas.addFunction(\n      'RulerLines.getLineCoordinates',\n      this.getLineCoordinates\n    );\n  }\n\n  deactivate() {\n    this.canvas.removeFunction('RulerLines.addLine');\n    this.canvas.removeFunction('RulerLines.removeLine');\n    this.canvas.removeFunction('RulerLines.setPosition');\n    this.canvas.removeFunction('RulerLines.removeAll');\n    this.canvas.removeFunction('RulerLines.addAll');\n    this.canvas.removeFunction('RulerLines.show');\n    this.canvas.removeFunction('RulerLines.hide');\n    this.canvas.removeFunction('RulerLines.getLineCoordinates');\n  }\n}\n","import { Layer } from '../../models/Layer';\nimport ISnapPoints from './interfaces/ISnapPoints';\nimport drawLineForAxis from './drawLineForAxis';\nimport { Canvas } from 'models/Canvas';\nimport ModelUtils from '../../models/utils';\nimport { get, forEach } from 'lodash';\n\nexport default function drawLinesForSnap(\n  canvas: Canvas,\n  layer: Layer,\n  boundingBox: any,\n  meta?: any,\n  className?: string\n) {\n  if (!className) {\n    className = 'snap-lines';\n  }\n\n  let parent = layer.parent ? layer.parent : meta && meta.parent;\n  if (!parent) {\n    return;\n  }\n\n  // // @ts-ignore\n  let snapLinesX = document.querySelectorAll('.' + className + '-x');\n  let snapLinesY = document.querySelectorAll('.' + className + '-y');\n  // @ts-ignore\n  for (let snapLine of snapLinesX) {\n    snapLine.style.visibility = 'hidden';\n  }\n  // @ts-ignore\n  for (let snapLine of snapLinesY) {\n    snapLine.style.visibility = 'hidden';\n  }\n\n  if (\n    !isNaN(get(meta, 'snappedSide.x.snappedSide.snappedPoint.rootValue', NaN))\n  ) {\n    let point = meta.snappedSide.x.snappedSide.snappedPoint.rootValue;\n    if (\n      ModelUtils.pointsOverlap(point, boundingBox.x) ||\n      ModelUtils.pointsOverlap(point, boundingBox.width / 2 + boundingBox.x) ||\n      ModelUtils.pointsOverlap(point, boundingBox.width + boundingBox.x)\n    ) {\n      // TODO: remove using architecture instead of DOM\n      let snapLines = document.querySelectorAll('.' + className + '-y');\n      // @ts-ignore\n      for (let snapLine of snapLines) {\n        snapLine.style.visibility = 'visible';\n        snapLine.style.left = point + 'px';\n\n        const parentAbsoluteRotation = parent.getAbsoluteRotation();\n        const parentDims = parent.getRotatedPolygon();\n        let offset = Math.max(boundingBox.width, boundingBox.height);\n        snapLine.style.transform = `rotate(${parentAbsoluteRotation}deg)`;\n        snapLine.style.transformOrigin = `${parentDims.centroid[0] -\n          point}px ${parentDims.centroid[1] + offset}px`;\n      }\n    }\n  }\n\n  if (\n    !isNaN(get(meta, 'snappedSide.y.snappedSide.snappedPoint.rootValue', NaN))\n  ) {\n    let point = meta.snappedSide.y.snappedSide.snappedPoint.rootValue;\n    // jugaad: cheking if bounding box is touches snap line\n\n    if (\n      ModelUtils.pointsOverlap(point, boundingBox.y) ||\n      ModelUtils.pointsOverlap(point, boundingBox.height / 2 + boundingBox.y) ||\n      ModelUtils.pointsOverlap(point, boundingBox.height + boundingBox.y)\n    ) {\n      let snapLines = document.querySelectorAll('.' + className + '-x');\n      // @ts-ignore\n      for (let snapLine of snapLines) {\n        snapLine.style.visibility = 'visible';\n        snapLine.style.top = point + 'px';\n\n        // transform changes\n        const parentAbsoluteRotation = parent.getAbsoluteRotation();\n        const parentDims = parent.getRotatedPolygon();\n        let offset = Math.max(boundingBox.width, boundingBox.height);\n        snapLine.style.transform = `rotate(${parentAbsoluteRotation}deg)`;\n        snapLine.style.transformOrigin = `${parentDims.centroid[0] +\n          offset}px ${parentDims.centroid[1] - point}px`;\n      }\n    }\n  }\n}\n\nfunction drawLine(\n  canvas: any,\n  layer: any,\n  point: any,\n  boundingBox: any,\n  axis: 'x' | 'y',\n  meta?: any,\n  className?: string\n) {\n  let parent = layer.parent ? layer.parent : meta && meta.parent;\n\n  if (!parent) {\n    return;\n  }\n  const parentAbsoluteRotation = parent.getAbsoluteRotation();\n  const parentDims = parent.getRotatedPolygon();\n  let offset = Math.max(boundingBox.width, boundingBox.height);\n\n  const value = point;\n  let extraStyle: any = {\n    // visibility: 'hidden',\n  };\n  if (axis === 'y') {\n    extraStyle = {\n      ...extraStyle,\n      transform: `rotate(${parentAbsoluteRotation}deg)`,\n      transformOrigin: `${parentDims.centroid[0] - value}px ${parentDims\n        .centroid[1] + offset}px`,\n    };\n  } else {\n    extraStyle = {\n      ...extraStyle,\n      transform: `rotate(${parentAbsoluteRotation}deg)`,\n      transformOrigin: `${parentDims.centroid[0] + offset}px ${parentDims\n        .centroid[1] - value}px`,\n    };\n  }\n\n  canvas.executeFunction(\n    'drawLine',\n    axis,\n    value,\n    className + '-' + axis,\n    -offset,\n    undefined,\n    undefined,\n    undefined,\n    extraStyle\n  );\n}\nexport function drawAllLinesForSnap(\n  canvas: Canvas,\n  layer: Layer,\n  boundingBox: any,\n  snapLines: any,\n  className: string = 'snap-lines',\n  meta?: any\n) {\n  drawLine(canvas, layer, -100, boundingBox, 'y', meta, className);\n  drawLine(canvas, layer, -100, boundingBox, 'x', meta, className);\n}\n","import { IPlugin } from '../../interfaces/IPlugin';\nimport { Canvas } from '../../models/Canvas';\nimport LayerDragEvent from '../../plugins/LayerDrag/LayerDragEvent';\nimport ISnapPoints from './interfaces/ISnapPoints';\nimport drawLinesForSnap, { drawAllLinesForSnap } from './drawLinesForSnap';\nimport Config from './interfaces/Config';\nimport drawLinesForGutterSnap from './drawLinesForGutterSnap';\nimport { Layer } from '../../models/Layer';\nimport StageDesignerDrawEvent from 'plugins/StageDesignerDrawComponent/events/stageDesignerDrawEvent';\n\nexport default class SnapLines implements IPlugin {\n  name = 'SnapLines';\n  canvas!: Canvas;\n\n  layer: Layer | undefined;\n  layerParent: Layer | null | undefined;\n\n  parentSnapPoints: ISnapPoints | undefined;\n  siblingSnapPoints: ISnapPoints | undefined;\n  gutterSnapPoints: ISnapPoints | undefined;\n\n  config: Config | undefined;\n\n  removeElementsWithClass(name: string) {\n    let snapLinesX = document.querySelectorAll('.' + name + '-x');\n    // TODO: remove using architecture instead of DOM\n    // @ts-ignore\n    for (let snapLine of snapLinesX) {\n      snapLine.remove();\n      this.canvas.removeDomFromWorld(snapLine);\n    }\n\n    let snapLinesY = document.querySelectorAll('.' + name + '-y');\n    // TODO: remove using architecture instead of DOM\n    // @ts-ignore\n    for (let snapLine of snapLinesY) {\n      snapLine.remove();\n      this.canvas.removeDomFromWorld(snapLine);\n    }\n  }\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  dragStartListener(data: LayerDragEvent, className: string = 'snap-lines') {\n    this.removeElementsWithClass(className);\n    let boundingBox = this.canvas.getContainerBoundingBoxWRTParent([\n      data.target,\n    ]);\n    drawAllLinesForSnap(\n      this.canvas,\n      data.target,\n      boundingBox,\n      data.snapPoints,\n      className,\n      data.meta\n    );\n  }\n  dragListener(data: LayerDragEvent, className: string = 'snap-lines') {\n    // this.removeElementsWithClass(className);\n\n    let boundingBox = this.canvas.getContainerBoundingBoxWRTParent([\n      data.target,\n    ]);\n    if (data.target.parent) {\n      boundingBox = {\n        ...boundingBox,\n        x: boundingBox.x + data.target.parent.rootX,\n        y: boundingBox.y + data.target.parent.rootY,\n      };\n    }\n    if (data.target) {\n      drawLinesForSnap(\n        this.canvas,\n        data.target,\n        boundingBox,\n        data.meta,\n        className\n      );\n    }\n  }\n\n  dragListenerDraw(\n    data: StageDesignerDrawEvent,\n    className: string = 'snap-lines'\n  ) {\n    // this.removeElementsWithClass(className);\n\n    const boundingBox = {\n      x: data.worldX,\n      y: data.worldY,\n      width: data.dimensions.width,\n      height: data.dimensions.height,\n    };\n    if (data.target) {\n      drawLinesForSnap(\n        this.canvas,\n        data.target,\n        boundingBox,\n        data.meta,\n        className\n      );\n    }\n  }\n\n  dragListenerResizer(data: LayerDragEvent, className: string = 'snap-lines') {\n    // this.removeElementsWithClass(className);\n    let boundingBox = this.canvas.getContainerBoundingBoxWRTParent(\n      this.canvas.selectedLayers\n    );\n    if (this.canvas.selectedLayers[0].parent) {\n      boundingBox = {\n        ...boundingBox,\n        x: boundingBox.x + this.canvas.selectedLayers[0].parent.rootX,\n        y: boundingBox.y + this.canvas.selectedLayers[0].parent.rootY,\n      };\n    }\n    if (data.target) {\n      drawLinesForSnap(\n        this.canvas,\n        data.target,\n        boundingBox,\n        data.meta,\n        className\n      );\n    }\n  }\n\n  drawComponentMouseMoveListener(\n    data: LayerDragEvent,\n    className: string = 'snap-lines'\n  ) {\n    // this.removeElementsWithClass(className);\n\n    const boundingBox = {\n      x: data.worldX,\n      y: data.worldY,\n      width: 0,\n      height: 0,\n    };\n\n    if (data.target) {\n      drawLinesForSnap(\n        this.canvas,\n        data.target,\n        boundingBox,\n        data.meta,\n        className\n      );\n    }\n  }\n\n  activate() {\n    // layer drag listener\n\n    this.canvas.addEventListener('layerDragStart', (data: LayerDragEvent) => {\n      this.dragStartListener(data);\n    });\n\n    this.canvas.addEventListener('layerDrag', (data: LayerDragEvent) => {\n      this.dragListener(data);\n    });\n\n    this.canvas.addEventListener('layerDragEnd', (data: LayerDragEvent) => {\n      this.removeElementsWithClass('snap-lines');\n    });\n\n    // resizer listener\n    this.canvas.addEventListener(\n      'LayerResizer.dragStart',\n      (data: LayerDragEvent) => {\n        this.dragStartListener(data);\n      }\n    );\n\n    this.canvas.addEventListener(\n      'LayerResizer.drag',\n      (data: LayerDragEvent) => {\n        this.dragListenerResizer(data);\n      }\n    );\n\n    this.canvas.addEventListener(\n      'LayerResizer.dragEnd',\n      (data: LayerDragEvent) => {\n        this.removeElementsWithClass('snap-lines');\n      }\n    );\n\n    // resizer handle drag listener\n    this.canvas.addEventListener(\n      'LayerResizer.handleDragStart',\n      (data: LayerDragEvent) => {\n        this.dragStartListener(data);\n      }\n    );\n    this.canvas.addEventListener(\n      'LayerResizer.handleDrag',\n      (data: LayerDragEvent) => {\n        this.dragListenerResizer(data);\n      }\n    );\n\n    this.canvas.addEventListener(\n      'LayerResizer.handleDragEnd',\n      (data: LayerDragEvent) => {\n        this.removeElementsWithClass('snap-lines');\n      }\n    );\n\n    /// draw component listener\n    this.canvas.addEventListener(\n      'StageDesignerDrawComponent.drawShape',\n      (data: LayerDragEvent) => {\n        this.dragStartListener(data, 'snap-lines-draw');\n      }\n    );\n    this.canvas.addEventListener(\n      'StageDesignerDrawComponent.mousemove',\n      (data: LayerDragEvent) => {\n        this.drawComponentMouseMoveListener(data, 'snap-lines-draw');\n      }\n    );\n\n    // resizer listener\n    this.canvas.addEventListener(\n      'StageDesignerDrawComponent.drawStart',\n      (data: LayerDragEvent) => {\n        this.dragStartListener(data);\n      }\n    );\n\n    this.canvas.addEventListener(\n      'StageDesignerDrawComponent.draw',\n      (data: StageDesignerDrawEvent) => {\n        this.dragListenerDraw(data);\n      }\n    );\n\n    this.canvas.addEventListener(\n      'StageDesignerDrawComponent.drawEnd',\n      (data: LayerDragEvent) => {\n        this.removeElementsWithClass('snap-lines');\n        this.removeElementsWithClass('snap-lines-draw');\n      }\n    );\n  }\n\n  deactivate() {}\n}\n","import { Layer, MouseEvent } from '../../..';\nimport { IPosition, IDimensionWithRotation } from 'interfaces';\n\nexport class LineDrawerDragEvent extends MouseEvent {\n  startValues: IDimensionWithRotation;\n  session: {\n    start: IPosition;\n    current: IPosition;\n    end: IPosition;\n  };\n  axis?: 'x' | 'y';\n  constructor(\n    name: string,\n    startValues: IDimensionWithRotation,\n    session: { start: IPosition; current: IPosition; end: IPosition },\n    originalEvent: any,\n    target: Layer,\n    currentTarget?: Layer,\n    axis?: 'x' | 'y'\n  ) {\n    super(name, target, originalEvent, currentTarget);\n    this.session = session;\n    this.startValues = startValues;\n    this.axis = axis;\n  }\n}\n","import { IPlugin, IContext } from 'interfaces';\nimport { Canvas } from 'models/Canvas';\nimport { LineDrawerDragEvent } from './events';\n\nexport default class LineDrawer implements IPlugin {\n  name = 'LineDrawer';\n  canvas!: Canvas;\n  namespace = 'LineDrawer';\n  ghostImageDOM?: any;\n  dispose: any;\n  handleGhostImage(e: any) {\n    var crt = e.target.cloneNode(true);\n    crt.style.backgroundColor = 'red';\n    crt.style.opacity = 0;\n    crt.style.pointerEvents = 'none';\n    document.body.appendChild(crt);\n    this.ghostImageDOM = crt;\n    e.dataTransfer.setDragImage(crt, 0, 0);\n  }\n\n  disposeGhostImage() {\n    if (this.ghostImageDOM) this.ghostImageDOM.remove();\n  }\n\n  drawLine(\n    context: IContext,\n    axis: 'x' | 'y',\n    axisCoordinate: number,\n    className: string | null,\n    startCoordinate?: number,\n    endCoordinate?: number,\n    draggable?: boolean,\n    label?: string,\n    style: any = {}\n  ): HTMLDivElement {\n    const lineWrappedLayer = document.createElement('div');\n    this.dispose = this.canvas.addDomToWorld(lineWrappedLayer, true, 103);\n    let zoom = this.canvas.getZoom();\n    let lineWidth = 1 / zoom;\n    let lineWrapperDim = 8 / zoom;\n    let line = document.createElement('div');\n    this.canvas.on('zoom', (e: any) => {\n      zoom = this.canvas.getZoom();\n      lineWidth = 1 / zoom;\n      lineWrapperDim = 8 / zoom;\n      if (line && lineWrappedLayer) {\n        if (axis === 'x') {\n          line.style.height = lineWidth + 'px';\n          lineWrappedLayer.style.height = `${lineWrapperDim}px`;\n        } else {\n          lineWrappedLayer.style.width = `${lineWrapperDim}px`;\n          line.style.width = lineWidth + 'px';\n        }\n      }\n    });\n    if (className) {\n      lineWrappedLayer.className = className;\n    }\n\n    let labelBox;\n    let boxWidth = 30;\n    let boxHeight = 15;\n    let fontSize = 10;\n    let labelSpacing = 10;\n    let length;\n\n    startCoordinate = startCoordinate ? startCoordinate : 0;\n\n    line.style.position = 'absolute';\n    lineWrappedLayer.style.position = 'absolute';\n    line.style.backgroundColor = '#22b9d1';\n    lineWrappedLayer.style.pointerEvents = 'none';\n\n    lineWrappedLayer.style.transform = style.transform;\n    lineWrappedLayer.style.transformOrigin = style.transformOrigin;\n    lineWrappedLayer.style.visibility = style.visibility;\n\n    const lineLength = Math.max(\n      this.canvas.getBoundingClientRect().width,\n      this.canvas.getBoundingClientRect().height\n    );\n\n    if (draggable) {\n      lineWrappedLayer.style.pointerEvents = 'auto';\n      lineWrappedLayer.draggable = true;\n      let x, y;\n\n      if (axis == 'x') {\n        endCoordinate = endCoordinate ? endCoordinate : lineLength;\n        x = Math.min(startCoordinate, endCoordinate);\n        y = axisCoordinate;\n        lineWrappedLayer.onmouseover = (e: any) => {\n          if (!this.canvas.executeFunction('LayerDrag.isDragging'))\n            this.canvas.setMouseCursor('row-resize');\n        };\n      } else {\n        endCoordinate = endCoordinate ? endCoordinate : lineLength;\n        y = Math.min(startCoordinate, endCoordinate);\n        x = axisCoordinate;\n        lineWrappedLayer.onmouseover = (e: any) => {\n          if (!this.canvas.executeFunction('LayerDrag.isDragging'))\n            this.canvas.setMouseCursor('col-resize');\n        };\n      }\n      lineWrappedLayer.onmouseleave = (e: any) => {\n        this.canvas.setMouseCursor('default');\n      };\n      const dims = {\n        x,\n        y,\n        height: lineWidth,\n        width: Math.abs(startCoordinate - endCoordinate),\n        rotation: 0,\n      };\n      lineWrappedLayer.ondragstart = e => {\n        this.handleGhostImage(e);\n        let dragVal = this.canvas.executeFunction(\n          'HtmlDragToWorld.dragStart',\n          e,\n          dims\n        );\n        this.canvas.dispatchEvent(\n          `${this.namespace}.dragStart`,\n          new LineDrawerDragEvent(\n            `${this.namespace}.dragStart`,\n            dragVal.startValues,\n            dragVal.session,\n            dragVal.event,\n            this.canvas,\n            undefined,\n            axis\n          )\n        );\n      };\n      lineWrappedLayer.ondrag = e => {\n        if (e.pageX && e.pageY) {\n          let dragVal = this.canvas.executeFunction('HtmlDragToWorld.drag', e);\n          if (\n            dragVal.session.current.deltaX !== 0 ||\n            dragVal.session.current.deltaY !== 0\n          ) {\n            this.canvas.dispatchEvent(\n              `${this.namespace}.onDrag`,\n              new LineDrawerDragEvent(\n                `${this.namespace}.onDrag`,\n                dragVal.startValues,\n                dragVal.session,\n                dragVal.event,\n                this.canvas,\n                undefined,\n                axis\n              )\n            );\n          }\n        }\n      };\n      lineWrappedLayer.ondragend = e => {\n        this.disposeGhostImage();\n        e.preventDefault();\n        let dragVal = this.canvas.executeFunction('HtmlDragToWorld.dragEnd', e);\n        this.canvas.dispatchEvent(\n          `${this.namespace}.dragEnd`,\n          new LineDrawerDragEvent(\n            `${this.namespace}.dragEnd`,\n            dragVal.startValues,\n            dragVal.session,\n            dragVal.event,\n            this.canvas,\n            undefined,\n            axis\n          )\n        );\n      };\n    }\n\n    switch (axis) {\n      case 'x':\n        endCoordinate = endCoordinate ? endCoordinate : lineLength;\n        length = Math.abs(startCoordinate - endCoordinate);\n        line.style.height = lineWidth + 'px';\n        line.style.width = length + 'px';\n        lineWrappedLayer.style.width = length + 'px';\n        lineWrappedLayer.style.height = `${lineWrapperDim}px`;\n        lineWrappedLayer.style.left =\n          Math.min(startCoordinate, endCoordinate) + 'px';\n        lineWrappedLayer.style.top = axisCoordinate + 'px';\n        lineWrappedLayer.appendChild(line);\n        labelBox = this.createLabelBox(\n          label,\n          'x',\n          axisCoordinate,\n          length / 2 - boxWidth / 2,\n          boxHeight,\n          boxWidth,\n          labelSpacing,\n          fontSize\n        );\n        if (labelBox) {\n          lineWrappedLayer.appendChild(labelBox);\n        }\n        break;\n\n      case 'y':\n        endCoordinate = endCoordinate ? endCoordinate : lineLength;\n        length = Math.abs(startCoordinate - endCoordinate);\n        line.style.width = lineWidth + 'px';\n        line.style.height = length + 'px';\n        lineWrappedLayer.style.height = length + 'px';\n        lineWrappedLayer.style.width = `${lineWrapperDim}px`;\n        lineWrappedLayer.style.top =\n          Math.min(startCoordinate, endCoordinate) + 'px';\n        lineWrappedLayer.style.left = axisCoordinate + 'px';\n        lineWrappedLayer.appendChild(line);\n        labelBox = this.createLabelBox(\n          label,\n          'y',\n          axisCoordinate,\n          length / 2 - boxHeight / 2,\n          boxHeight,\n          boxWidth,\n          labelSpacing,\n          fontSize\n        );\n        if (labelBox) {\n          lineWrappedLayer.appendChild(labelBox);\n        }\n        break;\n\n      default:\n        break;\n    }\n\n    return lineWrappedLayer;\n  }\n  setLabelBoxStyle(\n    labelBox: any,\n    height: any,\n    width: any,\n    axis: any,\n    labelSpacing: any,\n    pointOnAxis: any,\n    text: any,\n    fontSize: any\n  ) {\n    const zoom = this.canvas.getZoom();\n    height = height / zoom;\n    width = width / zoom;\n    labelSpacing = labelSpacing / zoom;\n\n    labelBox.style.width = width + 'px';\n    labelBox.style.height = height + 'px';\n    labelBox.style.borderRadius = `${2 / zoom}px`;\n\n    if (axis === 'x') {\n      if (height - labelSpacing <= 0) {\n        labelBox.style.top = labelSpacing + 'px';\n      } else {\n        labelBox.style.top = -(labelSpacing + height) + 'px';\n      }\n      labelBox.style.left = pointOnAxis + 'px';\n    } else {\n      if (width - labelSpacing <= 0) {\n        labelBox.style.left = -(labelSpacing + width) + 'px';\n      } else {\n        labelBox.style.left = labelSpacing + 'px';\n      }\n      labelBox.style.top = pointOnAxis + 'px';\n    }\n    text.style.fontSize = fontSize / zoom + 'px';\n  }\n  createLabelBox(\n    label: string | undefined,\n    axis: 'x' | 'y',\n    coordinate: number,\n    pointOnAxis: number,\n    boxHeight: number,\n    boxWidth: number,\n    labelSpacing: number,\n    fontSize: number\n  ): HTMLDivElement | undefined {\n    if (!label) return;\n\n    let labelBox = document.createElement('div');\n    labelBox.style.position = 'absolute';\n    labelBox.style.backgroundColor = '#22b9d1';\n\n    let text = document.createElement('span');\n    text.style.backgroundColor = 'transparent';\n    text.style.color = 'white';\n    text.style.left = 0 + 'px';\n    text.style.right = 0 + 'px';\n    text.style.top = 0 + 'px';\n    text.style.bottom = 0 + 'px';\n    text.style.position = 'absolute';\n    text.style.display = 'flex';\n    text.style.textAlign = 'center';\n    text.style.justifyContent = 'center';\n    text.style.alignItems = 'center';\n    this.setLabelBoxStyle(\n      labelBox,\n      boxHeight,\n      boxWidth,\n      axis,\n      labelSpacing,\n      pointOnAxis,\n      text,\n      fontSize\n    );\n    text.innerHTML = label;\n    labelBox.appendChild(text);\n    this.canvas.on('zoom', () => {\n      this.setLabelBoxStyle(\n        labelBox,\n        boxHeight,\n        boxWidth,\n        axis,\n        labelSpacing,\n        pointOnAxis,\n        text,\n        fontSize\n      );\n    });\n    return labelBox;\n  }\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addFunction('drawLine', this.drawLine.bind(this));\n  }\n\n  deactivate() {\n    this.canvas.removeFunction('drawLine');\n    this.dispose();\n  }\n}\n","export const iconRight =\n  'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNTEycHgiIGhlaWdodD0iNTEycHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0OS4zICg1MTE2NykgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+aWNvbl9yaWdodDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJpY29uX3JpZ2h0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0icmlnaHRfYXJyb3ciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwMi4wMDAwMDAsIDAuMDAwMDAwKSIgZmlsbD0iIzZGNzI3RCIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgPHBvbHlnb24gaWQ9Iu+PkiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTUzLjU1Mzk4NiwgMjU1LjkyMzMwOSkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtMTUzLjU1Mzk4NiwgLTI1NS45MjMzMDkpICIgcG9pbnRzPSIzMDcuMTA3OTcxIDMwLjM5MDg5MyA2Ny4xNzk4Njk4IDI1NS45MjMzMDkgMzA3LjEwNzk3MSA0ODEuNDU1NzI0IDI3My41MTgwMzcgNTExLjg0NjYxNyAxLjE0OTgxMjhlLTA2IDI1NS45MjMzMDkgMjczLjUxODAzNyAwIj48L3BvbHlnb24+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=';\n\nexport const iconLeft =\n  'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNTEycHgiIGhlaWdodD0iNTEycHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0OS4zICg1MTE2NykgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+aWNvbl9sZWZ0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGRlZnM+PC9kZWZzPgogICAgPGcgaWQ9Imljb25fbGVmdCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9InJpZ2h0X2Fycm93IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNTYuMDAwMDAwLCAyNTYuMDAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC0yNTYuMDAwMDAwLCAtMjU2LjAwMDAwMCkgdHJhbnNsYXRlKDEwMi4wMDAwMDAsIDAuMDAwMDAwKSIgZmlsbD0iIzZGNzI3RCIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgPHBvbHlnb24gaWQ9Iu+PkiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTUzLjU1Mzk4NiwgMjU1LjkyMzMwOSkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtMTUzLjU1Mzk4NiwgLTI1NS45MjMzMDkpICIgcG9pbnRzPSIzMDcuMTA3OTcxIDMwLjM5MDg5MyA2Ny4xNzk4Njk4IDI1NS45MjMzMDkgMzA3LjEwNzk3MSA0ODEuNDU1NzI0IDI3My41MTgwMzcgNTExLjg0NjYxNyAxLjE0OTgxMjhlLTA2IDI1NS45MjMzMDkgMjczLjUxODAzNyAwIj48L3BvbHlnb24+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=';\n","import { Canvas, IPlugin, IContext, Layer, Event } from '../..';\nimport { indexOf, map, isEqual } from 'lodash';\nimport { iconLeft, iconRight } from './iconsBase64';\n\nfunction getButtonCss(zoom: number) {\n  return `\nbackground: transparent;\nwidth: auto;\ncolor: rgb(251,251,251);\nheight: 80px;\npadding-left: ${6 / zoom}px;\npadding-right: ${6 / zoom}px;\nmargin-top: 0px;\nborder:none;\nmin-width: ${100 / zoom}px;\n`;\n}\nfunction getImgCss(zoom: number) {\n  return `\n  border: none;\n  margin-right: 0px;\n  margin-left: 0px;\n  opacity: 1;\n  width: ${32 / zoom}px;\n  height: ${32 / zoom}px;\n  `;\n}\n\nconst containerCss = `\nposition: absolute;\npointer-events: auto;\nz-index: 4;\ntransform-origin: 0px 0px;\n`;\n\nexport default class StageDesignerPreviewModePlugin implements IPlugin {\n  name = 'StageDesignerPreviewMode';\n  canvas!: Canvas;\n  disposeNextBtn: any;\n  disposePreviousBtn: any;\n  nextBtnContainerNode: any;\n  previousBtnContainerNode: any;\n  artboards: Array<Layer> = [];\n  prevBtnElement: any;\n  nextBtnElement: any;\n  prevImgElement: any;\n  nextImgElement: any;\n  currentMode!: string;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.disposeNextBtn = null;\n    this.disposePreviousBtn = null;\n    this.currentMode = 'stage';\n  }\n\n  activate() {\n    this.canvas.addFunction('switchToPreviewMode', this.previewMode.bind(this));\n    this.canvas.addFunction('switchToStageMode', this.stageMode.bind(this));\n    this.disposeNextBtn = this.renderNextButton();\n    this.disposePreviousBtn = this.renderPreviousButton();\n    this.previousBtnContainerNode.style.display = 'none';\n    this.nextBtnContainerNode.style.display = 'none';\n    this.canvas.on('zoom', () => {\n      if (this.currentMode === 'preview' && this.artboards.length > 1) {\n        this.prevImgElement.style.cssText = getImgCss(this.canvas.getZoom());\n        this.prevBtnElement.style.cssText = getButtonCss(this.canvas.getZoom());\n        this.nextBtnElement.style.cssText = getButtonCss(this.canvas.getZoom());\n        this.nextImgElement.style.cssText = getImgCss(this.canvas.getZoom());\n        this.setPreviousButtonContainerLayout();\n        this.setNextButtonContainerLayout();\n        this.setDisplayForButtons();\n      }\n    });\n  }\n\n  previewMode(context: IContext) {\n    this.currentMode = 'preview';\n    const artboards = this.canvas.executeFunction('getAllArtboards');\n    this.artboards = Array.from(artboards.values());\n    this.canvas.executeFunction('hidePlusButton');\n\n    if (this.artboards.length > 1) {\n      this.handleSelectedArtboardChange();\n    }\n  }\n\n  stageMode(context: IContext) {\n    this.currentMode = 'stage';\n    const artboards = this.canvas.executeFunction('getAllArtboards');\n    this.artboards = Array.from(artboards.values());\n    this.previousBtnContainerNode.style.display = 'none';\n    this.nextBtnContainerNode.style.display = 'none';\n    this.canvas.executeFunction('showPlusButton');\n    map(this.artboards, (artboard: Layer) => {\n      artboard.show();\n      artboard.executeFunction('LayerLabel.show');\n      artboard.executeFunction(\n        'showGrid',\n        this.canvas.executeFunction('getGridSize')\n      );\n    });\n  }\n\n  nextArtboard() {\n    const selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n    selectedArtboard.hide();\n    let selectedArtboardIndex = 0;\n    if (selectedArtboard)\n      selectedArtboardIndex = indexOf(this.artboards, selectedArtboard);\n    selectedArtboardIndex += 1;\n    this.artboards[selectedArtboardIndex].show();\n    this.canvas.dispatchEvent(\n      'StageDesignerPreviewMode.selectArtboard',\n      new Event(\n        'StageDesignerPreviewMode.selectArtboard',\n        this.artboards[selectedArtboardIndex]\n      )\n    );\n    this.handleSelectedArtboardChange();\n  }\n\n  previousArtboard() {\n    const selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n    selectedArtboard.hide();\n    let selectedArtboardIndex = 0;\n    if (selectedArtboard)\n      selectedArtboardIndex = indexOf(this.artboards, selectedArtboard);\n    selectedArtboardIndex -= 1;\n    this.artboards[selectedArtboardIndex].show();\n    this.canvas.dispatchEvent(\n      'StageDesignerPreviewMode.selectArtboard',\n      new Event(\n        'StageDesignerPreviewMode.selectArtboard',\n        this.artboards[selectedArtboardIndex]\n      )\n    );\n    this.handleSelectedArtboardChange();\n  }\n  setDisplayForButtons() {\n    let selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n    if (selectedArtboard) {\n      let selectedArtboardIndex = indexOf(this.artboards, selectedArtboard);\n      if (selectedArtboardIndex === 0) {\n        this.previousBtnContainerNode.style.display = 'none';\n        this.nextBtnContainerNode.style.display = '';\n      } else if (selectedArtboardIndex === this.artboards.length - 1) {\n        this.nextBtnContainerNode.style.display = 'none';\n        this.previousBtnContainerNode.style.display = '';\n      } else {\n        this.previousBtnContainerNode.style.display = '';\n        this.nextBtnContainerNode.style.display = '';\n      }\n    } else {\n      this.nextBtnContainerNode.style.display = 'none';\n      this.previousBtnContainerNode.style.display = 'none';\n    }\n  }\n  handleSelectedArtboardChange() {\n    this.setPreviousButtonContainerLayout();\n    this.setNextButtonContainerLayout();\n    let selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n    if (selectedArtboard) {\n      this.setDisplayForButtons();\n    } else {\n      selectedArtboard = this.artboards[0];\n      if (selectedArtboard) {\n        this.canvas.dispatchEvent(\n          'StageDesignerPreviewMode.selectArtboard',\n          new Event('StageDesignerPreviewMode.selectArtboard', selectedArtboard)\n        );\n      }\n      this.previousBtnContainerNode.style.display = 'none';\n      this.nextBtnContainerNode.style.display = '';\n    }\n    map(this.artboards, (artboard: Layer) => {\n      if (!isEqual(artboard, selectedArtboard)) {\n        artboard.hide();\n        artboard.executeFunction('LayerLabel.hide');\n        artboard.executeFunction('hideGrid');\n      } else {\n        artboard.show();\n        artboard.executeFunction('LayerLabel.show');\n        artboard.executeFunction(\n          'showGrid',\n          this.canvas.executeFunction('getGridSize')\n        );\n\n        if (artboard) {\n          this.canvas.dispatchEvent(\n            'StageDesignerPreviewMode.selectArtboard',\n            new Event('StageDesignerPreviewMode.selectArtboard', artboard)\n          );\n        }\n      }\n    });\n    selectedArtboard.executeFunction('focusArtboard');\n  }\n\n  renderNextButton() {\n    this.nextBtnContainerNode = document.createElement('div');\n    this.nextBtnElement = document.createElement('button');\n    this.nextBtnElement.style.cssText = getButtonCss(this.canvas.getZoom());\n    this.nextBtnElement.onclick = () => this.nextArtboard();\n    this.nextImgElement = document.createElement('img');\n    this.nextImgElement.src = iconRight;\n    this.nextImgElement.style.cssText = getImgCss(this.canvas.getZoom());\n    this.nextBtnElement.append(this.nextImgElement);\n    this.nextBtnContainerNode.appendChild(this.nextBtnElement);\n    return this.canvas.addDomToWorld(this.nextBtnContainerNode);\n  }\n\n  renderPreviousButton() {\n    this.previousBtnContainerNode = document.createElement('div');\n    this.prevBtnElement = document.createElement('button');\n    this.prevBtnElement.style.cssText = getButtonCss(this.canvas.getZoom());\n    this.prevBtnElement.onclick = () => this.previousArtboard();\n    this.prevImgElement = document.createElement('img');\n    this.prevImgElement.src = iconLeft;\n    this.prevImgElement.style.cssText = getImgCss(this.canvas.getZoom());\n    this.prevBtnElement.append(this.prevImgElement);\n    this.previousBtnContainerNode.appendChild(this.prevBtnElement);\n    return this.canvas.addDomToWorld(this.previousBtnContainerNode);\n  }\n  setPreviousButtonContainerLayout() {\n    let selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n    if (!selectedArtboard) selectedArtboard = this.artboards[0];\n    const containerLayout = {\n      left: selectedArtboard.layout.data.left - 150 / this.canvas.getZoom(),\n      top:\n        selectedArtboard.layout.data.height / 2 +\n        selectedArtboard.layout.data.top -\n        40 / this.canvas.getZoom(),\n    };\n    this.previousBtnContainerNode.style.cssText =\n      containerCss +\n      `left:${containerLayout.left}px;top:${containerLayout.top}px`;\n  }\n\n  setNextButtonContainerLayout() {\n    let selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n    if (!selectedArtboard) selectedArtboard = this.artboards[0];\n\n    const containerLayout = {\n      left:\n        selectedArtboard.layout.data.left +\n        selectedArtboard.layout.data.width +\n        50 / this.canvas.getZoom(),\n      top:\n        selectedArtboard.layout.data.height / 2 +\n        selectedArtboard.layout.data.top -\n        40 / this.canvas.getZoom(),\n    };\n    this.nextBtnContainerNode.style.cssText =\n      containerCss +\n      `left:${containerLayout.left}px;top:${containerLayout.top}px`;\n  }\n\n  deactivate() {\n    this.canvas.removeFunction('switchToPreviewMode');\n    this.canvas.removeFunction('switchToStageMode');\n    this.disposeNextBtn();\n    this.disposePreviousBtn();\n  }\n}\n","import { Layer } from '../../models/Layer';\nimport { Canvas } from 'models/Canvas';\nimport DesignerDropEvent from '../../events/DropEvent';\nexport default class StageDesignerDropEvent extends DesignerDropEvent {\n  artboard: Layer;\n\n  constructor(\n    name: string,\n    target: Layer,\n    originalEvent: any,\n    artboard: Layer,\n    currentTarget?: Layer\n  ) {\n    super(name, target, originalEvent, currentTarget);\n    this.artboard = artboard;\n  }\n}\n","import { Canvas, IPlugin, Layer } from '../..';\nimport { map } from 'lodash';\nimport DesignerDropEvent from '../../events/DropEvent';\nimport StageDesignerDropEvent from './StageDesignerDropEvent';\n\nexport default class StageDesignerDropPlugin implements IPlugin {\n  name = 'StageDesignerDrop';\n  canvas!: Canvas;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addEventListener('drop', (e: DesignerDropEvent) => {\n      const draggedLayerStyles = JSON.parse(\n        e.originalEvent.dataTransfer.getData('text')\n      );\n      const hitResult = this.canvas.getHitRectResult(\n        e.worldX - draggedLayerStyles.offsetX,\n        e.worldY - draggedLayerStyles.offsetY,\n        parseInt(draggedLayerStyles.width.replace('px', '')),\n        parseInt(draggedLayerStyles.height.replace('px', ''))\n      );\n      const canvas = hitResult.pop();\n      let artboard = null;\n\n      map(hitResult, (hitLayer: Layer) => {\n        if (canvas.children.indexOf(hitLayer) >= 0) {\n          artboard = hitLayer;\n        }\n      });\n      if (!artboard) {\n        artboard = this.canvas.executeFunction('getSelectedArtboard');\n      }\n\n      this.canvas.dispatchEvent(\n        'StageDesigner.drop',\n        new StageDesignerDropEvent(\n          'StageDesigner.drop',\n          this.canvas,\n          e.originalEvent,\n          artboard,\n          this.canvas\n        )\n      );\n    });\n  }\n\n  deactivate() {\n    // TODO: call remove event listener with callback\n    // this.canvas.removeEventListener('drop');\n  }\n}\n","import { Event, Layer } from '../../..';\n\nexport default class StageDesignerDrawEvent extends Event {\n  dimensions: { x: number; y: number; height?: number; width?: number };\n  worldX: number;\n  worldY: number;\n  meta?: any;\n  snapPoints?: any;\n  constructor(\n    name: string,\n    target: Layer,\n    payload: {\n      x: number;\n      y: number;\n      height?: number;\n      width?: number;\n      worldX: number;\n      worldY: number;\n    },\n    currentTarget?: Layer,\n    meta?: any,\n    snapPoints?: any\n  ) {\n    super(name, target, currentTarget);\n    this.dimensions = {\n      x: payload.x,\n      y: payload.y,\n      height: payload.height,\n      width: payload.width,\n    };\n    this.worldX = payload.worldX;\n    this.worldY = payload.worldY;\n    this.meta = meta;\n    this.snapPoints = snapPoints;\n  }\n}\n","import { IPlugin } from 'interfaces/IPlugin';\nimport { Canvas } from 'models/Canvas';\nimport DrawEvent from '../../plugins/DrawComponent/events/drawEvent';\nimport StageDesignerDrawEvent from './events/stageDesignerDrawEvent';\nimport { Layer, Event, IContext } from '../..';\nimport { get } from 'lodash';\nimport Config from './interfaces/Config';\n\nexport default class StageDesignerDrawComponent implements IPlugin {\n  name = 'StageDesignerDrawComponent';\n  canvas!: Canvas;\n  selectedArtboard!: Layer;\n  firstTime: boolean = true;\n\n  setSelectedArtboard = (data: DrawEvent) => {\n    let { worldX, worldY } = data.dimensions;\n\n    const artboard = this.canvas.executeFunction(\n      'getHitArtboard',\n      worldX,\n      worldY\n    );\n\n    let selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n\n    if (artboard) {\n      if (selectedArtboard !== artboard) {\n        this.canvas.dispatchEvent(\n          'selectArtboard',\n          new Event('selectArtboard', artboard)\n        );\n      }\n      this.selectedArtboard = artboard;\n    } else if (selectedArtboard) {\n      this.selectedArtboard = selectedArtboard;\n    } else {\n      throw new Error('No artboard is selected');\n    }\n  };\n\n  drawShape = (data: any) => {\n    let { worldX, worldY } = data.dimensions;\n    let relativeDims = this.getDimsFromArtboard(data.dimensions);\n\n    data.meta.parent = this.selectedArtboard.children[0];\n\n    this.snapPoints = this.canvas.executeFunction(\n      'getSnapPoints',\n      [],\n      this.selectedArtboard.children[0]\n    );\n    this.canvas.executeFunction('DrawComponent.setSnapPoints', this.snapPoints);\n\n    let stageDesignerDrawEvent = new StageDesignerDrawEvent(\n      `${this.name}.drawShape`,\n      this.canvas,\n      { ...relativeDims, worldX, worldY },\n      undefined,\n      data.meta,\n      this.snapPoints\n    );\n    this.canvas.dispatchEvent(`${this.name}.drawShape`, stageDesignerDrawEvent);\n  };\n  addListeners = () => {\n    this.canvas.addEventListener(\n      'DrawComponent.drawShape',\n      (data: DrawEvent) => {\n        if (this.selectedArtboard) {\n          data.meta.parent = this.selectedArtboard.children[0];\n          this.drawShape(data);\n        }\n      }\n    );\n    this.canvas.addEventListener(\n      'DrawComponent.mousemove',\n      (data: DrawEvent) => {\n        //\n        let { worldX, worldY } = data.dimensions;\n        const oldSelectedArtboard = this.selectedArtboard;\n        this.setSelectedArtboard(data);\n        let relativeDims = this.getDimsFromArtboard(data.dimensions);\n        data.meta.parent = this.selectedArtboard.children[0];\n\n        if (oldSelectedArtboard !== this.selectedArtboard) {\n          this.drawShape(data);\n        }\n\n        let stageDesignerDrawEvent = new StageDesignerDrawEvent(\n          `${this.name}.mousemove`,\n          this.canvas,\n          { ...relativeDims, worldX, worldY },\n          undefined,\n          data.meta\n        );\n        this.canvas.dispatchEvent(\n          `${this.name}.mousemove`,\n          stageDesignerDrawEvent\n        );\n      }\n    );\n    this.canvas.addEventListener(\n      'DrawComponent.drawStart',\n      (data: DrawEvent) => {\n        this.setSelectedArtboard(data);\n        let { worldX, worldY } = data.dimensions;\n\n        let relativeDims = this.getDimsFromArtboard(data.dimensions);\n\n        const parent = this.selectedArtboard.children[0];\n\n        let stageDesignerDrawStartEvent = new StageDesignerDrawEvent(\n          `${this.name}.drawStart`,\n          this.canvas,\n          { ...relativeDims, worldX, worldY },\n          undefined,\n          { parent },\n          this.snapPoints\n        );\n\n        this.canvas.dispatchEvent(\n          `${this.name}.drawStart`,\n          stageDesignerDrawStartEvent\n        );\n\n        this.canvas.executeFunction(\n          'DrawComponent.setSnapPoints',\n          this.snapPoints\n        );\n      }\n    );\n\n    this.canvas.addEventListener('DrawComponent.draw', (data: DrawEvent) => {\n      let { worldX, worldY } = data.dimensions;\n\n      // data.target.setParent(this.selectedArtboard.children[0]);\n      // (data.target as any).parent = this.selectedArtboard.children[0];\n\n      data.meta.parent = this.selectedArtboard.children[0];\n      let relativeDims = this.getDimsFromArtboard(data.dimensions);\n      let stageDesignerDrawEvent = new StageDesignerDrawEvent(\n        `${this.name}.draw`,\n        this.canvas,\n        {\n          ...relativeDims,\n          worldX: data.dimensions.worldX,\n          worldY: data.dimensions.worldY,\n        },\n        undefined,\n        data.meta\n      );\n\n      this.canvas.dispatchEvent(`${this.name}.draw`, stageDesignerDrawEvent);\n    });\n\n    this.canvas.addEventListener('DrawComponent.drawEnd', (data: DrawEvent) => {\n      let { worldX, worldY } = data.dimensions;\n      let relativeDims = this.getDimsFromArtboard(data.dimensions);\n      let stageDesignerDrawEndEvent = new StageDesignerDrawEvent(\n        `${this.name}.drawEnd`,\n        this.canvas,\n        { ...relativeDims, worldX, worldY }\n      );\n\n      this.canvas.dispatchEvent(\n        `${this.name}.drawEnd`,\n        stageDesignerDrawEndEvent\n      );\n    });\n\n    this.canvas.addEventListener('DrawComponent.click', (data: DrawEvent) => {\n      let { worldX, worldY } = data.dimensions;\n      let relativeDims = this.getDimsFromArtboard(data.dimensions);\n\n      let stageDesignerClickEvent = new StageDesignerDrawEvent(\n        `${this.name}.click`,\n        this.canvas,\n        { ...relativeDims, worldX, worldY, height: undefined, width: undefined }\n      );\n\n      this.canvas.dispatchEvent(`${this.name}.click`, stageDesignerClickEvent);\n    });\n  };\n\n  getDimsFromArtboard = (\n    layerPoints:\n      | { worldX: number; worldY: number; height: number; width: number }\n      | {}\n  ) => {\n    let relativeX = 0;\n    let relativeY = 0;\n    let layerX = get(layerPoints, 'worldX', undefined);\n    let layerY = get(layerPoints, 'worldY', undefined);\n    let height = get(layerPoints, 'height', undefined);\n    let width = get(layerPoints, 'width', undefined);\n    if (layerX && this.selectedArtboard) {\n      relativeX = layerX - this.selectedArtboard.rootX;\n    }\n\n    if (layerY && this.selectedArtboard) {\n      relativeY = layerY - this.selectedArtboard.rootY;\n    }\n\n    return {\n      x: relativeX,\n      y: relativeY,\n      height,\n      width,\n    };\n  };\n  snapPoints: any;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n  activate() {\n    this.addListeners();\n  }\n  deactivate() {}\n}\n","import { Canvas, IPlugin, Layer } from '../..';\nimport RulerLinesAddEvent from '../../plugins/RulerLines/events/RulerLinesAddEvent';\nimport RulerLinesRemoveEvent from '../../plugins/RulerLines/events/RulerLinesRemoveEvent';\nimport RulerLinesSetPositionEvent from '../../plugins/RulerLines/events/RulerLinesSetPositionEvent';\nimport ArtboardEvent from 'events/ArtboardEvent';\nimport { IContext } from 'interfaces';\nimport { forEach } from 'lodash';\n\ntype RulerLineData = {\n  axis: 'x' | 'y';\n  axisCoordinate: number;\n};\n\nexport default class StageDesignerRulerPlugin implements IPlugin {\n  name = 'StageDesignerRuler';\n  canvas!: Canvas;\n  rulerVisibility: boolean = true;\n  artboardLinesMap: Map<Layer, Array<RulerLineData>> = new Map();\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  activate() {\n    this.canvas.addEventListener('artboardSelected', this.artboardSelected);\n    this.canvas.addEventListener('RulerLines.add', this.addLine);\n    this.canvas.addEventListener('RulerLines.setPosition', this.setPosition);\n    this.canvas.addEventListener('RulerLines.remove', this.removeLine);\n    this.canvas.addFunction(`${this.name}.getAllLines`, this.getAllLines);\n    this.canvas.addFunction(\n      `${this.name}.getLineCoordinates`,\n      this.getLineCoordinates\n    );\n    this.canvas.addFunction(`${this.name}.show`, this.showRuler);\n    this.canvas.addFunction(`${this.name}.hide`, this.hideRuler);\n    this.canvas.on('scroll', (e: any) => {\n      const selectedArtboard: Layer = this.canvas.executeFunction(\n        'getSelectedArtboard'\n      );\n      if (selectedArtboard) {\n        const { x, y } = this.canvas.convertPoint(\n          { x: selectedArtboard.rootX, y: selectedArtboard.rootY },\n          'world',\n          'viewport'\n        );\n        this.canvas.executeFunction('RulerScale.setInitialPoint', {\n          x,\n          y,\n        });\n      }\n    });\n  }\n\n  showRuler = (context: IContext) => {\n    this.rulerVisibility = true;\n    this.canvas.executeFunction('RulerScale.show');\n    this.canvas.executeFunction('RulerLines.show');\n  };\n  hideRuler = (context: IContext) => {\n    this.rulerVisibility = false;\n    this.canvas.executeFunction('RulerScale.hide');\n    this.canvas.executeFunction('RulerLines.hide');\n  };\n\n  artboardSelected = (event: ArtboardEvent) => {\n    const selectedArtboard = event.artboard;\n    const artboardDims = selectedArtboard.getBoundingClientRect();\n    if (selectedArtboard) {\n      const { x, y } = this.canvas.convertPoint(\n        { x: selectedArtboard.rootX, y: selectedArtboard.rootY },\n        'world',\n        'viewport'\n      );\n      this.canvas.executeFunction('RulerScale.setInitialPoint', {\n        x,\n        y,\n      });\n    }\n    this.canvas.executeFunction('RulerLines.removeAll');\n    let artboardLines: Array<RulerLineData> =\n      this.artboardLinesMap.get(selectedArtboard) || [];\n\n    if (artboardLines.length !== 0) {\n      artboardLines = artboardLines.map((ruler: RulerLineData) => {\n        if (ruler.axis === 'x') {\n          return {\n            axis: 'x',\n            axisCoordinate: artboardDims.rootY + ruler.axisCoordinate,\n          };\n        } else {\n          return {\n            axis: 'y',\n            axisCoordinate: artboardDims.rootX + ruler.axisCoordinate,\n          };\n        }\n      });\n    }\n\n    this.canvas.executeFunction('RulerLines.addAll', artboardLines);\n\n    if (!this.rulerVisibility) {\n      this.canvas.executeFunction('RulerLines.hide', artboardLines);\n    }\n  };\n\n  getAllLines = (context: IContext, selectedArtboard: Layer) => {\n    if (!selectedArtboard) {\n      selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n    }\n    return this.artboardLinesMap.get(selectedArtboard);\n  };\n  getLineCoordinates = () => {\n    let selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n\n    let coordinates: { x: Array<number>; y: Array<number> } = {\n      x: [],\n      y: [],\n    };\n    if (!selectedArtboard) {\n      return coordinates;\n    }\n    const rulerLines = this.artboardLinesMap.get(selectedArtboard);\n\n    if (!rulerLines) {\n      return coordinates;\n    }\n\n    forEach(rulerLines, line => {\n      if (line.axis === 'y') {\n        coordinates.y.push(line.axisCoordinate);\n      } else {\n        coordinates.x.push(line.axisCoordinate);\n      }\n    });\n\n    return coordinates;\n  };\n\n  addLine = (event: RulerLinesAddEvent) => {\n    const selectedArtboard: Layer = this.canvas.executeFunction(\n      'getSelectedArtboard'\n    );\n    if (!selectedArtboard) return;\n    const artboardDims = selectedArtboard.getBoundingClientRect();\n    let artboardLines = this.artboardLinesMap.get(selectedArtboard);\n    if (!artboardLines) {\n      artboardLines = [];\n    }\n    const artboardAxisCoordinate =\n      event.axis === 'x' ? artboardDims.rootY : artboardDims.rootX;\n    artboardLines.push({\n      axis: event.axis,\n      axisCoordinate: event.axisCoordinate - artboardAxisCoordinate,\n    });\n    this.artboardLinesMap.set(selectedArtboard, artboardLines);\n  };\n\n  setPosition = (event: RulerLinesSetPositionEvent) => {\n    const selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n    if (!selectedArtboard) return;\n    const artboardDims = selectedArtboard.getBoundingClientRect();\n    let artboardLines = this.artboardLinesMap.get(selectedArtboard);\n\n    const artboardAxisCoordinate =\n      event.axis === 'x' ? artboardDims.rootY : artboardDims.rootX;\n\n    const line = {\n      axis: event.axis,\n      axisCoordinate: event.axisCoordinate - artboardAxisCoordinate,\n    };\n    if (artboardLines) {\n      if (event.index || event.index === 0) {\n        artboardLines[event.index] = line;\n      } else {\n        artboardLines[artboardLines.length - 1] = line;\n      }\n    } else {\n      artboardLines = [];\n      artboardLines.push(line);\n    }\n    this.artboardLinesMap.set(selectedArtboard, artboardLines);\n  };\n\n  removeLine = (event: RulerLinesRemoveEvent) => {\n    const selectedArtboard = this.canvas.executeFunction('getSelectedArtboard');\n    if (!selectedArtboard) return;\n    let artboardLines = this.artboardLinesMap.get(selectedArtboard);\n    artboardLines?.splice(event.index, 1);\n    this.artboardLinesMap.set(selectedArtboard, artboardLines || []);\n  };\n\n  deactivate() {\n    this.canvas.removeEventListener('artboardSelected', this.artboardSelected);\n    this.canvas.removeEventListener('RulerLines.add', this.addLine);\n    this.canvas.removeEventListener('RulerLines.setPosition', this.setPosition);\n    this.canvas.removeEventListener('RulerLines.remove', this.removeLine);\n    this.canvas.removeFunction(`${this.name}.getAllLines`);\n    this.canvas.removeFunction(`${this.name}.getLineCoordinates`);\n    this.canvas.removeFunction(`${this.name}.show`);\n    this.canvas.removeFunction(`${this.name}.hide`);\n  }\n}\n","import { Event, Layer } from './../../..';\n\nexport default class DrawEvent extends Event {\n  dimensions: {\n    worldX: number;\n    worldY: number;\n    height?: number;\n    width?: number;\n  };\n  meta?: any;\n\n  constructor(\n    name: string,\n    target: Layer,\n    payload: { x: number; y: number; height?: number; width?: number },\n    currentTarget?: Layer,\n    meta?: any\n  ) {\n    super(name, target, currentTarget);\n    this.dimensions = {\n      worldX: payload.x,\n      worldY: payload.y,\n      height: payload.height,\n      width: payload.width,\n    };\n    this.meta = meta;\n  }\n}\n","import { IPlugin } from 'interfaces/IPlugin';\nimport { Canvas } from 'models/Canvas';\nimport { IContext, IDimension } from 'interfaces';\nimport DrawEvent from './events/drawEvent';\nimport {\n  // computeOrientationWithDeltaMultiple,\n  computeOrientation,\n  // calculateRotation,\n} from './../../models/utils';\nexport default class DrawComponent implements IPlugin {\n  name = 'DrawComponent';\n  canvas!: Canvas;\n  removeDom: any;\n  mouseDown!: boolean;\n  dragStarted!: boolean;\n  dragStart: any = {\n    x: 0,\n    y: 0,\n  };\n  renderer: any;\n  isShiftPressed: boolean = false;\n  isAltPressed: boolean = false;\n  overlayDispose: any;\n  overlayLayer: any;\n  dims: IDimension = { x: 0, y: 0, height: 0, width: 0 };\n  dragSession = {\n    start: { x: 0, y: 0, deltaX: 0, deltaY: 0 },\n    current: { x: 0, y: 0, deltaX: 0, deltaY: 0 },\n    end: { x: 0, y: 0, deltaX: 0, deltaY: 0 },\n  };\n  shapeType: any;\n  ellipseRenderer: any;\n  boundMouseMove: any;\n  boundMouseUp: any;\n  snapPoints: any;\n  initialDelta: any;\n  initialDimensions: any = {\n    x: 0,\n    y: 0,\n    height: 0,\n    width: 0,\n    rotation: 0,\n  };\n  newDimensions: any = {\n    x: 0,\n    y: 0,\n    height: 0,\n    width: 0,\n    rotation: 0,\n  };\n  getQuad = (\n    start: { x: number; y: number },\n    current: { x: number; y: number }\n  ) => {\n    if (current.x < start.x && current.y > start.y) return 2;\n    else if (current.x < start.x && current.y <= start.y) return 3;\n    else if (current.x >= start.x && current.y < start.y) return 4;\n    else return 1;\n    // DOC:  quad as  3|4\n    //                2|1\n  };\n\n  onMouseMove = (shapeType: any, e: any) => {\n    let startX = 0;\n    let startY = 0;\n    // let initialDimensions = {\n    //   x: startX,\n    //   y: startY,\n    //   height: 0,\n    //   width: 0,\n    //   rotation: 0,\n    // };\n    if (this.mouseDown && !this.dragStarted) {\n      if (e.pageX && e.pageY) {\n        // let val = this.canvas.executeFunction('HtmlDragToWorld.drag', e);\n\n        startX = this.dims.x;\n        startY = this.dims.y;\n        this.initialDimensions.x = startX;\n        this.initialDimensions.y = startY;\n        this.initialDimensions.width = 0;\n        this.initialDimensions.height = 0;\n\n        const snappedData = this.canvas.executeFunction(\n          'snapToPoints',\n          this.snapPoints,\n          [this.initialDimensions.x, this.initialDimensions.y],\n          [0, 0],\n          {\n            ...this.initialDimensions,\n          },\n          [0, 0],\n          [this.initialDimensions.x, this.initialDimensions.y],\n          0,\n          this.initialDimensions\n        );\n\n        this.initialDelta = snappedData.delta;\n\n        this.newDimensions = computeOrientation(\n          this.initialDimensions,\n          snappedData.delta,\n          'C',\n          false,\n          false\n        );\n\n        this.dims.x = this.newDimensions.x;\n        this.dims.y = this.newDimensions.y;\n\n        this.initialDimensions.x = this.dims.x;\n        this.initialDimensions.y = this.dims.y;\n\n        this.dragStarted = true;\n\n        const drawEvent = new DrawEvent(\n          `${this.name}.draw`,\n          this.canvas,\n          {\n            ...this.initialDimensions,\n          },\n          undefined,\n          snappedData.meta\n        );\n        this.canvas.dispatchEvent(`${this.name}.draw`, drawEvent);\n      }\n    } else if (this.dragStarted) {\n      let zoom = this.canvas.getZoom();\n      let canvasDims = this.canvas.getBoundingClientRect();\n      // console.log(this.dims, 'dims here @@@@');\n\n      if (e.pageX && e.pageY) {\n        let val = this.canvas.executeFunction('HtmlDragToWorld.drag', e);\n\n        this.dragSession.current = val.session.current;\n        // this.dims.x =\n        //   this.dragSession.current.x <= this.dragSession.start.x\n        //     ? this.dragSession.current.x\n        //     : this.dragSession.start.x;\n        // this.dims.y =\n        //   this.dragSession.current.y <= this.dragSession.start.y\n        //     ? this.dragSession.current.y\n        //     : this.dragSession.start.y;\n        // this.dims.height = Math.abs(\n        //   this.dragSession.current.y - this.dragSession.start.y\n        // );\n        // this.dims.width = Math.abs(\n        //   this.dragSession.current.x - this.dragSession.start.x\n        // );\n        let left: any = this.dims.x;\n        let top: any = this.dims.y;\n        // console.log(this.dims, 'dims here @@@@');\n\n        let right;\n        let bottom;\n\n        const totalDx =\n          val.session.current.x - val.session.start.x + this.initialDelta.x;\n        const totalDy =\n          val.session.current.y - val.session.start.y + this.initialDelta.y;\n\n        const snappedData = this.canvas.executeFunction(\n          'snapToPoints',\n          this.snapPoints,\n          [this.initialDimensions.x, this.initialDimensions.y],\n          [totalDx, totalDy],\n          {\n            ...this.initialDimensions,\n          },\n          [totalDx, totalDy],\n          [this.initialDimensions.x, this.initialDimensions.y],\n          0,\n          this.initialDimensions\n        );\n\n        const delta = snappedData.delta;\n        let handle = '';\n\n        if (delta.x >= 0) {\n          handle += 'R';\n        }\n        if (delta.x < 0) {\n          handle += 'L';\n        }\n        if (delta.y >= 0) {\n          handle += 'B';\n        }\n        if (delta.y < 0) {\n          handle += 'T';\n        }\n        this.newDimensions = computeOrientation(\n          this.initialDimensions,\n          delta,\n          handle,\n          this.isShiftPressed,\n          this.isAltPressed\n        );\n\n        this.renderer.style.backgroundColor = 'transparent';\n        if (shapeType === 'rect') {\n          this.renderer.style.position = 'absolute';\n          this.renderer.style.left = this.newDimensions.x\n            ? this.newDimensions.x + 'px'\n            : '';\n          this.renderer.style.top = this.newDimensions.y\n            ? this.newDimensions.y + 'px'\n            : '';\n          // this.renderer.style.right = right ? right + 'px' : '';\n          // this.renderer.style.bottom = bottom ? bottom + 'px' : '';\n          this.renderer.style.height = this.newDimensions.height + 'px';\n          this.renderer.style.width = this.newDimensions.width + 'px';\n          this.renderer.style.border = `${1 / zoom}px solid black`;\n        } else if (shapeType === 'ellipse') {\n          this.overlayLayer.style.display = 'block';\n          this.renderer.style.position = 'absolute';\n          this.renderer.style.left = this.newDimensions.x;\n          this.renderer.style.top = this.newDimensions.y;\n          this.renderer.setAttribute(\n            'height',\n            this.newDimensions.height + 'px'\n          );\n          this.renderer.setAttribute('width', this.newDimensions.width + 'px');\n          this.ellipseRenderer.setAttribute(\n            'cx',\n            this.newDimensions.width / 2 + 'px'\n          );\n          this.ellipseRenderer.setAttribute(\n            'cy',\n            this.newDimensions.height / 2 + 'px'\n          );\n          let strokeZoomAdjustment = 1 / (2 * zoom);\n          this.ellipseRenderer.setAttribute(\n            'rx',\n            this.newDimensions.width !== 0\n              ? this.newDimensions.width / 2 - strokeZoomAdjustment + 'px'\n              : 0\n          );\n          this.ellipseRenderer.setAttribute(\n            'ry',\n            this.newDimensions.height !== 0\n              ? this.newDimensions.height / 2 - strokeZoomAdjustment + 'px'\n              : 0\n          );\n          this.ellipseRenderer.style.strokeWidth = `${1 / zoom}px`;\n        }\n\n        this.overlayLayer.appendChild(this.renderer);\n        // snap logic\n\n        const drawEvent = new DrawEvent(\n          `${this.name}.draw`,\n          this.canvas,\n          {\n            ...this.newDimensions,\n          },\n          undefined,\n          snappedData.meta\n        );\n        const viewportDims = this.canvas.convertPoint(\n          this.newDimensions,\n          'world',\n          'viewport'\n        );\n        this.canvas.executeFunction(\n          'Tooltip.show',\n          {\n            x: viewportDims.x + this.newDimensions.width * zoom,\n            y: viewportDims.y + this.newDimensions.height * zoom,\n          },\n          `${Math.round(this.newDimensions.width)} ✕ ${Math.round(\n            this.newDimensions.height\n          )}`\n        );\n        this.canvas.dispatchEvent(`${this.name}.draw`, drawEvent);\n      }\n    } else {\n    }\n  };\n  onMouseUp = (e: any) => {\n    this.dragStarted = false;\n    this.mouseDown = false;\n    let drawEndEvent = new DrawEvent(`${this.name}.drawEnd`, this.canvas, {\n      x: this.newDimensions.x,\n      y: this.newDimensions.y,\n      height: this.newDimensions.height,\n      width: this.newDimensions.width,\n    });\n    this.canvas.executeFunction('Tooltip.hide');\n    this.newDimensions.height = 0;\n    this.newDimensions.width = 0;\n    this.renderer.style.width = '0px';\n    this.renderer.style.height = '0px';\n    this.renderer.style.display = 'none';\n    this.overlayDispose();\n    this.canvas.setMouseCursor('default');\n    this.canvas.dispatchEvent(`${this.name}.drawEnd`, drawEndEvent);\n\n    if (this.overlayLayer) {\n      this.overlayLayer.ownerDocument.removeEventListener(\n        'mousemove',\n        this.boundMouseMove\n      );\n      this.overlayLayer.ownerDocument.removeEventListener(\n        'mouseup',\n        this.boundMouseUp\n      );\n      this.overlayLayer.ownerDocument.removeEventListener(\n        'contextmenu',\n        this.boundMouseUp\n      );\n    }\n\n    this.renderer = undefined;\n    this.overlayLayer = undefined;\n    this.shapeType = undefined;\n  };\n  drawShape(\n    context: IContext,\n    shapeType: string = 'rect',\n    cursor: string = 'crosshair'\n  ): void {\n    if (this.shapeType && this.shapeType !== shapeType) {\n      this.abortDraw();\n    }\n\n    if (!this.mouseDown && !this.overlayLayer) {\n      let left = 0;\n      let top = 0;\n\n      const drawShape = new DrawEvent(\n        `${this.name}.drawShape`,\n        this.canvas,\n        {\n          x: left,\n          y: top,\n          height: 0,\n          width: 0,\n        },\n        undefined,\n        {}\n      );\n      this.canvas.dispatchEvent(`${this.name}.drawShape`, drawShape);\n\n      this.canvas.setMouseCursor(cursor);\n      this.shapeType = shapeType;\n      if (shapeType === 'rect') {\n        this.renderer = document.createElement('div');\n      } else if (shapeType === 'ellipse') {\n        let svgns = 'http://www.w3.org/2000/svg';\n        this.renderer = document.createElementNS(\n          'http://www.w3.org/2000/svg',\n          'svg'\n        );\n        this.ellipseRenderer = document.createElementNS(svgns, 'ellipse');\n        this.ellipseRenderer.style.fill = 'transparent';\n        this.ellipseRenderer.style.stroke = 'black';\n        this.renderer.appendChild(this.ellipseRenderer);\n      }\n      this.renderer.style.position = 'absolute';\n      let canvasDims = this.canvas.getBoundingClientRect();\n\n      this.overlayLayer = document.createElement('div');\n      this.overlayLayer.style.background = 'transparent';\n      this.overlayLayer.style.height = canvasDims.height + 'px';\n      this.overlayLayer.style.width = canvasDims.width + 'px';\n      this.overlayLayer.style.top = canvasDims.y + 'px';\n      this.overlayLayer.style.left = canvasDims.x + 'px';\n      this.overlayLayer.style.pointerEvents = 'none';\n      this.overlayLayer.style.position = 'absolute';\n      this.overlayLayer.style.zIndex = 1;\n\n      this.overlayDispose = this.canvas.addDomToWorld(\n        this.overlayLayer,\n        true,\n        105\n      );\n\n      this.overlayLayer.addEventListener(`mousemove`, (e: any) => {\n        //\n        if (!this.mouseDown) {\n          let dragStartVal = this.canvas.executeFunction(\n            'HtmlDragToWorld.dragStart',\n            e,\n            { x: 0, y: 0, height: 0, width: 0, rotation: 0 }\n          );\n          left = dragStartVal.session.start.x;\n          top = dragStartVal.session.start.y;\n\n          let dimension = {\n            x: left,\n            y: top,\n            width: 0,\n            height: 0,\n          };\n\n          const snappedData = this.canvas.executeFunction(\n            'snapToPoints',\n            this.snapPoints,\n            [left, top],\n            [0, 0],\n            {\n              ...dimension,\n            },\n            [0, 0],\n            [left, top],\n            0,\n            this.initialDimensions\n          );\n\n          dimension = {\n            ...dimension,\n            x: dimension.x + snappedData.delta.x,\n            y: dimension.y + snappedData.delta.y,\n          };\n\n          const drawEvent = new DrawEvent(\n            `${this.name}.mousemove`,\n            this.canvas,\n            {\n              ...dimension,\n            },\n            undefined,\n            snappedData.meta\n          );\n          this.canvas.dispatchEvent(`${this.name}.mousemove`, drawEvent);\n        }\n        //   let dragStartVal = this.canvas.executeFunction(\n        //     'HtmlDragToWorld.dragStart',\n        //     e,\n        //     { x: 0, y: 0, height: 0, width: 0, rotation: 0 }\n        //   );\n        //   left = dragStartVal.session.start.x;\n        //   top = dragStartVal.session.start.y;\n        // }\n\n        // const snappedData = this.canvas.executeFunction(\n        //   'snapToPoints',\n        //   this.snapPoints,\n        //   [left, top],\n        //   [0, 0],\n        //   {\n        //     x: left,\n        //     y: top,\n        //     width: 0,\n        //     height: 0,\n        //     rotation: 0,\n        //   },\n        //   [0, 0],\n        //   [top, left],\n        //   0\n        // );\n      });\n      this.overlayLayer.addEventListener(`mousedown`, (e: any) => {\n        let dragStartVal = this.canvas.executeFunction(\n          'HtmlDragToWorld.dragStart',\n          e,\n          { x: 0, y: 0, height: 0, width: 0, rotation: 0 }\n        );\n        left = dragStartVal.session.start.x;\n        top = dragStartVal.session.start.y;\n        this.dragSession.start = dragStartVal.session.start;\n        this.mouseDown = true;\n        this.dragStarted = false;\n        this.dims = { x: left, y: top, height: 0, width: 0 };\n        this.newDimensions = { x: left, y: top, height: 0, width: 0 };\n\n        this.boundMouseMove = this.onMouseMove.bind(this, shapeType);\n        this.boundMouseUp = this.onMouseUp;\n        this.overlayLayer.ownerDocument.addEventListener(\n          'mousemove',\n          this.boundMouseMove\n        );\n        this.overlayLayer.ownerDocument.addEventListener(\n          'mouseup',\n          this.boundMouseUp\n        );\n        this.overlayLayer.ownerDocument.addEventListener(\n          'contextmenu',\n          this.boundMouseUp\n        );\n\n        const drawStartEvent = new DrawEvent(\n          `${this.name}.drawStart`,\n          this.canvas,\n          {\n            x: left,\n            y: top,\n            height: 0,\n            width: 0,\n          }\n        );\n        this.canvas.dispatchEvent(`${this.name}.drawStart`, drawStartEvent);\n      });\n      this.canvas.addEventListener('click', this.clickEvent);\n    }\n  }\n  clickEvent = (data: any) => {\n    let clickEvent = new DrawEvent(`${this.name}.click`, this.canvas, {\n      x: data.worldX,\n      y: data.worldY,\n      height: undefined,\n      width: undefined,\n    });\n    this.canvas.dispatchEvent(`${this.name}.click`, clickEvent);\n  };\n  abortDraw = () => {\n    this.dragStarted = false;\n    this.mouseDown = false;\n    this.dims.height = 0;\n    this.dims.width = 0;\n    if (this.renderer && this.renderer.style) {\n      this.renderer.style.width = '0px';\n      this.renderer.style.height = '0px';\n      this.renderer.style.display = 'none';\n    }\n    this.canvas.executeFunction('Tooltip.hide');\n    if (this.overlayDispose) {\n      this.overlayDispose();\n    }\n    this.canvas.setMouseCursor('default');\n    this.canvas.removeEventListener('click', this.clickEvent);\n    if (this.overlayLayer) {\n      this.overlayLayer.ownerDocument.removeEventListener(\n        'mousemove',\n        this.boundMouseMove\n      );\n      this.overlayLayer.ownerDocument.removeEventListener(\n        'mouseup',\n        this.boundMouseUp\n      );\n      this.overlayLayer.ownerDocument.removeEventListener(\n        'contextmenu',\n        this.boundMouseUp\n      );\n      this.renderer = undefined;\n      this.overlayLayer = undefined;\n    }\n    this.shapeType = undefined;\n  };\n\n  setSnapPoints = (context: IContext, snapPoints: any) => {\n    this.snapPoints = snapPoints;\n    if (this.snapPoints) {\n      this.snapPoints.parentSnapPoints.x.forEach((point: any) => {\n        point.value = point.rootValue;\n      });\n\n      this.snapPoints.parentSnapPoints.y.forEach((point: any) => {\n        point.value = point.rootValue;\n      });\n\n      this.snapPoints.siblingSnapPoints.x.forEach((point: any) => {\n        point.value = point.rootValue;\n      });\n\n      this.snapPoints.siblingSnapPoints.y.forEach((point: any) => {\n        point.value = point.rootValue;\n      });\n\n      this.snapPoints.rulerSnapPoints.x.forEach((point: any) => {\n        point.value = point.rootValue;\n      });\n\n      this.snapPoints.rulerSnapPoints.y.forEach((point: any) => {\n        point.value = point.rootValue;\n      });\n    }\n  };\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n  activate() {\n    this.canvas.addFunction('drawShape', this.drawShape.bind(this));\n    this.canvas.addFunction('abortDraw', this.abortDraw.bind(this));\n    this.canvas.addFunction(\n      'DrawComponent.setSnapPoints',\n      this.setSnapPoints.bind(this)\n    );\n    this.canvas.addEventListener('blur', () => {\n      if (this.isAltPressed) this.isAltPressed = false;\n      if (this.isShiftPressed) this.isShiftPressed = false;\n    });\n    this.canvas.addEventListener('keyUp', (data: any) => {\n      let event = data.originalEvent ? data.originalEvent : data;\n      if (event.keyCode === 16) {\n        this.isShiftPressed = false;\n      }\n      if (event.keyCode === 18) {\n        this.isAltPressed = false;\n      }\n    });\n    this.canvas.addEventListener('keyDown', (data: any) => {\n      let event = data.originalEvent ? data.originalEvent : data;\n      if (event.keyCode === 16) {\n        this.isShiftPressed = true;\n      }\n      if (event.keyCode === 18) {\n        this.isAltPressed = true;\n      }\n    });\n  }\n  deactivate() {\n    this.canvas.removeFunction('drawShape');\n    this.canvas.removeFunction('abortDraw');\n    this.canvas.removeFunction('DrawComponent.setSnapPoints');\n    this.overlayDispose();\n  }\n}\n","import { Layer } from '../../../models/Layer';\nimport { Canvas } from 'models/Canvas';\nimport DesignerMouseEvent from '../../../events/MouseEvent';\nexport default class LayerLabelEvent extends DesignerMouseEvent {\n  pageDx: number;\n  pageDy: number;\n  worldDx: number;\n  worldDy: number;\n  viewportDx: number;\n  viewportDy: number;\n  constructor(\n    name: string,\n    target: Layer,\n    originalEvent: any,\n    payload: any,\n    currentTarget?: Layer\n  ) {\n    super(name, target, originalEvent, currentTarget);\n    const canvas: Canvas = target.getCanvas();\n    this.worldDx = payload.worldDx;\n    this.worldDy = payload.worldDy;\n\n    let pagePoints = canvas.convertPoint(\n      { x: payload.worldDx, y: payload.worldDy },\n      'world',\n      'page'\n    );\n    this.pageDx = pagePoints.x;\n    this.pageDy = pagePoints.y;\n\n    let viewportPoints = canvas.convertPoint(\n      { x: this.pageDx, y: this.pageDy },\n      'page',\n      'viewport'\n    );\n\n    this.viewportDx = viewportPoints.x;\n    this.viewportDy = viewportPoints.y;\n  }\n}\n","// import { IPlugin } from '../../interfaces/IPlugin';\n// import { Canvas } from '../../models/Canvas';\nimport { IContext, IDimension } from 'interfaces';\nimport LayerLabelEvent from './events/layerLabelEvent';\nimport RemoveChildEvent from 'events/RemoveChildEvent';\nimport ArtboardEvent from 'events/ArtboardEvent';\nimport { Canvas, IPlugin, MouseEvent as DesignerMouseEvent } from '../../';\n\nexport default class LayerLabel implements IPlugin {\n  name = 'LayerLabel';\n  canvas!: Canvas;\n  labeltext: any;\n  removeDom: any;\n  lastPageX = 0;\n  lastPageY = 0;\n  dragStart: any = {\n    x: 0,\n    y: 0,\n  };\n  dims: IDimension = { x: 0, y: 0, height: 0, width: 0 };\n  layerLabelMap: Map<any, any> = new Map([]);\n  ghostImageDOM: any;\n\n  handleGhostImage(e: any) {\n    var crt = e.target.cloneNode(true);\n    crt.style.backgroundColor = 'red';\n    crt.style.opacity = 0;\n    crt.style.pointerEvents = 'none';\n    document.body.appendChild(crt);\n    this.ghostImageDOM = crt;\n    e.dataTransfer.setDragImage(crt, 0, 0);\n  }\n\n  updateLabelLayout(label: any, layer: any) {\n    label.style.top = layer.rootY - 20 / this.canvas.getZoom() + 'px';\n    label.style.left = layer.rootX + 'px';\n    label.style.height = `${20 / this.canvas.getZoom()}px`;\n    label.style.fontSize = `${12 / this.canvas.getZoom()}px`;\n  }\n\n  setLabel(context: IContext, layerLabel: string): void {\n    let layer = this.layerLabelMap.get(context.layer);\n    let layertextNode = layer.labeltextNode;\n    layertextNode.nodeValue = layerLabel;\n  }\n\n  selectedArtboardChanged = (event: ArtboardEvent) => {\n    const selectedArtboard = event.artboard;\n    if (selectedArtboard) {\n      this.layerLabelMap.forEach((label: any, artboard: any) => {\n        if (label.labeltextNode.parentElement) {\n          if (artboard === selectedArtboard) {\n            label.labeltextNode.parentElement.style.color = 'rgb(26, 170, 198)';\n          } else {\n            label.labeltextNode.parentElement.style.color =\n              'rgb(186, 189, 198)';\n          }\n        }\n      });\n    }\n  };\n\n  removeLabel(context: IContext): void {\n    let layerCallback = this.layerLabelMap.get(context.layer).removeCallback;\n    layerCallback();\n  }\n  hideLabel(context: IContext): void {\n    let label = this.layerLabelMap.get(context.layer);\n    if (label && label.labelNode) {\n      label.labelNode.style.display = 'none';\n    }\n  }\n  showLabel(context: IContext): void {\n    let label = this.layerLabelMap.get(context.layer);\n    if (label && label.labelNode) {\n      label.labelNode.style.display = '';\n    }\n  }\n  addLabel(context: IContext, layerLabel: string): void {\n    let layer = context.layer;\n    let label = document.createElement('span');\n    let labeltext = document.createTextNode(layerLabel);\n    label.appendChild(labeltext);\n\n    label.style.position = 'absolute';\n    label.style.top = layer.rootY - 20 / this.canvas.getZoom() + 'px';\n    label.style.left = layer.rootX + 'px';\n    // label.style.width = layer.getBoundingClientRect().width + 'px';\n\n    // label.style.letterSpacing = '1px';\n    label.style.height = `${20 / this.canvas.getZoom()}px`;\n    label.style.fontSize = `${12 / this.canvas.getZoom()}px`;\n\n    //label.style.lineHeight = '0.7px';\n    label.style.fontFamily =\n      'Roboto, -apple-system, BlinkMacSystemFont, sans-serif';\n    label.style.textOverflow = 'ellipsis';\n    label.style.color = 'rgb(186, 189, 198)';\n    label.style.overflow = 'hidden';\n    label.style.fontWeight = '300px';\n    label.style.letterSpacing = '0.6px';\n\n    this.canvas.on('zoom', () => {\n      this.updateLabelLayout(label, context.layer);\n    });\n    if (layer.parent) {\n      layer.parent.addEventListener(\n        'removeChild',\n        (event: RemoveChildEvent) => {\n          if (layer === event.layer) layer.executeFunction('LayerLabel.remove');\n        }\n      );\n    }\n    let dispose = this.canvas.addDomToWorld(label, true, 101);\n    label.setAttribute('class', 'file-header ' + label.className);\n    label.setAttribute('data-cypress-id', 'file-header');\n    this.layerLabelMap.set(layer, {\n      removeCallback: dispose,\n      labelNode: label,\n      labeltextNode: labeltext,\n    });\n    label.style.pointerEvents = 'all';\n    context.layer.on('layout', () => {\n      this.updateLabelLayout(label, context.layer);\n    });\n    context.layer.on('updateDom', () => {\n      this.updateLabelLayout(label, context.layer);\n    });\n\n    this.canvas.executeFunction('handleHtmlDrag', label);\n\n    label.addEventListener('htmlDragStart', (e: Event) => {\n      let dragVal = this.canvas.executeFunction(\n        'HtmlDragToWorld.dragStart',\n        e,\n        {\n          x: 0,\n          y: 0,\n          height: 0,\n          width: 0,\n          rotation: 0,\n        }\n      );\n\n      this.lastPageX = dragVal.event.worldX;\n      this.lastPageY = dragVal.event.worldY;\n\n      let labelDragStartEvent = new LayerLabelEvent(\n        `dragStart`,\n        context.layer,\n        e,\n        { worldX: dragVal.event.worldX, worldY: dragVal.event.worldY },\n        context.layer\n      );\n\n      layer.dispatchEvent(`dragStart`, labelDragStartEvent);\n    });\n\n    label.addEventListener('htmlDrag', (e: any) => {\n      if (e.pageX && e.pageY) {\n        let dragVal = this.canvas.executeFunction('HtmlDragToWorld.drag', e);\n        if (dragVal.session.current.deltaX || dragVal.session.current.deltaY) {\n          let relPos = {\n            x: dragVal.event.worldX - this.lastPageX,\n            y: dragVal.event.worldY - this.lastPageY,\n          };\n\n          let labelDragEvent = new LayerLabelEvent(`drag`, context.layer, e, {\n            worldDx: relPos.x,\n            worldDy: relPos.y,\n          });\n\n          layer.dispatchEvent(`drag`, labelDragEvent);\n          this.lastPageX = dragVal.event.worldX;\n          this.lastPageY = dragVal.event.worldY;\n        }\n      }\n    });\n    label.addEventListener('contextmenu', (e: any) => {\n      this.canvas.dispatchEventOnHitLayer(\n        e.type,\n        new DesignerMouseEvent(e.type, this.canvas, e, this.canvas),\n        e\n      );\n    });\n\n    label.addEventListener('htmlDragEnd', (e: any) => {\n      let dragVal = layer.executeFunction('HtmlDragToWorld.dragEnd', e);\n\n      // let relPos = {\n      //   x: dragVal.event.worldX - this.lastPageX,\n      //   y: dragVal.event.worldY - this.lastPageY,\n      // };\n\n      let labelDragEndEvent = new LayerLabelEvent(\n        `dragEnd`,\n        context.layer,\n        e,\n        { worldX: dragVal.event.worldX, worldY: dragVal.event.worldY },\n        context.layer\n      );\n\n      layer.dispatchEvent(`dragEnd`, labelDragEndEvent);\n\n      this.lastPageX = 0;\n      this.lastPageY = 0;\n    });\n\n    label.addEventListener('click', (e: any) => {\n      let labelClickEvent = new LayerLabelEvent(\n        `${this.name}.click`,\n        layer,\n        e,\n        {}\n      );\n      layer.dispatchEvent(`${this.name}.click`, labelClickEvent);\n    });\n\n    label.addEventListener('dblclick', (e: any) => {\n      let layerDoubleClickEvent = new LayerLabelEvent(\n        `${this.name}.doubleClick`,\n        layer,\n        e,\n        {}\n      );\n      layer.dispatchEvent(`${this.name}.doubleClick`, layerDoubleClickEvent);\n    });\n  }\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n  activate() {\n    this.canvas.addFunction(`${this.name}.add`, this.addLabel.bind(this));\n    this.canvas.addFunction(`${this.name}.set`, this.setLabel.bind(this));\n    this.canvas.addFunction(`${this.name}.remove`, this.removeLabel.bind(this));\n    this.canvas.addFunction(`${this.name}.show`, this.showLabel.bind(this));\n    this.canvas.addFunction(`${this.name}.hide`, this.hideLabel.bind(this));\n    this.canvas.addEventListener(\n      'artboardSelected',\n      this.selectedArtboardChanged\n    );\n  }\n  deactivate() {}\n}\n","import * as React from 'react';\n\nexport default class IPhoneXFrame extends React.Component<\n  { deviceOrientation: string; top: number; left: number },\n  any\n> {\n  render() {\n    const { deviceOrientation, left, top } = this.props;\n    const computedLeft =\n      deviceOrientation === 'landscape' ? left + 211 : left - 8;\n    const computedTop = deviceOrientation === 'landscape' ? top - 225 : top - 8;\n    const computedTransform =\n      deviceOrientation === 'landscape' ? `rotate(270deg)` : 'none';\n\n    const styleObject = {\n      position: 'absolute',\n      pointerEvents: 'none',\n      // zIndex: 1,\n      left: computedLeft,\n      top: computedTop,\n      transform: computedTransform,\n    };\n    return (\n      <div style={styleObject as any}>\n        <svg\n          width=\"388px\"\n          height=\"824px\"\n          viewBox=\"-2 -2 388 824\"\n          version=\"1.1\"\n          xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n        >\n          <path\n            d={`M46,6 C23.909,6 6,23.909 6,46 L6,778 C6,800.091 23.909,818 46,818 L341,818 C363.091,818 381,800.091 381,\n            778 L381,46 C381,23.909 363.091,6 341,6 L46,6 Z M112.04,37 C99.337,37 89.04,26.703 89.04,13.961\n            L89.046,10.037 C89.0345531,9.99058934 89.0205314,9.94485191 89.004,9.9 C88.334,8.086 86.78,6.674\n            84.892,6.216 L84,6 L303,6 L302.108,6.216 C300.210771,6.68271966 298.67094,8.06429185 298.002,9.9\n            C297.970221,9.98647005 297.953971,10.0778752 297.954,10.17 L297.961,14 C297.961,26.703 287.663,37\n            274.961,37 L112.039,37 L112.04,37 Z M0,0 L388,0 L388,824 L0,824 L0,0 Z M128.5,800 C127.119288,800\n            126,801.119288 126,802.5 C126,803.880712 127.119288,805 128.5,805 L258.5,805 C259.880712,805 261,803.880712\n            261,802.5 C261,801.119288 259.880712,800 258.5,800 L128.5,800 Z`}\n            fill=\"#171A21\"\n            fillRule=\"evenodd\"\n            id=\"Shape\"\n          />\n        </svg>\n      </div>\n    );\n  }\n}\n","import * as React from 'react';\n\nexport default class IPhoneXsMaxFrame extends React.Component<\n  { deviceOrientation: string; top: number; left: number },\n  any\n> {\n  render() {\n    const { deviceOrientation, left, top } = this.props;\n    const computedLeft =\n      deviceOrientation === 'landscape' ? left + 235 : left - 8;\n    const computedTop = deviceOrientation === 'landscape' ? top - 248 : top - 8;\n    const computedTransform =\n      deviceOrientation === 'landscape' ? `rotate(270deg)` : 'none';\n\n    const styleObject = {\n      position: 'absolute',\n      pointerEvents: 'none',\n      zIndex: 1,\n      left: computedLeft,\n      top: computedTop,\n      transform: computedTransform,\n    };\n    return (\n      <div style={styleObject as any}>\n        <svg\n          // this width, height too\n          width=\"427px\"\n          height=\"908px\"\n          // after 15 years of efforts, I have written this specific viewBox, dare not touch it ever\n          viewBox=\"0 -2 384 825\"\n          version=\"1.1\"\n          xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n        >\n          <path\n            d={`M46,6 C23.909,6 6,23.909 6,46 L6,778 C6,800.091 23.909,818 46,818 L341,818 C363.091,818 381,800.091 381,\n            778 L381,46 C381,23.909 363.091,6 341,6 L46,6 Z M112.04,37 C99.337,37 89.04,26.703 89.04,13.961\n            L89.046,10.037 C89.0345531,9.99058934 89.0205314,9.94485191 89.004,9.9 C88.334,8.086 86.78,6.674\n            84.892,6.216 L84,6 L303,6 L302.108,6.216 C300.210771,6.68271966 298.67094,8.06429185 298.002,9.9\n            C297.970221,9.98647005 297.953971,10.0778752 297.954,10.17 L297.961,14 C297.961,26.703 287.663,37\n            274.961,37 L112.039,37 L112.04,37 Z M0,0 L388,0 L388,824 L0,824 L0,0 Z M128.5,800 C127.119288,800\n            126,801.119288 126,802.5 C126,803.880712 127.119288,805 128.5,805 L258.5,805 C259.880712,805 261,803.880712\n            261,802.5 C261,801.119288 259.880712,800 258.5,800 L128.5,800 Z`}\n            fill=\"#171A21\"\n            fillRule=\"evenodd\"\n            id=\"Shape\"\n          />\n        </svg>\n      </div>\n    );\n  }\n}\n","// import { IPlugin } from '../../interfaces/IPlugin';\n// import { Canvas } from '../../models/Canvas';\nimport { IContext, IDimension } from 'interfaces';\nimport DeviceFrameEvent from './events/DeviceFrameEvent';\nimport RemoveChildEvent from 'events/RemoveChildEvent';\nimport ArtboardEvent from 'events/ArtboardEvent';\nimport {\n  Canvas,\n  IPlugin,\n  MouseEvent as DesignerMouseEvent,\n  Layer,\n} from '../..';\nimport IPhoneXFrame from './Frames/iPhoneX';\nimport * as React from 'react';\nimport IPhoneXsMaxFrame from './Frames/iPhoneXsMax';\nimport ReactDOM from 'react-dom';\n\nexport default class DeviceFrame implements IPlugin {\n  name = 'DeviceFrame';\n  canvas!: Canvas;\n  labeltext: any;\n  wrapperDiv: any;\n  deviceName: any;\n  deviceOrientation: any;\n  dispose: any;\n  removeDom: any;\n  deviceFrameMap: Map<any, any> = new Map([]);\n  lastPageX = 0;\n  lastPageY = 0;\n  dragStart: any = {\n    x: 0,\n    y: 0,\n  };\n  dims: IDimension = { x: 0, y: 0, height: 0, width: 0 };\n  DeviceFrameMap: Map<any, any> = new Map([]);\n  ghostImageDOM: any;\n\n  // updateFrameLayout(layer: any) {\n  //   this.render();\n  // }\n\n  selectedArtboardChanged = (event: ArtboardEvent) => {\n    const selectedArtboard = event.artboard;\n    if (selectedArtboard) {\n      this.DeviceFrameMap.forEach((label: any, artboard: any) => {\n        if (artboard === selectedArtboard) {\n          let layerTextNode = label.labeltextNode;\n          layerTextNode.parentElement.style.color = 'rgb(26, 170, 198)';\n        } else {\n          label.labeltextNode.parentElement.style.color = 'rgb(186, 189, 198)';\n        }\n      });\n    }\n  };\n\n  removeFrame(context: IContext): void {\n    const deviceFrame = this.deviceFrameMap.get(context.layer);\n\n    if (deviceFrame) {\n      deviceFrame.removeCallback();\n    }\n  }\n\n  render = (layer: Layer) => {\n    let FrameComponent;\n\n    const deviceFrame = this.deviceFrameMap.get(layer);\n\n    if (!deviceFrame) {\n      return;\n    }\n\n    deviceFrame.frameNode.style.top =\n      layer.getBoundingClientRect().rootY + 'px';\n    deviceFrame.frameNode.style.left =\n      layer.getBoundingClientRect().rootX + 'px';\n\n    if (deviceFrame.deviceName) {\n      switch (deviceFrame.deviceName.toLowerCase()) {\n        case 'iphone x':\n        case 'iphone xs':\n        case 'iphone 11 pro':\n          FrameComponent = (\n            <IPhoneXFrame\n              deviceOrientation={deviceFrame.deviceOrientation}\n              left={0}\n              top={0}\n            />\n          );\n          break;\n        case 'iphone xs max':\n        case 'iphone xr':\n        case 'iphone 11 pro max':\n        case 'iphone 11':\n          FrameComponent = (\n            <IPhoneXsMaxFrame\n              deviceOrientation={deviceFrame.deviceOrientation}\n              left={0}\n              top={0}\n            />\n          );\n          break;\n        default:\n      }\n    }\n\n    if (!FrameComponent) {\n      return;\n    }\n\n    ReactDOM.render(FrameComponent, deviceFrame.frameNode);\n  };\n\n  addFrame(\n    context: IContext,\n    deviceName: string,\n    deviceOrientation: string\n  ): void {\n    let layer = context.layer;\n\n    const deviceFrame = this.deviceFrameMap.get(layer);\n\n    if (deviceFrame) {\n      deviceFrame.removeCallback();\n    }\n    const wrapperDiv = document.createElement('div');\n    wrapperDiv.className = 'frame-wrappers';\n    wrapperDiv.style.pointerEvents = 'none';\n    wrapperDiv.style.position = 'absolute';\n\n    let dispose = this.canvas.addDomToWorld(wrapperDiv, true, 100);\n\n    this.deviceFrameMap.set(layer, {\n      removeCallback: dispose,\n      frameNode: wrapperDiv,\n      deviceName: deviceName,\n      deviceOrientation: deviceOrientation,\n    });\n\n    this.render(layer);\n\n    if (layer.parent) {\n      layer.parent.addEventListener(\n        'removeChild',\n        (event: RemoveChildEvent) => {\n          if (layer === event.layer)\n            layer.executeFunction('DeviceFrame.remove');\n        }\n      );\n    }\n\n    context.layer.on('layout', () => {\n      this.render(context.layer);\n    });\n    context.layer.on('updateDom', () => {\n      this.render(context.layer);\n    });\n  }\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n  activate() {\n    this.canvas.addFunction(`${this.name}.add`, this.addFrame.bind(this));\n    this.canvas.addFunction(`${this.name}.remove`, this.removeFrame.bind(this));\n    this.canvas.addEventListener(\n      'artboardSelected',\n      this.selectedArtboardChanged\n    );\n  }\n  deactivate() {}\n}\n","import * as React from 'react';\n\nexport class BatterySection extends React.Component<any, any> {\n  render() {\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: this.props.left,\n        }}\n      >\n        <svg\n          width={`150px`}\n          height=\"24px\"\n          viewBox={`0 0 150 24`}\n          version=\"1.1\"\n          xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n        >\n          <g stroke=\"none\" strokeWidth={1} fill=\"none\" fillRule=\"evenodd\">\n            <rect\n              // fill={this.props.backgroundColor}\n              x={0}\n              y={0}\n              width={150}\n              height={24}\n            />\n          </g>\n        </svg>\n      </div>\n    );\n  }\n}\nexport class NetworkSection extends React.Component<any, any> {\n  render() {\n    // //console.log(\"NetworkSection\", this.props.left, this.props.width);\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: this.props.left,\n        }}\n      >\n        <svg\n          width={`116px`}\n          height=\"24px\"\n          viewBox={`0 0 116 24`}\n          version=\"1.1\"\n          xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n        >\n          <g\n            // transform=\"translate(242.000000, 0.000000)\"\n            strokeWidth={1}\n          >\n            <text\n              opacity=\"0.9\"\n              transform=\"translate(74.000000, 4.000000)\"\n              fill={this.props.color}\n              fontFamily=\"Roboto-Medium, Roboto\"\n              fontSize={14}\n              fontWeight={400}\n            >\n              <tspan x=\"0.459960938\" y={13}>\n                12:30\n              </tspan>\n            </text>\n            <g transform=\"translate(55.000000, 4.000000)\" fill=\"transparent\">\n              <polygon points=\"0 0 16 0 16 16 0 16\" />\n              <polygon\n                fill={this.props.color}\n                points=\"9 1.875 9 1 6 1 6 1.875 3 1.875 3 15 12 15 12 1.875\"\n              />\n            </g>\n            <g transform=\"translate(35.000000, 4.000000)\" fill=\"transparent\">\n              <polygon points=\"0 0 16 0 16 16 0 16\" />\n              <polygon fill={this.props.color} points=\"0 15 14 15 14 1\" />\n            </g>\n            <g transform=\"translate(14.000000, 4.000000)\" fill=\"transparent\">\n              <polygon points=\"2 0 18 0 18 16 2 16\" />\n              <path\n                d=\"M.977 4.016A14.934 14.934 0 0 1 10 1c3.387 0 6.512 1.123 9.023 3.016L10 15 .977 4.016z\"\n                fill={this.props.color}\n              />\n            </g>\n          </g>\n        </svg>\n      </div>\n    );\n  }\n}\n\nexport default (props: any) => {\n  const backgroundColor: string = props.backgroundColor\n    ? props.backgroundColor\n    : '#000';\n  const color: string = props.color ? props.color : '#FFF';\n  return (\n    <div\n      style={{\n        position: 'relative',\n        width: props.width,\n        height: 24,\n        zIndex: 1,\n        backgroundColor: backgroundColor,\n      }}\n    >\n      <BatterySection\n        width={props.width}\n        // backgroundColor={backgroundColor}\n        left={0}\n      />\n      <NetworkSection\n        width={props.width}\n        color={color}\n        left={props.width - 115}\n      />\n    </div>\n  );\n};\n","import * as React from 'react';\nexport class RightSection extends React.Component<any, any> {\n  render() {\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          top: 13,\n          left: this.props.left,\n        }}\n      >\n        <svg\n          width=\"97px\"\n          height=\"18px\"\n          viewBox=\"0 0 145 27\"\n          version=\"1.1\"\n          xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n        >\n          <g\n            transform={`translate(-461.000000, -204.000000) translate(88.000000, 201.000000)\n            translate(373.000000, 3.000000)`}\n            stroke=\"none\"\n            strokeWidth={1}\n            fill=\"none\"\n            fillRule=\"evenodd\"\n          >\n            <path\n              d={`M0 11.99c0-.546.444-.99 1-.99h3a1 1 0 0 1 1 .99v4.02c0 .546-.444.99-1 .99H1a1\n              1 0 0 1-1-.99v-4.02zm7-2.992C7 8.447 7.444 8 8 8h3c.552 0 1 .446 1 .998v7.004c0\n              .551-.444.998-1 .998H8c-.552 0-1-.446-1-.998V8.998zm7-4A.997.997 0 0 1 15 4h3a1 1 0 0\n              1 1 .999V16A.997.997 0 0 1 18 17h-3a1 1 0 0 1-1-.999V5zm7-2.997C21 1.448 21.444 1 22\n              1h3c.552 0 1 .445 1 1v14c0 .552-.444 1-1 1h-3c-.552 0-1-.445-1-1V2z`}\n              fill={this.props.color}\n            />\n            <path\n              d={`M32.348 5.634C38.603-.621 48.745-.621 55 5.634l-2.35\n              2.35c-4.957-4.957-12.994-4.957-17.951 0l-2.35-2.35zm3.858 3.857c4.125-4.124 10.812-4.124\n              14.936 0l-2.028 2.03a7.692 7.692 0 0 0-10.88 0l-2.028-2.03zm3.33 3.33a5.853 5.853 0 0\n              1 8.277 0l-4.139 4.139-4.138-4.139z`}\n              fill={this.props.color}\n            />\n            <g transform=\"translate(61.000000, 0.000000)\">\n              <rect\n                stroke={this.props.color}\n                // stroke=\"none\"\n                opacity=\"0.300000012\"\n                x=\"0.5\"\n                y=\"0.5\"\n                width={31}\n                height={17}\n                rx={6}\n              />\n              <rect\n                fill={this.props.color}\n                x={3}\n                y={3}\n                width={26}\n                height={12}\n                rx={3}\n              />\n              <path d=\"M34 7a2 2 0 1 1 0 4V7z\" fill={this.props.color} />\n            </g>\n          </g>\n        </svg>\n      </div>\n    );\n  }\n}\n\nexport class LeftSection extends React.Component<any, any> {\n  render() {\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          top: 13,\n          left: this.props.left,\n        }}\n      >\n        <svg version=\"1.1\" xmlnsXlink=\"http://www.w3.org/1999/xlink\">\n          <g\n            fill={this.props.color}\n            stroke=\"none\"\n            strokeWidth={1}\n            fillRule=\"evenodd\"\n          >\n            <g fill={this.props.color}>\n              <text\n                fontFamily=\".AppleSystemUIFont\"\n                fontSize=\"11.9931181\"\n                fontWeight=\"normal\"\n              >\n                <tspan x={0} y={13}>\n                  9:41 AM\n                </tspan>\n              </text>\n              <path\n                d={`M61.797 2.5a2.163 2.163 0 0 0-.763.134l-.339.133 2.764 2.763.242.221.12-.312a2.186 2.186 0 0\n                0-.495-2.304 2.18 2.18 0 0 0-1.529-.636zm-5.535.002a2.185 2.185 0 0 0-1.656.633 2.18 2.18 0 0 0-.502\n                2.292l.133.34L57 3.002l.22-.241-.31-.122-.046-.019a2.153 2.153 0 0 0-.602-.119zm2.704.866a4.568 4.568\n                0 0 0-4.562 4.562 4.568 4.568 0 0 0 4.562 4.563A4.568 4.568 0 0 0 63.53 7.93a4.568 4.568 0 0\n                0-4.563-4.562zm0 1.303c.12 0 .217.098.217.217V7.93c0 .12-.097.217-.217.217h-1.738a.217.217 0\n                0 1 0-.434h1.52V4.888c0-.12.098-.217.218-.217z`}\n                fillRule=\"nonzero\"\n              />\n            </g>\n          </g>\n        </svg>\n      </div>\n    );\n  }\n}\n\nexport default (props: any) => (\n  <div style={{ position: 'relative', width: '100%', height: 44, zIndex: 1 }}>\n    <LeftSection left={14} width={83} color={props.color} />\n    <RightSection left={props.width - 80} width={83} color={props.color} />\n  </div>\n);\n","import * as React from 'react';\nexport class BatterySection extends React.Component<any, any> {\n  render() {\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          top: 2.5,\n          left: this.props.left,\n        }}\n      >\n        <svg version=\"1.1\" xmlnsXlink=\"http://www.w3.org/1999/xlink\">\n          <g\n            fill={this.props.color}\n            stroke=\"none\"\n            strokeWidth={1}\n            fillRule=\"evenodd\"\n          >\n            <g strokeWidth={1} fillRule=\"evenodd\">\n              <path\n                d={`M37.494 2.5h19.512c.82 0 1.494.674 1.494 1.505v6.49c0 .837-.669\n              1.505-1.494 1.505H37.494c-.82 0-1.494-.674-1.494-1.505v-6.49c0-.837.669-1.505\n              1.494-1.505zM59 5.5h.75c.417 0 .75.332.75.742v2.016a.748.748 0 0 1-.75.742H59V5.5zM37.508\n              3c-.557 0-1.008.457-1.008 1.008v6.484c0 .557.45 1.008 1.008 1.008h19.484c.557 0 1.008-.457\n              1.008-1.008V4.008C58 3.451 57.55 3 56.992 3H37.508zm-.001.5h19.486c.277\n              0 .507.22.507.492v6.516a.497.497 0 0 1-.507.492H37.507a.502.502 0 0\n              1-.507-.492V3.992c0-.276.227-.492.507-.492z`}\n              />\n              <text\n                fontFamily=\".AppleSystemUIFont\"\n                fontSize={12}\n                fontWeight=\"normal\"\n              >\n                <tspan x=\"2.85351562\" y=\"11.5\">\n                  100%\n                </tspan>\n              </text>\n            </g>\n          </g>\n        </svg>\n      </div>\n    );\n  }\n}\nexport class NetworkSection extends React.Component<any, any> {\n  render() {\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          top: 2.5,\n          left: this.props.left,\n        }}\n      >\n        <svg version=\"1.1\" xmlnsXlink=\"http://www.w3.org/1999/xlink\" fill=\"red\">\n          <g\n            fill={this.props.color}\n            stroke=\"none\"\n            strokeWidth={1}\n            fillRule=\"evenodd\"\n          >\n            <g strokeWidth={1} fillRule=\"evenodd\">\n              <path\n                d={`M90.144 9.439L88.023 11.5 85.86 9.405a2.857 2.857 0 0 1 2.128-.936c.864 0\n              1.638.376 2.156.97zm2.18-2.118l-1.09 1.058a4.417 4.417 0 0 0-3.246-1.402c-1.274 0-2.42.528-3.219\n              1.372l-1.09-1.056a5.979 5.979 0 0 1 4.309-1.809c1.713 0 3.257.708 4.335 1.837zM94.5 5.207l-1.088\n              1.057a7.539 7.539 0 0 0-5.424-2.272 7.54 7.54 0 0 0-5.398 2.245L81.5 5.182A9.1 9.1 0 0 1 87.988 2.5\n              9.1 9.1 0 0 1 94.5 5.207z`}\n              />\n              <text\n                fontFamily=\".AppleSystemUIFont\"\n                fontSize={12}\n                fontWeight=\"normal\"\n              >\n                <tspan x={38} y=\"11.5\">\n                  Carrier\n                </tspan>\n              </text>\n              <path\n                d={`M3.25 10a2.75 2.75 0 1 1 0-5.5 2.75 2.75 0 0 1 0 5.5zm7 0a2.75 2.75 0 1\n              1 0-5.5 2.75 2.75 0 0 1 0 5.5zm7 0a2.75 2.75 0 1 1 0-5.5 2.75 2.75 0 0 1 0 5.5zm7 0a2.75 2.75\n              0 1 1 0-5.5 2.75 2.75 0 0 1 0 5.5zm7 0a2.75 2.75 0 1 1 0-5.5 2.75 2.75 0 0 1 0 5.5z`}\n              />\n            </g>\n          </g>\n        </svg>\n      </div>\n    );\n  }\n}\n\nexport class TimeSection extends React.Component<any, any> {\n  render() {\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          top: 2.5,\n          left: this.props.left,\n        }}\n      >\n        <svg version=\"1.1\" xmlnsXlink=\"http://www.w3.org/1999/xlink\">\n          <g\n            fill={this.props.color}\n            stroke=\"none\"\n            strokeWidth={1}\n            fillRule=\"evenodd\"\n          >\n            <text\n              fontFamily=\".AppleSystemUIFont\"\n              fontSize={12}\n              fontWeight=\"normal\"\n            >\n              <tspan x=\"0\" y=\"11.5\">\n                9:41 AM\n              </tspan>\n            </text>\n          </g>\n        </svg>\n      </div>\n    );\n  }\n}\n\nexport class BackgroundRect extends React.Component<any, any> {\n  render() {\n    return (\n      <div\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: this.props.width,\n        }}\n      >\n        <svg\n          width={`${this.props.width}px`}\n          height=\"20px\"\n          viewBox={`0 0 ${this.props.width} 20`}\n          version=\"1.1\"\n          xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n        >\n          <g stroke=\"none\" strokeWidth={1} fill=\"none\" fillRule=\"evenodd\">\n            <rect\n              fill={this.props.backgroundColor}\n              x={0}\n              y={0}\n              width={this.props.width}\n              height={20}\n            />\n          </g>\n        </svg>\n      </div>\n    );\n  }\n}\n\nexport default (props: any) => (\n  <div\n    style={{ position: 'relative', width: props.width, height: 20, zIndex: 1 }}\n  >\n    <BackgroundRect\n      backgroundColor={props.backgroundColor}\n      width={props.width}\n    />\n    <NetworkSection left={3} color={props.color} />\n    <TimeSection color={props.color} left={props.width / 2 - 20} />\n    <BatterySection color={props.color} left={props.width - 65} />\n  </div>\n);\n","import { get } from 'lodash';\nimport * as React from 'react';\nimport AndroidStatusBar from './StatusBars/AndroidStatusBar';\nimport IPhoneXStatusBar from './StatusBars/IPhoneXStatusBar';\nimport IOSStatusBar from './StatusBars/IOSStatusBar';\nimport { Layer } from '../../..';\n\nexport default class StatusBarComponent extends React.Component<\n  {\n    layer: Layer;\n    width: number;\n    height: number;\n    deviceName: string;\n    deviceOS: string;\n    deviceOrientation: string;\n    backgroundColor: string;\n    barStyle: string;\n  },\n  any\n> {\n  constructor(props: any) {\n    super(props);\n  }\n  onUpdate = () => {\n    // this.forceUpdate();\n  };\n  attachStatusBarListeners = () => {\n    // const statusBarRenderLayer = this.props.layer;\n    // const statusBarLayer = statusBarRenderLayer.domainCompiledRef.domainRef;\n    // if (statusBarLayer) {\n    //   statusBarLayer.props.on('hidden', this.onUpdate);\n    //   statusBarLayer.props.on('backgroundColor', this.onUpdate);\n    //   statusBarLayer.props.on('barStyle', this.onUpdate);\n    //   statusBarLayer.props.on('animated', this.onUpdate);\n    // }\n    // if (this.props.layer.getFile()) {\n    //   this.props.layer.getFile().on('height', this.onUpdate);\n    //   this.props.layer.getFile().on('width', this.onUpdate);\n    // }\n  };\n  removeStatusBarListeners = () => {\n    // const statusBarRenderLayer = this.props.layer;\n    // const statusBarLayer = statusBarRenderLayer.domainCompiledRef.domainRef;\n    // if (statusBarLayer) {\n    //   statusBarLayer.props.off('hidden', this.onUpdate);\n    //   statusBarLayer.props.off('backgroundColor', this.onUpdate);\n    //   statusBarLayer.props.off('barStyle', this.onUpdate);\n    //   statusBarLayer.props.off('animated', this.onUpdate);\n    // }\n    // if (this.props.layer.getFile()) {\n    //   this.props.layer.getFile().off('height', this.onUpdate);\n    //   this.props.layer.getFile().off('width', this.onUpdate);\n    // }\n    // // if (this.props.layer.parent) {\n    // //   this.props.layer.parent.off(\"height\", this.onUpdate);\n    // //   this.props.layer.parent.off(\"width\", this.onUpdate);\n    // // }\n  };\n  componentDidMount() {\n    this.props.layer.on(['layout', 'updateDom'], this.onUpdate);\n  }\n  componentDidUpdate(prevProps: any) {\n    prevProps.layer.off(['layout', 'updateDom'], this.onUpdate);\n    this.props.layer.on(['layout', 'updateDom'], () => {\n      this.onUpdate();\n    });\n  }\n  componentWillUnmount() {\n    this.props.layer.off(['layout', 'updateDom'], this.onUpdate);\n  }\n  getElement() {\n    if (!this.props.layer) {\n      return null;\n    }\n\n    const deviceName = this.props.deviceName;\n    const deviceOS = this.props.deviceOS;\n    const deviceOrientation = this.props.deviceOrientation;\n\n    let barColor: string = '#000';\n\n    let deviceWidth = this.props.width;\n    let deviceHeight = this.props.height;\n    // if (deviceOrientation === 'portrait') {\n    //   deviceWidth = device.resolution.width / device.pixelRatio;\n    //   deviceHeight = device.resolution.height / device.pixelRatio;\n    // } else {\n    //   deviceWidth = device.resolution.height / device.pixelRatio;\n    //   deviceHeight = device.resolution.width / device.pixelRatio;\n    // }\n\n    const style = {\n      // display: statusBarRenderLayer.props.style.display,\n    };\n    // if (statusBarRenderLayer.props.hidden) {\n    //   return null;\n    // }\n    // const height = renderFile ? renderFile.height : 0;\n    // const width = renderFile ? renderFile.width : 0;\n    let IPHONEX_OR_IPHONEXS: boolean = false;\n    let IPHONEXR_OR_IPHONEXSMAX: boolean = false;\n\n    if (deviceOS && deviceName) {\n      IPHONEX_OR_IPHONEXS =\n        deviceOS.toLowerCase() === 'ios' &&\n        (deviceName.toLowerCase() === 'iphone x' ||\n          deviceName.toLowerCase() === 'iphone xs' ||\n          deviceName.toLowerCase() === 'iphone 11 pro');\n\n      IPHONEXR_OR_IPHONEXSMAX =\n        deviceOS.toLowerCase() === 'ios' &&\n        (deviceName.toLowerCase() === 'iphone xr' ||\n          deviceName.toLowerCase() === 'iphone xs max' ||\n          deviceName.toLowerCase() === 'iphone 11' ||\n          deviceName.toLowerCase() === 'iphone 11 pro max');\n    }\n\n    //    &&\n    // ((deviceWidth === height && deviceHeight === width) ||\n    //   (deviceWidth === width && deviceHeight === height));\n\n    const IOS: boolean = deviceOS === 'iOS';\n    const WEB: boolean = deviceOS === 'Web';\n    if (WEB) {\n      return null;\n    }\n\n    if (IOS && !IPHONEX_OR_IPHONEXS && !IPHONEXR_OR_IPHONEXSMAX) {\n      if (this.props.barStyle === 'light-content') {\n        barColor = '#ffffff';\n      } else if (this.props.barStyle === 'dark-content') {\n        barColor = '#000000';\n      }\n      return (\n        <div style={{ position: 'absolute', top: 0, left: 0 }}>\n          <IOSStatusBar width={deviceWidth} color={barColor} style={style} />\n        </div>\n      );\n    } else if (IPHONEX_OR_IPHONEXS || IPHONEXR_OR_IPHONEXSMAX) {\n      if (this.props.barStyle === 'light-content') {\n        barColor = '#ffffff';\n      } else if (this.props.barStyle === 'dark-content') {\n        barColor = '#000000';\n      }\n      return (\n        <div style={{ position: 'absolute', top: 0, left: 0 }}>\n          <IPhoneXStatusBar\n            width={deviceWidth}\n            deviceOrientation={deviceOrientation}\n            backgroundColor=\"rgba(255,255,255,0.2)\"\n            color={barColor}\n            style={style}\n          />\n        </div>\n      );\n    } else {\n      if (this.props.barStyle === 'light-content') {\n        barColor = '#ffffff';\n      } else if (this.props.barStyle === 'dark-content') {\n        barColor = '#404040';\n      }\n      return (\n        <div style={{ position: 'absolute', top: 0, left: 0 }}>\n          <AndroidStatusBar\n            width={deviceWidth}\n            height={deviceHeight}\n            backgroundColor={this.props.backgroundColor || '#999999'}\n            color={barColor}\n            style={style}\n          />\n        </div>\n      );\n    }\n  }\n  render() {\n    return this.getElement();\n  }\n}\n","// import { IPlugin } from '../../interfaces/IPlugin';\n// import { Canvas } from '../../models/Canvas';\nimport { IContext, IDimension } from 'interfaces';\nimport DeviceFrameEvent from './events/DeviceFrameEvent';\nimport RemoveChildEvent from 'events/RemoveChildEvent';\nimport ArtboardEvent from 'events/ArtboardEvent';\nimport {\n  Canvas,\n  IPlugin,\n  MouseEvent as DesignerMouseEvent,\n  Layer,\n} from '../..';\nimport * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport StatusBarComponent from './StatusBarComponent';\n\nexport default class StatusBar implements IPlugin {\n  name = 'StatusBar';\n  canvas!: Canvas;\n  labeltext: any;\n  wrapperDiv: any;\n  deviceName: any;\n  deviceOrientation: any;\n  dispose: any;\n  removeDom: any;\n  statusBarMap: Map<any, any> = new Map([]);\n  lastPageX = 0;\n  lastPageY = 0;\n  dragStart: any = {\n    x: 0,\n    y: 0,\n  };\n  dims: IDimension = { x: 0, y: 0, height: 0, width: 0 };\n  ghostImageDOM: any;\n\n  // updateFrameLayout(layer: any) {\n  //   this.render();\n  // }\n\n  selectedArtboardChanged = (event: ArtboardEvent) => {\n    // const selectedArtboard = event.artboard;\n    // if (selectedArtboard) {\n    //   this.statusBarMap.forEach((label: any, artboard: any) => {\n    //     if (artboard === selectedArtboard) {\n    //       let layerTextNode = label.labeltextNode;\n    //       layerTextNode.parentElement.style.color = 'rgb(26, 170, 198)';\n    //     } else {\n    //       label.labeltextNode.parentElement.style.color = 'rgb(186, 189, 198)';\n    //     }\n    //   });\n    // }\n  };\n\n  removeStatusBar(context: IContext): void {\n    const deviceFrame = this.statusBarMap.get(context.layer);\n\n    if (deviceFrame) {\n      deviceFrame.removeCallback();\n    }\n  }\n\n  render = (layer: Layer) => {\n    const deviceFrame = this.statusBarMap.get(layer);\n    if (!deviceFrame) {\n      return;\n    }\n    deviceFrame.frameNode.style.top =\n      layer.getBoundingClientRect().rootY + 'px';\n    deviceFrame.frameNode.style.left =\n      layer.getBoundingClientRect().rootX + 'px';\n\n    // const statusBarConfig = layer.executeFunction('getData', 'statusBarConfig');\n\n    ReactDOM.render(\n      <StatusBarComponent\n        layer={layer}\n        width={layer.getBoundingClientRect().width}\n        height={layer.getBoundingClientRect().height}\n        deviceName={deviceFrame.deviceName}\n        deviceOS={deviceFrame.deviceOS}\n        deviceOrientation={deviceFrame.deviceOrientation}\n        barStyle={deviceFrame.barStyle}\n        backgroundColor={deviceFrame.backgroundColor}\n      />,\n      deviceFrame.frameNode\n    );\n  };\n\n  addStatusBar(context: IContext, config: any): void {\n    let layer = context.layer;\n\n    const deviceFrame = this.statusBarMap.get(layer);\n\n    if (deviceFrame) {\n      deviceFrame.removeCallback();\n    }\n    const wrapperDiv = document.createElement('div');\n    wrapperDiv.className = 'status-bar-wrappers';\n    wrapperDiv.style.position = 'absolute';\n\n    let dispose = this.canvas.addDomToWorld(wrapperDiv, true, 100);\n    wrapperDiv.style.pointerEvents = 'none';\n\n    this.statusBarMap.set(layer, {\n      removeCallback: dispose,\n      frameNode: wrapperDiv,\n      deviceName: config.deviceName,\n      deviceOS: config.deviceOS,\n      deviceOrientation: config.deviceOrientation,\n      barStyle: config.barStyle,\n      backgroundColor: config.backgroundColor,\n    });\n\n    this.render(layer);\n\n    if (layer.parent) {\n      layer.parent.addEventListener(\n        'removeChild',\n        (event: RemoveChildEvent) => {\n          if (layer === event.layer) layer.executeFunction('StatusBar.remove');\n        }\n      );\n    }\n\n    context.layer.on('layout', () => {\n      this.render(context.layer);\n    });\n    context.layer.on('updateDom', () => {\n      this.render(context.layer);\n    });\n  }\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n  activate() {\n    this.canvas.addFunction(`${this.name}.add`, this.addStatusBar.bind(this));\n    this.canvas.addFunction(\n      `${this.name}.remove`,\n      this.removeStatusBar.bind(this)\n    );\n    // this.canvas.addEventListener(\n    //   'artboardSelected',\n    //   this.selectedArtboardChanged\n    // );\n  }\n  deactivate() {}\n}\n","import { Layer, MouseEvent } from '../../..';\nimport { IPosition, IDimensionWithRotation } from 'interfaces';\n\nexport class ResizerRendererDragEvent extends MouseEvent {\n  targetHandle: string;\n  startValues: IDimensionWithRotation;\n  session: {\n    start: IPosition;\n    current: any;\n    end: IPosition;\n  };\n  constructor(\n    name: string,\n    targetHandle: string,\n    startValues: IDimensionWithRotation,\n    session: { start: IPosition; current: IPosition; end: IPosition },\n    originalEvent: any,\n    target: Layer,\n    currentTarget?: Layer\n  ) {\n    super(name, target, originalEvent, currentTarget);\n    this.targetHandle = targetHandle;\n    this.session = session;\n    this.startValues = startValues;\n  }\n}\n","export function getResizerQuad(rotation: number): string {\n  rotation = rotation % 360;\n  if (rotation < 0) {\n    rotation += 360;\n  }\n  if (!rotation) {\n    return '4';\n  }\n  if (\n    (rotation >= 22.5 && rotation < 67.5) ||\n    (rotation >= 202.5 && rotation < 247.5)\n  ) {\n    return '1';\n  }\n\n  if (\n    (rotation >= 67.5 && rotation < 112.5) ||\n    (rotation >= 247.5 && rotation < 292.5)\n  ) {\n    return '2';\n  }\n  if (\n    (rotation >= 112.5 && rotation < 157.5) ||\n    (rotation >= 292.5 && rotation < 337.5)\n  ) {\n    return '3';\n  }\n\n  if (\n    (rotation >= 157.5 && rotation < 202.5) ||\n    (rotation >= 337.5 && rotation < 22.5)\n  ) {\n    return '4';\n  }\n  return '4';\n}\n\nexport function getCursor(handleName: string, rotation: any) {\n  let resizerQuad = getResizerQuad(rotation);\n  let cursor = 'default';\n  if (handleName === 'T' || handleName === 'B') {\n    if (resizerQuad === '1') {\n      cursor = 'nesw-resize';\n    } else if (resizerQuad === '2') {\n      cursor = 'ew-resize';\n    } else if (resizerQuad === '3') {\n      cursor = 'nwse-resize';\n    } else if (resizerQuad === '4') {\n      cursor = 'ns-resize';\n    } else {\n      cursor = 'ns-resize';\n    }\n  } else if (handleName === 'L' || handleName === 'R') {\n    if (resizerQuad === '1') {\n      cursor = 'nwse-resize';\n    } else if (resizerQuad === '2') {\n      cursor = 'ns-resize';\n    } else if (resizerQuad === '3') {\n      cursor = 'nesw-resize';\n    } else if (resizerQuad === '4') {\n      cursor = 'ew-resize';\n    } else {\n      cursor = 'ew-resize';\n    }\n  } else if (handleName === 'TL' || handleName === 'BR') {\n    if (resizerQuad === '1') {\n      cursor = 'ns-resize';\n    } else if (resizerQuad === '2') {\n      cursor = 'nesw-resize';\n    } else if (resizerQuad === '3') {\n      cursor = 'ew-resize';\n    } else if (resizerQuad === '4') {\n      cursor = 'nwse-resize';\n    } else {\n      cursor = 'nwse-resize';\n    }\n  } else if (handleName === 'TR' || handleName === 'BL') {\n    if (resizerQuad === '1') {\n      cursor = 'ew-resize';\n    } else if (resizerQuad === '2') {\n      cursor = 'nwse-resize';\n    } else if (resizerQuad === '3') {\n      cursor = 'ns-resize';\n    } else if (resizerQuad === '4') {\n      cursor = 'nesw-resize';\n    } else {\n      cursor = 'nesw-resize';\n    }\n  }\n  return cursor;\n}\n\nexport function getRotationQuad(rotation: number) {\n  rotation = rotation % 360;\n  if (rotation < 0) {\n    rotation = -rotation;\n  }\n  if (rotation >= 0 && rotation < 45) {\n    return 1;\n  }\n  if (rotation >= 45 && rotation < 90) {\n    return 2;\n  }\n  if (rotation >= 90 && rotation < 135) {\n    return 3;\n  }\n  if (rotation >= 135 && rotation < 180) {\n    return 4;\n  }\n  if (rotation >= 180 && rotation < 225) {\n    return 5;\n  }\n  if (rotation >= 225 && rotation < 270) {\n    return 6;\n  }\n  if (rotation >= 270 && rotation < 315) {\n    return 7;\n  }\n  if (rotation >= 315 && rotation < 360) {\n    return 8;\n  }\n  return 1;\n}\n\nexport function getInitialRotation(handleName: string) {\n  switch (handleName) {\n    case 'TL':\n      return 0;\n    case 'T':\n      return 45;\n    case 'TR':\n      return 90;\n    case 'R':\n      return 135;\n    case 'BR':\n      return 180;\n    case 'B':\n      return 225;\n    case 'BL':\n      return 270;\n    case 'L':\n      return 315;\n    default:\n      return 0;\n  }\n}\n\nexport function getRotationResizerIcon(rotation: any) {\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n  <svg width=\"20px\" height=\"20px\" viewBox=\"0 0 564 581\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n      <defs>\n          <path d=\"M477.685,171.292105 L371.8863,39.25 L263.608591,171.292105 L335.318307,171.23947 C335.404758,201.878069 335.447983,217.197368 335.447983,217.197368 C335.447983,240.945561 331.697189,285.753289 307.961066,309.007895 C286.086784,330.438429 244.930829,340.175619 223.588558,340.175619 L167.014783,340.175619 L166.896133,269.807895 L35.685,375.028947 L166.896133,480.25 L166.896133,410.453368 L223.42583,410.453368 C276.561146,410.453368 325.08715,391.950329 360.415853,357.229972 C395.744556,322.509615 406.110126,270.927723 406.110126,217.334067 C406.110126,217.334067 406.066901,201.986747 405.98045,171.292105 L477.685,171.292105 Z\" id=\"path-1\"></path>\n          <filter x=\"-22.4%\" y=\"-22.4%\" width=\"147.3%\" height=\"147.4%\" filterUnits=\"objectBoundingBox\" id=\"filter-2\">\n              <feMorphology radius=\"14\" operator=\"dilate\" in=\"SourceAlpha\" result=\"shadowSpreadOuter1\"></feMorphology>\n              <feOffset dx=\"2\" dy=\"2\" in=\"shadowSpreadOuter1\" result=\"shadowOffsetOuter1\"></feOffset>\n              <feGaussianBlur stdDeviation=\"25\" in=\"shadowOffsetOuter1\" result=\"shadowBlurOuter1\"></feGaussianBlur>\n              <feComposite in=\"shadowBlurOuter1\" in2=\"SourceAlpha\" operator=\"out\" result=\"shadowBlurOuter1\"></feComposite>\n              <feColorMatrix values=\"0 0 0 0 0.0487149004   0 0 0 0 0.0471071601   0 0 0 0 0.0471071601  0 0 0 1 0\" type=\"matrix\" in=\"shadowBlurOuter1\"></feColorMatrix>\n          </filter>\n      </defs>\n      <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <g id=\"iPhone-8\" transform=\"translate(0.000000, -95.000000)\">\n              <g id=\"curve-arrow\" transform=\"translate(21.000000, 131.000000)\">\n                  <g id=\"Path\" fill-rule=\"nonzero\" transform=\"translate(256.685000, 259.750000) rotate(${180 +\n                    rotation}) translate(-256.685000, -259.750000) \">\n                      <use fill=\"black\" fill-opacity=\"1\" filter=\"url(#filter-2)\" xlink:href=\"#path-1\"></use>\n                      <use stroke=\"#FCF7F7\" stroke-width=\"26\" fill=\"#000000\" xlink:href=\"#path-1\"></use>\n                  </g>\n              </g>\n          </g>\n      </g>\n  </svg>`;\n}\n\nexport function getHorizontalResizerIcon(rotation: any) {\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n  <svg width=\"20px\" height=\"20px\" viewBox=\"0 0 512 512\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n      <defs>\n          <path d=\"M30,256.450973 L156.560656,361 L156.597461,295.437849 C156.852233,295.437849 157.086901,295.480695 157.343864,295.480695 L343.414557,295.480695 C343.671649,295.480695 343.955674,295.444441 344.210833,295.437849 L344.053652,361 L482,256.343185 L344.053652,151 L344.210833,217.464668 C343.955932,217.464668 343.67152,217.421822 343.414557,217.421822 L157.343864,217.421822 C157.086772,217.421822 156.85249,217.458076 156.597461,217.464668 L156.560656,151 L30,256.450973 Z\" id=\"path-1\"></path>\n          <filter x=\"-21.8%\" y=\"-51.0%\" width=\"144.7%\" height=\"203.6%\" filterUnits=\"objectBoundingBox\" id=\"filter-2\">\n              <feMorphology radius=\"14\" operator=\"dilate\" in=\"SourceAlpha\" result=\"shadowSpreadOuter1\"></feMorphology>\n              <feOffset dx=\"2\" dy=\"2\" in=\"shadowSpreadOuter1\" result=\"shadowOffsetOuter1\"></feOffset>\n              <feGaussianBlur stdDeviation=\"25\" in=\"shadowOffsetOuter1\" result=\"shadowBlurOuter1\"></feGaussianBlur>\n              <feComposite in=\"shadowBlurOuter1\" in2=\"SourceAlpha\" operator=\"out\" result=\"shadowBlurOuter1\"></feComposite>\n              <feColorMatrix values=\"0 0 0 0 0.0448086504   0 0 0 0 0.0442135355   0 0 0 0 0.0442135355  0 0 0 1 0\" type=\"matrix\" in=\"shadowBlurOuter1\"></feColorMatrix>\n          </filter>\n      </defs>\n      <g id=\"Page-1\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\n          <g id=\"iPhone-8-Copy\">\n              <g id=\"rect3044-174-4-7-5-8-7-1-1-3-2\">\n                  <g id=\"rect3044-174-4-7-5-8-7-1-1-3\" fill-rule=\"nonzero\" transform=\"translate(256.000000, 256.000000) rotate(${45 +\n                    rotation}) translate(-256.000000, -256.000000) \">\n                      <use fill=\"black\" fill-opacity=\"1\" filter=\"url(#filter-2)\" xlink:href=\"#path-1\"></use>\n                      <use stroke=\"#FCF9F9\" stroke-width=\"26\" fill=\"#000000\" xlink:href=\"#path-1\"></use>\n                  </g>\n              </g>\n          </g>\n      </g>\n  </svg>`;\n}\n","import { forEach } from 'lodash';\nimport { ResizerRendererDragEvent } from './ResizerRendererDragEvent';\nimport { Canvas, IPlugin, MouseEvent as DesignerMouseEvent } from '../../';\nimport { IContext, IDimensionWithRotation } from '../../interfaces';\nimport ResetResizerEvent from 'events/ResetResizerEvent';\nimport {\n  getInitialRotation,\n  getHorizontalResizerIcon,\n  getRotationResizerIcon,\n} from './utils';\nexport default class ResizerRendererPlugin implements IPlugin {\n  name = 'ResizerRenderer';\n  namespace = 'ResizerRenderer';\n  canvas!: Canvas;\n  dispose: any;\n  allowClickEvents: boolean = false;\n  wrapperLayer: any;\n  resizerHandleLayersRef!: Map<string, any>;\n  resizerData!: { dims: IDimensionWithRotation; handles: Array<string> };\n  passedEvent = [\n    'mousedown',\n    'mouseup',\n    'mousemove',\n    'dblclick',\n    'contextmenu',\n    'click',\n    'drop',\n  ];\n  show: boolean = true;\n  mouseDown: boolean = false;\n  dragStarted: boolean = false;\n  handleDragStarted: boolean = false;\n  cursor: any;\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n    this.resizerData = {\n      dims: { x: 0, y: 0, height: 0, width: 0, rotation: 0 },\n      handles: [],\n    };\n    this.resizerHandleLayersRef = new Map<string, any>();\n  }\n\n  setHandleStyle(handleInstance: any, handleName: string) {\n    let zoom = this.canvas.getZoom();\n    const rotationHandleSize = 20;\n    const handleSize = 10;\n    if (handleName === 'ROTATE') {\n      return;\n    }\n    let propsWithoutPx: any = {\n      position: 'absolute',\n      display: '',\n      'background-color': 'rgba(255, 255, 255, 1)',\n      border: `${1 / zoom}px solid #1FB2CC`,\n      'pointer-events': 'auto',\n      'z-index': '1',\n    };\n    let fixedLayoutProps: any = {\n      height: handleSize / zoom,\n      width: handleSize / zoom,\n      'margin-left': -1 / zoom - handleSize / (2 * zoom),\n      'margin-top': -1 / zoom - handleSize / (2 * zoom),\n      'margin-right': -1 / zoom - handleSize / (2 * zoom),\n      'margin-bottom': -1 / zoom - handleSize / (2 * zoom),\n      'border-radius': 20 / zoom,\n    };\n    let pos: any = {};\n    let rotatorPos = {};\n    let dims: any = this.resizerData.dims;\n    switch (handleName) {\n      case 'T':\n        // pos = {\n        //   left: handleSize + 2,\n        //   top: 0,\n        //   width: dims.width - handleSize - 2,\n        // };\n        pos = { left: dims.width / 2, top: 0 };\n        rotatorPos = {\n          left: dims.width / 2 - rotationHandleSize / (2 * zoom),\n          top: -rotationHandleSize / zoom,\n        };\n        break;\n      case 'L':\n        // pos = {\n        //   left: 0,\n        //   top: handleSize + 2,\n        //   height: dims.height - handleSize - 2,\n        // };\n        pos = { left: 0, top: dims.height / 2 };\n        rotatorPos = {\n          left: -rotationHandleSize / zoom,\n          top: dims.height / 2 - rotationHandleSize / (2 * zoom),\n        };\n        break;\n      case 'R':\n        // pos = {\n        //   left: dims.width,\n        //   top: handleSize + 2,\n        //   height: dims.height - handleSize - 2,\n        // };\n        pos = { left: dims.width, top: dims.height / 2 };\n        rotatorPos = {\n          left: dims.width,\n          top: dims.height / 2 - rotationHandleSize / (2 * zoom),\n        };\n        break;\n      case 'B':\n        // pos = {\n        //   left: handleSize + 2,\n        //   top: dims.height,\n        //   width: dims.width - handleSize - 2,\n        // };\n        pos = { left: dims.width / 2, top: dims.height };\n        rotatorPos = {\n          left: dims.width / 2 - rotationHandleSize / (2 * zoom),\n          top: dims.height,\n        };\n        break;\n      case 'TR':\n        rotatorPos = {\n          left: dims.width,\n          top: -rotationHandleSize / zoom,\n        };\n        pos = { left: dims.width, top: 0 };\n        break;\n      case 'BL':\n        rotatorPos = {\n          left: -rotationHandleSize / zoom,\n          top: dims.height,\n        };\n        pos = { left: 0, top: dims.height };\n        break;\n      case 'BR':\n        rotatorPos = {\n          left: dims.width,\n          top: dims.height,\n        };\n        pos = { left: dims.width, top: dims.height };\n        break;\n      default:\n        rotatorPos = {\n          left: -rotationHandleSize / zoom,\n          top: -rotationHandleSize / zoom,\n        };\n        pos = { left: 0, top: 0 };\n        break;\n    }\n    forEach(propsWithoutPx, (val: string, key: string) => {\n      handleInstance.handleLayer.style[key] = val;\n    });\n    forEach({ ...fixedLayoutProps, ...pos }, (val: string, key: string) => {\n      handleInstance.handleLayer.style[key] = val.toString() + 'px';\n    });\n    if (handleName !== 'ROTATE') {\n      let rotatorPropsWithoutPx = {\n        position: 'absolute',\n        display: '',\n        'pointer-events': 'auto',\n      };\n      fixedLayoutProps = {\n        height: rotationHandleSize / zoom,\n        width: rotationHandleSize / zoom,\n      };\n      pos = rotatorPos;\n      forEach(rotatorPropsWithoutPx, (val: string, key: string) => {\n        handleInstance.handleRotator.style[key] = val;\n      });\n      forEach({ ...fixedLayoutProps, ...pos }, (val: string, key: string) => {\n        handleInstance.handleRotator.style[key] = val.toString() + 'px';\n      });\n    }\n  }\n  addEventListeners(\n    handleLayer: any,\n    handleName: string,\n    rotationType?: string\n  ) {\n    let dragData: any;\n    if (rotationType) {\n      this.resizerData.dims = {\n        ...this.resizerData.dims,\n        rotation:\n          this.resizerData.dims.rotation + getInitialRotation(rotationType),\n      };\n    }\n    this.canvas.executeFunction('handleHtmlDrag', handleLayer);\n    handleLayer.addEventListener('htmlDragStart', (e: any) => {\n      if (\n        (rotationType && !this.resizerData.handles.includes('ROTATE')) ||\n        this.canvas.moveWithGrabHandle\n      ) {\n        return;\n      }\n      this.canvas.blockMouseEvents();\n      let dragVal = this.canvas.executeFunction(\n        'HtmlDragToWorld.dragStart',\n        e,\n        this.resizerData.dims\n      );\n      this.handleDragStarted = true;\n      if (rotationType) {\n        this.canvas.setMouseCursor(\n          `url(\"data:image/svg+xml,${escape(\n            getRotationResizerIcon(\n              getInitialRotation(rotationType) + this.resizerData.dims.rotation\n            )\n          )}\") 10 10, auto`\n        );\n      }\n      dragData = dragVal;\n      this.canvas.dispatchEvent(\n        `${this.namespace}.handleDragStart`,\n        new ResizerRendererDragEvent(\n          `${this.namespace}.handleDragStart`,\n          handleName + (rotationType ? rotationType : ''),\n          dragVal.startValues,\n          dragVal.session,\n          dragVal.event,\n          this.canvas\n        )\n      );\n    });\n    handleLayer.addEventListener('htmlDrag', (e: any) => {\n      if (\n        (rotationType && !this.resizerData.handles.includes('ROTATE')) ||\n        this.canvas.moveWithGrabHandle\n      ) {\n        return;\n      }\n      if (e.pageX && e.pageY) {\n        let dragVal = this.canvas.executeFunction('HtmlDragToWorld.drag', e);\n        if (\n          dragVal.session.current.deltaX !== 0 ||\n          dragVal.session.current.deltaY !== 0\n        ) {\n          dragData = dragVal;\n          if (rotationType) {\n            this.canvas.setMouseCursor(\n              `url(\"data:image/svg+xml,${escape(\n                getRotationResizerIcon(\n                  getInitialRotation(rotationType) +\n                    this.resizerData.dims.rotation\n                )\n              )}\") 10 10, auto`\n            );\n          }\n          this.canvas.dispatchEvent(\n            `${this.namespace}.handleDrag`,\n            new ResizerRendererDragEvent(\n              `${this.namespace}.handleDrag`,\n              handleName + (rotationType ? rotationType : ''),\n              dragVal.startValues,\n              dragVal.session,\n              dragVal.event,\n              this.canvas\n            )\n          );\n        }\n      }\n    });\n    handleLayer.addEventListener('htmlDragEnd', (e: any) => {\n      e.preventDefault();\n      this.canvas.setMouseCursor('default');\n      this.canvas.unblockMouseEvents();\n      if (\n        (rotationType && !this.resizerData.handles.includes('ROTATE')) ||\n        this.canvas.moveWithGrabHandle\n      ) {\n        return;\n      }\n      this.handleDragStarted = false;\n      this.canvas.dispatchEvent(\n        `${this.namespace}.handleDragEnd`,\n        new ResizerRendererDragEvent(\n          `${this.namespace}.handleDragEnd`,\n          handleName + (rotationType ? rotationType : ''),\n          dragData.startValues,\n          dragData.session,\n          dragData.event,\n          this.canvas\n        )\n      );\n    });\n  }\n  renderCursor(handleInstance: any, handleName: string) {\n    handleInstance.handleLayer.addEventListener('mousemove', (event: any) => {\n      if (!this.handleDragStarted && !this.canvas.mouseEventsBlocked) {\n        this.canvas.setMouseCursor(\n          `url(\"data:image/svg+xml,${escape(\n            getHorizontalResizerIcon(\n              getInitialRotation(handleName) + this.resizerData.dims.rotation\n            )\n          )}\") 10 10, auto`\n        );\n      }\n    });\n    handleInstance.handleLayer.addEventListener('mouseenter', (event: any) => {\n      if (!this.handleDragStarted && !this.canvas.mouseEventsBlocked) {\n        this.canvas.setMouseCursor(\n          `url(\"data:image/svg+xml,${escape(\n            getHorizontalResizerIcon(\n              getInitialRotation(handleName) + this.resizerData.dims.rotation\n            )\n          )}\") 10 10, auto`\n        );\n      }\n    });\n    handleInstance.handleLayer.addEventListener('mouseleave', () => {\n      if (\n        !this.handleDragStarted &&\n        !this.canvas.mouseEventsBlocked &&\n        this.canvas.mouseCursorType &&\n        this.canvas.mouseCursorType.includes('url')\n      ) {\n        this.canvas.setMouseCursor('default');\n      }\n    });\n    handleInstance.handleLayer.addEventListener('contextmenu', (e: any) => {\n      e.preventDefault();\n    });\n    handleInstance.handleRotator.addEventListener('contextmenu', (e: any) => {\n      e.preventDefault();\n    });\n    handleInstance.handleRotator.addEventListener(\n      'mouseenter',\n      (event: any) => {\n        if (\n          this.resizerData.handles.includes('ROTATE') &&\n          !this.handleDragStarted &&\n          !this.canvas.mouseEventsBlocked\n        ) {\n          this.canvas.setMouseCursor(\n            `url(\"data:image/svg+xml,${escape(\n              getRotationResizerIcon(\n                getInitialRotation(handleName) + this.resizerData.dims.rotation\n              )\n            )}\") 10 10, auto`\n          );\n        }\n      }\n    );\n    handleInstance.handleRotator.addEventListener('mouseleave', () => {\n      if (\n        !this.handleDragStarted &&\n        this.canvas.mouseCursorType &&\n        this.canvas.mouseCursorType.includes('url') &&\n        !this.canvas.mouseEventsBlocked\n      ) {\n        this.canvas.setMouseCursor('default');\n      }\n    });\n  }\n  renderHandles() {\n    let handles = this.resizerData.handles;\n    return handles.map((handleName: any, i: number) => {\n      let handle = this.resizerHandleLayersRef.get(handleName);\n      if (!handle) {\n        const handleLayer = document.createElement('div');\n        const handleRotator = document.createElement('div');\n        this.wrapperLayer.appendChild(handleLayer);\n        this.wrapperLayer.appendChild(handleRotator);\n        this.resizerHandleLayersRef.set(handleName, {\n          handleLayer,\n          handleRotator,\n        });\n        handle = { handleLayer, handleRotator };\n        this.addEventListeners(handle.handleLayer, handleName);\n        this.addEventListeners(handle.handleRotator, 'ROTATE', handleName);\n        this.renderCursor(handle, handleName);\n      }\n      this.setHandleStyle(handle, handleName);\n    });\n  }\n  isVisible() {\n    return (\n      this.show &&\n      this.resizerData.dims.x &&\n      this.resizerData.dims.y &&\n      this.resizerData.dims.width &&\n      this.resizerData.dims.height\n    );\n  }\n  renderResizer() {\n    if (this.isVisible()) {\n      let zoom = this.canvas.getZoom();\n      this.wrapperLayer.style.border = `${1 / zoom}px solid #1FB2CC`;\n      this.wrapperLayer.style.top = this.resizerData.dims.y + 'px';\n      this.wrapperLayer.style.left = this.resizerData.dims.x + 'px';\n      this.wrapperLayer.style.height = this.resizerData.dims.height + 'px';\n      this.wrapperLayer.style.width = this.resizerData.dims.width + 'px';\n      if (this.resizerData.dims.rotation) {\n        this.wrapperLayer.style.transform = `rotate(${this.resizerData.dims.rotation}deg`;\n      } else {\n        this.wrapperLayer.style.transform = ``;\n      }\n      this.wrapperLayer.style.display = '';\n      this.renderHandles();\n    } else {\n      this.wrapperLayer.style.display = 'none';\n    }\n  }\n  toggleResizer(show: boolean) {\n    this.show = show;\n    this.renderResizer();\n  }\n  showHandle(context: IContext, name: string) {\n    if (!this.resizerData.handles.includes(name.toUpperCase())) {\n      this.resizerData.handles.push(name.toUpperCase());\n      this.renderHandles();\n    }\n  }\n  hideHandle(context: IContext, name: string) {\n    if (this.resizerData.handles.includes(name.toUpperCase())) {\n      this.resizerData.handles.splice(\n        this.resizerData.handles.indexOf(name.toUpperCase()),\n        1\n      );\n      let handle = this.resizerHandleLayersRef.get(name);\n      if (handle) {\n        const { handleLayer, handleRotator } = handle;\n        handleLayer.style.display = 'none';\n        handleRotator.style.display = 'none';\n      }\n    }\n  }\n  isValidKey(key: string) {\n    return (\n      key === 'x' ||\n      key === 'y' ||\n      key === 'height' ||\n      key === 'width' ||\n      key === 'rotation'\n    );\n  }\n  setResizerOrientation(\n    context: any,\n    key: 'x' | 'y' | 'height' | 'width' | 'rotation' | object,\n    value?: any\n  ) {\n    if (typeof key == 'object') {\n      for (var prop in key) {\n        if (this.isValidKey(prop)) {\n          // @ts-ignore\n          this.resizerData.dims[prop] = (key as any)[prop];\n        } else {\n          throw new Error(`Resizer Orientation Error: Invalid key '${prop}'`);\n        }\n      }\n    } else {\n      if (this.isValidKey(key)) {\n        this.resizerData.dims[key] = value;\n      } else {\n        throw new Error(`Resizer Orientation Error: Invalid key '${key}'`);\n      }\n    }\n    this.renderResizer();\n  }\n\n  passEvent = (e: MouseEvent) => {\n    // FIXME: If we include this, drag events get fired and mouse rect starts showing but we need this in case sibling overlaps and the bottom one is already selected and we are trying to drag the top one.\n    if (e.type !== 'mousedown') {\n      if (e.type === 'mousemove') {\n        if (this.mouseDown) {\n          this.dragStarted = true;\n        }\n      }\n\n      if (this.dragStarted && this.mouseDown) {\n      } else {\n        this.canvas.dispatchEventOnHitLayer(\n          e.type,\n          new DesignerMouseEvent(e.type, this.canvas, e, this.canvas),\n          e\n        );\n      }\n\n      if (e.type === 'mouseup') {\n        this.dragStarted = false;\n        this.mouseDown = false;\n\n        this.canvas.dispatchEventOnHitLayer(\n          e.type,\n          new DesignerMouseEvent(e.type, this.canvas, e, this.canvas),\n          e\n        );\n      }\n    } else {\n      if (e.button !== 2 && e.which !== 3) {\n        this.mouseDown = true;\n      }\n    }\n  };\n  handleLayerListeners(handle: any) {\n    this.passedEvent.map(event => {\n      handle.addEventListener(event, (e1: any) => {\n        this.passEvent(e1);\n      });\n    });\n  }\n  hideAllHandles(context: IContext) {\n    this.resizerData.handles.forEach((handleName: string) => {\n      let handle = this.resizerHandleLayersRef.get(handleName);\n      if (handle) {\n        const { handleLayer, handleRotator } = handle;\n        handleLayer.style.display = 'none';\n        handleRotator.style.display = 'none';\n      }\n    });\n    this.resizerData.handles = [];\n  }\n  activate() {\n    this.canvas.addFunction(\n      `${this.namespace}.show`,\n      this.toggleResizer.bind(this, true)\n    );\n    this.canvas.addFunction(\n      `${this.namespace}.hide`,\n      this.toggleResizer.bind(this, false)\n    );\n    this.canvas.addFunction(\n      `${this.namespace}.showHandle`,\n      this.showHandle.bind(this)\n    );\n    this.canvas.addFunction(\n      `${this.namespace}.hideHandle`,\n      this.hideHandle.bind(this)\n    );\n    this.canvas.addFunction(\n      `${this.namespace}.setOrientation`,\n      this.setResizerOrientation.bind(this)\n    );\n    this.canvas.addFunction(\n      `${this.namespace}.hideAllHandles`,\n      this.hideAllHandles.bind(this)\n    );\n    this.canvas.addEventListener('resetResizer', (e: ResetResizerEvent) => {\n      this.canvas.executeFunction('HtmlDragToWorld.dragEnd', e.originalEvent);\n      this.canvas.executeFunction(\n        'HtmlDragToWorld.dragStart',\n        e.originalEvent,\n        this.resizerData.dims\n      );\n    });\n\n    this.wrapperLayer = document.createElement('div');\n    this.wrapperLayer.style.pointerEvents = 'none';\n    this.wrapperLayer.style.position = 'absolute';\n    this.wrapperLayer.style.zIndex = 200;\n    this.renderDragLayer();\n    this.dispose = this.canvas.addDomToWorld(this.wrapperLayer, true, 101);\n    this.renderResizer();\n    ['zoom', 'scroll'].map((event: string) => {\n      this.canvas.on(event, (e: any) => {\n        this.renderResizer();\n      });\n    });\n  }\n\n  renderDragLayer = () => {\n    let dragLayer = document.createElement('div');\n    dragLayer.style.pointerEvents = 'auto';\n    dragLayer.style.position = 'absolute';\n    dragLayer.style.top = '0';\n    dragLayer.style.left = '0';\n    dragLayer.style.right = '0';\n    dragLayer.style.bottom = '0';\n    dragLayer.setAttribute('class', 'resizer move ' + dragLayer.className);\n    this.wrapperLayer.appendChild(dragLayer);\n    this.handleLayerListeners(dragLayer);\n    this.canvas.executeFunction('handleHtmlDrag', dragLayer);\n    dragLayer.addEventListener('htmlDragStart', e => {\n      let dragVal = this.canvas.executeFunction(\n        'HtmlDragToWorld.dragStart',\n        e,\n        this.resizerData.dims\n      );\n      this.canvas.blockMouseEvents();\n      this.canvas.dispatchEvent(\n        `${this.namespace}.dragStart`,\n        new ResizerRendererDragEvent(\n          `${this.namespace}.handleDragStart`,\n          'C',\n          dragVal.startValues,\n          dragVal.session,\n          dragVal.event,\n          this.canvas\n        )\n      );\n      return false;\n    });\n\n    dragLayer.addEventListener('htmlDrag', (e: any) => {\n      if (e.pageX && e.pageY) {\n        let dragVal = this.canvas.executeFunction('HtmlDragToWorld.drag', e);\n        if (\n          dragVal.session.current.deltaX !== 0 ||\n          dragVal.session.current.deltaY !== 0\n        ) {\n          this.canvas.dispatchEvent(\n            `${this.namespace}.drag`,\n            new ResizerRendererDragEvent(\n              `${this.namespace}.drag`,\n              'C',\n              dragVal.startValues,\n              dragVal.session,\n              dragVal.event,\n              this.canvas\n            )\n          );\n        }\n      }\n    });\n    dragLayer.addEventListener('htmlDragEnd', (e: any) => {\n      let dragVal = this.canvas.executeFunction('HtmlDragToWorld.drag', e);\n      this.canvas.unblockMouseEvents();\n      this.canvas.dispatchEvent(\n        `${this.namespace}.dragEnd`,\n        new ResizerRendererDragEvent(\n          `${this.namespace}.dragEnd`,\n          'C',\n          dragVal.startValues,\n          dragVal.session,\n          dragVal.event,\n          this.canvas\n        )\n      );\n    });\n  };\n  deactivate() {\n    this.canvas.removeFunction(`${this.namespace}.show`);\n    this.canvas.removeFunction(`${this.namespace}.hide`);\n    this.canvas.removeFunction(`${this.namespace}.showHandle`);\n    this.canvas.removeFunction(`${this.namespace}.hideHandle`);\n    this.canvas.removeFunction(`${this.namespace}.setOrientation`);\n    this.canvas.removeFunction(`${this.namespace}.hideAllHandles`);\n    this.dispose();\n  }\n}\n","import { Canvas, IPlugin } from '../..';\n\nexport default class UndoRedoPlugin implements IPlugin {\n  name = 'UndoRedoPlugin';\n  canvas!: Canvas;\n\n  store: Array<any> = [];\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    // //@ts-ignore\n    // window['undoRedoStore'] = this.store;\n  }\n\n  activate() {\n    this.canvas.addMiddleware('Layer.setStyle', (next: any, data: any) => {\n      next(data);\n\n      this.store.push({\n        type: 'Layer.setStyle',\n        payload: data,\n      });\n    });\n  }\n\n  deactivate() {}\n}\n","import { Event, Layer } from '../../..';\nimport { IDimensionWithRotation } from 'interfaces';\n\nexport class LayerResizerEvent extends Event {\n  payload: any;\n  meta?: any;\n  originalEvent: any;\n  snapPoints?: any;\n  constructor(\n    name: string,\n    target: Layer,\n    payload: any,\n    originalEvent: any,\n    currentTarget?: Layer,\n    meta?: any,\n    snapPoints?: any\n  ) {\n    super(name, target, currentTarget);\n    this.payload = payload;\n    this.meta = meta;\n    this.originalEvent = originalEvent;\n    this.snapPoints = snapPoints;\n  }\n}\n","import { Canvas, Layer } from '../../';\nimport { isEmpty, intersection, isNil, forEach, round } from 'lodash';\nimport { ResizerRendererDragEvent } from '../ResizerRenderer/ResizerRendererDragEvent';\nimport ModelUtils, {\n  computeOrientation,\n  calculateRotation,\n  computeOrientationMultiple,\n} from './../../models/utils';\nimport { IDimensionWithRotation, IPlugin, IPosition } from 'interfaces';\nimport { LayerResizerEvent } from './LayerResizerEvent';\nimport ResetResizerEvent from '../../events/ResetResizerEvent';\n\nexport default class LayerResizerPlugin implements IPlugin {\n  name = 'LayerResizerPlugin';\n  namespace = 'LayerResizer';\n  forbiddenLayers: Array<Layer> = [];\n  canvas!: Canvas;\n  dispose: any;\n  draggingHandles: boolean = false;\n  targetLayer: Layer | undefined;\n  selectedLayers: Array<Layer> = [];\n  boundingBox: any;\n  boundingBoxWRTWorld: any;\n  selectedLayerDims: Map<Layer, any> = new Map<Layer, any>();\n  startValues: any;\n  updatedStartValues: any;\n  snapPoints: any;\n  boundQueueUpdates: Map<Layer, any> = new Map();\n  rerenderHandles: boolean = true;\n\n  isAltPressed: boolean = false;\n  isShiftPressed: boolean = false;\n  layoutElementArray: Array<any> = [];\n  shiftDirection: string = '';\n\n  startX = 0;\n  startY = 0;\n  startAbsoluteX = 0;\n  startAbsoluteY = 0;\n\n  totalDx = 0;\n  totalDy = 0;\n\n  dragEventData: any;\n\n  getHandlesForFill = (layer: Layer) => {\n    let handlesForFill: Array<string> = [];\n    const isFillWidth = layer.isFillWidth();\n    const isFillHeight = layer.isFillHeight();\n    let flexSiblings: Array<Layer> = [];\n    if (layer.type !== 'root') {\n      flexSiblings = layer.getSiblingsWithFlex();\n    }\n    if (flexSiblings.length === 0) {\n      handlesForFill = this.getHandlesForFlexLayer(isFillHeight, isFillWidth);\n    } else if (layer.parent) {\n      const layerParent = layer.parent as Layer;\n\n      const parentFlexDirection = layerParent.layout.get('flexDirection');\n      handlesForFill = this.getHandlesForFlexLayerWithSiblings(\n        layer,\n        parentFlexDirection,\n        isFillHeight,\n        isFillWidth\n      );\n    }\n    return handlesForFill;\n  };\n  getHandlesForAutoOrAbsoluteLayer = (\n    isAutoHeight: boolean,\n    isAutoWidth: boolean\n  ) => {\n    if (isAutoHeight && isAutoWidth) {\n      return ['ROTATE'];\n    } else if (isAutoHeight) {\n      return ['ROTATE', 'L', 'R'];\n    } else if (isAutoWidth) {\n      return ['ROTATE', 'T', 'B'];\n    } else {\n      return ['ROTATE', 'T', 'B', 'R', 'L', 'BL', 'BR', 'TR', 'TL'];\n    }\n  };\n  getHandlesForFlexLayer = (isFillHeight: boolean, isFillWidth: boolean) => {\n    if (isFillHeight && isFillWidth) {\n      return [];\n    } else if (isFillHeight) {\n      return ['L', 'R'];\n    } else if (isFillWidth) {\n      return ['T', 'B'];\n    } else {\n      return ['T', 'B', 'R', 'L', 'BL', 'BR', 'TR', 'TL', 'ROTATE'];\n    }\n  };\n  getHandlesForFlexLayerWithSiblings = (\n    layer: Layer,\n    parentFlexDirection: string,\n    isFillHeight: boolean,\n    isFillWidth: boolean\n  ) => {\n    if (parentFlexDirection === 'row') {\n      if (isFillHeight) {\n        // if fill Width and fill Height or only fill Height\n        return this.getResizerHandlesLayout(layer, parentFlexDirection);\n      } else if (isFillWidth) {\n        let resizer = this.getResizerHandlesLayout(layer, parentFlexDirection);\n        return resizer.concat(['T', 'B']);\n      } else {\n        return ['T', 'B', 'R', 'L', 'BL', 'BR', 'TR', 'TL', 'ROTATE'];\n      }\n    } else {\n      // column\n      if (isFillWidth) {\n        // if fill Width and fill Height or only fill Height\n        return this.getResizerHandlesLayout(layer, parentFlexDirection);\n      } else if (isFillHeight) {\n        let resizer = this.getResizerHandlesLayout(layer, parentFlexDirection);\n        return resizer.concat(['L', 'R']);\n      } else {\n        return ['T', 'B', 'R', 'L', 'BL', 'BR', 'TR', 'TL', 'ROTATE'];\n      }\n    }\n  };\n  getResizerHandlesLayout = (layer: Layer, parentFlexDirection: string) => {\n    let parentLayer = layer.parent as Layer;\n    let handles: any = [];\n    const childrenLength = parentLayer.children.length;\n    parentLayer.children.forEach((childLayer: Layer, index: number) => {\n      if (childLayer === layer) {\n        // first\n        if (index === 0) {\n          if (parentFlexDirection === 'row') {\n            handles.push('R');\n          } else {\n            handles.push('B');\n          }\n        } else if (index === childrenLength - 1) {\n          // last\n          if (parentFlexDirection === 'row') {\n            handles.push('L');\n          } else {\n            handles.push('T');\n          }\n        } else {\n          // middle\n          if (parentFlexDirection === 'row') {\n            handles.push('R');\n            handles.push('L');\n          } else {\n            handles.push('B');\n            handles.push('T');\n          }\n        }\n      }\n    });\n    return handles;\n  };\n  // getResizerHandlesForLayers = (layers: any) => {\n  //   // add all handles except ROTATE handle when icon is selected\n\n  //   let handles: any = ['T', 'B', 'R', 'L', 'BL', 'BR', 'TR', 'TL', 'ROTATE'];\n  //   if (layers.length === 0) {\n  //     return [];\n  //   }\n  //   layers.forEach((layer: Layer) => {\n  //     if (layer.type === 'icon' || layer.type === 'switch') {\n  //       handles = intersection(handles, ['ROTATE']);\n  //     }\n  //     const isLayerAbsolute = !isNil(layer.layout.get('position'));\n  //     const isAutoHeight = layer.isAutoHeight();\n  //     const isAutoWidth = layer.isAutoWidth();\n  //     let handlesForAutoOrAbs = this.getHandlesForAutoOrAbsoluteLayer(\n  //       isAutoHeight,\n  //       isAutoWidth\n  //     );\n\n  //     if (isLayerAbsolute) {\n  //       handles = intersection(handles, handlesForAutoOrAbs);\n  //     } else {\n  //       const handlesForFill = this.getHandlesForFill(layer);\n  //       let handlesHere = intersection(handlesForAutoOrAbs, handlesForFill);\n  //       handles = intersection(handles, handlesHere);\n  //     }\n  //   });\n\n  //   return handles;\n  // };\n\n  getHandles = (layers: Array<Layer>) => {\n    return this.canvas.executeMiddleware(\n      'LayerResizer.getHandles',\n      layers,\n      (layers: Array<Layer>) => {\n        let handles = ['T', 'B', 'R', 'L', 'BL', 'BR', 'TR', 'TL', 'ROTATE'];\n        if (\n          layers.length === 0 ||\n          (layers.length === 1 && layers[0].type === 'canvas')\n        ) {\n          return [];\n        }\n\n        layers.forEach((layer: Layer) => {\n          const isLayerAbsolute = !isNil(layer.layout.get('position'));\n          const isAutoHeight = layer.isAutoHeight();\n          const isAutoWidth = layer.isAutoWidth();\n          if (\n            layer.type === 'icon' ||\n            layer.type === 'switch' ||\n            layer.type === 'activityIndicator' ||\n            (isAutoHeight && isAutoWidth)\n          ) {\n            handles = intersection(handles, ['ROTATE']);\n          }\n          let handlesForAutoOrAbs = this.getHandlesForAutoOrAbsoluteLayer(\n            isAutoHeight,\n            isAutoWidth\n          );\n\n          if (isLayerAbsolute) {\n            handles = intersection(handles, handlesForAutoOrAbs);\n          } else {\n            const handlesForFill = this.getHandlesForFill(layer);\n            let handlesHere = intersection(handlesForAutoOrAbs, handlesForFill);\n            handles = intersection(handles, handlesHere);\n          }\n        });\n\n        return handles;\n      }\n    );\n  };\n  layersQueuedForUpdate: any = [];\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n    this.selectedLayers = [];\n  }\n  hideLayerResizer(context: any) {\n    if (!this.forbiddenLayers.includes(context.layer)) {\n      this.forbiddenLayers.push(context.layer);\n      this.setSelectedLayers();\n      this.rerender();\n    }\n  }\n  showLayerResizer(context: any) {\n    if (this.forbiddenLayers.includes(context.layer)) {\n      this.forbiddenLayers.splice(\n        this.forbiddenLayers.indexOf(context.layer),\n        1\n      );\n      this.setSelectedLayers();\n      this.rerender();\n    }\n  }\n  rerender() {\n    let dims = this.canvas.getBoundingBox(this.selectedLayers);\n    if (this.rerenderHandles) {\n      this.canvas.executeFunction('ResizerRenderer.hideAllHandles');\n      this.getHandles(this.canvas.selectedLayers).map((handle: string) => {\n        this.canvas.executeFunction('ResizerRenderer.showHandle', handle);\n      });\n    }\n    this.canvas.executeFunction('ResizerRenderer.setOrientation', dims);\n  }\n  onUpdate = () => {\n    this.rerender();\n  };\n\n  queueUpdate = (layer: Layer) => {\n    this.layersQueuedForUpdate.push(layer);\n\n    // render when all the layers have finised emiiting layout updates\n    if (this.layersQueuedForUpdate.length === this.selectedLayers.length) {\n      this.rerender();\n      this.layersQueuedForUpdate = [];\n    }\n  };\n  setSelectedLayers() {\n    this.layersQueuedForUpdate = [];\n    this.boundQueueUpdates.forEach((cb: any, layer: Layer) => {\n      layer.off('yoga', cb);\n    });\n    this.boundQueueUpdates.clear();\n    this.selectedLayers = this.canvas.selectedLayers.filter(\n      (layer: Layer) => !this.forbiddenLayers.includes(layer)\n    );\n\n    this.selectedLayers.forEach((layer: Layer) => {\n      const cb = this.queueUpdate.bind(this, layer);\n      layer.on('yoga', cb);\n      this.boundQueueUpdates.set(layer, cb);\n    });\n  }\n  getParentRelativeDims(dims: IDimensionWithRotation, layer: Layer) {\n    let parentDims = layer.parent\n      ? layer.parent.getBoundingClientRect()\n      : { rootX: 0, rootY: 0 };\n    return {\n      ...dims,\n      x: dims.x - parentDims.rootX,\n      y: dims.y - parentDims.rootY,\n    };\n  }\n  applyDimensions(eventType: string) {\n    const data: ResizerRendererDragEvent = this.dragEventData;\n    const deltaX = data.session.current.x - data.session.start.x;\n    const deltaY = data.session.current.y - data.session.start.y;\n\n    if (!this.isShiftPressed) {\n      this.shiftDirection = '';\n    }\n    if (data.targetHandle.indexOf('C') > -1 && this.isShiftPressed) {\n      if (!this.shiftDirection) {\n        if (\n          Math.abs(data.session.current.deltaX) >\n          Math.abs(data.session.current.deltaY)\n        ) {\n          this.shiftDirection = 'horizontal';\n        } else {\n          this.shiftDirection = 'vertical';\n        }\n      }\n\n      if (this.shiftDirection === 'horizontal') {\n        this.totalDx = deltaX;\n        // this.totalDy = 0;\n      } else {\n        this.totalDy = deltaY;\n        // this.totalDx = 0;\n      }\n      // if (this.shiftDirection === \"horizontal\") {}\n    } else {\n      this.totalDy = deltaY;\n      this.totalDx = deltaX;\n    }\n\n    // console.log(this.totalDx, this.totalDy, 'drag data here');\n\n    if (\n      !this.selectedLayers.length ||\n      (this.selectedLayers.length && !this.selectedLayers[0].parent)\n    ) {\n      return;\n    }\n    const parentAbsoluteRotation =\n      this.selectedLayers.length && this.selectedLayers[0].parent\n        ? this.selectedLayers[0].parent.getAbsoluteRotation()\n        : 0;\n    let rotateDelta = ModelUtils.rotatePoint(\n      [this.totalDx, this.totalDy],\n      360 - parentAbsoluteRotation,\n      [0, 0]\n    );\n\n    const snappedData = this.canvas.executeFunction(\n      'snapToPoints',\n      this.snapPoints,\n      [this.startX, this.startY],\n      [rotateDelta[0], rotateDelta[1]],\n      {\n        ...this.boundingBox,\n      },\n      [this.totalDx, this.totalDy],\n      [this.startAbsoluteX, this.startAbsoluteY],\n      parentAbsoluteRotation,\n      this.boundingBoxWRTWorld\n    );\n    this.boundingBox = {\n      ...this.boundingBox,\n      x: this.boundingBox?.x + snappedData.delta.x,\n      y: this.boundingBox?.y + snappedData.delta.y,\n    };\n\n    let delta = snappedData.delta;\n\n    this.setNewLayout(\n      this.selectedLayers,\n      this.boundingBox,\n      data.session,\n      data.targetHandle,\n      eventType,\n      data,\n      delta,\n      snappedData.meta\n      // { x: rotateDelta[0], y: rotateDelta[1] }\n    );\n  }\n\n  normalizeChildrenFlex() {\n    const parent = this.selectedLayers.length\n      ? this.selectedLayers[0].parent\n      : undefined;\n\n    if (parent) {\n      const totalChildrenFlex = parent.getTotalFlexOfFlexChildren();\n      parent.children.forEach((child: Layer, index: number) => {\n        const layerFlex = child.getFlexValue();\n        if (!isNil(layerFlex) && !isNil(totalChildrenFlex)) {\n          // this.commandManager.execute(\n          //   new RemoveStyleAttribute(this.session, child, 'flexGrow')\n          // );\n\n          child.removeLayout('flexGrow');\n          const newFlex = layerFlex * (1 / totalChildrenFlex);\n          // this.commandManager.execute(\n          //   new SetStyleAttribute(this.session, child, 'flex', newFlex)\n          // );\n          child.setLayout('flex', newFlex);\n        }\n      });\n    }\n  }\n  setLayoutChildren() {\n    let normalizeForFlex = false;\n\n    normalizeForFlex = this.selectedLayers.some((layer: Layer) => {\n      return (\n        (layer.isFillHeight() || layer.isFillWidth()) && layer.type !== 'root'\n      );\n    });\n\n    if (normalizeForFlex) {\n      this.normalizeChildrenFlex();\n    }\n\n    this.layoutElementArray.length = 0;\n\n    const selectedLayers = this.selectedLayers;\n    if (selectedLayers.length === 0) {\n      return;\n    }\n    const parentLayer = this.selectedLayers[0].parent;\n    if (parentLayer) {\n      parentLayer.children.forEach((child: any, index: number) => {\n        const layoutChild = {\n          layer: child,\n          startFlex: child.layout.get('flex') ? child.layout.get('flex') : 0,\n        };\n        this.layoutElementArray.push(layoutChild);\n      });\n    }\n  }\n\n  // flex drag here\n  private setLayoutChildSize(layer: Layer, deltaFactor: any) {\n    const parentFlexDirection = layer.getParentLayerFlexDirection();\n    const startDims = layer.executeFunction('getData', 'initialDims');\n    let width = startDims.width;\n    let height = startDims.height;\n    if (startDims) {\n      width = startDims.width + startDims.width * deltaFactor;\n      height = startDims.height + startDims.height * deltaFactor;\n    }\n    if (parentFlexDirection === 'row') {\n      layer.setLayout('width', width);\n      // this.commandManager.execute(\n      //   new SetStyleAttribute(this.session, layer, 'width', width)\n      // );\n    } else {\n      layer.setLayout('height', height);\n\n      // this.commandManager.execute(\n      //   new SetStyleAttribute(this.session, layer, 'height', height)\n      // );\n    }\n  }\n  private getDeltaFactor(layer: Layer, delta: any, handle: any): any {\n    const parent = layer.parent;\n\n    if (!parent) {\n      return 0;\n    }\n    const flexDirection = layer.getParentLayerFlexDirection();\n\n    const width = parent.getBoundingClientRect().width;\n    const height = parent.getBoundingClientRect().height;\n    let deltaX = delta.x / width;\n    let deltaY = delta.y / height;\n    let deltaFactor = 0;\n    if (handle.indexOf('C') === -1) {\n      if (flexDirection === 'row') {\n        if (handle.indexOf('L') > -1) {\n          deltaX = -deltaX;\n        }\n        deltaFactor = deltaX;\n      } else {\n        if (handle.indexOf('T') > -1) {\n          deltaY = -deltaY;\n        }\n        deltaFactor = deltaY;\n      }\n    }\n    return +deltaFactor.toFixed(2);\n  }\n\n  dragLayout(layer: Layer, delta: IPosition, handle: any, eventName: string) {\n    let deltaX: number = delta.x;\n    let deltaY: number = delta.y;\n\n    const startDims = layer.executeFunction('getData', 'initialDims');\n    const originalDelta: IPosition = { x: deltaX, y: deltaY };\n\n    let totalFlex = 0;\n\n    let deltaFactor = this.getDeltaFactor(layer, originalDelta, handle);\n\n    const selectedLayerFlex = startDims.flex;\n\n    if (!selectedLayerFlex) {\n      this.setLayoutChildSize(layer, deltaFactor);\n    } else {\n      const childrenLength = this.layoutElementArray.length;\n      this.layoutElementArray.forEach((child: any, index: number) => {\n        let expectedFlex;\n        if (child.layer === layer) {\n          expectedFlex = selectedLayerFlex + deltaFactor;\n        } else {\n          expectedFlex = child.startFlex - deltaFactor / (childrenLength - 1);\n        }\n        expectedFlex = +expectedFlex;\n\n        if (!isNil(expectedFlex)) {\n          child.layer.dispatchEvent(\n            `${this.namespace}.${eventName}`,\n            new LayerResizerEvent(\n              `${this.namespace}.${eventName}`,\n              child.layer,\n              { flex: expectedFlex },\n              null\n            )\n          );\n\n          totalFlex = expectedFlex + totalFlex;\n        }\n      });\n    }\n  }\n\n  private dragLayoutIsDoable(handle: string, layer: Layer) {\n    const position = layer.layout.get('position');\n    // TODO: implement this condition after symbols are done\n    // workspace.persist.domain.isSymbolRootLayer(this.selectedLayers[0]\n    return (\n      ((handle.indexOf('B') > -1 || handle.indexOf('T') > -1) &&\n        position !== 'absolute' &&\n        layer.isFillHeight()) ||\n      ((handle.indexOf('L') > -1 || handle.indexOf('R') > -1) &&\n        position !== 'absolute' &&\n        layer.isFillWidth())\n    );\n  }\n\n  applyDimensionsForHandle(eventType: string) {\n    const data = this.dragEventData;\n    this.totalDx = data.session.current.x - data.session.start.x;\n    this.totalDy = data.session.current.y - data.session.start.y;\n\n    if (\n      !this.selectedLayers.length ||\n      (this.selectedLayers.length && !this.selectedLayers[0].parent)\n    ) {\n      return;\n    }\n    const parentAbsoluteRotation =\n      this.selectedLayers.length && this.selectedLayers[0].parent\n        ? this.selectedLayers[0].parent.getAbsoluteRotation()\n        : 0;\n    let rotateDelta = ModelUtils.rotatePoint(\n      [this.totalDx, this.totalDy],\n      360 - parentAbsoluteRotation,\n      [0, 0]\n    );\n\n    if (this.dragLayoutIsDoable(data.targetHandle, this.selectedLayers[0])) {\n      this.dragLayout(\n        this.selectedLayers[0],\n        { x: rotateDelta[0], y: rotateDelta[1] },\n        data.targetHandle,\n        eventType + 'Layout'\n      );\n      return;\n    }\n\n    const snappedData = this.canvas.executeFunction(\n      'snapToPoints',\n      this.snapPoints,\n      [this.startX, this.startY],\n      [rotateDelta[0], rotateDelta[1]],\n      {\n        ...this.boundingBox,\n      },\n      [this.totalDx, this.totalDy],\n      [this.startAbsoluteX, this.startAbsoluteY],\n      parentAbsoluteRotation,\n      this.boundingBoxWRTWorld,\n      data.targetHandle\n    );\n\n    let delta = snappedData.delta;\n\n    let boundingBox = this.boundingBox;\n    if (this.selectedLayers.length === 1) {\n      let rotateDelta1 = ModelUtils.rotatePoint(\n        [snappedData.delta.x, snappedData.delta.y],\n        360 - this.selectedLayers[0].getBoundingClientRect().rotation,\n        [0, 0]\n      );\n      delta = {\n        x: rotateDelta1[0],\n        y: rotateDelta1[1],\n      };\n    } else {\n      boundingBox = this.boundingBoxWRTWorld;\n      boundingBox = {\n        ...this.boundingBoxWRTWorld,\n        x: this.boundingBoxWRTWorld.x,\n        y: this.boundingBoxWRTWorld.y,\n      };\n    }\n\n    this.setNewLayout(\n      this.selectedLayers,\n      boundingBox,\n      data.session,\n      data.targetHandle,\n      eventType,\n      data,\n      delta,\n      snappedData.meta\n    );\n  }\n\n  activate() {\n    this.setSelectedLayers();\n\n    this.startX = 0;\n    this.startY = 0;\n    this.startAbsoluteX = 0;\n    this.startAbsoluteY = 0;\n\n    this.totalDx = 0;\n    this.totalDy = 0;\n\n    this.canvas.on('selectedLayers', (event: any) => {\n      this.setSelectedLayers();\n      if (isEmpty(this.canvas.selectedLayers)) {\n        this.canvas.executeFunction('ResizerRenderer.hide');\n      } else {\n        this.canvas.executeFunction('ResizerRenderer.show');\n        this.rerender();\n      }\n    });\n    this.canvas.addFunction(`${this.namespace}.stopHandleRerender`, () => {\n      this.rerenderHandles = false;\n    });\n    this.canvas.addFunction(`${this.namespace}.startHandleRerender`, () => {\n      this.rerenderHandles = true;\n      this.rerender();\n    });\n    this.canvas.addEventListener(\n      'ResizerRenderer.dragStart',\n      (data: ResizerRendererDragEvent) => {\n        this.canvas.executeMiddleware(\n          'LayerResizer.dragStart',\n          { data, selectedLayers: this.selectedLayers },\n          (event: any) => {\n            const data: ResizerRendererDragEvent = event.data;\n            this.boundingBox = this.canvas.getContainerBoundingBoxWRTParent(\n              this.selectedLayers\n            );\n            this.boundingBoxWRTWorld = this.canvas.getContainerBoundingBox(\n              this.selectedLayers\n            );\n\n            forEach(this.selectedLayers, selectedLayer => {\n              selectedLayer.setDragging(true);\n            });\n\n            const parentLayer = this.selectedLayers.length\n              ? this.selectedLayers[0].parent\n              : undefined;\n\n            if (!parentLayer) {\n              return;\n            }\n            this.startValues = this.getParentRelativeDims(\n              data.startValues,\n              this.selectedLayers[0]\n            );\n\n            this.startX = this.boundingBox.x;\n            this.startY = this.boundingBox.y;\n\n            this.startAbsoluteX =\n              this.boundingBoxWRTWorld.x -\n              this.canvas.getContainerBoundingBox([parentLayer]).x;\n\n            this.startAbsoluteY =\n              this.boundingBoxWRTWorld.y -\n              this.canvas.getContainerBoundingBox([parentLayer]).y;\n\n            this.snapPoints = this.canvas.executeFunction(\n              'getSnapPoints',\n              this.selectedLayers,\n              parentLayer\n            );\n\n            this.selectedLayers.forEach((selectedLayer: any) => {\n              let initialDims = selectedLayer.getBoundingClientRect();\n\n              // initialDims.x = initialDims.x - parentLayer.getBorderLeft();\n              // initialDims.y = initialDims.y - parentLayer.getBorderTop();\n              initialDims.rootX =\n                initialDims.rootX - parentLayer.getBorderLeft();\n              initialDims.rootY =\n                initialDims.rootY - parentLayer.getBorderTop();\n\n              selectedLayer.executeFunction('setData', 'initialDims', {\n                ...initialDims,\n                absoluteRotation: selectedLayer.getAbsoluteRotation(),\n                flex: selectedLayer.layout.get('flex'),\n              });\n              selectedLayer.dispatchEvent(\n                `${this.namespace}.dragStart`,\n                new LayerResizerEvent(\n                  `${this.namespace}.dragStart`,\n                  selectedLayer,\n                  initialDims,\n                  data,\n                  undefined,\n                  undefined,\n                  this.snapPoints\n                )\n              );\n              this.selectedLayerDims.set(selectedLayer, initialDims);\n            });\n\n            // this.snapPoints.gridSnap = this.config.gridSnap;\n          }\n        );\n      }\n    );\n    this.canvas.addEventListener(\n      'ResizerRenderer.drag',\n      (data: ResizerRendererDragEvent) => {\n        this.canvas.executeMiddleware(\n          'LayerResizer.drag',\n          { data, selectedLayers: this.selectedLayers },\n          (event: any) => {\n            this.dragEventData = event.data;\n            this.applyDimensions('drag');\n          }\n        );\n      }\n    );\n    this.canvas.addEventListener(\n      'ResizerRenderer.dragEnd',\n      (data: ResizerRendererDragEvent) => {\n        this.canvas.executeMiddleware(\n          'LayerResizer.dragEnd',\n          { data, selectedLayers: this.selectedLayers },\n          (event: any) => {\n            forEach(this.selectedLayers, selectedLayer => {\n              selectedLayer.setDragging(false);\n            });\n            this.dragEventData = event.data;\n            this.applyDimensions('dragEnd');\n\n            this.startValues = undefined;\n            this.selectedLayerDims = new Map();\n            this.shiftDirection = '';\n            this.dragEventData = undefined;\n            this.totalDx = 0;\n            this.totalDy = 0;\n          }\n        );\n      }\n    );\n    this.canvas.addEventListener(\n      'ResizerRenderer.handleDragStart',\n      (data: ResizerRendererDragEvent) =>\n        this.canvas.executeMiddleware(\n          'LayerResizer.handleDragStart',\n          { data, selectedLayer: this.selectedLayers[0] },\n          (event: any) => {\n            const data: ResizerRendererDragEvent = event.data;\n            this.boundingBox = this.canvas.getContainerBoundingBoxWRTParent(\n              this.selectedLayers\n            );\n            this.boundingBoxWRTWorld = this.canvas.getContainerBoundingBox(\n              this.selectedLayers\n            );\n\n            forEach(this.selectedLayers, selectedLayer => {\n              selectedLayer.setDragging(true);\n            });\n\n            this.startValues = this.getParentRelativeDims(\n              data.startValues,\n              this.selectedLayers[0]\n            );\n\n            const parentLayer = this.selectedLayers.length\n              ? this.selectedLayers[0].parent\n              : undefined;\n\n            if (!parentLayer) {\n              return;\n            }\n            this.snapPoints = this.canvas.executeFunction(\n              'getSnapPoints',\n              this.selectedLayers,\n              parentLayer,\n              data.targetHandle\n            );\n\n            // console.log(this.snapPoints, 'snap points here');\n            this.setLayoutChildren();\n\n            this.selectedLayers.forEach((selectedLayer: any) => {\n              const initialDims = selectedLayer.getBoundingClientRect();\n              initialDims.rootX =\n                initialDims.rootX - parentLayer.getBorderLeft();\n              initialDims.rootY =\n                initialDims.rootY - parentLayer.getBorderTop();\n              selectedLayer.executeFunction('setData', 'initialDims', {\n                ...initialDims,\n                absoluteRotation: selectedLayer.getAbsoluteRotation(),\n                flex: selectedLayer.layout.get('flex'),\n              });\n              selectedLayer.dispatchEvent(\n                `${this.namespace}.handleDragStart`,\n                new LayerResizerEvent(\n                  `${this.namespace}.handleDragStart`,\n                  selectedLayer,\n                  initialDims,\n                  data,\n                  undefined,\n                  undefined,\n                  this.snapPoints\n                )\n              );\n              this.selectedLayerDims.set(selectedLayer, initialDims);\n            });\n\n            this.startX = this.boundingBox.x;\n            this.startY = this.boundingBox.y;\n\n            this.startAbsoluteX =\n              this.boundingBoxWRTWorld.x -\n              this.canvas.getContainerBoundingBox([parentLayer]).x;\n\n            this.startAbsoluteY =\n              this.boundingBoxWRTWorld.y -\n              this.canvas.getContainerBoundingBox([parentLayer]).y;\n          }\n        )\n    );\n\n    this.canvas.addEventListener(\n      'ResizerRenderer.handleDrag',\n      (data: ResizerRendererDragEvent) =>\n        this.canvas.executeMiddleware(\n          'LayerResizer.handleDrag',\n          { data, selectedLayer: this.selectedLayers[0] },\n          (event: any) => {\n            this.dragEventData = event.data;\n            this.applyDimensionsForHandle('handleDrag');\n          }\n        )\n    );\n    this.canvas.addEventListener(\n      'ResizerRenderer.handleDragEnd',\n      (data: ResizerRendererDragEvent) =>\n        this.canvas.executeMiddleware(\n          'LayerResizer.handleDragEnd',\n          { data, selectedLayer: this.selectedLayers[0] },\n          (event: any) => {\n            forEach(this.selectedLayers, selectedLayer => {\n              selectedLayer.setDragging(false);\n            });\n            this.dragEventData = event.data;\n            this.applyDimensionsForHandle('handleDragEnd');\n            this.startValues = undefined;\n            this.dragEventData = undefined;\n            this.totalDx = 0;\n            this.totalDy = 0;\n            this.selectedLayerDims = new Map();\n          }\n        )\n    );\n    this.canvas.addFunction(\n      'LayerResizer.hideLayer',\n      this.hideLayerResizer.bind(this)\n    );\n    this.canvas.addFunction(\n      'LayerResizer.showLayer',\n      this.showLayerResizer.bind(this)\n    );\n\n    this.canvas.addEventListener('blur', () => {\n      if (this.isAltPressed) this.isAltPressed = false;\n      if (this.isShiftPressed) this.isShiftPressed = false;\n    });\n    this.canvas.addEventListener('keyUp', (data: any) => {\n      let event = data.originalEvent ? data.originalEvent : data;\n      if (event.keyCode === 16) {\n        this.isShiftPressed = false;\n      }\n      if (event.keyCode === 18) {\n        this.isAltPressed = false;\n      }\n\n      if (this.dragEventData) {\n        if (this.dragEventData.targetHandle.indexOf('C') === -1) {\n          this.applyDimensionsForHandle('handleDrag');\n        } else {\n          this.applyDimensions('drag');\n        }\n      }\n    });\n    this.canvas.addEventListener('keyDown', (data: any) => {\n      let event = data.originalEvent ? data.originalEvent : data;\n      if (event.keyCode === 16) {\n        this.isShiftPressed = true;\n      }\n      if (event.keyCode === 18) {\n        this.isAltPressed = true;\n      }\n      if (this.dragEventData) {\n        if (this.dragEventData.targetHandle.indexOf('C') === -1) {\n          this.applyDimensionsForHandle('handleDrag');\n        } else {\n          this.applyDimensions('drag');\n        }\n      }\n    });\n\n    this.canvas.addEventListener('resetResizer', (e: ResetResizerEvent) => {\n      const event = e.originalEvent;\n      // const newLayer = e.newTarget;\n\n      this.startValues = undefined;\n      this.selectedLayerDims = new Map();\n\n      this.boundingBox = this.canvas.getContainerBoundingBox(\n        this.selectedLayers\n      );\n      this.startValues = this.getParentRelativeDims(\n        event.startValues,\n        this.selectedLayers[0]\n      );\n      const parentLayer = this.selectedLayers.length\n        ? this.selectedLayers[0].parent\n        : undefined;\n      this.startX = this.boundingBox.x - (parentLayer ? parentLayer.rootX : 0);\n      this.startY = this.boundingBox.y - (parentLayer ? parentLayer.rootY : 0);\n      this.selectedLayers.forEach((selectedLayer: Layer) => {\n        const initialDims = selectedLayer.getBoundingClientRect();\n        selectedLayer.executeFunction('setData', 'initialDims', initialDims);\n        this.selectedLayerDims.set(selectedLayer, initialDims);\n      });\n\n      this.snapPoints = this.canvas.executeFunction(\n        'getSnapPoints',\n        this.selectedLayers,\n        parentLayer\n      );\n    });\n  }\n  setNewLayout(\n    layers: Array<Layer>,\n    boundingBox: IDimensionWithRotation,\n    session: any,\n    handle: string,\n    eventName: string,\n    originalEvent: any,\n    delta?: any,\n    meta?: any\n  ) {\n    let deltaInput = {\n      x: session.current.x - session.start.x,\n      y: session.current.y - session.start.y,\n    };\n\n    if (delta) {\n      deltaInput = delta;\n    }\n\n    layers.forEach((selectedLayer: Layer, index: number) => {\n      const initialDims = selectedLayer.executeFunction(\n        'getData',\n        'initialDims'\n      );\n      if (!initialDims) {\n        return;\n      }\n      let initialDimensions = {\n        x: initialDims.rootX,\n        y: initialDims.rootY,\n        height: initialDims.height,\n        width: initialDims.width,\n        rotation: initialDims.rotation,\n      };\n      let dimensions;\n      if (handle.indexOf('ROTATE') !== -1) {\n        let rotationDelta = {\n          x: session.current.x - session.start.x,\n          y: session.current.y - session.start.y,\n        };\n\n        if (layers.length === 1) {\n          boundingBox = {\n            ...boundingBox,\n            x: selectedLayer.getBoundingClientRect().x,\n            y: selectedLayer.getBoundingClientRect().y,\n          };\n          const rotateDelta = ModelUtils.rotatePoint(\n            [rotationDelta.x, rotationDelta.y],\n            360 - initialDims.absoluteRotation,\n            [0, 0]\n          );\n\n          rotationDelta = {\n            x: rotateDelta[0],\n            y: rotateDelta[1],\n          };\n        }\n\n        let rotation = calculateRotation(\n          { ...boundingBox },\n          session,\n          initialDims.rotation,\n          rotationDelta,\n          handle\n        );\n\n        if (this.isShiftPressed) {\n          const ROTATION_FACTOR = 15;\n          const multiplicationFactor = Math.round(rotation / ROTATION_FACTOR);\n          rotation = ROTATION_FACTOR * multiplicationFactor;\n        }\n\n        dimensions = { ...initialDimensions, rotation };\n      } else {\n        let isFlexChildren = false;\n        let maintainAspectRatio = false;\n        layers.forEach((layer: Layer) => {\n          if (layer.isFlexChild()) isFlexChildren = true;\n          if (layer.aspectRatio) maintainAspectRatio = true;\n        });\n        if (layers.length === 1) {\n          dimensions = computeOrientation(\n            initialDimensions,\n            deltaInput,\n            handle,\n            this.isShiftPressed || maintainAspectRatio,\n            this.isAltPressed && !isFlexChildren\n          );\n        } else {\n          dimensions = computeOrientationMultiple(\n            initialDimensions,\n            deltaInput,\n            handle,\n            boundingBox,\n            ModelUtils.getPointsFromBoundingBox(\n              initialDimensions,\n              initialDims.rotation\n            ),\n            this.isShiftPressed || maintainAspectRatio,\n            this.isAltPressed && !isFlexChildren\n          );\n        }\n      }\n      let parentRootDims = { rootX: 0, rootY: 0 };\n      if (selectedLayer.parent) {\n        parentRootDims = selectedLayer.parent.getBoundingClientRect();\n      }\n      let newDimension = {\n        ...dimensions,\n      };\n      // if (handle.indexOf('C') !== -1 || handle.indexOf('ROTATE') !== -1) {\n      newDimension = {\n        ...dimensions,\n        x: dimensions.x - parentRootDims.rootX,\n        y: dimensions.y - parentRootDims.rootY,\n      };\n      // }\n\n      selectedLayer.dispatchEvent(\n        `${this.namespace}.${eventName}`,\n        new LayerResizerEvent(\n          `${this.namespace}.${eventName}`,\n          selectedLayer,\n          newDimension,\n          originalEvent,\n          undefined,\n          meta\n        )\n      );\n      this.selectedLayerDims.set(selectedLayer, newDimension);\n    });\n  }\n  deactivate() {\n    this.dispose();\n  }\n}\n","import { Canvas, IPlugin, Layer, IContext } from '../..';\nexport default class FloatingButton implements IPlugin {\n  name = 'FloatingButton';\n  canvas!: Canvas;\n\n  dom: any;\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n  activate() {\n    this.canvas.addFunction(\n      'addFloatingButton',\n      this.addFloatingButton.bind(this)\n    );\n    this.canvas.addFunction(\n      'removeFloatingButton',\n      this.removeFloatingButton.bind(this)\n    );\n  }\n\n  removeFloatingButton() {\n    if (this.dom) this.canvas.removeDomFromViewport(this.dom);\n  }\n\n  addFloatingButton(context: any, caption: any, callback: any) {\n    var button = document.createElement('button');\n\n    this.dom = button;\n\n    button.innerHTML = caption;\n    button.addEventListener('click', callback);\n\n    let styles = `text-size-adjust: 100%;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n    box-sizing: border-box;\n    user-select: none;\n    -webkit-font-smoothing: antialiased;\n    outline: none;\n    font-size: 11px;\n    align-items: center;\n    display: inline-flex;\n    position: relative;\n    border: none;\n    transition: all 0.3s ease 0s;\n    cursor: pointer;\n    border-right: none;\n    border-left: none;\n    padding: 3px 6px;\n    justify-content: center;\n    margin-right: 0px;\n    margin-left: 0px;\n    min-width: 0px;\n    -webkit-app-region: no-drag;\n    border-radius: 2px;\n    background: rgb(37, 41, 49);\n    width: auto;\n    color: rgb(251, 251, 251);\n    height: 30px;\n    padding-left: 6px;\n    padding-right: 6px;\n    margin-top: 30px;\n    margin-left: 30px;\n\n    text-size-adjust: 100%;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n    cursor: pointer;\n    vertical-align: baseline;\n    border-width: 0px;\n    border-style: initial;\n    border-color: initial;\n    border-image: initial;\n    font: inherit;\n    box-sizing: border-box;\n    user-select: none;\n    -webkit-font-smoothing: antialiased;\n    font-family: Roboto, -apple-system, BlinkMacSystemFont, sans-serif;\n    font-weight: 400;\n    align-self: center;\n    text-overflow: ellipsis;\n    letter-spacing: -0.27px;\n    font-size: 14px;\n    color: rgb(241, 242, 244, 0.6);\n\n    `;\n\n    button.setAttribute('style', styles);\n\n    this.canvas.addDomToViewport(button);\n  }\n\n  deactivate() {\n    this.canvas.removeFunction('addFloatingButton');\n    this.canvas.removeFunction('removeFloatingButton');\n  }\n}\n","import { Layer, Event } from '../../..';\n\nexport default class GradientEditorEvent extends Event {\n  task?: 'open' | 'close';\n  constructor(\n    name: string,\n    target: Layer,\n    task?: 'open' | 'close',\n    currentTarget?: Layer\n  ) {\n    super(name, target, currentTarget);\n    this.task = task;\n  }\n}\n","import { Canvas, IPlugin, Layer, IContext } from '../..';\nimport DesignerMouseEvent from '../../events/MouseEvent';\nexport default class PlusButton implements IPlugin {\n  name = 'PlusButton';\n  canvas!: Canvas;\n  dispose: any;\n  dom: any;\n  passedEvent = ['mouseup', 'mousemove', 'drop'];\n\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n    this.dispose = null;\n  }\n  activate() {\n    this.canvas.addFunction('addPlusButton', this.addPlusButton.bind(this));\n    this.canvas.addFunction('showPlusButton', this.showPlusButton.bind(this));\n    this.canvas.addFunction('hidePlusButton', this.hidePlusButton.bind(this));\n    this.canvas.addFunction(\n      'removePlusButton',\n      this.removePlusButton.bind(this)\n    );\n\n    this.canvas.on('zoom', this.handleZoom.bind(this));\n    this.canvas.addEventListener(\n      'artboardLayoutChanges',\n      this.positionPlusButton.bind(this)\n    );\n  }\n\n  passEvent(e: Event) {\n    e.preventDefault();\n    this.canvas.dispatchEventOnHitLayer(\n      e.type,\n      new DesignerMouseEvent(e.type, this.canvas, e, this.canvas),\n      e\n    );\n  }\n\n  handleLayerListeners(handle: any) {\n    this.passedEvent.map(event => {\n      handle.addEventListener(event, (e1: any) => {\n        this.passEvent(e1);\n      });\n    });\n  }\n\n  positionPlusButton() {\n    if (!this.dom) return;\n    var zoom = 1;\n    var artboards = this.canvas.executeFunction('getAllArtboards');\n\n    let left = Number.MIN_VALUE;\n    let artLeft = Number.MIN_VALUE;\n    let artTop = Number.MIN_VALUE;\n    let top = Number.MIN_VALUE;\n\n    if (artboards.size === 0) {\n      this.dom.style.display = 'none';\n    }\n    // else {\n    //   this.dom.style.display = 'inline-block';\n    // }\n\n    if (artboards.size === 0) {\n      position = { left: 300, top: 50, artTop: 50, artLeft: 300 };\n    }\n    artboards.forEach((artboard: Layer) => {\n      const artboardClientRect = artboard.getBoundingClientRect();\n      const artMaxX = artboardClientRect.x + artboardClientRect.width;\n      const artMidY = artboardClientRect.y + artboardClientRect.height / 2;\n      if (left < artMaxX) {\n        left = artMaxX;\n        top = artMidY;\n        artTop = artboardClientRect.y;\n      }\n    });\n    artLeft = left + 50;\n    left = left * zoom + 50;\n    top = top * zoom - 40;\n    var position = { left, top, artTop, artLeft };\n\n    this.dom.style.top = position.top + 'px';\n    this.dom.style.left = position.left + 'px';\n  }\n\n  handleZoom() {\n    if (this.dom) {\n      let zoom = this.canvas.getZoom();\n      if (zoom > 0.5) {\n        this.dom.style.transform = 'scale(' + 1 / zoom + ')';\n      }\n    }\n  }\n\n  removePlusButton() {\n    if (this.dom) this.canvas.removeDomFromWorld(this.dom);\n  }\n\n  hidePlusButton() {\n    if (this.dom) this.dom.style.display = 'none';\n  }\n  showPlusButton() {\n    if (this.dom) {\n      this.dom.style.display = '';\n    }\n  }\n  addPlusButton(context: any, caption: any, callback: any) {\n    let button = document.createElement('button');\n    this.dom = button;\n    button.innerHTML = '<span style=\"font-size: 36px\">+</span>';\n    button.addEventListener('click', (event: any) => {\n      if (!this.canvas.mouseEventsBlocked && event.sourceCapabilities) {\n        callback();\n      }\n    });\n\n    this.handleLayerListeners(button);\n\n    let styles = `text-size-adjust: 100%;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n    box-sizing: border-box;\n    user-select: none;\n    -webkit-font-smoothing: antialiased;\n    outline: none;\n    font-size: 11px;\n    align-items: center;\n    display: inline-flex;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100px;\n    height: 80px;\n    border: none;\n    cursor: inherit;\n    border-right: none;\n    border-left: none;\n    padding: 3px 6px;\n    justify-content: center;\n    margin-right: 0px;\n    margin-left: 0px;\n    min-width: 0px;\n    -webkit-app-region: no-drag;\n    border-radius: 2px;\n    background: rgb(37, 41, 49);\n    color: rgb(251, 251, 251);\n    padding-left: 6px;\n    padding-right: 6px;\n    margin-top: 2px;\n    margin-left: 2px;\n\n    text-size-adjust: 100%;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n    vertical-align: baseline;\n    border-width: 0px;\n    border-style: initial;\n    border-color: initial;\n    border-image: initial;\n    font: inherit;\n    box-sizing: border-box;\n    user-select: none;\n    -webkit-font-smoothing: antialiased;\n    font-family: Roboto, -apple-system, BlinkMacSystemFont, sans-serif;\n    font-weight: 400;\n    align-self: center;\n    text-overflow: ellipsis;\n    letter-spacing: -0.27px;\n    font-size: 14px;\n    color: rgb(241, 242, 244, 0.6);\n    transform-origin: 0 0;\n    `;\n\n    button.setAttribute('style', styles);\n    button.setAttribute('name', 'add-artboard');\n    button.addEventListener('mouseenter', (event: any) => {\n      if (!this.canvas.mouseEventsBlocked) {\n        this.canvas.setMouseCursor('pointer');\n      }\n    });\n    button.addEventListener('mouseleave', (event: any) => {\n      if (!this.canvas.mouseEventsBlocked) {\n        this.canvas.setMouseCursor('default');\n      }\n    });\n    this.dispose = this.canvas.addDomToWorld(button);\n    this.positionPlusButton();\n  }\n\n  deactivate() {\n    this.canvas.removeFunction('addPlusButton');\n    this.canvas.removeFunction('removePlusButton');\n    this.dispose();\n  }\n}\n","import { Canvas, IPlugin, MouseEvent } from '../../';\nimport { IDimensionWithRotation, IPosition } from 'interfaces';\nimport ModelUtils from './../../models/utils';\nexport default class HtmlDragToWorldPlugin implements IPlugin {\n  name = 'HtmlDragToWorldPlugin';\n  namespace = 'HtmlDragToWorld';\n  canvas!: Canvas;\n  resizerHandleLayersRef!: Map<string, any>;\n  initPos: IPosition = { x: 0, y: 0 };\n  relPos: IPosition = { x: 0, y: 0 };\n  lastPos: IPosition = { x: 0, y: 0 };\n  startValues = { x: 0, y: 0, height: 0, width: 0, rotation: 0 };\n  dragSession = {\n    start: { x: 0, y: 0, deltaX: 0, deltaY: 0 },\n    current: { x: 0, y: 0, deltaX: 0, deltaY: 0 },\n    end: { x: 0, y: 0, deltaX: 0, deltaY: 0 },\n  };\n  init(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n  setStartValues = (dims: IDimensionWithRotation) => {\n    this.startValues = dims;\n  };\n  startDragSession = (x: number, y: number) => {\n    this.dragSession.start = { x, y, deltaX: 0, deltaY: 0 };\n    this.dragSession.current = { x, y, deltaX: 0, deltaY: 0 };\n    this.dragSession.end = { x, y, deltaX: 0, deltaY: 0 };\n  };\n  endDragSession = () => {\n    this.dragSession.end = {\n      x: this.dragSession.current.x,\n      y: this.dragSession.current.y,\n      deltaX: this.dragSession.current.x - this.dragSession.start.x,\n      deltaY: this.dragSession.current.y - this.dragSession.start.y,\n    };\n  };\n  updateDragSession = (dx: number, dy: number) => {\n    this.dragSession.current = {\n      x: this.dragSession.current.x + dx,\n      y: this.dragSession.current.y + dy,\n      deltaX: dx,\n      deltaY: dy,\n    };\n  };\n  dragStart(context: any, e: any, initialDims: IDimensionWithRotation) {\n    let event = new MouseEvent(`${this.namespace}.dragStart`, this.canvas, e);\n    this.initPos = { x: event.worldX, y: event.worldY };\n    this.setStartValues(initialDims);\n    this.startDragSession(event.worldX, event.worldY);\n    this.lastPos = { x: 0, y: 0 };\n    return {\n      event,\n      startValues: { ...this.startValues },\n      session: { ...this.dragSession },\n    };\n  }\n  drag(context: any, e: any) {\n    e.preventDefault();\n    let event = new MouseEvent(`${this.namespace}.drag`, this.canvas, e);\n    this.relPos = {\n      x: event.worldX - this.initPos.x,\n      y: event.worldY - this.initPos.y,\n    };\n    let deltaX = this.relPos.x - this.lastPos.x;\n    let deltaY = this.relPos.y - this.lastPos.y;\n    // let rotatedDelta = ModelUtils.rotatePoint(\n    //   [deltaX, deltaY],\n    //   360 - this.startValues.rotation,\n    //   [0, 0]\n    // );\n    this.updateDragSession(deltaX, deltaY);\n    this.lastPos = { ...this.relPos };\n    return {\n      event,\n      startValues: { ...this.startValues },\n      session: { ...this.dragSession },\n    };\n  }\n  dragEnd(context: any, e: any) {\n    e.preventDefault();\n    let event = new MouseEvent(`${this.namespace}.dragEnd`, this.canvas, e);\n    this.setStartValues({ x: 0, y: 0, height: 0, width: 0, rotation: 0 });\n    this.endDragSession();\n    this.initPos = { x: 0, y: 0 };\n    return {\n      event,\n      startValues: { ...this.startValues },\n      session: { ...this.dragSession },\n    };\n  }\n  activate() {\n    this.canvas.addFunction(\n      `${this.namespace}.dragStart`,\n      this.dragStart.bind(this)\n    );\n    this.canvas.addFunction(`${this.namespace}.drag`, this.drag.bind(this));\n    this.canvas.addFunction(\n      `${this.namespace}.dragEnd`,\n      this.dragEnd.bind(this)\n    );\n  }\n\n  deactivate() {\n    //\n  }\n}\n","import { Layer } from '../models/Layer';\nimport { Event as DesignerEvent } from './index';\n\nexport default class DesignerKeyboardEvent extends DesignerEvent {\n  originalEvent: KeyboardEvent;\n  name!: string;\n  target!: Layer;\n  constructor(name: string, target: Layer, originalEvent: any) {\n    super(name, target);\n    this.originalEvent = originalEvent;\n  }\n}\n"],"names":["RootRenderer","forceUpdate","componentDidMount","props","layer","on","onUpdate","componentWillUnmount","off","render","TheChosenOne","canvas","getRenderer","type","React","ScrollContainer","viewport","getViewport","viewportState","height","width","baseState","layout","get","centerScrollTo","scroll","state","x","scrollX","y","scrollY","zoom","centerX","centerY","center","emit","scrollContainerRef","scrollLeft","scrollTop","values","isNaN","setScroll","event","isMouseDown","moveWithGrabHandle","deltaX","nativeEvent","movementX","deltaY","movementY","currentScrollX","getScrollLeft","currentScrollY","getScrollTop","stopPropagation","getZoom","getScroll","scrollFactor","scrollXFactor","scrollYFactor","scrollDom","ReactDOM","document","addEventListener","e","keyCode","target","body","preventDefault","setCenterPosition","getCenterPointInCurrentViewport","removeEventListener","getScrollPositon","inputScroll","scrollPostion","spaceKey","Scrollbars","ref","c","autoHide","onScrollFrame","style","cursor","mouseCursorType","overflow","onMouseDown","button","which","setMouseDown","onMouseUp","onMouseLeave","onMouseMove","className","map","children","child","pointerEvents","ZoomContainer","initialScroll","undefined","defaultProps","onUpdateZoom","shouldComponentUpdate","componentDidUpdate","setZoom","componentWillMount","getSceneStyle","position","transform","transformOrigin","containerRef","onClick","CanvasRenderer","keys","baseHeight","baseWidth","backgroundColor","index","key","DesignerReact","canvasDOMElement","createElement","setAttribute","top","left","opacity","renderCompiledDom","pane","context","getContext","collisionScope","strokeStyle","beginPath","drawBVH","stroke","appendChild","worldStackRef","firstChild","removeChild","stackWorldDOM","forEach","element","viewportStackRef","stackViewportDOM","thisNode","ownerDocument","handleNativeEvent","renderDOMStack","viewportHeight","viewportWidth","r","setViewportRef","right","bottom","onMouseEnter","onContextMenu","onDoubleClick","onMouseOut","onDrop","onDragOver","Serializable","fromJS","snapshot","classObject","classInstance","fields","getAllFields","_","Object","field","console","warn","constructor","name","log","objectClassInstance","getClassInstanceFromPlainObject","push","Map","value","mapKey","valueType","set","valueArray","valueClassInstance","Error","toJS","shallow","ret","object","getPlainObjectFromClassInstance","MapToPOJO","mapInstance","result","valuePlainArray","instance","getFields","newFields","superInstance","getPrototypeOf","literal","array","keyType","ignore","types","rerendererLog","stopUpdates","actionCounter","noRerenderCounter","pendingUpdates","action","callback","runListenersBatch","updateObject","listener","model","disposed","properties","window","clear","Model","eventListenersMap","reverseMap","property","existingArrOfListeners","arrayOfProperties","concat","uniq","combinedArrayOfListeners","reduce","combined","union","existingUpdateObject","remove","n","length","ModelUtils","pointsOverlap","point1","point2","Math","abs","getDimensionFromPolygon","points","rotatePolygon","poly","angle","centroid","getCentroid","point","rotatePoint","findAngle","A","B","C","range","AB","sqrt","pow","BC","AC","acos","PI","getAbsoluteRotation","point3","middlePoint","newX","newY","coord","distance","a","b","cos","sin","getPointsFromBoundingBox","box","rotation","rotatedPoly","getPointsFromDims","dims","reverse","obj","rotate","depthComparator","activeA","getActiveDigit","activeB","nextA","getNextCharacter","nextB","aIndex","indexOf","substring","includes","parseInt","getCorrection","orientation","finalOrientation","handle","x1","y1","new_x1","new_y1","diff1","y2","x2","new_x2","new_y2","diff2","offsetWidth","offsetHeight","getResizerQuad","computeOrientation","delta","shift","alt","computeOrientationWithDeltaAR","computeOrientationWithDeltaAlt","computeOrientationWithDeltaShiftAlt","computeOrientationWithDelta","computeOrientationMultiple","boundaryBox","computeOrientationWithDeltaARMultiple","computeOrientationWithDeltaAltMultiple","computeOrientationWithDeltaShiftAltMultiple","computeOrientationWithDeltaMultiple","max","isNil","newPoints","pointXDiff","pointYDiff","pointY","pointX","pointNew","deltaInp","aspectRatio","initialDims","widthFactor","pointYDiffDirect","pointXDiffDirect","pointYDiffOpposite","pointXDiffOpposite","getBoundingBoxFromOrientation","minX","minY","maxX","maxY","computeDelta","oldOrientation","newOrientation","oldBB","newBB","getGradientString","gradient","palette","colors","data","color","stops","stopColor","vector","to","from","angleRad","atan2","angleDeg","realLocations","pos","offset","colorStrings","i","round","join","gradientType","dist","maxDist","radialColorStrings","getHandlePoint","getQuotient","calculateRotation","startValues","session","oldRotation","deltaInput","current","start","polygon","getNewLayout","newLayout","rotateDelta","generateRandomString","characters","charAt","floor","random","EventCallableRegsitry","registry","callbacks","splice","dispatchEvent","propagate","KeyValueContainer","isValidKey","prop","getAll","Array","isArray","Style","Props","Layout","validKeys","Event","currentTarget","_propagate","_defaults","SetLayoutEvent","RemoveChildEvent","payload","GlobalLayerUpdateController","last","shouldBatch","updateChildrenLayoutCount","rerenderCount","shouldAddToBatch","updateLayoutCount","layerMap","setYogaAfterBatch","onUpdateDom","globalLayerUpdateController","stopChildrenLayoutUpdates","startChildrenLayoutUpdates","stopRerender","startRerender","stopAndBatchLayoutUpdates","stopAndForgetLayoutUpdates","resumeLayoutUpdates","Layer","uuid","val","_aspectRatio","_dom","dragging","_dragging","scope","_locked","_collisionScope","setLayoutEvent","updateChildrenLayout","isFlexChild","parent","setChildrenLayout","rerender","updateLayout","setNativeProps","updatedStyle","textDecoration","dom","findDOMNode","attributes","container","containerWidth","containerHeight","dimensions","percent","number","_name","_type","_parent","_props","_children","_style","_layout","config","yoga","Config","create","setPointScaleFactor","_yogaNode","Node","setType","_visible","_preservedProperties","locked","hidden","_dims","_mouseProps","_canvas","_thirdParty","setYoga","getDomBoundingBox","offsetLeft","offsetTop","clientRect","getBoundingClientRect","parentDom","parentElement","getAttribute","parentClientRect","rect","updateDomainCompileDimensions","isAutoHeight","isAutoWidth","_domDims","getCanvas","setSelectable","unlock","lock","getBorderLeft","getBorderTop","rootX","rootY","getBounds","getMarginLeft","margin","getMarginTop","getPaddingLeft","padding","getPaddingTop","yogaNode","getComputedBorder","EDGE_LEFT","EDGE_TOP","removeProp","yogaProps","setProps","setProp","show","setStyle","hide","noShow","setName","setParent","executeFunction","args","functionRegistry","Promise","resolve","reject","addChild","setCollisionScope","addYogaNode","setCollisionNode","calculateLayout","removeCollisionNode","removeChildEvent","setDims","move","newParent","newIndex","getRootLayer","node","parentLayer","getChildCount","insertChild","getComputedLayout","rootLayer","UNDEFINED","DIRECTION_LTR","elementType","getTotalFlexOfFlexChildren","sumOfFlex","layerFlex","getFlexValue","getParentLayerFlexDirection","err","flexDirection","flex","alignSelf","isFillWidth","isFillHeight","flexGrow","getSiblingsWithFlex","siblingsWithFlex","childLayer","updateNode","setHeight","setWidth","setLayout","emitLayoutChanges","recalculateLayout","removeLayout","removeStyle","isValidLayoutKey","setViewport","getTransform","transformObj","transformArray","getRotatedDims","firstPoint","getRotatedPolygon","_collisionNode","updatedPoly","createPolygon","update","getPartialPath","parentChildren","childIndex","findIndex","parentPath","getDepth","parentDepth","depth","getIndexInParent","getHitLayer","hitLayers","getHitResult","hitResult","createResult","player","createPoint","potentials","layersHit","shape","collides","sort","layer1","layer2","newHitLayers","executeMiddleware","getHitRectResult","orderBy","_eventCallableRegistry","dispatchedData","setInnerText","text","_innerText","convertLayerDimensions","layoutData","originalLeft","originalTop","originalRight","originalBottom","originalHeight","originalWidth","originalTransform","newLeft","newRight","newTop","newBottom","newWidth","newHeight","getDimensions","endsWith","transformValue","rerenderDescendants","_id","parentX","parentY","styleObj","item","parseFloat","slice","LayerInstantiable","MiddlewareRegistry","middlewares","_middlewares","execute","middlewareCallbacks","cb","self","mw","remainingCbs","next","_data","FunctionRegistry","_functions","fn","DesignerMouseEvent","originalEvent","pageX","pageY","worldPoints","convertPoint","worldX","worldY","viewportPoints","viewportX","viewportY","DesignerDropEvent","HoverEvent","SetScrollEvent","SetZoomEvent","ASSET_URL","Canvas","resultPoint","convertPointFromViewportToPage","convertPointFromViewportToWorld","convertPointFromPageToViewport","convertPointFromWorldToViewport","world","Collisions","_hoveredLayers","_selectedLayers","_stackWorldDOM","_stackViewportDOM","addFunction","setScrollCallback","bind","setZoomCallback","setMouseCursor","_mouseCursorType","scrollDims","blockMouseEvents","_mouseEventsBlocked","unblockMouseEvents","createLayer","addMiddleware","_middlewareRegistry","_functionRegistry","removeFunction","setAssetUrl","url","_assetURL","_viewportRef","_isMouseDown","setHoverLayers","layers","selectLayers","viewPortLeftPos","viewPortTopPos","pageScrollY","documentElement","pageScrollX","viewportDom","installPlugin","plugin","plugins","init","activate","dispatchEventOnHitLayer","addComponent","ReactComponent","componentDefinition","componentMap","renderer","definition","getComponentDefinition","addDomToWorld","domElement","maintainScale","zIndex","wrapperLayer","canvasDims","removeDomFromWorld","ele","addDomToViewport","removeDomFromViewport","dispatchHandledEvent","setDragging","MouseEvent","getContainerBoundingBox","getBoundingBox","getContainerBoundingBoxWRTParent","getBoundingBoxWRTParent","withoutRotation","wrtParent","isEmpty","layerPoints","localBox","minXLayer","minBy","minYLayer","maxXLayer","maxBy","maxYLayer","parentDims","enableMoveWithGrabHandle","mouseEventsBlocked","disableMoveWithGrabHandle","_componentMap","Gradient","activeIndex","elipseLength","gradientJSON","isFunction","cx","cy","radians","nx","ny","rotateGradient","nFrom","nTo","rotatedFrom","rotatedTo","HoverPlugin","dispose","hideLayerHover","forbiddenLayers","showLayerHover","hideAllHoverBoxes","hoverWrapperLayer","display","showAllHoverBoxes","showHover","selectedLayers","renderBoxes","hoveredLayers","hoverBox","hoverLayers","id","border","breakIndex","deactivate","DragEvent","worldDx","worldDy","pagePoints","pageDx","pageDy","viewportDx","viewportDy","Drag","offsetPageX","offsetPageY","relPos","mouseDown","dragStarted","lastPageX","lastPageY","dragStartEvent","dragEvent","dragEndEvent","rerenderProps","ViewRenderer","styles","returnStyles","setDomRef","_ref","domNode","findNodeHandle","prevProps","layerProps","layerId","View","component","getStyles","nativeID","ViewComponentDefinition","version","template","layerName","packageName","isDefaultImport","asName","centerVertical","centerHorizontal","thumbnail","controlsProperty","title","showForMultiple","propertyName","defaultValue","min","category","options","ViewRendererPlugin","TouchableOpacityRenderer","additionalOptions","showGradient","TouchableOpacityRendererPlugin","TouchableOpacityComponentDefinition","ScrollViewRenderer","contentContainerStyle","ScrollViewRendererPlugin","ScrollViewComponentDefinition","RenderEvent","TextRenderer","WebkitFontSmoothing","wordBreak","textDecorationLine","textRef","whiteSpaceTo","whiteSpace","innerText","replace","RegExp","Text","webkit","fontSize","fontFamily","fontPostscriptName","fontStyle","fontWeight","TextRendererPlugin","TextComponentDefinition","TextInputRenderer","appliedStyles","filteredProps","pick","TextInput","placeholder","uiOptions","size","TextInputRendererPlugin","TextInputComponentDefinition","ImageRenderer","imageStyle","sourceUri","imageURI","maskPath","imageMaskId","Svg","viewBox","preserveAspectRatio","Defs","Mask","Path","fill","d","SVGImage","svgDims","href","mask","resizeMode","src","objectFit","Image","source","uri","imageMask","generateSVGPath","ImageRendererPlugin","ImageComponentDefinition","PathRenderer","pathStyle","maskId","gradientId","LinearGradient","stop","Stop","strokeWidth","fillOpacity","strokeOpacity","clipPath","svgPath","pathProps","isClosed","PathRendererPlugin","PathComponentDefinition","Icons","EntypoIcon","AntDesignIcon","EvilIconsIcon","FeatherIcon","FontAwesomeIcon","FoundationIcon","IoniconsIcon","MaterialCommunityIconsIcon","MaterialIconsIcon","OcticonsIcon","SimpleLineIconsIcon","ZocialIcon","Fonts","EntypoFont","AntDesignFont","EvilIconsFont","FeatherFont","FontAwesomeFont","FoundationFont","IoniconsFont","MaterialCommunityIconsFont","MaterialIconsFont","OcticonsFont","SimpleLineIconsFont","ZocialFont","IconRenderer","componentWillUpdate","iconStyle","iconType","Icon","IconComponentDefinition","hideSize","IconRendererPlugin","AndroidSwitchRenderer","switchStyle","Switch","activeThumbColor","thumbTintColor","trackColor","onTintColor","tintColor","styled","input","disabled","IOSSwitchRenderer","IOSSwitch","checked","onChange","SwitchRenderer","platform","deviceData","AndroidRenderer","IOSRenderer","AndroidSwitchComponentDefinition","IOSSwitchRendererPlugin","SwitchComponentDefinition","AndroidActivityIndicatorRenderer","activityIndicatorStyle","ActivityIndicator","defaultSpinnerColor","keyFrameFade","keyframes","Bar","div","SpinnerWrapper","IOSSpinner","remainingProps","animationDelay","IOSActivityIndicatorRenderer","layerStyle","ActivityIndicatorRenderer","ActivityIndicatorComponentDefinition","ActivityIndicatorRendererPlugin","EllipseRenderer","ellipseProps","ellipseStyle","Number","appliedProps","rx","ry","getRef","Ellipse","EllipseRendererPlugin","EllipseComponentDefinition","SliderWrapper","AndroidSliderButton","AndroidSliderProgressBar","minimumTrackTintColor","maximumTrackTintColor","IOSSliderButton","IOSSliderProgressBar","Slider","isAndroid","SliderProgressBar","SliderButton","maximumValue","minimumValue","sliderRange","sliderValue","sliderButtonPosition","paddingTop","SliderRenderer","sliderProps","sliderStyle","SliderComponentDefinition","SliderRendererPlugin","MapViewRenderer","mapViewStyles","mapStyle","customMapStyle","assetURL","MapViewComponentDefinition","provider","initialRegion","latitude","longitude","latitudeDelta","longitudeDelta","MapViewRendererPlugin","PopoverMenuPlugin","showMenu","json","containerElement","randomId","menuReactElement","MainMenu","menuId","contextMenu","getAllSiblingLayerPoints","snapPoints","snap","siblingSnap","getLayerPoints","layerBox","xSnapPoint1","rootValue","snapTo","end","xSnapPoint2","xSnapPoint3","ySnapPoint1","ySnapPoint2","ySnapPoint3","getParentSnapPoints","parentSnap","layerDimensions","getDistance","axis","box1","box2","getDistanceBetweenLayers","isAlignedOnAxis","layerDims","otherLayerDims","getOverlapBetweenLayers","extremities","getDisconnectedGutterPointsForX","snapXPoints","restrictedLayers","originalAllLayers","dims1","dims2","allLayers","filter","leftMostPoint","leftMostRootPoint","rightMostPoint","rightMostRootPoint","addToSnapXPoint","getDisconnectedGutterPointsForY","snapYPoints","topMostPoint","topMostRootPoint","bottomMostPoint","bottomMostRootPoint","addToSnapYPoint","snapLines","getGutterSnapPoints","gutterSnap","allGutterPoints","overlapX","overlapY","gridSnapPoint","startPoint","gridSpace","stretch","snappedSide","coordinate","NaN","delta1","delta2","outputDelta","snapType","snapToGrid","startX","totalDeltaX","startY","totalDeltaY","stretchX","stretchY","gridSnap","gridOffset","snapBounds","xSnapPoint","ySnapPoints","snapToPoints","totalDelta","absoluteDelta","startAbsolutePoint","parentAbsoluteRotation","boundingBoxWRTWorld","meta","snappedData","snapPoint","rulerCoordinatesX","rulerSnapPoints","rulerCoordinatesY","documentCoordinatesX","parentSnapPoints","documentCoordinatesY","layerCoordinatesX","siblingSnapPoints","layerCoordinatesY","coordinateValueX","coordinateValueY","parentSnappedDataX","getPointForParentSnap","parentSnappedDataY","siblingDataX","getPointForSiblingSnap","siblingDataY","rulersDataX","getPointForRulerLines","rulersDataY","gridDataX","gridDataY","gridSnapPoints","rotateDeltaGrid","minSnappedDataX","MAX_VALUE","minSnappedDataY","documentCoordinates","coordinateValue","snappedPoint","originalCoordinateValue","newData","calculateCoordinate","snapped","layerCoordinates","showLog","rulerCoordinates","value1","value2","snapMagnet","filterSnapPointX","filterSnapPointY","getSnapPoints","gutterSnapPoints","layerParent","documentBound","rulerSnap","boundingBox","SnapPointsCalculator","bound","snapBound","getConfig","setConfig","getSiblingPoints","setSnapBound","getSnapBound","ConstructionLinesPlugin","clearRect","constructionLinesWrapper","toString","showConstructionLines","hideConstructionLines","setDimensions","attachListeners","updateLines","ScrollMousePositionPlugin","positionElement","mousePosWorldNode","createTextNode","mousePosViewportNode","pagePosPageNode","scrollPosNode","zoomNode","toFixed","nodeValue","isContained","helperBox","leftContained","rightContained","topContained","bottomContained","isAlignedonAxis","getDirection","getLeftEnd","xContained","yContained","getLeftWidth","getTop","getRightEnd","getRightWidth","drawXLines","xAligned","leftAligned","rightAligned","direction","leftEnd","leftWidth","rightEnd","rightWidth","leftDistance","rightDistance","leftShow","rightShow","lines","getTopEnd","getTopHeight","getLeft","getBottomEnd","getBottomHeight","drawYLines","yAligned","topAligned","bottomAligned","topEnd","topHeight","bottomEnd","bottomHeight","topDistance","topShow","bottomDistance","bottomShow","MeasurementLinesPlugin","emptyBox","hoveredDims","parentHoveredLayer","currentHoveredLayer","xLines","yLines","line","parentNode","showLines","temporarilyHidden","hideLines","namespace","MouseRectEvent","MouseRectPlugin","hitRectResult","dragStart","drawEvent","getLayers","drawEndEvent","TextEditor","isBlurred","TextEditorEvent","editorState","getCurrentContent","getPlainText","onEvent","isNumpadEnter","onBlur","newStyle","setState","contentBlock","getType","newContentState","Modifier","replaceText","getSelection","EditorState","getDefaultKeyBinding","isText","moveFocusToEnd","createWithContent","ContentState","createFromText","onFocus","handleNumpadEnter","execCommand","location","removePositionalAttribute","visibility","isAuto","caretColor","lineHeight","getStringStyle","letterSpacing","Editor","editorRef","keyBindingFn","handleKeyBinding","blockStyleFn","myBlockStyleFn","handleReturn","onTab","handleTab","TextEditorPlugin","mountTextEditor","TextEditorRenderer","unmountTextEditor","unmountComponentAtNode","PathEditor","paper","segment","finishEditing","path","closePath","ready","clearHandles","handleIn","isZero","smooth","handleOut","newPath","tempPath","clone","insert","deep","translate","Point","bounds","convertedJSON","convertPaperPointToBxObj","emitEvent","PathEvent","tempPath2","getRotation","oldBounds","canvasEvent","selected","project","hitTest","segments","tolerance","emitUpdatedJSON","add","downPoint","subtract","isLastUpdate","isFirstClick","handles","newCurve","curve","divideAt","segment1","contains","pathEditorOnEnd","getElementById","setup","tool","Tool","onMouseDrag","settings","handleSize","pointMode","actions","deleteSelectedPoint","straightenSelectedPoint","disconnectSelectedPoint","selectedColor","strokeColor","paperLayer","addLayer","pathJSON","getPaperPathFromPoints","xFactor","yFactor","applyMatrix","scale","topLeft","fillColor","view","draw","PathEditorPlugin","nameSpace","selectedTool","closed","canvasScroll","viewPort","getScrollShift","PathEditorRenderer","handlePathEditorEvents","handleEvent","mountEditor","targetLayer","getLineSegmentObject","getGradientFromLineSegmentObject","GradientEditorRenderer","newStops","lineSegmentObj","LineSegmentSliderInput","changeIndex","handleMove","removeHandle","onClickOutside","onWrapperMouseDown","onWrapperContexMenu","onWrapperDoubleClick","onWrapperMouseOut","onWrapperDrop","onWrapperMouseMove","onWrapperMouseUp","onDragStart","handleDragStart","onDragEnd","handleDragEnd","CommandEvent","commandParams","GradientEditorPlugin","stylePropName","isOpened","initialShift","gradientProps","closeEditor","NativeHtmlDrag","dragDom","boundMouseMove","boundMouseUp","disableSelect","handleHtmlDrag","StageDesignerDeviceData","getDeviceDataOnLayer","getDeviceData","ArtboardEvent","artboard","isFinal","LayerDragEvent","newDims","layerWorldX","layerWorldY","LayerDrag","applyDimensions","eventType","dragEventData","totalDx","totalDy","currentDeltaX","currentDeltaY","startAbsoluteX","startAbsoluteY","isShiftPressed","shiftDirection","startLayoutX","startLayoutY","layerDragEvent","isAltPressed","GridRenderer","gridData","gridLayers","createGrid","gridSize","has","gridLayersRef","gridElementMap","wrapperElement","gridWrapper","refreshGrid","setGridSize","pathElement","setAttributeNS","gridDims","svgns","svgElement","createElementNS","defsElement","patternElement","rectElement","showGrid","hideGrid","getGridSize","setGridOffset","getGridOffset","adjustStroke","SelectLayers","ResetResizerEvent","StageDesigner","targetDims","currentArtboard","currentRootLayer","newRootLayersHit","newRootLayer","x_overlap","y_overlap","overlapArea","previousMovedLayers","currentSelectedLayers","hitRectParams","getNewRootLayer","newToSelectLayers","newLayer","moveLayer","mouseUpEvent","mouseDownEvent","fromIndex","toIndex","fromParent","toParent","newRootLayerDims","newLayerDims","MIN_VALUE","artLeft","artTop","artboards","artboardClientRect","artMaxX","artMidY","addArtboard","removeArtboard","selectArtboard","getSelectedArtboard","getArtboard","focusArtboard","getAllArtboards","getArtboardById","getSelectedArtboardId","getNewArtboardPosition","getHitArtboard","artboardLayer","selectedArtboard","selectedArtboardLayers","lowestIndexArtboardLayers","allArtboards","lowestIndex","ignoredHitRectLayers","hitRectResultWithIgnored","currentLayerArtboard","modLayers","intersection","modifyEventForSelectableLayers","currentLayer","filteredLayer","filterIgnoredLayers","hitLayer","allRootLayers","artboardArray","setTopLayerSelectionMode","handlesWithoutRotation","h","filePath","DesignerEvent","artboardDims","forLayerDrag","allRootLayerChildren","topLayerSelectionMode","ancestorsList","ancestorSiblingsList","ancestor","topChildInHitLayers","findLast","LayerMouseCursorPlugin","DataStore","setData","getData","removeData","layerData","dataMap","TooltipPlugin","containerDiv","textAlign","alignItems","justifyContent","verticalAlign","borderRadius","background","coords","childNodes","OpacityShortcutPlugin","keycode","newOpacity","isModifierKeyPressed","altKey","ctrlKey","metaKey","shiftKey","previousEvent","timeStamp","opacityInString","selectedLayer","handleKeyPress","FontResizerEvent","FontResizerPlugin","textLayer","textLayerDims","newHandle","parentCenterY","parentCenterX","textLayerCenterY","textLayerCenterX","isInsideCenterBox","targetHandle","currentFontSize","ratioX","ratioY","newFontSize","currentDims","widthChanged","heightChanged","positionChanged","handleDrag","getHandles","disableDrag","parentBoundaries","layerCenterY","layerCenterX","transitionStyle","innerHTML","FlexDragPlugin","layersHeightWidth","layerOpacities","isFlex","revertParentDims","initialParentData","hasOwnProperty","getMarginAdjustedBounds","flexLayers","saveLayersHeightWidth","ghostLayer","layerStyles","copyLayer","wrapperLayerDims","ghostMove","ghostMouseUp","initialBounds","currentSnapshotData","cloneDeep","sibling","siblingDims","snapshotData","originalHW","previousLayer","prevLayerIndex","findAbsoluteNextLayer","findAbsolutePreviousLayer","nextLayer","nextLayerIndex","previousTriggerPoint","nextTriggerPoint","targetIndexInParent","findPreviousLayer","findNextLayer","currentTargetDims","previousLayerDims","calculateTriggerPoint","nextLayerDims","sortedSelectedLayers","sortBy","firstSelectedLayerIndex","lastSelectedLayerIndex","boundingBoxDims","boundingBoxDimsWRTParent","oldCenter","newCenter","crossedPreviousTriggerPoint","crossedNextTriggerPoint","targetLayerIndex","toMoveLayer","newTargetIndex","internalMove","revertBackToSnapshot","newPositionData","recordCurrentSnapshot","setFlexLayers","setTriggerPoints","beforeDragSnapshotData","changeToAbsolute","newChildLayout","every","saveSiblingOpacity","targetInitialDims","initialSnapshotData","endFlexLayerDragging","createGhostLayer","startGhostDragging","changeParentDims","targetGhostLayer","targetNewDims","oldCenterTargetLayer","newCenterTargetLayer","handleSwapWRTNewPosition","revertSiblingOpacity","clearFlexLayersHeightWidth","layerDragStart","layerDrag","layerDragEnd","layerResizerDrag","layerResizerDragEnd","Ruler","domWidth","domHeight","ratio","ruler","ctx","font","lineWidth","textBaseline","drawRuler","handleResize","select","HorizontalRuler","fontColor","bgColor","fontScale","perWidth","fillStyle","fillRect","tempX","moveTo","save","fillText","restore","lineTo","VerticalRuler","vertical","perHeight","tempY","RulerScaleWrapper","getPixelRatio","backingStore","backingStorePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","devicePixelRatio","horLineArr","verLineArr","shadow","fgColor","shadowColor","draggable","onDragStartHorizontal","onDrag","onDragHorizontal","onDragEndHorizontal","initialPoint","marginTop","onDragStartVertical","onDragVertical","onDragEndVertical","RulerScalePlugin","handleGhostImage","selectedLineIndex","disposeGhostImage","dragVal","showRulers","renderScale","hideRulers","setInitialPoint","crt","cloneNode","ghostImageDOM","dataTransfer","setDragImage","calculateScaleFromZoom","thick","lineColor","horLineValue","verLineValue","RulerLinesAddEvent","axisCoordinate","RulerLinesSetPositionEvent","RulerLinesRemoveEvent","RulerLinesPlugin","noEmit","lineWrapper","o","setPosition","dragEnd","indexOfLayer","axisPoint","viewportPoint","viewportAxisCoordinate","removeLine","addLine","coordinates","removeAll","addAll","getLineCoordinates","drawLinesForSnap","snapLinesX","querySelectorAll","snapLinesY","snapLine","drawLine","extraStyle","drawAllLinesForSnap","SnapLines","removeElementsWithClass","dragStartListener","dragListener","dragListenerDraw","dragListenerResizer","drawComponentMouseMoveListener","LineDrawerDragEvent","LineDrawer","startCoordinate","endCoordinate","label","lineWrappedLayer","lineWrapperDim","labelBox","boxWidth","boxHeight","labelSpacing","lineLength","onmouseover","onmouseleave","ondragstart","ondrag","ondragend","createLabelBox","setLabelBoxStyle","pointOnAxis","iconRight","iconLeft","getButtonCss","getImgCss","containerCss","StageDesignerPreviewModePlugin","disposeNextBtn","disposePreviousBtn","currentMode","previewMode","stageMode","renderNextButton","renderPreviousButton","previousBtnContainerNode","nextBtnContainerNode","prevImgElement","cssText","prevBtnElement","nextBtnElement","nextImgElement","setPreviousButtonContainerLayout","setNextButtonContainerLayout","setDisplayForButtons","handleSelectedArtboardChange","nextArtboard","selectedArtboardIndex","previousArtboard","isEqual","onclick","append","containerLayout","StageDesignerDropEvent","StageDesignerDropPlugin","draggedLayerStyles","JSON","parse","offsetX","offsetY","pop","StageDesignerDrawEvent","StageDesignerDrawComponent","relativeDims","getDimsFromArtboard","stageDesignerDrawEvent","drawShape","oldSelectedArtboard","setSelectedArtboard","stageDesignerDrawStartEvent","stageDesignerDrawEndEvent","stageDesignerClickEvent","relativeX","relativeY","layerX","layerY","addListeners","StageDesignerRulerPlugin","rulerVisibility","artboardLines","artboardLinesMap","rulerLines","artboardAxisCoordinate","artboardSelected","getAllLines","showRuler","hideRuler","DrawEvent","DrawComponent","shapeType","initialDimensions","initialDelta","newDimensions","dragSession","overlayLayer","ellipseRenderer","strokeZoomAdjustment","viewportDims","overlayDispose","clickEvent","abortDraw","dragStartVal","dimension","drawStartEvent","setSnapPoints","LayerLabelEvent","LayerLabel","layerLabelMap","labeltextNode","updateLabelLayout","setLabel","layerLabel","layertextNode","removeLabel","layerCallback","removeCallback","hideLabel","labelNode","showLabel","addLabel","labeltext","textOverflow","labelDragStartEvent","labelDragEvent","labelDragEndEvent","labelClickEvent","layerDoubleClickEvent","selectedArtboardChanged","IPhoneXFrame","deviceOrientation","computedLeft","computedTop","computedTransform","styleObject","xmlnsXlink","fillRule","IPhoneXsMaxFrame","DeviceFrame","DeviceFrameMap","layerTextNode","FrameComponent","deviceFrame","deviceFrameMap","frameNode","deviceName","toLowerCase","removeFrame","addFrame","wrapperDiv","BatterySection","NetworkSection","RightSection","LeftSection","TimeSection","BackgroundRect","StatusBarComponent","getElement","deviceOS","barColor","deviceWidth","deviceHeight","IPHONEX_OR_IPHONEXS","IPHONEXR_OR_IPHONEXSMAX","IOS","WEB","barStyle","IOSStatusBar","IPhoneXStatusBar","AndroidStatusBar","StatusBar","statusBarMap","removeStatusBar","addStatusBar","ResizerRendererDragEvent","getInitialRotation","handleName","getRotationResizerIcon","getHorizontalResizerIcon","ResizerRendererPlugin","dragLayer","handleLayerListeners","resizerData","resizerHandleLayersRef","setHandleStyle","handleInstance","rotationHandleSize","propsWithoutPx","fixedLayoutProps","rotatorPos","handleLayer","rotatorPropsWithoutPx","handleRotator","addEventListeners","rotationType","dragData","handleDragStarted","escape","renderCursor","renderHandles","isVisible","renderResizer","toggleResizer","showHandle","toUpperCase","hideHandle","setResizerOrientation","passedEvent","e1","passEvent","hideAllHandles","renderDragLayer","UndoRedoPlugin","store","LayerResizerEvent","LayerResizerPlugin","handlesForFill","flexSiblings","getHandlesForFlexLayer","parentFlexDirection","getHandlesForFlexLayerWithSiblings","getResizerHandlesLayout","resizer","childrenLength","isLayerAbsolute","handlesForAutoOrAbs","getHandlesForAutoOrAbsoluteLayer","getHandlesForFill","handlesHere","layersQueuedForUpdate","hideLayerResizer","setSelectedLayers","showLayerResizer","rerenderHandles","boundQueueUpdates","queueUpdate","getParentRelativeDims","setNewLayout","normalizeChildrenFlex","totalChildrenFlex","newFlex","setLayoutChildren","normalizeForFlex","some","layoutElementArray","layoutChild","startFlex","setLayoutChildSize","deltaFactor","startDims","getDeltaFactor","dragLayout","eventName","originalDelta","selectedLayerFlex","expectedFlex","totalFlex","dragLayoutIsDoable","applyDimensionsForHandle","rotateDelta1","absoluteRotation","selectedLayerDims","rotationDelta","ROTATION_FACTOR","multiplicationFactor","isFlexChildren","maintainAspectRatio","parentRootDims","newDimension","FloatingButton","addFloatingButton","removeFloatingButton","caption","GradientEditorEvent","task","PlusButton","addPlusButton","showPlusButton","hidePlusButton","removePlusButton","handleZoom","positionPlusButton","sourceCapabilities","HtmlDragToWorldPlugin","dx","dy","initPos","setStartValues","startDragSession","lastPos","drag","updateDragSession","endDragSession","DesignerKeyboardEvent"],"mappings":"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"}
import { Layer } from "@builderx-core/designer";
import { forEach } from "lodash";
import { SessionEvent } from "event-manager";
import { Session, StageArtboard } from "session";
import { globalRefMap } from "global-ref-map";

function applySideEffects(layer: any, key: string) {
  const compiledLayers = globalRefMap.get(layer);
  forEach(compiledLayers, (compiledLayer: Layer | StageArtboard) => {
    // @ts-ignore
    compiledLayer.removeProp(key);
  });
}

export default function RemovePropGlue(session: Session, e: SessionEvent) {
  applySideEffects(e.payload.layer, e.payload.key);
}

import { Layer } from "@builderx-core/designer";
import { forEach } from "lodash";
import { SessionEvent } from "event-manager";
import { Session } from "session";

function applySideEffects(session: Session, value: boolean) {
  if (session.currentStage.canvas) {
    forEach(session.currentStage.canvas.children, (artboard: Layer) => {
      if (value) {
        artboard.executeFunction("showGrid", {
          x: session.drivers.configuration.get("editor.grid.row"),
          y: session.drivers.configuration.get("editor.grid.column")
        });
      } else {
        artboard.executeFunction("hideGrid");
      }
    });
  }
}

export default function SetGridVisibilityGlue(
  session: Session,
  e: SessionEvent
) {
  applySideEffects(session, e.payload.value);
}

import { DomainLayer, DomainFile } from "domain-x";
import { forEach, find } from "lodash";
import { SessionEvent } from "event-manager";
import { Session } from "session";

function applySideEffects(session: Session, layers: Array<DomainLayer>) {
  let canvasLayers: any = [];
  forEach(layers, (domainLayer: DomainLayer) => {
    if (
      domainLayer &&
      domainLayer.type !== "file" &&
      domainLayer.type !== "root"
    ) {
      const canvasLayer = domainLayer.getOwnCanvasRef();

      if (canvasLayer) {
        canvasLayers.push(canvasLayer);
      }
    }
  });
  session.currentStage.canvas.setHoverLayers(canvasLayers);
}

export default function SetHoverLayersGlue(session: Session, e: SessionEvent) {
  applySideEffects(session, e.payload.layers);
}

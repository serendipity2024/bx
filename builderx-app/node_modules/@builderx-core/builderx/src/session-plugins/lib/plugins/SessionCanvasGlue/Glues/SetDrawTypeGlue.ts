import { SessionEvent } from "event-manager";
import { Session } from "session";
import { PathEvent } from "@builderx-core/designer";

function applySideEffects(session: Session, drawType: string) {
  if (drawType !== "default" && drawType !== "path") {
    let cursor;
    switch (drawType) {
      case "text":
        cursor = "text";
        break;
      case "image":
        cursor = "auto";
        break;
      default:
        cursor = "crosshair";
    }
    const shapeType = drawType === "ellipse" ? "ellipse" : "rect";
    session.currentStage.canvas.executeFunction("drawShape", shapeType, cursor);
  } else if (drawType === "default") {
    session.currentStage.canvas.executeFunction("abortDraw");
  }

  if (drawType !== "path") {
    session.currentStage.canvas.executeFunction("PathEditor.unmount");
  } else if (drawType === "path") {
    // session.currentStage.canvas.executeFunction("ResizerRenderer.hide");
    // session.currentStage.canvas.executeFunction(
    //   "PathEditor.open",
    //   new PathEvent("PathEditor.open", session.currentStage.canvas, {
    //     selectedTool: "pen"
    //   })
    // );
  }
}

export default function SetDrawTypeGlue(session: Session, e: SessionEvent) {
  applySideEffects(session, e.payload.drawType);
}

import { set } from "lodash";

const electron = window["require"]("electron");
const path = window["require"]("path");
const electronIsDev = window["require"]("electron-is-dev");
const getPort = window["require"]("get-port");
const Store = window["require"]("electron-store");
const store = {};

export default async () => {
  // console.log(__dirname, "__dirname");
  let port = await getPort({ port: 9080 });
  console.log(port, electron.remote.process.env, "port boot");
  // ,console.log(e, s.remote.process.env, "&*&*&*&")
  if (electronIsDev) {
    // window["require"](
    //   path.join(
    //     electron.remote.app.getAppPath(),
    //     "src",
    //     "server",
    //     "dist",
    //     "server",
    //     "src"
    //   )
    // );
    port = 9090;
  } else {
    // set(electron, "remote.process.env.EXPRESS_PORT", port);
    electron.remote.process.env.EXPRESS_PORT = port;
    // store.set("EXPRESS_PORT", port);
    window["require"](
      path.join(
        electron.remote.app.getAppPath(),
        "build",
        "_",
        "server",
        "dist"
      )
    );
  }

  console.log(port, "hello port");

  return port;
};

import { Context, ExtraParams } from "../types";
import { addImportToContext } from "../utils";
import LayerCodeGen from "../LayerCodeGen";

export default class LoopCodeGen extends LayerCodeGen {
  context: Context;
  constructor(context: Context) {
    super();
    this.context = context;
  }

  generate(json: any, extraParams: ExtraParams): string {
    addImportToContext(this.context, {
      import: {
        isDefaultImport: false,
        layerName: "times",
        packageName: "lodash"
      }
    });

    return ` {times(${
      json.template.repetitions
    }, () =>  ${this.context.baseCodeGen.generate(json.children[0], {
      ...extraParams,
      parent: json
    })})}`;
  }
}

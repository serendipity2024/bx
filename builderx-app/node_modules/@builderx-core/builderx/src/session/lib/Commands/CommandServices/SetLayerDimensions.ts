import { SetAllStyleService } from "./SetAllStyleService";
import { Session } from "../../models/Session";
import { Dimension } from "../../models/types";
import createService from ".";

export const SetLayerDimensionsService = createService(
  "SetLayerDimensionsService",
  (session: Session, domainLayerPath: string, newDimensions: Dimension) => {
    const domainLayer = session.getLayerFromLayerPath(domainLayerPath);
    if (domainLayer) {
      const compiledLayer = domainLayer.getOwnCanvasRef();
      if (newDimensions.width && newDimensions.width < 1) {
        newDimensions.width = 1;
      }
      if (newDimensions.height && newDimensions.height < 1) {
        newDimensions.height = 1;
      }
      if (newDimensions.rotation) {
        newDimensions.rotation = Math.round(newDimensions.rotation);
      }
      const layerLayout = compiledLayer.convertLayerDimensions({
        ...newDimensions
      });
      SetAllStyleService(session, domainLayerPath, layerLayout);
    }
    // if (
    //   session.currentStage.id.includes("layer:") &&
    //   session.currentRootLayer.type === "scrollView"
    // ) {
    //   CommandUtils.setScrollViewContentContainerStyle(
    //     session,
    //     session.currentRootLayer
    //   );
    // }
  }
);

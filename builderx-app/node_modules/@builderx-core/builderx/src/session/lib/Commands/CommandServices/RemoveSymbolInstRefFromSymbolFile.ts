import { isNil } from "lodash";
import { Session } from "../../models/Session";
import createService from ".";

export const RemoveSymbolInstRefFromSymbolFile = createService(
  "RemoveSymbolInstRefFromSymbolFile",
  (session: Session, domainLayerPath: string) => {
    const domainLayer = session.getLayerFromLayerPath(domainLayerPath);
    if (domainLayer.type === "symbol") {
      const symbolFile = session.domain.getSymbolFileFromSymbolInstance(
        domainLayer
      );
      if (!symbolFile) {
        return;
      }
      const index = symbolFile.symbolInstances.indexOf(domainLayer);
      if (!isNil(index) && index !== -1) {
        symbolFile.symbolInstances.splice(index, 1);
      }
    }
  }
);

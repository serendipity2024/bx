import { ICommand } from "command-manager";
import { Session } from "../../models/Session";
import { isNil } from "lodash";

export default class SetRequestCounter implements ICommand {
  displayName = "SetRequestCounter";
  session: Session;
  operation?: "+" | "-";
  astNetworkRequestCounter: number;
  constructor(
    session: Session,
    operation?: "+" | "-",
    astNetworkRequestCounter: number = 0
  ) {
    this.session = session;
    this.operation = operation;
    this.astNetworkRequestCounter = astNetworkRequestCounter;
  }
  execute() {
    if (this.operation) {
      if (this.operation === "+") {
        this.session.networkRequestCounter++;
      } else if (
        this.operation === "-" &&
        this.session.networkRequestCounter !== 0
      ) {
        this.session.networkRequestCounter--;
      }
      this.session.emit("networkRequestCounter");
    }

    if (!isNil(this.astNetworkRequestCounter)) {
      this.session.astNetworkRequestCounter = this.astNetworkRequestCounter;
      this.session.emit("astNetworkRequestCounter");
    }
  }
  undo() {
    //
  }
  redo() {
    //
  }
}

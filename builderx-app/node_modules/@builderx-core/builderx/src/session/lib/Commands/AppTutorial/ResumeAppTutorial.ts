import { ICommand } from "command-manager";
import { Session } from "../../models/Session";
import SetConfig from "../Workspace/SetConfig";
export default class ResumeAppTutorial implements ICommand {
  displayName = "ResumeAppTutorial";
  session: Session;
  userInitiated: boolean;
  refreshed: boolean;

  constructor(
    session: Session,
    userInitiated: boolean = false,
    refreshed: boolean = true
  ) {
    this.session = session;
    this.userInitiated = userInitiated;
    this.refreshed = refreshed;
  }
  execute() {
    this.session.commandManager.executeAndSkip(
      new SetConfig(this.session, "app.tutorial.skipped", false)
    );
    if (this.userInitiated) {
      this.session.commandManager.executeAndSkip(
        new SetConfig(this.session, "app.tutorial.userInitiated", true)
      );
      if (
        this.session.drivers.configuration.get("app.tutorial.pageRefreshed")
      ) {
        this.session.commandManager.executeAndSkip(
          new SetConfig(this.session, "app.tutorial.pageRefreshed", false)
        );
      }
    }
    window.onbeforeunload = () => {
      this.session.drivers.configuration.set(
        "app.tutorial.pageRefreshed",
        true
      );
    };
    if (!document) {
      this.session.drivers.analyticsService.addActivity(
        {
          name: `app.tutorial.resumed`,
          path: "",
          category: "app/command"
        },
        true
      );
    }
  }
  undo() {
    //
  }
  redo() {
    //
  }
}

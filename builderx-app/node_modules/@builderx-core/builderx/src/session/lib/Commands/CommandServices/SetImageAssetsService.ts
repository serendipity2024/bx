import createService from ".";
import { Session } from "../../models/Session";
import SetPropMutator from "../../Mutators/SetPropMutator";

export const SetImageAssetsService = createService(
  "SetImageAssets",
  (
    session: Session,
    layerPath: string,
    relativePath: string,
    imageBlobURL: any
  ) => {
    console.log("hello here", "hello 111", relativePath);
    const asset = session.assetsMap.get(relativePath);
    const layer = session.getLayerFromLayerPath(layerPath);
    if (asset && !asset.refs.includes(layer)) {
      asset.refs.push(layer);
    }
    if (imageBlobURL) {
      // SetImageSourceURIMutator(
      //   session,
      //   layer.getFullPath(),
      //   imageBlobURL,
      //   relativePath
      // );

      SetPropMutator(session, layer.getFullPath(), "source_local", {
        uri: imageBlobURL,
        relativePath
      });
    }
  }
);

import * as React from "react";

import { SetModalRoute } from "../../../../Commands";
import { Session } from "../../../../models/Session";

import ErrorMsgBox from "../../ErrorMessageBox";
import { action } from "model";
import { Utils } from "utils";

type propType = {
  session: Session;
};
export default class ApplicationExpired extends React.Component<propType, any> {
  reloadPage() {
    // window.parent.location.reload();
    Utils.reloadParentWindow();
  }
  quitApp = () => {
    this.props.session.drivers.appLifeCycleService.quitApp();
  };
  buyLicence = () => {
    this.props.session.drivers.appLifeCycleService.openWeb(
      "https://builderx.io/pricing"
    );
  };
  enterLicenceKey = () => {
    action(() => {
      this.props.session.commandManager.executeAndSkip(
        new SetModalRoute(this.props.session, "activation/licencekeyform")
      );
    });
  };
  changeEmailAddress = () => {
    action(() => {
      this.props.session.commandManager.executeAndSkip(
        new SetModalRoute(this.props.session, "activation/changeEmailAddress")
      );
    });
  };
  render() {
    return (
      <ErrorMsgBox
        errorHeading="Trial Expired"
        errorMsg={`Your copy of BuilderX is not activated and it's trial period has expired.
        Please buy a licence`}
        errorAction={true}
        email={this.props.session.drivers.userService.email}
        changeEmailAddress={this.changeEmailAddress}
        noInternet={this.reloadPage}
        quitApp={this.quitApp}
        buyNowBtn={true}
        buyLicence={this.buyLicence}
        enterLicenceKey={this.enterLicenceKey}
      />
    );
  }
}

import * as React from "react";
import {
  WindowWrapper,
  Form,
  WindowBody,
  Pane,
  Logo,
  FormGroup,
  FormRow,
  Title,
  InputGroupInput,
  RadioButtonBox,
  RadioButton,
  RadioButtonLabel,
  WindowFooter,
  ButtonGroup,
  Button,
  Text,
  Window
} from "components-x";

export default class ActivationForm extends React.Component<any, any> {
  constructor(props: any) {
    super(props);
    this.state = {
      userEmail: "",
      role: "",
      userName: "",
      isSubmitting: false
    };
  }
  get emailVerified() {
    if (!this.state.userEmail) {
      return false;
    }
    if (this.state.userEmail.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)) {
      return true;
    } else {
      return false;
    }
  }
  onSubmit(e: any) {
    // e.preventDefault();
    this.setState({ ...this.state, isSubmitting: true });
    if (
      this.state.isSubmitting &&
      this.emailVerified &&
      this.state.userName &&
      this.state.role
    ) {
      // console.log(e.target.value, "onSubmit");
      this.props.activate(
        this.state.userEmail,
        this.state.userName,
        this.state.role
      );
    }
  }
  keyPress(e: any) {
    // e.preventDefault();
    if (e.charCode === 13) {
      this.onSubmit(e);
    }
  }
  handleChange = (e: any, key: string) => {
    this.setState({
      [key]: e.target.value
    });
  };

  render() {
    return (
      <WindowWrapper>
        <Window uiSize="s">
          <Form
            onSubmit={(e: any) => {
              e.preventDefault();
              this.onSubmit(e);
            }}
          >
            <WindowBody>
              <Pane contentCenter={true} uiBackground={800} padder="s">
                <Logo
                  src={this.props.builderxAssetsUrl + "/images/logo.png"}
                  uiSize="l"
                />
                <FormGroup noPadding>
                  <FormRow>
                    <Title uiSize="m" uiColor={200}>
                      BuilderX Version {this.props.appVersion}
                    </Title>
                  </FormRow>
                  <FormRow>
                    <Title uiSize="s" uiColor={200}>
                      Activate BuilderX
                    </Title>
                  </FormRow>
                  <FormRow>
                    <InputGroupInput
                      type="text"
                      uiSize="l"
                      autoFocus={true}
                      onChange={(e: any) => this.handleChange(e, "userName")}
                      value={this.state.userName}
                      placeholder="Enter Your Name"
                    />
                  </FormRow>
                  <FormRow noPadding>
                    <Text uiSize={"m"}>
                      {this.state.isSubmitting && !this.state.userName
                        ? "This field is required"
                        : ""}
                    </Text>
                  </FormRow>
                  <FormRow noPadding>
                    <InputGroupInput
                      type="text"
                      uiSize="l"
                      onChange={(e: any) => this.handleChange(e, "userEmail")}
                      value={this.state.userEmail}
                      placeholder="Enter Your Email Address"
                    />
                  </FormRow>
                  <FormRow noPadding>
                    <Text uiSize={"m"}>
                      {this.state.isSubmitting && !this.emailVerified
                        ? this.state.userEmail
                          ? "Please enter a valid email"
                          : "This field is required"
                        : ""}
                    </Text>
                  </FormRow>
                  <FormRow marginTop={12}>
                    <Text uiSize={"m"}>Are you a designer or a developer?</Text>
                  </FormRow>
                  <FormRow marginLeft={17} marginTop={7}>
                    <RadioButtonBox>
                      <RadioButton
                        name="role"
                        value="designer"
                        checked={this.state.role === "designer"}
                        onChange={(e: any) => this.handleChange(e, "role")}
                      />
                      <RadioButtonLabel>Designer</RadioButtonLabel>
                    </RadioButtonBox>
                  </FormRow>
                  <FormRow marginLeft={17}>
                    <RadioButtonBox>
                      <RadioButton
                        name="role"
                        value="developer"
                        checked={this.state.role === "developer"}
                        onChange={(e: any) => this.handleChange(e, "role")}
                      />
                      <RadioButtonLabel>Developer</RadioButtonLabel>
                    </RadioButtonBox>
                  </FormRow>
                  <FormRow marginLeft={17}>
                    <RadioButtonBox>
                      <RadioButton
                        name="role"
                        value="both"
                        checked={this.state.role === "both"}
                        onChange={(e: any) => this.handleChange(e, "role")}
                      />
                      <RadioButtonLabel>Both</RadioButtonLabel>
                    </RadioButtonBox>
                  </FormRow>
                  <FormRow marginLeft={17}>
                    <RadioButtonBox>
                      <RadioButton
                        name="role"
                        value="neither"
                        checked={this.state.role === "neither"}
                        onChange={(e: any) => this.handleChange(e, "role")}
                      />
                      <RadioButtonLabel>Neither</RadioButtonLabel>
                    </RadioButtonBox>
                  </FormRow>
                </FormGroup>
              </Pane>
            </WindowBody>
            <WindowFooter>
              <Pane padder="xs" uiBackground={800}>
                <ButtonGroup
                  contentRight={true}
                  style={{ width: 70, padding: 0, height: 28 }}
                >
                  <Button
                    uiBackground={500}
                    actionBtn={true}
                    color={0}
                    // borderRadius={true}
                    border={true}
                    caption="Activate"
                    // minWidth={true}
                    uiSize="m"
                    onClick={(e: any) => this.onSubmit(e)}
                    active
                  />
                </ButtonGroup>
              </Pane>
            </WindowFooter>
          </Form>
        </Window>
      </WindowWrapper>
    );
  }
}

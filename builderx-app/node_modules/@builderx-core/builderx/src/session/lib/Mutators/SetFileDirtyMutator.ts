import { IMutator } from "common-interfaces";
import { Session } from "../models/Session";
import { File as DomainFile } from "domain-x";
import { isNil } from "lodash";

export default function SetFileDirtyMutator(
  session: Session,
  filePath: string,
  isDirty: boolean
) {
  //
  // if (session.readonly) {
  //   return;
  // }
  // const file = session.domain.files.get(filePath);
  // if (!file) {
  //   return;
  // }
  // if (file && !session.readonly && session.globalStateService.setDirty) {
  //   // file.isDirty = isDirty;
  //   session.emitPatch({
  //     op: "replace",
  //     path: `/domain/files:::${filePath}:::/isDirty`,
  //     value: isDirty
  //   });
  //   if (isDirty) {
  //     const index = session.dirtyFiles.indexOf(file);
  //     if (isNil(index) || index === -1) {
  //       // session.dirtyFiles.push(file);
  //       session.emitPatch({
  //         op: "replace",
  //         path: `/dirtyFiles/-`,
  //         value: file
  //       });
  //     }
  //   }
  //   // if (!session.currentStage.dragging) {
  //   //   file.emit("isDirty");
  //   // }
  // }
}

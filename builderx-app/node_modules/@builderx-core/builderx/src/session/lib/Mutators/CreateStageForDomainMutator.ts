import { Session } from "../models/Session";
import { AddStageMutator } from ".";
import { SessionEvent } from "event-manager";
import AddStageArtboardMutator from "./AddStageArtboardMutator";
import { DomainLayer } from "domain-x";
// import { Layer as CompiledLayer } from "@builderx-core/designer";

export default function CreateStageForDomainMutator(
  session: Session,
  stageId: string,
  domainLayerPath: string
) {
  stageId = stageId ? stageId : `layer:${domainLayerPath}`;
  const domainLayer: DomainLayer = session.getLayerFromLayerPath(
    domainLayerPath
  );
  if (!domainLayer) {
    return;
  }
  const stage = AddStageMutator(session, stageId);

  const file = domainLayer.getFile();
  if (!file) {
    return;
  }

  const stageArtboard = AddStageArtboardMutator(
    session,
    stageId,
    file.path,
    domainLayer.getFullPath()
  );

  return stage;
}

import { Session } from "../models/Session";
import { SetFileDirtyMutator } from ".";
import { SessionEvent } from "event-manager";

export default function RemoveFileMutator(session: Session, filePath: string) {
  let fileId = filePath;
  const file = session.domain.files.get(fileId);
  if (!file) {
    return;
  }

  if (file.isSymbol()) {
    const stage = session.stages.get(filePath);

    if (stage) {
      session.emitPatch({
        op: "remove",
        path: `/stages:::${filePath}`
      });
    }
  }

  session.emitPatch({
    op: "remove",
    path: `/domain/files:::${filePath}`
  });

  // const firstFilePath = session.domain.files.keys().next().value;
  // SetFileDirtyMutator(session, firstFilePath, true);
}

import { Session } from "../models/Session";
import { SessionEvent } from "event-manager";
import { SetFileDirtyMutator } from ".";

export default function SetStatusBarMutator(
  session: Session,
  filePath: string,
  value: any
) {
  const file = session.domain.files.get(filePath);
  if (!file) {
    return;
  }

  if (value) {
    session.emitPatch({
      op: "replace",
      path: `/domain/files:::${filePath}:::/statusBar`,
      value: value
    });
    // file.statusBar = value;
    // file.emit("statusBar");
    // const event = new SessionEvent("setStatusBar", {
    //   file
    // });
    // session.eventManager.dispatchEvent("setStatusBar", event);
    SetFileDirtyMutator(session, file.path, true);
  }

  return file;
}

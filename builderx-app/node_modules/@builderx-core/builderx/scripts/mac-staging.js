"use strict";

const builder = require("electron-builder");
var _ = require("lodash");

var BuildConfig = require("./build-config");
// Promise is returned

const Platform = builder.Platform;
_.set(
  BuildConfig,
  "icon",
  "./src/electron-app/assets/NightlyBuildIcons/icon.icns"
);
_.set(
  BuildConfig,
  "mac.icon",
  "./src/electron-app/assets/NightlyBuildIcons/icon.icns"
);
_.set(BuildConfig, "mac.extendInfo.NSAppTransportSecurity", {
  NSAllowsArbitraryLoads: true
});
_.set(BuildConfig, "appId", "com.geekyants.builderxnightly");
_.set(BuildConfig, "productName", "BuilderX Nightly");
// console.log(Platform.MAC.createTarget(), "MKB");
builder
  .build({
    targets: Platform.MAC.createTarget(),
    config: BuildConfig
  })
  .then(() => {
    console.log("Build Successful");
    // handle result
  })
  .catch(error => {
    console.log("", error);
    // handle error
  });
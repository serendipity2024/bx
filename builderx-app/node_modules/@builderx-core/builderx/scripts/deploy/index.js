var envPath =
  process.env.NODE_ENV === "production"
    ? __dirname + "/../../.env.production"
    : __dirname + "/../../.env.local";
var dotenv = require("dotenv").config({ path: envPath });
const path = require("path");
const uploadFile = require("./uploadFile");
var packageJson = require(__dirname + "/../../package.json");

var appName =
  process.env.NODE_ENV === "production" ? "BuilderX" : "BuilderX Nightly";
var archiveName =
  process.env.NODE_ENV === "production" ? "BuilderX" : "BuilderX_Nightly";

const version = packageJson.version;
console.log("version: " + version);
console.log(
  "url===",
  dotenv.parsed.REACT_APP_BUILDERX_DOWNLOAD_URL + "release/upload"
);
const timestamp = Date.now();
console.log("timestamp: " + timestamp);
const url = `${dotenv.parsed.REACT_APP_BUILDERX_DOWNLOAD_URL}release/upload`;
const token = "BuilderX@Geekyants123";

const zipFilePath = path.resolve(
  `${__dirname}/../../dist/${appName}-${version}-mac.zip`
);

const zipFileName = `${archiveName}-${version}-mac-${timestamp}.zip`;

const dmgFilePath = path.resolve(
  `${__dirname}/../../dist/${appName}-${version}.dmg`
);
const dmgFileName = `${archiveName}-${version}-mac-${timestamp}.dmg`;
console.log("url===", url);
uploadFile(url, zipFilePath, zipFileName, version, timestamp, token);
uploadFile(url, dmgFilePath, dmgFileName, version, timestamp, token);
